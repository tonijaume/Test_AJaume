OBJECT Page 9227 Sales Analysis by Dim Matrix
{
  OBJECT-PROPERTIES
  {
    Date=05/11/08;
    Time=12:00:00;
    Version List=NAVW16.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Sales Analysis by Dim Matrix;
               ESP=Matriz an lisis venta por dim.];
    LinksAllowed=No;
    SourceTable=Table367;
    PageType=List;
    OnInit=BEGIN
             Field32Visible := TRUE;
             Field31Visible := TRUE;
             Field30Visible := TRUE;
             Field29Visible := TRUE;
             Field28Visible := TRUE;
             Field27Visible := TRUE;
             Field26Visible := TRUE;
             Field25Visible := TRUE;
             Field24Visible := TRUE;
             Field23Visible := TRUE;
             Field22Visible := TRUE;
             Field21Visible := TRUE;
             Field20Visible := TRUE;
             Field19Visible := TRUE;
             Field18Visible := TRUE;
             Field17Visible := TRUE;
             Field16Visible := TRUE;
             Field15Visible := TRUE;
             Field14Visible := TRUE;
             Field13Visible := TRUE;
             Field12Visible := TRUE;
             Field11Visible := TRUE;
             Field10Visible := TRUE;
             Field9Visible := TRUE;
             Field8Visible := TRUE;
             Field7Visible := TRUE;
             Field6Visible := TRUE;
             Field5Visible := TRUE;
             Field4Visible := TRUE;
             Field3Visible := TRUE;
             Field2Visible := TRUE;
             Field1Visible := TRUE;
             TotalInvtValueVisible := TRUE;
             TotalQuantityVisible := TRUE;
           END;

    OnOpenPage=BEGIN
                 ApplyColumnFilter;

                 Field1Visible := 1 <= NoOfRecords;
                 Field2Visible := 2 <= NoOfRecords;
                 Field3Visible := 3 <= NoOfRecords;
                 Field4Visible := 4 <= NoOfRecords;
                 Field5Visible := 5 <= NoOfRecords;
                 Field6Visible := 6 <= NoOfRecords;
                 Field7Visible := 7 <= NoOfRecords;
                 Field8Visible := 8 <= NoOfRecords;
                 Field9Visible := 9 <= NoOfRecords;
                 Field10Visible := 10 <= NoOfRecords;
                 Field11Visible := 11 <= NoOfRecords;
                 Field12Visible := 12 <= NoOfRecords;
                 Field13Visible := 13 <= NoOfRecords;
                 Field14Visible := 14 <= NoOfRecords;
                 Field15Visible := 15 <= NoOfRecords;
                 Field16Visible := 16 <= NoOfRecords;
                 Field17Visible := 17 <= NoOfRecords;
                 Field18Visible := 18 <= NoOfRecords;
                 Field19Visible := 19 <= NoOfRecords;
                 Field20Visible := 20 <= NoOfRecords;
                 Field21Visible := 21 <= NoOfRecords;
                 Field22Visible := 22 <= NoOfRecords;
                 Field23Visible := 23 <= NoOfRecords;
                 Field24Visible := 24 <= NoOfRecords;
                 Field25Visible := 25 <= NoOfRecords;
                 Field26Visible := 26 <= NoOfRecords;
                 Field27Visible := 27 <= NoOfRecords;
                 Field28Visible := 28 <= NoOfRecords;
                 Field29Visible := 29 <= NoOfRecords;
                 Field30Visible := 30 <= NoOfRecords;
                 Field31Visible := 31 <= NoOfRecords;
                 Field32Visible := 32 <= NoOfRecords;

                 GLSetup.GET;
                 NormalFormatString := Text001 + GLSetup."Amount Decimal Places" + Text002;
               END;

    OnFindRecord=BEGIN
                   EXIT(
                     ItemAnalysisMgt.FindRec(
                       ItemAnalysisView,LineDimOption,Rec,Which,
                       ItemFilter,LocationFilter,PeriodType,DateFilter,PeriodInitialized,InternalDateFilter,
                       Dim1Filter,Dim2Filter,Dim3Filter));
                 END;

    OnNextRecord=BEGIN
                   EXIT(
                     ItemAnalysisMgt.NextRec(
                       ItemAnalysisView,LineDimOption,Rec,Steps,
                       ItemFilter,LocationFilter,PeriodType,DateFilter,
                       Dim1Filter,Dim2Filter,Dim3Filter));
                 END;

    OnAfterGetRecord=BEGIN
                       "+QuantityHideValue" := FALSE;
                       IF TotalQuantityVisible THEN
                         Quantity := CalcAmt(DimCodeBufferColumn,2,FALSE);
                       IF TotalInvtValueVisible THEN
                         Amount := CalcAmt(DimCodeBufferColumn,0,FALSE);
                       Steps := 1;
                       ApplyColumnFilter;
                       Which := '-';

                       ItemAnalysisMgt.FindRec(
                         ItemAnalysisView,ColumnDimOption,DimCodeBufferColumn3,Which,
                         ItemFilter1,LocationFilter1,PeriodType,DateFilter1,PeriodInitialized,InternalDateFilter,
                         Dim1Filter1,Dim2Filter1,Dim3Filter1);

                       i := 1;
                       WHILE (i <= NoOfRecords) AND (i <= ARRAYLEN(MatrixColumnCaptions)) DO BEGIN
                         MatrixData[i] := CalcAmt(DimCodeBufferColumn3,ValueType,TRUE);
                         ItemAnalysisMgt.NextRec(
                           ItemAnalysisView,ColumnDimOption,DimCodeBufferColumn3,Steps,
                           ItemFilter1,LocationFilter1,PeriodType,DateFilter1,
                           Dim1Filter1,Dim2Filter1,Dim3Filter1);
                         i := i + 1;
                       END;
                       OnAfterGetCurrRecord;
                       QuantityOnFormat(FORMAT(+Quantity));
                       AmountOnFormat(FORMAT(+Amount));
                       MatrixData1OnFormat(FORMAT(MatrixData[1]));
                       MatrixData2OnFormat(FORMAT(MatrixData[2]));
                       MatrixData3OnFormat(FORMAT(MatrixData[3]));
                       MatrixData4OnFormat(FORMAT(MatrixData[4]));
                       MatrixData5OnFormat(FORMAT(MatrixData[5]));
                       MatrixData6OnFormat(FORMAT(MatrixData[6]));
                       MatrixData7OnFormat(FORMAT(MatrixData[7]));
                       MatrixData8OnFormat(FORMAT(MatrixData[8]));
                       MatrixData9OnFormat(FORMAT(MatrixData[9]));
                       MatrixData10OnFormat(FORMAT(MatrixData[10]));
                       MatrixData11OnFormat(FORMAT(MatrixData[11]));
                       MatrixData12OnFormat(FORMAT(MatrixData[12]));
                       MatrixData13OnFormat(FORMAT(MatrixData[13]));
                       MatrixData14OnFormat(FORMAT(MatrixData[14]));
                       MatrixData15OnFormat(FORMAT(MatrixData[15]));
                       MatrixData16OnFormat(FORMAT(MatrixData[16]));
                       MatrixData17OnFormat(FORMAT(MatrixData[17]));
                       MatrixData18OnFormat(FORMAT(MatrixData[18]));
                       MatrixData19OnFormat(FORMAT(MatrixData[19]));
                       MatrixData20OnFormat(FORMAT(MatrixData[20]));
                       MatrixData21OnFormat(FORMAT(MatrixData[21]));
                       MatrixData22OnFormat(FORMAT(MatrixData[22]));
                       MatrixData23OnFormat(FORMAT(MatrixData[23]));
                       MatrixData24OnFormat(FORMAT(MatrixData[24]));
                       MatrixData25OnFormat(FORMAT(MatrixData[25]));
                       MatrixData26OnFormat(FORMAT(MatrixData[26]));
                       MatrixData27OnFormat(FORMAT(MatrixData[27]));
                       MatrixData28OnFormat(FORMAT(MatrixData[28]));
                       MatrixData29OnFormat(FORMAT(MatrixData[29]));
                       MatrixData30OnFormat(FORMAT(MatrixData[30]));
                       MatrixData31OnFormat(FORMAT(MatrixData[31]));
                       MatrixData32OnFormat(FORMAT(MatrixData[32]));
                     END;

    OnNewRecord=BEGIN
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 77      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Actions;
                                 ESP=&Acciones] }
      { 79      ;2   ;Action    ;
                      CaptionML=[ENU=Export to Excel;
                                 ESP=Exportar a Excel];
                      OnAction=VAR
                                 ItemAnalysisViewEntry@1000 : Record 7154;
                                 ItemAnalysisViewToExcel@1001 : Codeunit 7152;
                               BEGIN
                                 ItemAnalysisViewToExcel.SetCommonFilters(
                                   CurrentAnalysisArea,CurrentItemAnalysisViewCode,
                                   ItemAnalysisViewEntry,DateFilter,ItemFilter,Dim1Filter,Dim2Filter,Dim3Filter,LocationFilter);
                                 ItemAnalysisViewEntry.FIND('-');
                                 ItemAnalysisViewToExcel.ExportData(
                                   ItemAnalysisViewEntry,LineDimCode,ColumnDimCode,ValueType,
                                   PeriodType,ShowColumnName,DateFilter,ItemFilter,BudgetFilter,
                                   Dim1Filter,Dim2Filter,Dim3Filter,ShowActualBudget,LocationFilter,ShowOppositeSign);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr=Code }

    { 4   ;2   ;Field     ;
                SourceExpr=Name }

    { 6   ;2   ;Field     ;
                Name=TotalQuantity;
                CaptionML=[ENU=Total Quantity;
                           ESP=Cantidad total];
                SourceExpr=+Quantity;
                Visible=TotalQuantityVisible;
                HideValue="+QuantityHideValue";
                OnDrillDown=BEGIN
                              ItemAnalysisMgt.DrillDown(
                                CurrentAnalysisArea,ItemStatisticsBuffer,CurrentItemAnalysisViewCode,
                                ItemFilter,LocationFilter,DateFilter,
                                Dim1Filter,Dim2Filter,Dim3Filter,BudgetFilter,
                                LineDimOption,Rec,
                                ColumnDimOption,DimCodeBufferColumn,
                                FALSE,2,ShowActualBudget);
                            END;
                             }

    { 8   ;2   ;Field     ;
                Name=TotalInvtValue;
                CaptionML=[ENU=Total Sales Amount;
                           ESP=Importe total de las ventas];
                SourceExpr=+Amount;
                Visible=TotalInvtValueVisible;
                OnDrillDown=BEGIN
                              ItemAnalysisMgt.DrillDown(
                                CurrentAnalysisArea,ItemStatisticsBuffer,CurrentItemAnalysisViewCode,
                                ItemFilter,LocationFilter,DateFilter,
                                Dim1Filter,Dim2Filter,Dim3Filter,BudgetFilter,
                                LineDimOption,Rec,
                                ColumnDimOption,DimCodeBufferColumn,
                                FALSE,1,ShowActualBudget);
                            END;
                             }

    { 13  ;2   ;Field     ;
                Name=Field1;
                BlankZero=Yes;
                SourceExpr=MatrixData[1];
                CaptionClass='3,' + MatrixColumnCaptions[1];
                Visible=Field1Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(1);
                            END;
                             }

    { 15  ;2   ;Field     ;
                Name=Field2;
                BlankZero=Yes;
                SourceExpr=MatrixData[2];
                CaptionClass='3,' + MatrixColumnCaptions[2];
                Visible=Field2Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(2);
                            END;
                             }

    { 17  ;2   ;Field     ;
                Name=Field3;
                BlankZero=Yes;
                SourceExpr=MatrixData[3];
                CaptionClass='3,' + MatrixColumnCaptions[3];
                Visible=Field3Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(3);
                            END;
                             }

    { 25  ;2   ;Field     ;
                Name=Field4;
                BlankZero=Yes;
                SourceExpr=MatrixData[4];
                CaptionClass='3,' + MatrixColumnCaptions[4];
                Visible=Field4Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(4);
                            END;
                             }

    { 23  ;2   ;Field     ;
                Name=Field5;
                BlankZero=Yes;
                SourceExpr=MatrixData[5];
                CaptionClass='3,' + MatrixColumnCaptions[5];
                Visible=Field5Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(5);
                            END;
                             }

    { 21  ;2   ;Field     ;
                Name=Field6;
                BlankZero=Yes;
                SourceExpr=MatrixData[6];
                CaptionClass='3,' + MatrixColumnCaptions[6];
                Visible=Field6Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(6);
                            END;
                             }

    { 19  ;2   ;Field     ;
                Name=Field7;
                BlankZero=Yes;
                SourceExpr=MatrixData[7];
                CaptionClass='3,' + MatrixColumnCaptions[7];
                Visible=Field7Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(7);
                            END;
                             }

    { 31  ;2   ;Field     ;
                Name=Field8;
                BlankZero=Yes;
                SourceExpr=MatrixData[8];
                CaptionClass='3,' + MatrixColumnCaptions[8];
                Visible=Field8Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(8);
                            END;
                             }

    { 39  ;2   ;Field     ;
                Name=Field9;
                BlankZero=Yes;
                SourceExpr=MatrixData[9];
                CaptionClass='3,' + MatrixColumnCaptions[9];
                Visible=Field9Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(9);
                            END;
                             }

    { 41  ;2   ;Field     ;
                Name=Field10;
                BlankZero=Yes;
                SourceExpr=MatrixData[10];
                CaptionClass='3,' + MatrixColumnCaptions[10];
                Visible=Field10Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(10);
                            END;
                             }

    { 45  ;2   ;Field     ;
                Name=Field11;
                BlankZero=Yes;
                SourceExpr=MatrixData[11];
                CaptionClass='3,' + MatrixColumnCaptions[11];
                Visible=Field11Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(11);
                            END;
                             }

    { 27  ;2   ;Field     ;
                Name=Field12;
                BlankZero=Yes;
                SourceExpr=MatrixData[12];
                CaptionClass='3,' + MatrixColumnCaptions[12];
                Visible=Field12Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(12);
                            END;
                             }

    { 29  ;2   ;Field     ;
                Name=Field13;
                BlankZero=Yes;
                SourceExpr=MatrixData[13];
                CaptionClass='3,' + MatrixColumnCaptions[13];
                Visible=Field13Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(13);
                            END;
                             }

    { 33  ;2   ;Field     ;
                Name=Field14;
                BlankZero=Yes;
                SourceExpr=MatrixData[14];
                CaptionClass='3,' + MatrixColumnCaptions[14];
                Visible=Field14Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(14);
                            END;
                             }

    { 35  ;2   ;Field     ;
                Name=Field15;
                BlankZero=Yes;
                SourceExpr=MatrixData[15];
                CaptionClass='3,' + MatrixColumnCaptions[15];
                Visible=Field15Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(15);
                            END;
                             }

    { 37  ;2   ;Field     ;
                Name=Field16;
                BlankZero=Yes;
                SourceExpr=MatrixData[16];
                CaptionClass='3,' + MatrixColumnCaptions[16];
                Visible=Field16Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(16);
                            END;
                             }

    { 43  ;2   ;Field     ;
                Name=Field17;
                BlankZero=Yes;
                SourceExpr=MatrixData[17];
                CaptionClass='3,' + MatrixColumnCaptions[17];
                Visible=Field17Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(17);
                            END;
                             }

    { 47  ;2   ;Field     ;
                Name=Field18;
                BlankZero=Yes;
                SourceExpr=MatrixData[18];
                CaptionClass='3,' + MatrixColumnCaptions[18];
                Visible=Field18Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(18);
                            END;
                             }

    { 49  ;2   ;Field     ;
                Name=Field19;
                BlankZero=Yes;
                SourceExpr=MatrixData[19];
                CaptionClass='3,' + MatrixColumnCaptions[19];
                Visible=Field19Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(19);
                            END;
                             }

    { 51  ;2   ;Field     ;
                Name=Field20;
                BlankZero=Yes;
                SourceExpr=MatrixData[20];
                CaptionClass='3,' + MatrixColumnCaptions[20];
                Visible=Field20Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(20);
                            END;
                             }

    { 53  ;2   ;Field     ;
                Name=Field21;
                BlankZero=Yes;
                SourceExpr=MatrixData[21];
                CaptionClass='3,' + MatrixColumnCaptions[21];
                Visible=Field21Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(21);
                            END;
                             }

    { 55  ;2   ;Field     ;
                Name=Field22;
                BlankZero=Yes;
                SourceExpr=MatrixData[22];
                CaptionClass='3,' + MatrixColumnCaptions[22];
                Visible=Field22Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(22);
                            END;
                             }

    { 57  ;2   ;Field     ;
                Name=Field23;
                BlankZero=Yes;
                SourceExpr=MatrixData[23];
                CaptionClass='3,' + MatrixColumnCaptions[23];
                Visible=Field23Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(23);
                            END;
                             }

    { 59  ;2   ;Field     ;
                Name=Field24;
                BlankZero=Yes;
                SourceExpr=MatrixData[24];
                CaptionClass='3,' + MatrixColumnCaptions[24];
                Visible=Field24Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(24);
                            END;
                             }

    { 61  ;2   ;Field     ;
                Name=Field25;
                BlankZero=Yes;
                SourceExpr=MatrixData[25];
                CaptionClass='3,' + MatrixColumnCaptions[25];
                Visible=Field25Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(25);
                            END;
                             }

    { 63  ;2   ;Field     ;
                Name=Field26;
                BlankZero=Yes;
                SourceExpr=MatrixData[26];
                CaptionClass='3,' + MatrixColumnCaptions[26];
                Visible=Field26Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(26);
                            END;
                             }

    { 65  ;2   ;Field     ;
                Name=Field27;
                BlankZero=Yes;
                SourceExpr=MatrixData[27];
                CaptionClass='3,' + MatrixColumnCaptions[27];
                Visible=Field27Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(27);
                            END;
                             }

    { 67  ;2   ;Field     ;
                Name=Field28;
                BlankZero=Yes;
                SourceExpr=MatrixData[28];
                CaptionClass='3,' + MatrixColumnCaptions[28];
                Visible=Field28Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(28);
                            END;
                             }

    { 69  ;2   ;Field     ;
                Name=Field29;
                BlankZero=Yes;
                SourceExpr=MatrixData[29];
                CaptionClass='3,' + MatrixColumnCaptions[29];
                Visible=Field29Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(29);
                            END;
                             }

    { 71  ;2   ;Field     ;
                Name=Field30;
                BlankZero=Yes;
                SourceExpr=MatrixData[30];
                CaptionClass='3,' + MatrixColumnCaptions[30];
                Visible=Field30Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(30);
                            END;
                             }

    { 73  ;2   ;Field     ;
                Name=Field31;
                BlankZero=Yes;
                SourceExpr=MatrixData[31];
                CaptionClass='3,' + MatrixColumnCaptions[31];
                Visible=Field31Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(31);
                            END;
                             }

    { 75  ;2   ;Field     ;
                Name=Field32;
                BlankZero=Yes;
                SourceExpr=MatrixData[32];
                CaptionClass='3,' + MatrixColumnCaptions[32];
                Visible=Field32Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(32);
                            END;
                             }

  }
  CODE
  {
    VAR
      ItemAnalysisView@1011 : Record 7152;
      AVBreakdownBuffer@1013 : TEMPORARY Record 375;
      DimCodeBufferColumn@1014 : Record 367;
      DimCodeBufferColumn3@1034 : Record 367;
      ItemStatisticsBuffer@1019 : Record 5821;
      GLSetup@1029 : Record 98;
      ItemAnalysisMgt@1012 : Codeunit 7153;
      RoundingFactor@1033 : 'None,1,1000,1000000';
      ValueType@1003 : 'Sales Amount,COGS Amount,Sales Quantity';
      LineDimOption@1002 : 'Item,Period,Location,Dimension 1,Dimension 2,Dimension 3';
      ColumnDimOption@1001 : 'Item,Period,Location,Dimension 1,Dimension 2,Dimension 3';
      LineDimCode@1036 : Text[30];
      ColumnDimCode@1035 : Text[30];
      PeriodType@1008 : 'Day,Week,Month,Quarter,Year,Accounting Period';
      ShowActualBudget@1015 : 'Actual Amounts,Budgeted Amounts,Variance,Variance%,Index%';
      CurrentAnalysisArea@1018 : 'Sales,Purchase,Inventory';
      CurrentItemAnalysisViewCode@1017 : Code[10];
      LocationFilter@1009 : Code[250];
      ItemFilter@1010 : Code[250];
      Dim1Filter@1007 : Code[250];
      Dim2Filter@1006 : Code[250];
      Dim3Filter@1005 : Code[250];
      BudgetFilter@1016 : Code[250];
      DateFilter@1004 : Text[30];
      MatrixColumnCaptions@1024 : ARRAY [32] OF Text[1024];
      InternalDateFilter@1025 : Text[30];
      Which@1026 : Text[1024];
      NormalFormatString@1030 : Text[80];
      ShowOppositeSign@1020 : Boolean;
      PeriodInitialized@1021 : Boolean;
      i@1022 : Integer;
      Steps@1023 : Integer;
      NoOfRecords@1028 : Integer;
      MatrixData@1000 : ARRAY [32] OF Decimal;
      Text001@1032 : TextConst 'ENU=<Precision,;ESP=<Precision,';
      Text002@1031 : TextConst 'ENU=><Standard Format,0>;ESP=><Standard Format,0>';
      LocationFilter1@1043 : Code[250];
      ItemFilter1@1042 : Code[250];
      Dim1Filter1@1041 : Code[250];
      Dim2Filter1@1040 : Code[250];
      Dim3Filter1@1039 : Code[250];
      DateFilter1@1038 : Text[30];
      FirstColumn@1044 : Text[50];
      LastColumn@1045 : Text[50];
      ShowColumnName@1027 : Boolean;
      TotalQuantityVisible@19074073 : Boolean INDATASET;
      TotalInvtValueVisible@19006309 : Boolean INDATASET;
      Field1Visible@19069335 : Boolean INDATASET;
      Field2Visible@19014807 : Boolean INDATASET;
      Field3Visible@19062679 : Boolean INDATASET;
      Field4Visible@19074839 : Boolean INDATASET;
      Field5Visible@19043543 : Boolean INDATASET;
      Field6Visible@19067287 : Boolean INDATASET;
      Field7Visible@19067863 : Boolean INDATASET;
      Field8Visible@19039959 : Boolean INDATASET;
      Field9Visible@19008663 : Boolean INDATASET;
      Field10Visible@19006501 : Boolean INDATASET;
      Field11Visible@19052468 : Boolean INDATASET;
      Field12Visible@19013039 : Boolean INDATASET;
      Field13Visible@19079726 : Boolean INDATASET;
      Field14Visible@19077225 : Boolean INDATASET;
      Field15Visible@19035896 : Boolean INDATASET;
      Field16Visible@19003763 : Boolean INDATASET;
      Field17Visible@19049730 : Boolean INDATASET;
      Field18Visible@19007213 : Boolean INDATASET;
      Field19Visible@19053180 : Boolean INDATASET;
      Field20Visible@19014629 : Boolean INDATASET;
      Field21Visible@19060596 : Boolean INDATASET;
      Field22Visible@19021167 : Boolean INDATASET;
      Field23Visible@19047854 : Boolean INDATASET;
      Field24Visible@19045353 : Boolean INDATASET;
      Field25Visible@19004024 : Boolean INDATASET;
      Field26Visible@19011891 : Boolean INDATASET;
      Field27Visible@19057858 : Boolean INDATASET;
      Field28Visible@19015341 : Boolean INDATASET;
      Field29Visible@19061308 : Boolean INDATASET;
      Field30Visible@19010597 : Boolean INDATASET;
      Field31Visible@19056564 : Boolean INDATASET;
      Field32Visible@19017135 : Boolean INDATASET;
      "+QuantityHideValue"@19055203 : Boolean INDATASET;
      TotalQuantityEmphasize@19067989 : Boolean INDATASET;
      TotalInvtValueEmphasize@19018555 : Boolean INDATASET;

    PROCEDURE LoadVariables@1(ItemAnalysisView1@1000 : Record 7152;ItemStatisticsBuffer1@1004 : Record 5821;CurrentItemAnalysisViewCode1@1005 : Code[10];CurrentAnalysisArea1@1003 : 'Sales,Purchase,Inventory';LineDimOption1@1010 : 'Item,Period,Location,Dimension 1,Dimension 2,Dimension 3';ColumnDimOption1@1002 : 'Item,Period,Location,Dimension 1,Dimension 2,Dimension 3';LineDimCode1@1016 : Text[30];ColumnDimCode1@1015 : Text[30];PeriodType1@1007 : 'Day,Week,Month,Quarter,Year,Accounting Period';ValueType1@1009 : 'Sales Amount,Inventory Value,Sales Quantity';RoundingFactor1@1011 : 'None,1,1000,1000000';ShowActualBudget1@1012 : 'Actual Amounts,Budgeted Amounts,Variance,Variance%,Index%';MatrixColumnCaptions1@1001 : ARRAY [32] OF Text[1024];ShowOppositeSign1@1006 : Boolean;PeriodInitialized1@1008 : Boolean;FirstColumn1@1014 : Text[50];LastColumn1@1013 : Text[50];ShowColumnName1@1017 : Boolean;NoOfRecordsLocal@1018 : Integer);
    BEGIN
      CLEAR(MatrixColumnCaptions);
      ItemAnalysisView.COPY(ItemAnalysisView1);

      CurrentItemAnalysisViewCode := CurrentItemAnalysisViewCode1;
      CurrentAnalysisArea := CurrentAnalysisArea1;

      LineDimOption := LineDimOption1;
      ColumnDimOption := ColumnDimOption1;

      LineDimCode := LineDimCode1;
      ColumnDimCode := ColumnDimCode1;

      PeriodType := PeriodType1;
      ShowOppositeSign := ShowOppositeSign1;

      COPYARRAY(MatrixColumnCaptions,MatrixColumnCaptions1,1);

      PeriodInitialized := PeriodInitialized1;
      PeriodType := PeriodType1;
      ValueType := ValueType1;
      RoundingFactor := RoundingFactor1;
      ShowActualBudget := ShowActualBudget1;

      FirstColumn := FirstColumn1;
      LastColumn := LastColumn1;

      ShowColumnName := ShowColumnName1;

      NoOfRecords := NoOfRecordsLocal;
    END;

    PROCEDURE LoadFilters@2(ItemFilter1@1006 : Code[250];LocationFilter1@1005 : Code[250];Dim1Filter1@1004 : Code[250];Dim2Filter1@1003 : Code[250];Dim3Filter1@1002 : Code[250];DateFilter2@1001 : Text[30];BudgetFilter1@1000 : Code[250];InternalDateFilter1@1007 : Text[30]);
    BEGIN
      ItemFilter := ItemFilter1;
      LocationFilter := LocationFilter1;
      Dim1Filter := Dim1Filter1;
      Dim2Filter := Dim2Filter1;
      Dim3Filter := Dim3Filter1;
      DateFilter := DateFilter2;
      BudgetFilter := BudgetFilter1;
      InternalDateFilter := InternalDateFilter1;
    END;

    LOCAL PROCEDURE CalcAmt@3(DimCodeBufferColumn1@1004 : Record 367;ValueType@1001 : Integer;SetColFilter@1000 : Boolean) : Decimal;
    VAR
      Amt@1002 : Decimal;
      AmtFromBuffer@1003 : Boolean;
      TempValue@1005 : Text[250];
    BEGIN
      IF SetColFilter THEN
        IF AVBreakdownBuffer.GET(Code,DimCodeBufferColumn1.Code) THEN BEGIN
          Amt := AVBreakdownBuffer.Amount;
          AmtFromBuffer := TRUE;
        END;

      IF NOT AmtFromBuffer THEN BEGIN
        Amt := ItemAnalysisMgt.CalcAmount(
            ValueType,SetColFilter,
            CurrentAnalysisArea,ItemStatisticsBuffer,CurrentItemAnalysisViewCode,
            ItemFilter,LocationFilter,DateFilter,BudgetFilter,
            Dim1Filter,Dim2Filter,Dim3Filter,
            LineDimOption,Rec,
            ColumnDimOption,DimCodeBufferColumn1,
            ShowActualBudget);

        IF SetColFilter THEN BEGIN
          AVBreakdownBuffer."Line Code" := Code;
          AVBreakdownBuffer."Column Code" := DimCodeBufferColumn1.Code;
          AVBreakdownBuffer.Amount := Amt;
          AVBreakdownBuffer.INSERT;
        END;
      END;

      IF ShowOppositeSign THEN
        Amt := -Amt;
      EXIT(Amt);
    END;

    LOCAL PROCEDURE FieldDrillDown@4(Ordinal@1000 : Integer);
    BEGIN
      CLEAR(DimCodeBufferColumn3);
      Which := '-';

      ItemAnalysisMgt.FindRec(
        ItemAnalysisView,ColumnDimOption,DimCodeBufferColumn3,Which,
        ItemFilter1,LocationFilter1,PeriodType,DateFilter1,PeriodInitialized,InternalDateFilter,
        Dim1Filter1,Dim2Filter1,Dim3Filter1);

      Steps := Ordinal - 1;
      ItemAnalysisMgt.NextRec(
        ItemAnalysisView,ColumnDimOption,DimCodeBufferColumn3,Steps,
        ItemFilter1,LocationFilter1,PeriodType,DateFilter1,
        Dim1Filter1,Dim2Filter1,Dim3Filter1);

      ItemAnalysisMgt.DrillDown(
        CurrentAnalysisArea,ItemStatisticsBuffer,CurrentItemAnalysisViewCode,
        ItemFilter1,LocationFilter1,DateFilter1,
        Dim1Filter1,Dim2Filter1,Dim3Filter1,BudgetFilter,
        LineDimOption,Rec,
        ColumnDimOption,DimCodeBufferColumn3,
        TRUE,ValueType,ShowActualBudget);
    END;

    LOCAL PROCEDURE FindNextColumn@6();
    BEGIN
      ItemAnalysisMgt.NextRec(
        ItemAnalysisView,ColumnDimOption,DimCodeBufferColumn,Steps,
        ItemFilter,LocationFilter,PeriodType,DateFilter,
        Dim1Filter,Dim2Filter,Dim3Filter);
    END;

    LOCAL PROCEDURE CalcFormatAmt@7() : Text[1024];
    VAR
      Result@1000 : Decimal;
      Text1@1001 : Text[1024];
    BEGIN
      Result := CalcAmt(DimCodeBufferColumn3,ValueType,TRUE);
      IF Result = 0 THEN
        Text1 := ''
      ELSE
        Text1 := FORMAT(Result,0,NormalFormatString);
      ItemAnalysisMgt.FormatAmount(Text1,RoundingFactor);
      EXIT(Text1);
    END;

    PROCEDURE ApplyColumnFilter@13();
    BEGIN
      CLEAR(ItemFilter1);
      CLEAR(LocationFilter1);
      CLEAR(DateFilter1);
      CLEAR(Dim1Filter1);
      CLEAR(Dim2Filter1);
      CLEAR(Dim3Filter1);

      CASE ColumnDimOption OF
        ColumnDimOption::Item:
          BEGIN
            IF ItemFilter <> '' THEN
              ItemFilter1 := ItemFilter + '&';
            ItemFilter1 := ItemFilter1 + FORMAT(FirstColumn) + '..' + FORMAT(LastColumn);
            LocationFilter1 := LocationFilter;
            DateFilter1 := DateFilter;
            Dim1Filter1 := Dim1Filter;
            Dim2Filter1 := Dim2Filter;
            Dim3Filter1 := Dim3Filter;
          END;
        ColumnDimOption::Location:
          BEGIN
            ItemFilter1 := ItemFilter;
            IF LocationFilter <> '' THEN
              LocationFilter1 := LocationFilter + '&';
            LocationFilter1 := LocationFilter1 + FORMAT(FirstColumn) + '..' + FORMAT(LastColumn);
            DateFilter1 := DateFilter;
            Dim1Filter1 := Dim1Filter;
            Dim2Filter1 := Dim2Filter;
            Dim3Filter1 := Dim3Filter;
          END;
        ColumnDimOption::Period:
          BEGIN
            ItemFilter1 := ItemFilter;
            LocationFilter1 := LocationFilter;
            IF DateFilter <> '' THEN
              DateFilter1 := DateFilter
            ELSE
              DateFilter1 := FORMAT(FirstColumn) + '..' + FORMAT(LastColumn);
            Dim1Filter1 := Dim1Filter;
            Dim2Filter1 := Dim2Filter;
            Dim3Filter1 := Dim3Filter;
          END;
        ColumnDimOption::"Dimension 1":
          BEGIN
            ItemFilter1 := ItemFilter;
            LocationFilter1 := LocationFilter;
            DateFilter1 := DateFilter;
            IF Dim1Filter <> '' THEN
              Dim1Filter1 := Dim1Filter + '&';
            Dim1Filter1 := Dim1Filter1 + FORMAT(FirstColumn) + '..' + FORMAT(LastColumn);
            Dim2Filter1 := Dim2Filter;
            Dim3Filter1 := Dim3Filter;
          END;
        ColumnDimOption::"Dimension 2":
          BEGIN
            ItemFilter1 := ItemFilter;
            LocationFilter1 := LocationFilter;
            DateFilter1 := DateFilter;
            Dim1Filter1 := Dim1Filter;
            IF Dim2Filter <> '' THEN
              Dim2Filter1 := Dim2Filter + '&';
            Dim2Filter1 := Dim2Filter1 + FORMAT(FirstColumn) + '..' + FORMAT(LastColumn);
            Dim3Filter1 := Dim3Filter;
          END;
        ColumnDimOption::"Dimension 3":
          BEGIN
            ItemFilter1 := ItemFilter;
            LocationFilter1 := LocationFilter;
            DateFilter1 := DateFilter;
            Dim1Filter1 := Dim1Filter;
            Dim2Filter1 := Dim2Filter;
            IF Dim3Filter <> '' THEN
              Dim3Filter1 := Dim3Filter + '&';
            Dim3Filter1 := Dim3Filter1 + FORMAT(FirstColumn) + '..' + FORMAT(LastColumn);
          END;
      END;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      IF TotalQuantityVisible THEN
        Quantity := CalcAmt(DimCodeBufferColumn,2,FALSE);
      IF TotalInvtValueVisible THEN
        Amount := CalcAmt(DimCodeBufferColumn,0,FALSE);
      Steps := 1;
      ApplyColumnFilter;
      Which := '-';

      ItemAnalysisMgt.FindRec(
        ItemAnalysisView,ColumnDimOption,DimCodeBufferColumn3,Which,
        ItemFilter1,LocationFilter1,PeriodType,DateFilter1,PeriodInitialized,InternalDateFilter,
        Dim1Filter1,Dim2Filter1,Dim3Filter1);

      i := 1;
      WHILE (i <= NoOfRecords) AND (i <= ARRAYLEN(MatrixColumnCaptions)) DO BEGIN
        MatrixData[i] := CalcAmt(DimCodeBufferColumn3,ValueType,TRUE);
        ItemAnalysisMgt.NextRec(
          ItemAnalysisView,ColumnDimOption,DimCodeBufferColumn3,Steps,
          ItemFilter1,LocationFilter1,PeriodType,DateFilter1,
          Dim1Filter1,Dim2Filter1,Dim3Filter1);
        i := i + 1;
      END;
    END;

    LOCAL PROCEDURE QuantityOnFormat@19071269(Text@19015373 : Text[1024]);
    BEGIN
      IF Quantity = 0 THEN
        "+QuantityHideValue" := TRUE;
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);

      TotalQuantityEmphasize := "Show in Bold";
    END;

    LOCAL PROCEDURE AmountOnFormat@19014598(Text@19024947 : Text[1024]);
    BEGIN
      IF Amount = 0 THEN
        Text := ''
      ELSE
        Text := FORMAT(Amount,0,NormalFormatString);
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
      TotalInvtValueEmphasize := "Show in Bold";
    END;

    LOCAL PROCEDURE MatrixData1OnFormat@19069692(Text@19028438 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData2OnFormat@19026465(Text@19036635 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData3OnFormat@19060166(Text@19071760 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData4OnFormat@19009051(Text@19069349 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData5OnFormat@19059552(Text@19051658 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData6OnFormat@19053253(Text@19066063 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData7OnFormat@19050026(Text@19015060 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData8OnFormat@19034111(Text@19046185 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData9OnFormat@19067812(Text@19060590 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData10OnFormat@19054039(Text@19007565 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData11OnFormat@19009431(Text@19015585 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData12OnFormat@19079383(Text@19064572 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData13OnFormat@19000855(Text@19020092 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData14OnFormat@19018071(Text@19025983 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData15OnFormat@19060759(Text@19026243 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData16OnFormat@19003415(Text@19016414 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData17OnFormat@19052183(Text@19028126 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData18OnFormat@19001303(Text@19062689 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData19OnFormat@19065175(Text@19042469 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData20OnFormat@19031868(Text@19076488 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData21OnFormat@19074556(Text@19047132 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData22OnFormat@19017212(Text@19068835 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData23OnFormat@19065980(Text@19040547 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData24OnFormat@19043196(Text@19007610 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData25OnFormat@19038588(Text@19055166 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData26OnFormat@19068540(Text@19046509 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData27OnFormat@19030012(Text@19018221 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData28OnFormat@19066428(Text@19044316 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData29OnFormat@19003004(Text@19004832 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData30OnFormat@19044513(Text@19064831 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData31OnFormat@19079905(Text@19006275 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData32OnFormat@19069857(Text@19039070 : Text[1024]);
    BEGIN
      ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    BEGIN
    END.
  }
}
