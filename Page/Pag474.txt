OBJECT Page 474 VAT Statement Preview
{
  OBJECT-PROPERTIES
  {
    Date=05/11/08;
    Time=12:00:00;
    Version List=NAVW16.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=VAT Statement Preview;
               ESP=Vista prelim. decl. IVA];
    SaveValues=Yes;
    SourceTable=Table257;
    PageType=Worksheet;
    OnOpenPage=BEGIN
                 UpdateSubForm;
               END;

    OnAfterGetRecord=BEGIN
                       IF ISSERVICETIER THEN
                         UpdateSubForm;
                     END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           ESP=General] }

    { 2   ;2   ;Field     ;
                SourceExpr="Statement Template Name" }

    { 4   ;2   ;Field     ;
                SourceExpr=Name }

    { 15  ;2   ;Field     ;
                CaptionML=[ENU=Include VAT entries;
                           ESP=Incluye movs. IVA];
                OptionCaptionML=[ENU=Open,Closed,Open and Closed;
                                 ESP=Pendiente,Cerrado,Pendiente y cerrado];
                SourceExpr=Selection;
                OnValidate=BEGIN
                             IF Selection = Selection::"Open and Closed" THEN
                               OpenandClosedSelectionOnValida;
                             IF Selection = Selection::Closed THEN
                               ClosedSelectionOnValidate;
                             IF Selection = Selection::Open THEN
                               OpenSelectionOnValidate;
                           END;
                            }

    { 11  ;2   ;Field     ;
                CaptionML=[ENU=Include VAT entries;
                           ESP=Incluye movs. IVA];
                OptionCaptionML=[ENU=Before and Within Period,Within Period;
                                 ESP=Anteriores y comprendidos en el periodo,Comprendidos en el periodo];
                SourceExpr=PeriodSelection;
                OnValidate=BEGIN
                             IF PeriodSelection = PeriodSelection::"Before and Within Period" THEN
                               BeforeandWithinPeriodSelection;
                             IF PeriodSelection = PeriodSelection::"Within Period" THEN
                               WithinPeriodPeriodSelectionOnV;
                           END;
                            }

    { 17  ;2   ;Field     ;
                CaptionML=[ENU=Show Amounts in Add. Reporting Currency;
                           ESP=Muestra importes en div.-adic.];
                SourceExpr=UseAmtsInAddCurr;
                MultiLine=Yes;
                OnValidate=BEGIN
                             UseAmtsInAddCurrOnPush;
                           END;
                            }

    { 7   ;1   ;Part      ;
                Name=VATStatementLineSubForm;
                SubFormView=SORTING(Statement Template Name,Statement Name,Line No.);
                SubFormLink=Statement Template Name=FIELD(Statement Template Name),
                            Statement Name=FIELD(Name);
                PagePartID=Page475 }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Selection@1000 : 'Open,Closed,Open and Closed';
      PeriodSelection@1001 : 'Before and Within Period,Within Period';
      UseAmtsInAddCurr@1002 : Boolean;

    PROCEDURE UpdateSubForm@3();
    BEGIN
      CurrPage.VATStatementLineSubForm.FORM.UpdateForm(Rec,Selection,PeriodSelection,UseAmtsInAddCurr);
    END;

    LOCAL PROCEDURE OpenandClosedSelectionOnPush@19050697();
    BEGIN
      UpdateSubForm;
    END;

    LOCAL PROCEDURE ClosedSelectionOnPush@19021849();
    BEGIN
      UpdateSubForm;
    END;

    LOCAL PROCEDURE OpenSelectionOnPush@19074623();
    BEGIN
      UpdateSubForm;
    END;

    LOCAL PROCEDURE BeforeandWithinPeriodSelOnPush@19032274();
    BEGIN
      UpdateSubForm;
    END;

    LOCAL PROCEDURE WithinPeriodPeriodSelectOnPush@19020295();
    BEGIN
      UpdateSubForm;
    END;

    LOCAL PROCEDURE UseAmtsInAddCurrOnPush@19045403();
    BEGIN
      UpdateSubForm;
    END;

    LOCAL PROCEDURE OpenSelectionOnValidate@19071264();
    BEGIN
      OpenSelectionOnPush;
    END;

    LOCAL PROCEDURE ClosedSelectionOnValidate@19024252();
    BEGIN
      ClosedSelectionOnPush;
    END;

    LOCAL PROCEDURE OpenandClosedSelectionOnValida@19001032();
    BEGIN
      OpenandClosedSelectionOnPush;
    END;

    LOCAL PROCEDURE WithinPeriodPeriodSelectionOnV@19011162();
    BEGIN
      WithinPeriodPeriodSelectOnPush;
    END;

    LOCAL PROCEDURE BeforeandWithinPeriodSelection@19031646();
    BEGIN
      BeforeandWithinPeriodSelOnPush;
    END;

    BEGIN
    END.
  }
}
