OBJECT Codeunit 5300 Outlook Synch. Setup Mgt.
{
  OBJECT-PROPERTIES
  {
    Date=14/08/09;
    Time=12:00:00;
    Version List=NAVW16.00.01;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      OSynchEntity@1010 : Record 5300;
      OSynchEntityElement@1013 : Record 5301;
      OSynchDependency@1028 : Record 5311;
      OSynchFilter@1011 : Record 5303;
      OSynchField@1012 : Record 5304;
      OSynchOptionCorrel@1022 : Record 5307;
      OSynchUserSetup@1014 : Record 5305;
      Field@1001 : Record 2000000041;
      RecRef@1140001 : RecordRef;
      FldRef@1140000 : FieldRef;
      OSynchTypeConversion@1035 : Codeunit 5302;
      OObjLibrary@1005 : Automation "{316692C7-ABC7-4929-AF58-68C1D274E6A9} 1.0:{E9B8EFD3-ABC7-4C4E-A0B4-1998B764DBBF}:Unknown Automation Server.Unknown Class";
      OObjInfo@1006 : Automation "{316692C7-ABC7-4929-AF58-68C1D274E6A9} 1.0:{7FBB866B-68A6-4F3F-987B-1B5D38A6C681}:Unknown Automation Server.Unknown Class";
      OObjInfo1@1019 : Automation "{316692C7-ABC7-4929-AF58-68C1D274E6A9} 1.0:{7FBB866B-68A6-4F3F-987B-1B5D38A6C681}:Unknown Automation Server.Unknown Class";
      OPropertyInfo@1017 : Automation "{316692C7-ABC7-4929-AF58-68C1D274E6A9} 1.0:{9A949449-1520-4308-B499-686F1C199EFA}:Unknown Automation Server.Unknown Class";
      OPropertyInfo1@1018 : Automation "{316692C7-ABC7-4929-AF58-68C1D274E6A9} 1.0:{9A949449-1520-4308-B499-686F1C199EFA}:Unknown Automation Server.Unknown Class";
      OEnumInfo@1020 : Automation "{316692C7-ABC7-4929-AF58-68C1D274E6A9} 1.0:{2267CEF4-F3B5-442D-856F-A2304E3E7D4D}:Unknown Automation Server.Unknown Class";
      Text001@1021 : TextConst 'ENU=You should select a table and define a filter.;ESP=Seleccione una tabla y defina un filtro.';
      Text002@1015 : TextConst 'ENU=You cannot setup a correlation with a property of an Outlook item for this field because it is not of the Option type.;ESP=No puede establecer una correlaci¢n con una propiedad de un elemento de Outlook para este campo porque no es del tipo Option.';
      Text003@1009 : TextConst 'ENU=The filter cannot be processed because its length exceeds %1 symbols. Please redefine your criteria.;ESP=El filtro no se puede procesar porque su longitud supera los %1 s¡mbolos. Vuelva a definir los criterios.';
      Text004@1003 : TextConst 'ENU=The %1 entity cannot be found in the %2 for the selected collection.;ESP=El objeto %1 no se encuentra en %2 para la colecci¢n seleccionada.';
      Text005@1002 : TextConst 'ENU=The %1 entity should not have the ''%2'' %3 in the %4.;ESP=El objeto %1 no debe tener ''%2'' %3 en %4.';
      Text006@1024 : TextConst 'ENU=The %1 entities cannot be found in the %2 for the selected collection.;ESP=Los objetos %1 no se encuentran en %2 para la colecci¢n seleccionada.';
      Text007@1000 : TextConst 'ENU=You cannot setup a correlation with this field. This property of an Outlook item is not an enumeration value. Use the Assist button to see a list of valid enumeration values.;ESP=No puede establecer una correlaci¢n con este campo. Esta propiedad de un elemento de Outlook no es un valor de enumeraci¢n. Utilice el bot¢n Assist para ver una lista de valores de enumeraci¢n v lidos.';
      Text008@1026 : TextConst 'ENU=The %1 field cannot be empty.;ESP=El campo %1 no puede estar vac¡o.';
      Text009@1004 : TextConst 'ENU=You cannot reset the %1 entity to defaults because it is being used for synchronization. Remove this entity from %2 and try again.;ESP=No puede restablecer el objeto %1 a su valor predeterminado porque se est  utilizando para la sincronizaci¢n. Elimine este objeto de %2 y vuelva a intentarlo.';
      Text010@1008 : TextConst 'ENU=The %1 entity has collections that depend on it. All dependencies will be now deleted.\Do you want to proceed anyway?;ESP=El objeto %1 tiene colecciones que dependen de ‚l. Todas las dependencias se eliminar n.\¨Desea proceder de todos modos?';
      Text011@1016 : TextConst 'ENU=The %1 table cannot be processed because its primary key contains more than 3 fields.;ESP=La tabla %1 no se puede procesar porque la clave principal contiene m s de 3 campos.';
      Text012@1031 : TextConst 'ENU=Reset to defaults...;ESP=Restaurar valores predeterminados...';
      Text013@1034 : TextConst 'ENU=%1 of the %2 entity must be %3 not %4.;ESP=%1 del objeto %2 debe ser %3 y no %4.';
      Text014@1201 : TextConst 'ENU=Installation and configuration of the Microsoft Outlook Integration add-in is not complete. Be sure that Outlook Integration is installed and all required objects are allowed to run.;ESP=No ha finalizado la instalaci¢n y configuraci¢n del complemento de Integraci¢n con Microsoft Outlook. Aseg£rese de que la Integraci¢n con Outlook est‚ instalada y de que se permita la ejecuci¢n de todos los objetos necesarios.';
      Text100@1029 : TextConst 'ENU=Microsoft Dynamics NAV Meetings;ESP=Reuniones en Microsoft Dynamics NAV';
      Text101@1027 : TextConst 'ENU=Microsoft Dynamics NAV Tasks;ESP=Tareas en Microsoft Dynamics NAV';
      Text102@1025 : TextConst 'ENU=Microsoft Dynamics NAV Contacts of the Person type;ESP=Contactos personales en Microsoft Dynamics NAV';
      Text103@1023 : TextConst 'ENU=Microsoft Dynamics NAV Contacts of the Company type;ESP=Contactos empresariales en Microsoft Dynamics NAV';
      Text104@1007 : TextConst 'ENU=Microsoft Dynamics NAV Salespeople;ESP=Vendedores en Microsoft Dynamics NAV';
      Text110@1037 : TextConst 'ENU=CONT_PERS;ESP=CONT_PERS';
      Text111@1036 : TextConst 'ENU=CONT_COMP;ESP=CONT_COMP';
      Text112@1030 : TextConst 'ENU=CONT_SP;ESP=CONT_SP';
      Text120@1032 : TextConst 'ENU=Links;ESP=Links';
      Text121@1033 : TextConst 'ENU=Recipients;ESP=Recipients';
      Text130@1131 : TextConst 'ENU=APP;ESP=AP';
      Text131@1129 : TextConst 'ENU=TASK;ESP=TAREA';
      Text132@1127 : TextConst 'ENU=CONT_PERS;ESP=CONT_PERS';
      Text133@1125 : TextConst 'ENU=CONT_COMP;ESP=CONT_COMP';
      Text134@1132 : TextConst 'ENU=CONT_SP;ESP=CONT_SP';

    PROCEDURE ShowTablesList@3() TableID : Integer;
    VAR
      AllObjWithCaption@1000 : Record 2000000058;
    BEGIN
      AllObjWithCaption.RESET;

      IF FORM.RUNMODAL(FORM::"Outlook Synch. Table List",AllObjWithCaption) = ACTION::LookupOK THEN
        TableID := AllObjWithCaption."Object ID";
    END;

    PROCEDURE ShowTableFieldsList@7(TableID@1000 : Integer) FieldID : Integer;
    BEGIN
      Field.RESET;
      Field.SETRANGE(TableNo,TableID);

      IF FORM.RUNMODAL(FORM::"Outlook Synch. Table Fields",Field) = ACTION::LookupOK THEN
        FieldID := Field."No.";
    END;

    PROCEDURE ShowOItemsList@4() ItemName : Text[80];
    VAR
      TempOSynchLookupName@1002 : TEMPORARY Record 5306;
      Counter@1000 : Integer;
    BEGIN
      CLEAR(OObjLibrary);
      IF NOT CREATE(OObjLibrary,FALSE,TRUE) THEN
        ERROR(Text014);

      FOR Counter := 1 TO OObjLibrary.ItemsCount DO BEGIN
        TempOSynchLookupName.INIT;
        TempOSynchLookupName.Name := OObjLibrary.GetItemName(Counter);
        TempOSynchLookupName."Entry No." := Counter;
        TempOSynchLookupName.INSERT;
      END;

      ItemName := ShowLookupNames(TempOSynchLookupName);
    END;

    PROCEDURE ShowOItemProperties@8(ItemName@1000 : Text[80]) PropertyName : Text[80];
    VAR
      TempOSynchLookupName@1002 : TEMPORARY Record 5306;
      Counter@1001 : Integer;
    BEGIN
      CLEAR(OObjLibrary);
      IF NOT CREATE(OObjLibrary,FALSE,TRUE) THEN
        ERROR(Text014);

      OObjInfo := OObjLibrary.GetItem(ItemName);

      FOR Counter := 1 TO OObjInfo.PropertiesCount DO BEGIN
        OPropertyInfo := OObjInfo.GetProperty(Counter);
        IF NOT OPropertyInfo.ReturnsCollection THEN BEGIN
          TempOSynchLookupName.INIT;
          TempOSynchLookupName.Name := OPropertyInfo.name;
          TempOSynchLookupName."Entry No." := Counter;
          TempOSynchLookupName.INSERT;
        END;
      END;

      PropertyName := ShowLookupNames(TempOSynchLookupName);
    END;

    PROCEDURE ShowOCollectionsList@5(ItemName@1000 : Text[80]) CollectionName : Text[80];
    VAR
      TempOSynchLookupName@1002 : TEMPORARY Record 5306;
      Counter@1001 : Integer;
    BEGIN
      CLEAR(OObjLibrary);
      IF NOT CREATE(OObjLibrary,FALSE,TRUE) THEN
        ERROR(Text014);

      OObjInfo := OObjLibrary.GetItem(ItemName);

      FOR Counter := 1 TO OObjInfo.PropertiesCount DO BEGIN
        OPropertyInfo := OObjInfo.GetProperty(Counter);
        IF OPropertyInfo.ReturnsCollection THEN BEGIN
          TempOSynchLookupName.INIT;
          TempOSynchLookupName.Name := OPropertyInfo.name;
          TempOSynchLookupName."Entry No." := Counter;
          TempOSynchLookupName.INSERT;
        END;
      END;

      CollectionName := ShowLookupNames(TempOSynchLookupName);
    END;

    PROCEDURE ShowOCollectionProperties@10(ItemName@1001 : Text[80];CollectionName@1000 : Text[80]) PropertyName : Text[80];
    VAR
      TempOSynchLookupName@1003 : TEMPORARY Record 5306;
      Counter@1002 : Integer;
      Counter1@1004 : Integer;
    BEGIN
      CLEAR(OObjLibrary);
      IF NOT CREATE(OObjLibrary,FALSE,TRUE) THEN
        ERROR(Text014);

      OObjInfo := OObjLibrary.GetItem(ItemName);

      FOR Counter := 1 TO OObjInfo.PropertiesCount DO BEGIN
        OPropertyInfo := OObjInfo.GetProperty(Counter);
        IF OPropertyInfo.ReturnsCollection THEN BEGIN
          IF OPropertyInfo.name = CollectionName THEN BEGIN
            OObjInfo1 := OPropertyInfo.ReturnedCollectionElement;
            FOR Counter1 := 1 TO OObjInfo1.PropertiesCount DO BEGIN
              OPropertyInfo1 := OObjInfo1.GetProperty(Counter1);
              TempOSynchLookupName.INIT;
              TempOSynchLookupName.Name := OPropertyInfo1.name;
              TempOSynchLookupName."Entry No." := TempOSynchLookupName."Entry No." + 1;
              TempOSynchLookupName.INSERT;
            END;
          END;
        END;
      END;

      PropertyName := ShowLookupNames(TempOSynchLookupName);
    END;

    PROCEDURE ShowOEntityCollections@17(UserID@1003 : Code[20];SynchEntityCode@1000 : Code[10]) ElementNo : Integer;
    VAR
      TempOSynchLookupName@1001 : TEMPORARY Record 5306;
      CollectionName@1002 : Text[80];
    BEGIN
      WITH OSynchEntityElement DO BEGIN
        RESET;
        SETRANGE("Synch. Entity Code",SynchEntityCode);
        SETFILTER("Outlook Collection",'<>%1','');

        IF FIND('-') THEN
          REPEAT
            TempOSynchLookupName.INIT;
            TempOSynchLookupName.Name := "Outlook Collection";
            TempOSynchLookupName."Entry No." := "Element No.";
            TempOSynchLookupName.INSERT;
          UNTIL NEXT = 0;

        CollectionName := ShowLookupNames(TempOSynchLookupName);
        IF CollectionName <> '' THEN BEGIN
          SETRANGE("Outlook Collection",CollectionName);
          IF FINDFIRST THEN
            IF CheckOCollectionAvailability(OSynchEntityElement,UserID) THEN
              ElementNo := "Element No.";
        END;
      END;
    END;

    PROCEDURE ShowOptionsLookup@9(OptionString@1000 : Text[250]) OptionID : Integer;
    VAR
      TempOSynchLookupName@1005 : TEMPORARY Record 5306;
      Separator@1004 : Text[30];
      TempString@1003 : Text[250];
      NamesCount@1002 : Integer;
      Counter@1001 : Integer;
    BEGIN
      IF OptionString = '' THEN
        EXIT;

      Separator := ',';
      NamesCount := 0;
      TempString := OptionString;

      WHILE STRPOS(TempString,Separator) <> 0 DO BEGIN
        NamesCount := NamesCount + 1;
        TempString := DELSTR(TempString,STRPOS(TempString,Separator),1);
      END;

      FOR Counter := 1 TO NamesCount + 1 DO BEGIN
        TempOSynchLookupName.INIT;
        TempOSynchLookupName.Name := SELECTSTR(Counter,OptionString);
        TempOSynchLookupName."Entry No." := TempOSynchLookupName."Entry No." + 1;
        TempOSynchLookupName.INSERT;
      END;

      TempString := ShowLookupNames(TempOSynchLookupName);
      TempOSynchLookupName.SETCURRENTKEY(Name);
      TempOSynchLookupName.SETRANGE(Name,TempString);
      IF TempOSynchLookupName.FINDFIRST THEN
        OptionID := TempOSynchLookupName."Entry No.";
    END;

    PROCEDURE ShowEnumerationsLookup@31(ItemName@1002 : Text[80];CollectionName@1001 : Text[80];PropertyName@1000 : Text[80];VAR EnumerationNo@1007 : Integer) SelectedName : Text[80];
    VAR
      TempOSynchLookupName@1005 : TEMPORARY Record 5306;
      Counter@1004 : Integer;
      Counter1@1003 : Integer;
      Counter2@1006 : Integer;
    BEGIN
      CLEAR(OObjLibrary);
      IF NOT CREATE(OObjLibrary,FALSE,TRUE) THEN
        ERROR(Text014);

      OObjInfo := OObjLibrary.GetItem(ItemName);

      IF CollectionName = '' THEN BEGIN
        FOR Counter := 1 TO OObjInfo.PropertiesCount DO BEGIN
          OPropertyInfo := OObjInfo.GetProperty(Counter);

          IF NOT OPropertyInfo.ReturnsCollection AND (OPropertyInfo.name = PropertyName) THEN BEGIN
            IF OPropertyInfo.ReturnsEnumeration THEN BEGIN
              OEnumInfo := OPropertyInfo.ReturnedEnumeration;
              FOR Counter1 := 1 TO OEnumInfo.ValuesCount DO BEGIN
                TempOSynchLookupName.INIT;
                TempOSynchLookupName.Name := OEnumInfo.GetName(Counter1);
                TempOSynchLookupName."Entry No." := OEnumInfo.GetValue(Counter1);
                TempOSynchLookupName.INSERT;
              END;

              SelectedName := ShowLookupNames(TempOSynchLookupName);
              EnumerationNo := TempOSynchLookupName."Entry No.";
              EXIT;
            END;
          END;
        END;
      END ELSE BEGIN
        FOR Counter := 1 TO OObjInfo.PropertiesCount DO BEGIN
          OPropertyInfo := OObjInfo.GetProperty(Counter);
          IF OPropertyInfo.ReturnsCollection AND (OPropertyInfo.name = CollectionName) THEN BEGIN
            OObjInfo1 := OPropertyInfo.ReturnedCollectionElement;
            FOR Counter1 := 1 TO OObjInfo1.PropertiesCount DO BEGIN
              OPropertyInfo1 := OObjInfo1.GetProperty(Counter1);
              IF OPropertyInfo1.name = PropertyName THEN BEGIN
                IF OPropertyInfo1.ReturnsEnumeration THEN BEGIN
                  OEnumInfo := OPropertyInfo1.ReturnedEnumeration;
                  FOR Counter2 := 1 TO OEnumInfo.ValuesCount DO BEGIN
                    TempOSynchLookupName.INIT;
                    TempOSynchLookupName.Name := OEnumInfo.GetName(Counter2);
                    TempOSynchLookupName."Entry No." := OEnumInfo.GetValue(Counter2);
                    TempOSynchLookupName.INSERT;
                  END;

                  SelectedName := ShowLookupNames(TempOSynchLookupName);
                  EnumerationNo := TempOSynchLookupName."Entry No.";
                  EXIT;
                END;
              END;
            END;
          END;
        END;
      END;
    END;

    PROCEDURE ShowLookupNames@1(VAR OSynchLookupNameRec@1000 : Record 5306) SelectedName : Text[80];
    BEGIN
      OSynchLookupNameRec.FINDFIRST;

      IF FORM.RUNMODAL(FORM::"Outlook Synch. Lookup Names",OSynchLookupNameRec) = ACTION::LookupOK THEN
        SelectedName := OSynchLookupNameRec.Name;
    END;

    PROCEDURE ShowOSynchFiltersForm@2(RecGUID@1001 : GUID;TableNo@1002 : Integer;MasterTableNo@1003 : Integer) ComposedFilter : Text[250];
    VAR
      TempOSynchFilter@1006 : TEMPORARY Record 5303;
      OSynchFiltersForm@1005 : Form 5303;
      LookUpOk@1000 : Boolean;
      ShowWarning@1004 : Boolean;
    BEGIN
      IF TableNo = 0 THEN
        ERROR(Text001);

      OSynchFilter.RESET;
      OSynchFilter.SETRANGE("Record GUID",RecGUID);
      IF MasterTableNo = 0 THEN
        OSynchFilter.SETRANGE("Filter Type",OSynchFilter."Filter Type"::Condition)
      ELSE
        OSynchFilter.SETRANGE("Filter Type",OSynchFilter."Filter Type"::"Table Relation");

      CLEAR(OSynchFiltersForm);
      OSynchFiltersForm.SetTables(TableNo,MasterTableNo);
      OSynchFiltersForm.SETTABLEVIEW(OSynchFilter);
      OSynchFiltersForm.SETRECORD(OSynchFilter);

      TempOSynchFilter.RESET;
      TempOSynchFilter.DELETEALL;
      TempOSynchFilter.COPYFILTERS(OSynchFilter);
      IF OSynchFilter.FIND('-') THEN
        REPEAT
          TempOSynchFilter.TRANSFERFIELDS(OSynchFilter);
          TempOSynchFilter.INSERT;
        UNTIL OSynchFilter.NEXT = 0;

      LookUpOk := OSynchFiltersForm.RUNMODAL = ACTION::OK;
      ShowWarning := LookUpOk AND ((OSynchFilter.COUNT = 0) AND (MasterTableNo <> 0));

      IF ShowWarning OR (NOT LookUpOk) THEN BEGIN
        IF OSynchFilter.COUNT > 0 THEN
          OSynchFilter.DELETEALL;
        IF TempOSynchFilter.FIND('-') THEN
          REPEAT
            OSynchFilter.TRANSFERFIELDS(TempOSynchFilter);
            OSynchFilter.INSERT;
          UNTIL TempOSynchFilter.NEXT = 0;
        COMMIT;
      END ELSE
        OSynchFiltersForm.GETRECORD(OSynchFilter);

      ComposedFilter := ComposeFilterExpression(RecGUID,OSynchFilter."Filter Type");
      CLEAR(OSynchFilter);
      IF ShowWarning THEN
        ERROR(Text008,OSynchEntityElement.FIELDCAPTION("Table Relation"));
    END;

    PROCEDURE ShowOOptionCorrelForm@13(OSynchFieldIn@1000 : Record 5304);
    VAR
      OSynchOptionCorrel@1001 : Record 5307;
    BEGIN
      CLEAR(OObjLibrary);
      IF NOT CREATE(OObjLibrary,FALSE,TRUE) THEN
        ERROR(Text014);

      IF OSynchFieldIn."Table No." = 0 THEN
        Field.GET(OSynchFieldIn."Master Table No.",OSynchFieldIn."Field No.")
      ELSE
        Field.GET(OSynchFieldIn."Table No.",OSynchFieldIn."Field No.");

      IF Field.Type <> Field.Type::Option THEN
        ERROR(Text002);

      OSynchOptionCorrel.RESET;
      OSynchOptionCorrel.SETRANGE("Synch. Entity Code",OSynchFieldIn."Synch. Entity Code");
      OSynchOptionCorrel.SETRANGE("Element No.",OSynchFieldIn."Element No.");
      OSynchOptionCorrel.SETRANGE("Field Line No.",OSynchFieldIn."Line No.");
      FORM.RUNMODAL(FORM::"Outlook Synch. Option Correl.",OSynchOptionCorrel);
    END;

    PROCEDURE CheckOCollectionAvailability@28(OSynchEntityElementIn@1000 : Record 5301;UserID@1001 : Code[20]) : Boolean;
    VAR
      OSynchUserSetup1@1004 : Record 5305;
      EntityList@1002 : Text[250];
      CountAvailable@1003 : Integer;
    BEGIN
      OSynchDependency.RESET;
      OSynchDependency.SETRANGE("Synch. Entity Code",OSynchEntityElementIn."Synch. Entity Code");
      OSynchDependency.SETRANGE("Element No.",OSynchEntityElementIn."Element No.");
      IF OSynchDependency.FIND('-') THEN BEGIN
        REPEAT
          IF OSynchUserSetup.GET(UserID,OSynchDependency."Depend. Synch. Entity Code") THEN BEGIN
            OSynchUserSetup1.GET(UserID,OSynchEntityElementIn."Synch. Entity Code");
            IF (OSynchUserSetup."Synch. Direction" = OSynchUserSetup1."Synch. Direction") OR
               (OSynchUserSetup."Synch. Direction" = OSynchUserSetup."Synch. Direction"::Bidirectional)
            THEN
              CountAvailable := CountAvailable + 1
            ELSE
              ERROR(
                Text005,
                OSynchUserSetup."Synch. Entity Code",
                OSynchUserSetup."Synch. Direction",
                OSynchUserSetup.FIELDCAPTION("Synch. Direction"),
                OSynchUserSetup.TABLECAPTION);
          END ELSE BEGIN
            IF EntityList = '' THEN
              EntityList := OSynchDependency."Depend. Synch. Entity Code"
            ELSE
              EntityList := EntityList + ', ' + OSynchDependency."Depend. Synch. Entity Code";
          END;
        UNTIL OSynchDependency.NEXT = 0;

        IF CountAvailable = OSynchDependency.COUNT THEN
          EXIT(TRUE);

        IF STRPOS(EntityList,',') = 0 THEN
          ERROR(Text004,EntityList,OSynchUserSetup.TABLECAPTION);
        ERROR(Text006,EntityList,OSynchUserSetup.TABLECAPTION);
      END;

      EXIT(TRUE);
    END;

    PROCEDURE ValidateEnumerationValue@33(VAR InputValue@1000 : Text[80];VAR EnumerationNo@1001 : Integer;ItemName@1004 : Text[80];CollectionName@1003 : Text[80];PropertyName@1002 : Text[80]);
    VAR
      TempOSynchLookupName@1008 : TEMPORARY Record 5306;
      Counter@1007 : Integer;
      Counter1@1006 : Integer;
      Counter2@1005 : Integer;
      IntVar@1009 : Integer;
      FilteringString@1010 : Text[250];
    BEGIN
      CLEAR(OObjLibrary);
      IF NOT CREATE(OObjLibrary,FALSE,TRUE) THEN
        ERROR(Text014);

      TempOSynchLookupName.RESET;
      TempOSynchLookupName.DELETEALL;

      OObjInfo := OObjLibrary.GetItem(ItemName);

      IF CollectionName = '' THEN BEGIN
        FOR Counter := 1 TO OObjInfo.PropertiesCount DO BEGIN
          OPropertyInfo := OObjInfo.GetProperty(Counter);

          IF NOT OPropertyInfo.ReturnsCollection AND (OPropertyInfo.name = PropertyName) THEN BEGIN
            IF OPropertyInfo.ReturnsEnumeration THEN BEGIN
              OEnumInfo := OPropertyInfo.ReturnedEnumeration;
              FOR Counter1 := 1 TO OEnumInfo.ValuesCount DO BEGIN
                TempOSynchLookupName.INIT;
                TempOSynchLookupName.Name := OEnumInfo.GetName(Counter1);
                TempOSynchLookupName."Entry No." := OEnumInfo.GetValue(Counter1);
                TempOSynchLookupName.INSERT;
              END;

              IF EVALUATE(IntVar,InputValue) THEN BEGIN
                TempOSynchLookupName.RESET;
                TempOSynchLookupName.SETRANGE("Entry No.",IntVar);
                IF TempOSynchLookupName.FIND('-') THEN BEGIN
                  InputValue := TempOSynchLookupName.Name;
                  EnumerationNo := TempOSynchLookupName."Entry No.";
                  EXIT;
                END;
              END;

              FilteringString := '@' + InputValue + '*';
              TempOSynchLookupName.RESET;
              TempOSynchLookupName.SETFILTER(Name,'@' + InputValue + '*');
              IF NOT TempOSynchLookupName.FIND('-') THEN
                ERROR(Text007);

              InputValue := TempOSynchLookupName.Name;
              EnumerationNo := TempOSynchLookupName."Entry No.";
              EXIT;
            END;
          END;
        END;
      END ELSE BEGIN
        FOR Counter := 1 TO OObjInfo.PropertiesCount DO BEGIN
          OPropertyInfo := OObjInfo.GetProperty(Counter);
          IF OPropertyInfo.ReturnsCollection AND (OPropertyInfo.name = CollectionName) THEN BEGIN
            OObjInfo1 := OPropertyInfo.ReturnedCollectionElement;
            FOR Counter1 := 1 TO OObjInfo1.PropertiesCount DO BEGIN
              OPropertyInfo1 := OObjInfo1.GetProperty(Counter1);
              IF OPropertyInfo1.name = PropertyName THEN BEGIN
                IF OPropertyInfo1.ReturnsEnumeration THEN BEGIN
                  OEnumInfo := OPropertyInfo1.ReturnedEnumeration;
                  FOR Counter2 := 1 TO OEnumInfo.ValuesCount DO BEGIN
                    TempOSynchLookupName.INIT;
                    TempOSynchLookupName.Name := OEnumInfo.GetName(Counter2);
                    TempOSynchLookupName."Entry No." := OEnumInfo.GetValue(Counter2);
                    TempOSynchLookupName.INSERT;
                  END;

                  IF EVALUATE(IntVar,InputValue) THEN BEGIN
                    TempOSynchLookupName.RESET;
                    TempOSynchLookupName.SETRANGE("Entry No.",IntVar);
                    IF TempOSynchLookupName.FIND('-') THEN BEGIN
                      InputValue := TempOSynchLookupName.Name;
                      EnumerationNo := TempOSynchLookupName."Entry No.";
                      EXIT;
                    END;
                  END;

                  TempOSynchLookupName.RESET;
                  TempOSynchLookupName.SETFILTER(Name,'@' + InputValue + '*');
                  IF NOT TempOSynchLookupName.FIND('-') THEN
                    ERROR(Text007);

                  InputValue := TempOSynchLookupName.Name;
                  EnumerationNo := TempOSynchLookupName."Entry No.";
                  EXIT;
                END;
              END;
            END;
          END;
        END;
      END;
    END;

    PROCEDURE ValidateFieldName@30(VAR NameString@1000 : Text[30];TableID@1001 : Integer) : Boolean;
    BEGIN
      Field.RESET;
      Field.SETRANGE(TableNo,TableID);
      Field.SETFILTER("Field Caption",'@' + OSynchTypeConversion.ReplaceFilterChars(NameString) + '*');
      IF Field.FIND('-') THEN BEGIN
        NameString := Field."Field Caption";
        EXIT(TRUE);
      END;
    END;

    PROCEDURE ValidateOutlookItemName@25(VAR InputString@1000 : Text[80]) : Boolean;
    VAR
      TempOSynchLookupName@1002 : TEMPORARY Record 5306;
      Counter@1001 : Integer;
    BEGIN
      CLEAR(OObjLibrary);
      IF NOT CREATE(OObjLibrary,FALSE,TRUE) THEN
        ERROR(Text014);

      FOR Counter := 1 TO OObjLibrary.ItemsCount DO BEGIN
        TempOSynchLookupName.INIT;
        TempOSynchLookupName.Name := OObjLibrary.GetItemName(Counter);
        TempOSynchLookupName."Entry No." := Counter;
        TempOSynchLookupName.INSERT;
      END;

      TempOSynchLookupName.SETCURRENTKEY(Name);
      TempOSynchLookupName.SETFILTER(Name,'@' + OSynchTypeConversion.ReplaceFilterChars(InputString) + '*');

      IF TempOSynchLookupName.FINDFIRST THEN BEGIN
        InputString := TempOSynchLookupName.Name;
        EXIT(TRUE);
      END;
    END;

    PROCEDURE ValidateOutlookCollectionName@18(VAR InputString@1000 : Text[80];ItemName@1004 : Text[80]) : Boolean;
    VAR
      TempOSynchLookupName@1002 : TEMPORARY Record 5306;
      Counter@1001 : Integer;
    BEGIN
      CLEAR(OObjLibrary);
      IF NOT CREATE(OObjLibrary,FALSE,TRUE) THEN
        ERROR(Text014);

      OObjInfo := OObjLibrary.GetItem(ItemName);

      FOR Counter := 1 TO OObjInfo.PropertiesCount DO BEGIN
        OPropertyInfo := OObjInfo.GetProperty(Counter);
        IF OPropertyInfo.ReturnsCollection THEN BEGIN
          TempOSynchLookupName.INIT;
          TempOSynchLookupName.Name := OPropertyInfo.name;
          TempOSynchLookupName."Entry No." := Counter;
          TempOSynchLookupName.INSERT;
        END;
      END;

      TempOSynchLookupName.SETCURRENTKEY(Name);
      TempOSynchLookupName.SETFILTER(Name,'@' + OSynchTypeConversion.ReplaceFilterChars(InputString) + '*');

      IF TempOSynchLookupName.FINDFIRST THEN BEGIN
        InputString := TempOSynchLookupName.Name;
        EXIT(TRUE);
      END;
    END;

    PROCEDURE ValidateOItemPropertyName@11(VAR InputString@1002 : Text[80];ItemName@1003 : Text[80];VAR IsReadOnly@1004 : Boolean;FullTextSearch@1005 : Boolean) : Boolean;
    VAR
      TempOSynchLookupName@1001 : TEMPORARY Record 5306;
      Counter@1000 : Integer;
    BEGIN
      IF ISCLEAR(OObjLibrary) THEN
        IF NOT CREATE(OObjLibrary,FALSE,TRUE) THEN
          ERROR(Text014);

      OObjInfo := OObjLibrary.GetItem(ItemName);

      FOR Counter := 1 TO OObjInfo.PropertiesCount DO BEGIN
        OPropertyInfo := OObjInfo.GetProperty(Counter);
        IF NOT OPropertyInfo.ReturnsCollection THEN BEGIN
          TempOSynchLookupName.INIT;
          TempOSynchLookupName.Name := OPropertyInfo.name;
          TempOSynchLookupName."Entry No." := Counter;
          TempOSynchLookupName.INSERT;
        END;
      END;

      TempOSynchLookupName.SETCURRENTKEY(Name);

      IF FullTextSearch THEN
        TempOSynchLookupName.SETFILTER(Name,'@' + OSynchTypeConversion.ReplaceFilterChars(InputString))
      ELSE
        TempOSynchLookupName.SETFILTER(Name,'@' + OSynchTypeConversion.ReplaceFilterChars(InputString) + '*');

      IF TempOSynchLookupName.FINDFIRST THEN BEGIN
        InputString := TempOSynchLookupName.Name;
        OPropertyInfo := OObjInfo.GetProperty(TempOSynchLookupName."Entry No.");
        IsReadOnly := OPropertyInfo.IsReadOnly;
        EXIT(TRUE);
      END;
    END;

    PROCEDURE ValidateOCollectPropertyName@26(VAR InputString@1004 : Text[80];ItemName@1003 : Text[80];CollectionName@1005 : Text[80];VAR IsReadOnly@1006 : Boolean;FullTextSearch@1007 : Boolean) : Boolean;
    VAR
      TempOSynchLookupName@1002 : TEMPORARY Record 5306;
      Counter@1001 : Integer;
      Counter1@1000 : Integer;
    BEGIN
      CLEAR(OObjLibrary);
      IF NOT CREATE(OObjLibrary,FALSE,TRUE) THEN
        ERROR(Text014);

      OObjInfo := OObjLibrary.GetItem(ItemName);

      FOR Counter := 1 TO OObjInfo.PropertiesCount DO BEGIN
        OPropertyInfo := OObjInfo.GetProperty(Counter);
        IF OPropertyInfo.ReturnsCollection THEN BEGIN
          IF OPropertyInfo.name = CollectionName THEN BEGIN
            OObjInfo1 := OPropertyInfo.ReturnedCollectionElement;
            FOR Counter1 := 1 TO OObjInfo1.PropertiesCount DO BEGIN
              OPropertyInfo1 := OObjInfo1.GetProperty(Counter1);
              TempOSynchLookupName.INIT;
              TempOSynchLookupName.Name := OPropertyInfo1.name;
              TempOSynchLookupName."Entry No." := TempOSynchLookupName."Entry No." + 1;
              TempOSynchLookupName.INSERT;
            END;
          END;
        END;
      END;

      TempOSynchLookupName.SETCURRENTKEY(Name);

      IF FullTextSearch THEN
        TempOSynchLookupName.SETFILTER(Name,'@' + OSynchTypeConversion.ReplaceFilterChars(InputString))
      ELSE
        TempOSynchLookupName.SETFILTER(Name,'@' + OSynchTypeConversion.ReplaceFilterChars(InputString) + '*');

      IF TempOSynchLookupName.FINDFIRST THEN
        FOR Counter := 1 TO OObjInfo.PropertiesCount DO BEGIN
          OPropertyInfo := OObjInfo.GetProperty(Counter);
          IF OPropertyInfo.ReturnsCollection THEN
            IF OPropertyInfo.name = CollectionName THEN BEGIN
              OObjInfo1 := OPropertyInfo.ReturnedCollectionElement;
              FOR Counter1 := 1 TO OObjInfo1.PropertiesCount DO BEGIN
                OPropertyInfo1 := OObjInfo1.GetProperty(Counter1);
                InputString := OPropertyInfo1.name;
                IF TempOSynchLookupName.Name = OPropertyInfo1.name THEN BEGIN
                  InputString := OPropertyInfo1.name;
                  IsReadOnly := OPropertyInfo1.IsReadOnly;
                  EXIT(TRUE);
                END;
              END;
            END;
        END;
    END;

    PROCEDURE ComposeFilterExpression@12(RecGUID@1000 : GUID;FilterType@1001 : Integer) OutFilterString : Text[250];
    VAR
      Delimiter@1003 : Text[1];
      TempString@1004 : Text[1024];
      FilterLength@1005 : Integer;
    BEGIN
      OSynchFilter.RESET;
      OSynchFilter.SETRANGE("Record GUID",RecGUID);
      OSynchFilter.SETRANGE("Filter Type",FilterType);

      OutFilterString := '';
      IF OSynchFilter.FIND('-') THEN BEGIN
        Delimiter := '';
        REPEAT
          FilterLength := STRLEN(TempString) +
            STRLEN(OSynchFilter."Field Name") + STRLEN(FORMAT(OSynchFilter.Type)) + STRLEN(OSynchFilter.Value);
          IF FilterLength + STRLEN(TempString) > MAXSTRLEN(TempString) - 5 THEN
            ERROR(Text003,FORMAT(MAXSTRLEN(TempString)));
          TempString :=
            STRSUBSTNO('%1%2%3=%4(%5)',
              TempString,Delimiter,OSynchFilter."Field Name",FORMAT(OSynchFilter.Type),OSynchFilter.Value);
          Delimiter := ',';
        UNTIL OSynchFilter.NEXT = 0;

        TempString := STRSUBSTNO('WHERE(%1)',TempString);
        IF STRLEN(TempString) > 250 THEN
          OutFilterString := STRSUBSTNO('%1...',COPYSTR(TempString,1,247))
        ELSE
          OutFilterString := TempString;
      END;
    END;

    PROCEDURE ComposeTableFilter@6(VAR OSynchFilterIn@1000 : Record 5303;SynchRecRef@1001 : RecordRef) OutFilterString : Text[1024];
    VAR
      MasterFieldRef@1002 : FieldRef;
      Delimiter@1003 : Text[1];
      TempStr@1004 : Text[250];
      FilterLength@1005 : Integer;
    BEGIN
      OutFilterString := '';
      IF NOT OSynchFilterIn.FIND('-') THEN
        EXIT;

      Delimiter := '';
      REPEAT
        CASE OSynchFilterIn.Type OF
          OSynchFilterIn.Type::CONST:
            BEGIN
              RecRef.OPEN(OSynchFilterIn."Table No.");
              FldRef := RecRef.FIELD(OSynchFilterIn."Field No.");
              IF EVALUATE(Field.Type,FORMAT(FldRef.TYPE)) THEN
                IF Field.Type = Field.Type::Option THEN
                  OSynchFilterIn.Value := FORMAT(
                    OSynchTypeConversion.TextToOptionValue(OSynchFilterIn.Value,FldRef.OPTIONCAPTION));
              RecRef.CLOSE;
              TempStr := STRSUBSTNO('CONST(%1)',OSynchFilterIn.Value);
            END;
          OSynchFilterIn.Type::FILTER:
            BEGIN
              RecRef.OPEN(OSynchFilterIn."Table No.");
              FldRef := RecRef.FIELD(OSynchFilterIn."Field No.");
              IF EVALUATE(Field.Type,FORMAT(FldRef.TYPE)) THEN
                IF Field.Type = Field.Type::Option THEN
                  OSynchTypeConversion.EvaluateFilterOptionField(FldRef,OSynchFilterIn.Value,TRUE);
              RecRef.CLOSE;
              TempStr := STRSUBSTNO('FILTER(%1)',OSynchFilterIn.Value);
            END;
          OSynchFilterIn.Type::FIELD:
            BEGIN
              MasterFieldRef := SynchRecRef.FIELD(OSynchFilterIn."Master Table Field No.");
              TempStr := STRSUBSTNO('FILTER(%1)',OSynchTypeConversion.ReplaceFilterChars(FORMAT(MasterFieldRef.VALUE)));
            END;
        END;
        FilterLength := STRLEN(OutFilterString) +
          STRLEN(Delimiter) + STRLEN(OSynchFilterIn."Field Name") + STRLEN(TempStr);
        IF FilterLength > 1000 THEN
          ERROR(Text003,FORMAT(1000));
        OutFilterString := STRSUBSTNO('%1%2%3=%4',OutFilterString,Delimiter,OSynchFilterIn."Field Name",TempStr);
        Delimiter := ',';
      UNTIL OSynchFilterIn.NEXT = 0;
      OutFilterString := STRSUBSTNO('WHERE(%1)',OutFilterString);
    END;

    PROCEDURE ComposeTableView@63(VAR OSynchFilterCondition@1000 : Record 5303;VAR OSynchFilterRelation@1001 : Record 5303;RelatedRecRef@1003 : RecordRef) FilteringExpression : Text[1024];
    VAR
      TempOSynchFilter@1002 : TEMPORARY Record 5303;
      NullRecRef@1004 : RecordRef;
    BEGIN
      CopyFilterRecords(OSynchFilterCondition,TempOSynchFilter);
      ComposeFilterRecords(OSynchFilterRelation,TempOSynchFilter,RelatedRecRef,TempOSynchFilter.Type::FILTER);

      FilteringExpression := ComposeTableFilter(TempOSynchFilter,NullRecRef);
    END;

    PROCEDURE CopyFilterRecords@52(VAR FromOSynchFilter@1001 : Record 5303;VAR ToOSynchFilter@1002 : Record 5303);
    BEGIN
      IF FromOSynchFilter.FIND('-') THEN
        REPEAT
          ToOSynchFilter.INIT;
          ToOSynchFilter := FromOSynchFilter;
          IF ToOSynchFilter.INSERT THEN;
        UNTIL FromOSynchFilter.NEXT = 0;
    END;

    PROCEDURE ComposeFilterRecords@85(VAR FromOSynchFilter@1001 : Record 5303;VAR ToOSynchFilter@1000 : Record 5303;RecRef@1002 : RecordRef;FilteringType@1004 : Integer);
    VAR
      FieldRef@1003 : FieldRef;
    BEGIN
      IF FromOSynchFilter.FIND('-') THEN
        REPEAT
          FieldRef := RecRef.FIELD(FromOSynchFilter."Field No.");
          CreateFilterCondition(
            ToOSynchFilter,
            FromOSynchFilter."Master Table No.",
            FromOSynchFilter."Master Table Field No.",
            FilteringType,
            FORMAT(FieldRef));
        UNTIL FromOSynchFilter.NEXT = 0;
    END;

    PROCEDURE CreateFilterCondition@53(VAR OSynchFilterIn@1004 : Record 5303;TableID@1000 : Integer;FieldID@1001 : Integer;FilterType@1002 : Integer;FilterValue@1003 : Text[1024]);
    VAR
      FilterValueLen@1005 : Integer;
    BEGIN
      IF FilterType = OSynchFilterIn.Type::FIELD THEN
        EXIT;

      Field.GET(TableID,FieldID);
      IF STRLEN(FilterValue) > Field.Len THEN
        FilterValue := PADSTR(FilterValue,Field.Len);

      OSynchFilterIn.INIT;
      OSynchFilterIn."Record GUID" := CREATEGUID;
      OSynchFilterIn."Filter Type" := OSynchFilterIn."Filter Type"::Condition;
      OSynchFilterIn."Line No." := OSynchFilterIn."Line No." + 10000;
      OSynchFilterIn."Table No." := TableID;
      OSynchFilterIn.VALIDATE("Field No.",FieldID);
      OSynchFilterIn.Type := FilterType;

      IF FilterType = OSynchFilterIn.Type::CONST THEN BEGIN
        Field.GET(OSynchFilterIn."Table No.",OSynchFilterIn."Field No.");
        OSynchFilterIn.Value := OSynchTypeConversion.HandleFilterChars(FilterValue,Field.Len);
      END ELSE BEGIN
        FilterValueLen := Field.Len;
        Field.GET(DATABASE::"Outlook Synch. Filter",OSynchFilterIn.FIELDNO(Value));
        IF FilterValueLen = Field.Len THEN BEGIN
          FilterValue := PADSTR(FilterValue,Field.Len - 2);
          OSynchFilterIn.Value := '@' + OSynchTypeConversion.ReplaceFilterChars(FilterValue) + '*';
        END ELSE
          OSynchFilterIn.Value := '@' + OSynchTypeConversion.ReplaceFilterChars(FilterValue);
      END;

      IF OSynchFilterIn.INSERT THEN;
    END;

    PROCEDURE ResetEntity@15(SynchEntityCode@1000 : Code[10]);
    VAR
      Window@1002 : Dialog;
      Selected@1001 : Integer;
    BEGIN
      Selected := STRMENU(STRSUBSTNO('%1,%2,%3,%4,%5',Text100,Text101,Text103,Text102,Text104));

      IF Selected = 0 THEN
        EXIT;

      OSynchEntity.GET(SynchEntityCode);

      OSynchDependency.RESET;
      OSynchDependency.SETRANGE("Depend. Synch. Entity Code",SynchEntityCode);
      IF OSynchDependency.FIND('-') THEN
        IF NOT CONFIRM(STRSUBSTNO(Text010,SynchEntityCode)) THEN
          EXIT;

      OSynchUserSetup.RESET;
      OSynchUserSetup.SETRANGE("Synch. Entity Code",SynchEntityCode);
      IF OSynchUserSetup.FIND('-') THEN
        ERROR(Text009,SynchEntityCode,OSynchUserSetup.TABLECAPTION);

      Window.OPEN(Text012);

      OSynchDependency.DELETEALL(TRUE);
      OSynchUserSetup.DELETEALL(TRUE);

      OSynchEntityElement.RESET;
      OSynchEntityElement.SETRANGE("Synch. Entity Code",SynchEntityCode);
      OSynchEntityElement.DELETEALL(TRUE);

      OSynchField.RESET;
      OSynchField.SETRANGE("Synch. Entity Code",SynchEntityCode);
      OSynchField.DELETEALL(TRUE);

      OSynchFilter.RESET;
      OSynchFilter.SETRANGE("Record GUID",OSynchEntity."Record GUID");
      OSynchFilter.DELETEALL;

      OSynchEntity.DELETE;

      CASE Selected OF
        1:
          CreateDefaultApp(SynchEntityCode);

        2:
          CreateDefaultTask(SynchEntityCode);

        3:
          CreateDefaultContComp(SynchEntityCode);

        4:
          CreateDefaultContPers(SynchEntityCode);

        5:
          CreateDefaultContSp(SynchEntityCode);
      END;

      Window.CLOSE;
    END;

    PROCEDURE CreateDefaultContPers@19(SynchEntityCodeIn@1002 : Code[10]);
    VAR
      Contact@1140000 : Record 5050;
    BEGIN
      InsertOSycnhEntity(SynchEntityCodeIn,Text102,5050,'ContactItem');

      OSynchEntity.GET(SynchEntityCodeIn);
      InsertOSycnhFilter(OSynchEntity."Record GUID",OSynchFilter."Filter Type"::Condition,OSynchEntity."Table No.",
        5050,OSynchFilter.Type::CONST,0,0,'1');
      OSynchEntity.Condition := ComposeFilterExpression(OSynchEntity."Record GUID",0);
      OSynchEntity.MODIFY;

      RecRef.OPEN(OSynchEntity."Table No.");
      FldRef := RecRef.FIELD(Contact.FIELDNO(Type));
      InsertOSynchField(
        OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'',FALSE,FALSE,0,Contact.FIELDNO(Type),
        OSynchTypeConversion.OptionValueToText(Contact.Type::Person,FldRef.OPTIONCAPTION),1);
      RecRef.CLOSE;

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'CompanyName',
        FALSE,FALSE,5050,5052,'',0);
      OSynchField.RESET;
      OSynchField.SETRANGE("Synch. Entity Code",OSynchEntity.Code);
      OSynchField.SETRANGE("Element No.",0);
      IF OSynchField.FINDLAST THEN BEGIN
        InsertOSycnhFilter(OSynchField."Record GUID",OSynchFilter."Filter Type"::"Table Relation",OSynchField."Table No.",
          1,OSynchFilter.Type::FIELD,OSynchField."Master Table No.",5051,'');
        InsertOSycnhFilter(OSynchField."Record GUID",OSynchFilter."Filter Type"::"Table Relation",OSynchField."Table No.",
          5050,OSynchFilter.Type::CONST,0,0,'0');

        OSynchField."Table Relation" := ComposeFilterExpression(OSynchField."Record GUID",1);
        OSynchField.MODIFY;
      END;

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'FullName',
        FALSE,FALSE,0,2,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'FirstName',
        FALSE,FALSE,0,5054,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'MiddleName',
        FALSE,FALSE,0,5055,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'LastName',
        FALSE,FALSE,0,5056,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'JobTitle',
        FALSE,FALSE,0,5058,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'BusinessAddressStreet',
        FALSE,FALSE,0,5,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'BusinessAddressCity',
        FALSE,FALSE,225,2,'',0);
      OSynchField.RESET;
      OSynchField.SETRANGE("Synch. Entity Code",OSynchEntity.Code);
      OSynchField.SETRANGE("Element No.",0);
      IF OSynchField.FINDLAST THEN BEGIN
        InsertOSycnhFilter(OSynchField."Record GUID",OSynchFilter."Filter Type"::"Table Relation",OSynchField."Table No.",
          2,OSynchFilter.Type::FIELD,OSynchField."Master Table No.",7,'');

        OSynchField."Table Relation" := ComposeFilterExpression(OSynchField."Record GUID",1);
        OSynchField.MODIFY;
      END;

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'BusinessAddressPostalCode',
        FALSE,FALSE,225,1,'',0);
      OSynchField.RESET;
      OSynchField.SETRANGE("Synch. Entity Code",OSynchEntity.Code);
      OSynchField.SETRANGE("Element No.",0);
      IF OSynchField.FINDLAST THEN BEGIN
        InsertOSycnhFilter(OSynchField."Record GUID",OSynchFilter."Filter Type"::"Table Relation",OSynchField."Table No.",
          1,OSynchFilter.Type::FIELD,OSynchField."Master Table No.",91,'');
        OSynchField."Table Relation" := ComposeFilterExpression(OSynchField."Record GUID",1);
        OSynchField.MODIFY;
      END;

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'BusinessAddressCountry',
        FALSE,FALSE,9,2,'',0);
      OSynchField.RESET;
      OSynchField.SETRANGE("Synch. Entity Code",OSynchEntity.Code);
      OSynchField.SETRANGE("Element No.",0);
      IF OSynchField.FINDLAST THEN BEGIN
        InsertOSycnhFilter(OSynchField."Record GUID",OSynchFilter."Filter Type"::"Table Relation",OSynchField."Table No.",
          1,OSynchFilter.Type::FIELD,OSynchField."Master Table No.",35,'');

        OSynchField."Table Relation" := ComposeFilterExpression(OSynchField."Record GUID",1);
        OSynchField.MODIFY;
      END;

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'BusinessTelephoneNumber',
        FALSE,FALSE,0,9,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'BusinessFaxNumber',
        FALSE,FALSE,0,84,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'BusinessHomePage',
        FALSE,FALSE,0,103,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'Email1Address',
        FALSE,FALSE,0,102,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'Email2Address',
        FALSE,FALSE,0,5105,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'MobileTelephoneNumber',
        FALSE,FALSE,0,5061,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'PagerNumber',
        FALSE,FALSE,0,5062,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'TelexNumber',
        FALSE,FALSE,0,10,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'Salesperson Code',
        TRUE,FALSE,0,29,'',0);

      InsertDefaultDependency(OSynchEntity,Text130,Text121);
      InsertDefaultDependency(OSynchEntity,Text130,Text120);
      InsertDefaultDependency(OSynchEntity,Text131,Text120);
    END;

    PROCEDURE CreateDefaultContComp@29(SynchEntityCodeIn@1002 : Code[10]);
    VAR
      Contact@1140000 : Record 5050;
    BEGIN
      InsertOSycnhEntity(SynchEntityCodeIn,Text103,5050,'ContactItem');

      OSynchEntity.GET(SynchEntityCodeIn);
      InsertOSycnhFilter(OSynchEntity."Record GUID",OSynchFilter."Filter Type"::Condition,OSynchEntity."Table No.",
        5050,OSynchFilter.Type::CONST,0,0,'0');
      OSynchEntity.Condition := ComposeFilterExpression(OSynchEntity."Record GUID",0);
      OSynchEntity.MODIFY;

      RecRef.OPEN(OSynchEntity."Table No.");
      FldRef := RecRef.FIELD(Contact.FIELDNO(Type));
      InsertOSynchField(
        OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'',FALSE,FALSE,0,Contact.FIELDNO(Type),
        OSynchTypeConversion.OptionValueToText(Contact.Type::Company,FldRef.OPTIONCAPTION),1);
      RecRef.CLOSE;

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'BusinessAddressStreet',
        FALSE,FALSE,0,5,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'BusinessAddressCity',
        FALSE,FALSE,225,2,'',0);
      OSynchField.RESET;
      OSynchField.SETRANGE("Synch. Entity Code",OSynchEntity.Code);
      OSynchField.SETRANGE("Element No.",0);
      IF OSynchField.FINDLAST THEN BEGIN
        InsertOSycnhFilter(OSynchField."Record GUID",OSynchFilter."Filter Type"::"Table Relation",OSynchField."Table No.",
          2,OSynchFilter.Type::FIELD,OSynchField."Master Table No.",7,'');
        OSynchField."Table Relation" := ComposeFilterExpression(OSynchField."Record GUID",1);
        OSynchField.MODIFY;
      END;

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'BusinessAddressPostalCode',
        FALSE,FALSE,225,1,'',0);
      OSynchField.RESET;
      OSynchField.SETRANGE("Synch. Entity Code",OSynchEntity.Code);
      OSynchField.SETRANGE("Element No.",0);
      IF OSynchField.FINDLAST THEN BEGIN
        InsertOSycnhFilter(OSynchField."Record GUID",OSynchFilter."Filter Type"::"Table Relation",OSynchField."Table No.",
          1,OSynchFilter.Type::FIELD,OSynchField."Master Table No.",91,'');
        OSynchField."Table Relation" := ComposeFilterExpression(OSynchField."Record GUID",1);
        OSynchField.MODIFY;
      END;

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'BusinessAddressCountry',
        FALSE,FALSE,9,2,'',0);
      OSynchField.RESET;
      OSynchField.SETRANGE("Synch. Entity Code",OSynchEntity.Code);
      OSynchField.SETRANGE("Element No.",0);
      IF OSynchField.FINDLAST THEN BEGIN
        InsertOSycnhFilter(OSynchField."Record GUID",OSynchFilter."Filter Type"::"Table Relation",OSynchField."Table No.",
          1,OSynchFilter.Type::FIELD,OSynchField."Master Table No.",35,'');
        OSynchField."Table Relation" := ComposeFilterExpression(OSynchField."Record GUID",1);
        OSynchField.MODIFY;
      END;

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'BusinessTelephoneNumber',
        FALSE,FALSE,0,9,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'CompanyName',
        FALSE,FALSE,0,2,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'BusinessFaxNumber',
        FALSE,FALSE,0,84,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'Email1Address',
        FALSE,FALSE,0,102,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'Email2Address',
        FALSE,FALSE,0,5105,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'BusinessHomePage',
        FALSE,FALSE,0,103,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'MobileTelephoneNumber',
        FALSE,FALSE,0,5061,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'PagerNumber',
        FALSE,FALSE,0,5062,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'TelexNumber',
        FALSE,FALSE,0,10,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'Salesperson Code',
        TRUE,FALSE,0,29,'',0);

      InsertDefaultDependency(OSynchEntity,Text130,Text121);
      InsertDefaultDependency(OSynchEntity,Text130,Text120);
      InsertDefaultDependency(OSynchEntity,Text131,Text120);
    END;

    PROCEDURE CreateDefaultContSp@16(SynchEntityCodeIn@1002 : Code[10]);
    BEGIN
      InsertOSycnhEntity(SynchEntityCodeIn,Text104,13,'ContactItem');

      OSynchEntity.GET(SynchEntityCodeIn);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'FullName',
        FALSE,FALSE,0,2,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'JobTitle',
        FALSE,FALSE,0,5062,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'Email1Address',
        FALSE,FALSE,0,5052,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'Email2Address',
        FALSE,FALSE,0,5086,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'BusinessTelephoneNumber',
        FALSE,FALSE,0,5053,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'Salesperson Code',
        TRUE,FALSE,0,1,'',1);

      InsertDefaultDependency(OSynchEntity,Text130,Text121);
      InsertDefaultDependency(OSynchEntity,Text130,Text120);
    END;

    PROCEDURE CreateDefaultTask@22(SynchEntityCodeIn@1002 : Code[10]);
    VAR
      OSynchEntity1@1000 : Record 5300;
    BEGIN
      IF OSynchEntity.GET(Text110) THEN
        IF OSynchEntity."Table No." <> 5050 THEN
          ERROR(Text013,OSynchEntity.FIELDCAPTION("Table No."),Text110,5050,OSynchEntity."Table No.");

      IF OSynchEntity.GET(Text111) THEN
        IF OSynchEntity."Table No." <> 5050 THEN
          ERROR(Text013,OSynchEntity.FIELDCAPTION("Table No."),Text111,5050,OSynchEntity."Table No.");

      InsertOSycnhEntity(SynchEntityCodeIn,Text101,5080,'TaskItem');

      OSynchEntity.GET(SynchEntityCodeIn);
      InsertOSycnhFilter(OSynchEntity."Record GUID",OSynchFilter."Filter Type"::Condition,OSynchEntity."Table No.",
        8,OSynchFilter.Type::FILTER,0,0,'<>1');
      InsertOSycnhFilter(OSynchEntity."Record GUID",OSynchFilter."Filter Type"::Condition,OSynchEntity."Table No.",
        45,OSynchFilter.Type::CONST,0,0,'0');
      InsertOSycnhFilter(OSynchEntity."Record GUID",OSynchFilter."Filter Type"::Condition,OSynchEntity."Table No.",
        2,OSynchFilter.Type::CONST,0,0,'');

      OSynchEntity.Condition := ComposeFilterExpression(OSynchEntity."Record GUID",0);
      OSynchEntity.MODIFY;

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'',
        FALSE,FALSE,0,8,'',1);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'StartDate',
        FALSE,FALSE,0,9,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'StartDate',
        FALSE,FALSE,0,28,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'DueDate',
        FALSE,FALSE,0,47,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'DueDate',
        FALSE,FALSE,0,48,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'Subject',
        FALSE,FALSE,0,12,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'Importance',
        FALSE,FALSE,0,11,'',0);
      InsertOOptionCorrelation(OSynchField."Synch. Entity Code",OSynchField."Element No.",OSynchField."Line No.",
        'olImportanceLow',0,0);
      InsertOOptionCorrelation(OSynchField."Synch. Entity Code",OSynchField."Element No.",OSynchField."Line No.",
        'olImportanceNormal',1,1);
      InsertOOptionCorrelation(OSynchField."Synch. Entity Code",OSynchField."Element No.",OSynchField."Line No.",
        'olImportanceHigh',2,2);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'Status',
        FALSE,FALSE,0,10,'',0);
      InsertOOptionCorrelation(OSynchField."Synch. Entity Code",OSynchField."Element No.",OSynchField."Line No.",
        'olTaskNotStarted',0,0);
      InsertOOptionCorrelation(OSynchField."Synch. Entity Code",OSynchField."Element No.",OSynchField."Line No.",
        'olTaskInProgress',1,1);
      InsertOOptionCorrelation(OSynchField."Synch. Entity Code",OSynchField."Element No.",OSynchField."Line No.",
        'olTaskComplete',2,2);
      InsertOOptionCorrelation(OSynchField."Synch. Entity Code",OSynchField."Element No.",OSynchField."Line No.",
        'olTaskWaiting',3,3);
      InsertOOptionCorrelation(OSynchField."Synch. Entity Code",OSynchField."Element No.",OSynchField."Line No.",
        'olTaskDeferred',4,4);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'Owner',
        FALSE,FALSE,13,2,'',0);
      OSynchField.RESET;
      OSynchField.SETRANGE("Synch. Entity Code",OSynchEntity.Code);
      OSynchField.SETRANGE("Element No.",0);
      IF OSynchField.FINDLAST THEN BEGIN
        InsertOSycnhFilter(OSynchField."Record GUID",OSynchFilter."Filter Type"::"Table Relation",OSynchField."Table No.",
          1,OSynchFilter.Type::FIELD,OSynchEntity."Table No.",3,'');

        OSynchField."Table Relation" := ComposeFilterExpression(OSynchField."Record GUID",1);
        OSynchField.MODIFY;
      END;

      InsertOSynchEntityElement(OSynchEntity.Code,5080,Text120);
      OSynchEntityElement.RESET;
      OSynchEntityElement.SETRANGE("Synch. Entity Code",OSynchEntity.Code);
      IF OSynchEntityElement.FINDLAST THEN BEGIN
        OSynchEntityElement.CALCFIELDS("Master Table No.");
        InsertOSycnhFilter(OSynchEntityElement."Record GUID",OSynchFilter."Filter Type"::"Table Relation",
          OSynchEntityElement."Table No.",1,OSynchFilter.Type::FIELD,OSynchEntityElement."Master Table No.",1,'');
        InsertOSycnhFilter(OSynchEntityElement."Record GUID",OSynchFilter."Filter Type"::"Table Relation",
          OSynchEntityElement."Table No.",5,OSynchFilter.Type::FILTER,OSynchEntityElement."Master Table No.",0,'<>''''');

        OSynchEntityElement."Table Relation" := ComposeFilterExpression(OSynchEntityElement."Record GUID",1);
        OSynchEntityElement.MODIFY;
      END;

      InsertODependency(OSynchEntityElement."Synch. Entity Code",OSynchEntityElement."Element No.",Text110);
      OSynchDependency.GET(OSynchEntityElement."Synch. Entity Code",OSynchEntityElement."Element No.",Text110);
      OSynchEntity1.GET(OSynchDependency."Depend. Synch. Entity Code");
      InsertOSycnhFilter(OSynchDependency."Record GUID",OSynchFilter."Filter Type"::"Table Relation",
        OSynchEntity1."Table No.",1,OSynchFilter.Type::FIELD,OSynchEntityElement."Table No.",5,'');

      OSynchDependency."Table Relation" := ComposeFilterExpression(OSynchDependency."Record GUID",1);
      OSynchDependency.MODIFY;

      InsertODependency(OSynchEntityElement."Synch. Entity Code",OSynchEntityElement."Element No.",Text111);
      OSynchDependency.GET(OSynchEntityElement."Synch. Entity Code",OSynchEntityElement."Element No.",Text111);
      OSynchEntity1.GET(OSynchDependency."Depend. Synch. Entity Code");
      InsertOSycnhFilter(OSynchDependency."Record GUID",OSynchFilter."Filter Type"::"Table Relation",
        OSynchEntity1."Table No.",1,OSynchFilter.Type::FIELD,OSynchField."Master Table No.",5,'');

      OSynchDependency."Table Relation" := ComposeFilterExpression(OSynchDependency."Record GUID",1);
      OSynchDependency.MODIFY;

      InsertOSynchField(OSynchEntityElement."Synch. Entity Code",OSynchEntityElement."Element No.",OSynchEntityElement."Table No.",
        OSynchEntityElement."Outlook Collection",'Name',FALSE,TRUE,5050,2,'',2);
      OSynchField.RESET;
      OSynchField.SETRANGE("Synch. Entity Code",OSynchEntity.Code);
      OSynchField.SETRANGE("Element No.",OSynchEntityElement."Element No.");
      IF OSynchField.FINDLAST THEN BEGIN
        OSynchEntityElement.CALCFIELDS("Master Table No.");
        InsertOSycnhFilter(OSynchField."Record GUID",OSynchFilter."Filter Type"::"Table Relation",OSynchField."Table No.",
          1,OSynchFilter.Type::FIELD,OSynchField."Master Table No.",5,'');

        OSynchField."Table Relation" := ComposeFilterExpression(OSynchField."Record GUID",1);
        OSynchField.MODIFY;
      END;
    END;

    PROCEDURE CreateDefaultApp@27(SynchEntityCodeIn@1002 : Code[10]);
    VAR
      OSynchEntity1@1000 : Record 5300;
      ToDo@1140000 : Record 5080;
    BEGIN
      IF OSynchEntity.GET(Text110) THEN
        IF OSynchEntity."Table No." <> 5050 THEN
          ERROR(Text013,OSynchEntity.FIELDCAPTION("Table No."),Text110,5050,OSynchEntity."Table No.");

      IF OSynchEntity.GET(Text111) THEN
        IF OSynchEntity."Table No." <> 5050 THEN
          ERROR(Text013,OSynchEntity.FIELDCAPTION("Table No."),Text111,5050,OSynchEntity."Table No.");

      IF OSynchEntity.GET(Text112) THEN
        IF OSynchEntity."Table No." <> 13 THEN
          ERROR(Text013,OSynchEntity.FIELDCAPTION("Table No."),Text112,13,OSynchEntity."Table No.");

      InsertOSycnhEntity(SynchEntityCodeIn,Text100,5080,'AppointmentItem');

      OSynchEntity.GET(SynchEntityCodeIn);
      InsertOSycnhFilter(OSynchEntity."Record GUID",OSynchFilter."Filter Type"::Condition,OSynchEntity."Table No.",
        8,OSynchFilter.Type::CONST,0,0,'1');
      InsertOSycnhFilter(OSynchEntity."Record GUID",OSynchFilter."Filter Type"::Condition,OSynchEntity."Table No.",
        17,OSynchFilter.Type::CONST,0,0,'0');
      InsertOSycnhFilter(OSynchEntity."Record GUID",OSynchFilter."Filter Type"::Condition,OSynchEntity."Table No.",
        45,OSynchFilter.Type::CONST,0,0,'0');
      InsertOSycnhFilter(OSynchEntity."Record GUID",OSynchFilter."Filter Type"::Condition,OSynchEntity."Table No.",
        2,OSynchFilter.Type::CONST,0,0,'');

      OSynchEntity.Condition := ComposeFilterExpression(OSynchEntity."Record GUID",0);
      OSynchEntity.MODIFY;

      RecRef.OPEN(OSynchEntity."Table No.");
      FldRef := RecRef.FIELD(ToDo.FIELDNO(Type));
      InsertOSynchField(
        OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'',FALSE,FALSE,0,ToDo.FIELDNO(Type),
        OSynchTypeConversion.OptionValueToText(ToDo.Type::Meeting,FldRef.OPTIONCAPTION),1);
      RecRef.CLOSE;

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'Start',
        FALSE,FALSE,0,9,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'Start',
        FALSE,FALSE,0,28,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'Subject',
        FALSE,FALSE,0,12,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'Location',
        FALSE,FALSE,0,35,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'AllDayEvent',
        FALSE,FALSE,0,34,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'Importance',
        FALSE,FALSE,0,11,'',0);
      InsertOOptionCorrelation(OSynchField."Synch. Entity Code",OSynchField."Element No.",OSynchField."Line No.",
        'olImportanceLow',0,0);
      InsertOOptionCorrelation(OSynchField."Synch. Entity Code",OSynchField."Element No.",OSynchField."Line No.",
        'olImportanceNormal',1,1);
      InsertOOptionCorrelation(OSynchField."Synch. Entity Code",OSynchField."Element No.",OSynchField."Line No.",
        'olImportanceHigh',2,2);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'Duration',
        FALSE,FALSE,0,29,'',0);

      InsertOSynchField(OSynchEntity.Code,0,OSynchEntity."Table No.",OSynchEntity."Outlook Item",'Organizer',
        FALSE,FALSE,13,2,'',2);
      OSynchField.RESET;
      OSynchField.SETRANGE("Synch. Entity Code",OSynchEntity.Code);
      OSynchField.SETRANGE("Element No.",0);
      IF OSynchField.FINDLAST THEN BEGIN
        InsertOSycnhFilter(OSynchField."Record GUID",OSynchFilter."Filter Type"::"Table Relation",OSynchField."Table No.",
          1,OSynchFilter.Type::FIELD,OSynchEntity."Table No.",3,'');

        OSynchField."Table Relation" := ComposeFilterExpression(OSynchField."Record GUID",1);
        OSynchField.MODIFY;
      END;

      InsertOSynchEntityElement(OSynchEntity.Code,5199,Text121);
      OSynchEntityElement.RESET;
      OSynchEntityElement.SETRANGE("Synch. Entity Code",OSynchEntity.Code);
      IF OSynchEntityElement.FINDLAST THEN BEGIN
        OSynchEntityElement.CALCFIELDS("Master Table No.");
        InsertOSycnhFilter(OSynchEntityElement."Record GUID",OSynchFilter."Filter Type"::"Table Relation",
          OSynchEntityElement."Table No.",1,OSynchFilter.Type::FIELD,OSynchEntityElement."Master Table No.",1,'');
        InsertOSycnhFilter(OSynchEntityElement."Record GUID",OSynchFilter."Filter Type"::"Table Relation",
          OSynchEntityElement."Table No.",7,OSynchFilter.Type::CONST,OSynchEntityElement."Master Table No.",0,'1');

        OSynchEntityElement."Table Relation" := ComposeFilterExpression(OSynchEntityElement."Record GUID",1);
        OSynchEntityElement.MODIFY;
      END;

      InsertODependency(OSynchEntityElement."Synch. Entity Code",OSynchEntityElement."Element No.",Text110);
      OSynchDependency.GET(OSynchEntityElement."Synch. Entity Code",OSynchEntityElement."Element No.",Text110);
      OSynchEntity1.GET(OSynchDependency."Depend. Synch. Entity Code");
      InsertOSycnhFilter(OSynchDependency."Record GUID",OSynchFilter."Filter Type"::Condition,OSynchEntityElement."Table No.",
        4,OSynchFilter.Type::CONST,0,0,'0');
      InsertOSycnhFilter(OSynchDependency."Record GUID",OSynchFilter."Filter Type"::"Table Relation",
        OSynchEntity1."Table No.",1,OSynchFilter.Type::FIELD,OSynchEntityElement."Table No.",5,'');

      OSynchDependency.Condition := ComposeFilterExpression(OSynchDependency."Record GUID",0);
      OSynchDependency."Table Relation" := ComposeFilterExpression(OSynchDependency."Record GUID",1);
      OSynchDependency.MODIFY;

      InsertODependency(OSynchEntityElement."Synch. Entity Code",OSynchEntityElement."Element No.",Text111);
      OSynchDependency.GET(OSynchEntityElement."Synch. Entity Code",OSynchEntityElement."Element No.",Text111);
      OSynchEntity1.GET(OSynchDependency."Depend. Synch. Entity Code");
      InsertOSycnhFilter(OSynchDependency."Record GUID",OSynchFilter."Filter Type"::Condition,OSynchEntityElement."Table No.",
        4,OSynchFilter.Type::CONST,0,0,'0');
      InsertOSycnhFilter(OSynchDependency."Record GUID",OSynchFilter."Filter Type"::"Table Relation",
        OSynchEntity1."Table No.",1,OSynchFilter.Type::FIELD,OSynchEntityElement."Table No.",5,'');

      OSynchDependency.Condition := ComposeFilterExpression(OSynchDependency."Record GUID",0);
      OSynchDependency."Table Relation" := ComposeFilterExpression(OSynchDependency."Record GUID",1);
      OSynchDependency.MODIFY;

      InsertODependency(OSynchEntityElement."Synch. Entity Code",OSynchEntityElement."Element No.",Text112);
      OSynchDependency.GET(OSynchEntityElement."Synch. Entity Code",OSynchEntityElement."Element No.",Text112);
      OSynchEntity1.GET(OSynchDependency."Depend. Synch. Entity Code");
      InsertOSycnhFilter(OSynchDependency."Record GUID",OSynchFilter."Filter Type"::Condition,OSynchEntityElement."Table No.",
        4,OSynchFilter.Type::CONST,0,0,'1');
      InsertOSycnhFilter(OSynchDependency."Record GUID",OSynchFilter."Filter Type"::"Table Relation",
        OSynchEntity1."Table No.",1,OSynchFilter.Type::FIELD,OSynchEntityElement."Table No.",5,'');

      OSynchDependency.Condition := ComposeFilterExpression(OSynchDependency."Record GUID",0);
      OSynchDependency."Table Relation" := ComposeFilterExpression(OSynchDependency."Record GUID",1);
      OSynchDependency.MODIFY;

      InsertOSynchField(OSynchEntityElement."Synch. Entity Code",OSynchEntityElement."Element No.",OSynchEntityElement."Table No.",
        OSynchEntityElement."Outlook Collection",'',FALSE,FALSE,0,7,FORMAT(TRUE),1);

      InsertOSynchField(OSynchEntityElement."Synch. Entity Code",OSynchEntityElement."Element No.",OSynchEntityElement."Table No.",
        OSynchEntityElement."Outlook Collection",'Type',FALSE,FALSE,0,3,'',0);
      InsertOOptionCorrelation(OSynchField."Synch. Entity Code",OSynchField."Element No.",OSynchField."Line No.",
        '0',2,0);
      InsertOOptionCorrelation(OSynchField."Synch. Entity Code",OSynchField."Element No.",OSynchField."Line No.",
        '1',0,1);
      InsertOOptionCorrelation(OSynchField."Synch. Entity Code",OSynchField."Element No.",OSynchField."Line No.",
        '2',1,2);

      InsertOSynchField(OSynchEntityElement."Synch. Entity Code",OSynchEntityElement."Element No.",OSynchEntityElement."Table No.",
        OSynchEntityElement."Outlook Collection",'Address',FALSE,TRUE,5050,102,'',2);
      OSynchField.RESET;
      OSynchField.SETRANGE("Synch. Entity Code",OSynchEntity.Code);
      OSynchField.SETRANGE("Element No.",OSynchEntityElement."Element No.");
      IF OSynchField.FINDLAST THEN BEGIN
        OSynchEntityElement.CALCFIELDS("Master Table No.");
        InsertOSycnhFilter(OSynchField."Record GUID",OSynchFilter."Filter Type"::"Table Relation",OSynchField."Table No.",
          1,OSynchFilter.Type::FIELD,OSynchField."Master Table No.",5,'');
        InsertOSycnhFilter(OSynchField."Record GUID",OSynchFilter."Filter Type"::Condition,OSynchEntityElement."Table No.",
          4,OSynchFilter.Type::CONST,0,0,'0');

        OSynchField."Table Relation" := ComposeFilterExpression(OSynchField."Record GUID",1);
        OSynchField.Condition := ComposeFilterExpression(OSynchField."Record GUID",0);
        OSynchField.MODIFY;
      END;

      InsertOSynchField(OSynchEntity.Code,OSynchEntityElement."Element No.",OSynchEntityElement."Table No.",
        OSynchEntityElement."Outlook Collection",'Address',FALSE,TRUE,13,5052,'',2);
      OSynchField.RESET;
      OSynchField.SETRANGE("Synch. Entity Code",OSynchEntity.Code);
      OSynchField.SETRANGE("Element No.",OSynchEntityElement."Element No.");
      IF OSynchField.FINDLAST THEN BEGIN
        OSynchEntityElement.CALCFIELDS("Master Table No.");
        InsertOSycnhFilter(OSynchField."Record GUID",OSynchFilter."Filter Type"::"Table Relation",OSynchField."Table No.",
          1,OSynchFilter.Type::FIELD,OSynchField."Master Table No.",5,'');
        InsertOSycnhFilter(OSynchField."Record GUID",OSynchFilter."Filter Type"::Condition,OSynchEntityElement."Table No.",
          4,OSynchFilter.Type::CONST,0,0,'1');

        OSynchField."Table Relation" := ComposeFilterExpression(OSynchField."Record GUID",1);
        OSynchField.Condition := ComposeFilterExpression(OSynchField."Record GUID",0);
        OSynchField.MODIFY;
      END;

      InsertOSynchField(OSynchEntity.Code,OSynchEntityElement."Element No.",OSynchEntityElement."Table No.",
        OSynchEntityElement."Outlook Collection",'MeetingResponseStatus',FALSE,FALSE,0,8,'',2);

      OSynchField.RESET;
      OSynchField.SETRANGE("Synch. Entity Code",OSynchEntityElement."Synch. Entity Code");
      OSynchField.SETRANGE("Element No.",OSynchEntityElement."Element No.");
      IF OSynchField.FINDLAST THEN BEGIN
        InsertOOptionCorrelation(OSynchField."Synch. Entity Code",OSynchField."Element No.",OSynchField."Line No.",
          'olResponseNone',0,0);
        InsertOOptionCorrelation(OSynchField."Synch. Entity Code",OSynchField."Element No.",OSynchField."Line No.",
          'olResponseAccepted',1,3);
        InsertOOptionCorrelation(OSynchField."Synch. Entity Code",OSynchField."Element No.",OSynchField."Line No.",
          'olResponseDeclined',2,4);
        InsertOOptionCorrelation(OSynchField."Synch. Entity Code",OSynchField."Element No.",OSynchField."Line No.",
          'olResponseTentative',3,2);
      END;

      InsertOSynchEntityElement(OSynchEntity.Code,5199,Text120);
      OSynchEntityElement.RESET;
      OSynchEntityElement.SETRANGE("Synch. Entity Code",OSynchEntity.Code);
      IF OSynchEntityElement.FINDLAST THEN BEGIN
        OSynchEntityElement.CALCFIELDS("Master Table No.");
        InsertOSycnhFilter(OSynchEntityElement."Record GUID",OSynchFilter."Filter Type"::"Table Relation",
          OSynchEntityElement."Table No.",1,OSynchFilter.Type::FIELD,OSynchEntityElement."Master Table No.",1,'');
        InsertOSycnhFilter(OSynchEntityElement."Record GUID",OSynchFilter."Filter Type"::"Table Relation",
          OSynchEntityElement."Table No.",7,OSynchFilter.Type::CONST,OSynchEntityElement."Master Table No.",0,'0');

        OSynchEntityElement."Table Relation" := ComposeFilterExpression(OSynchEntityElement."Record GUID",1);
        OSynchEntityElement.MODIFY;
      END;

      InsertODependency(OSynchEntityElement."Synch. Entity Code",OSynchEntityElement."Element No.",Text110);
      OSynchDependency.GET(OSynchEntityElement."Synch. Entity Code",OSynchEntityElement."Element No.",Text110);
      OSynchEntity1.GET(OSynchDependency."Depend. Synch. Entity Code");
      InsertOSycnhFilter(OSynchDependency."Record GUID",OSynchFilter."Filter Type"::Condition,OSynchEntityElement."Table No.",
        4,OSynchFilter.Type::CONST,0,0,'0');
      InsertOSycnhFilter(OSynchDependency."Record GUID",OSynchFilter."Filter Type"::"Table Relation",
        OSynchEntity1."Table No.",1,OSynchFilter.Type::FIELD,OSynchEntityElement."Table No.",5,'');

      OSynchDependency.Condition := ComposeFilterExpression(OSynchDependency."Record GUID",0);
      OSynchDependency."Table Relation" := ComposeFilterExpression(OSynchDependency."Record GUID",1);
      OSynchDependency.MODIFY;

      InsertODependency(OSynchEntityElement."Synch. Entity Code",OSynchEntityElement."Element No.",Text111);
      OSynchDependency.GET(OSynchEntityElement."Synch. Entity Code",OSynchEntityElement."Element No.",Text111);
      OSynchEntity1.GET(OSynchDependency."Depend. Synch. Entity Code");
      InsertOSycnhFilter(OSynchDependency."Record GUID",OSynchFilter."Filter Type"::Condition,OSynchEntityElement."Table No.",
        4,OSynchFilter.Type::CONST,0,0,'0');
      InsertOSycnhFilter(OSynchDependency."Record GUID",OSynchFilter."Filter Type"::"Table Relation",
        OSynchEntity1."Table No.",1,OSynchFilter.Type::FIELD,OSynchEntityElement."Table No.",5,'');

      OSynchDependency.Condition := ComposeFilterExpression(OSynchDependency."Record GUID",0);
      OSynchDependency."Table Relation" := ComposeFilterExpression(OSynchDependency."Record GUID",1);
      OSynchDependency.MODIFY;

      InsertODependency(OSynchEntityElement."Synch. Entity Code",OSynchEntityElement."Element No.",Text112);
      OSynchDependency.GET(OSynchEntityElement."Synch. Entity Code",OSynchEntityElement."Element No.",Text112);
      OSynchEntity1.GET(OSynchDependency."Depend. Synch. Entity Code");
      InsertOSycnhFilter(OSynchDependency."Record GUID",OSynchFilter."Filter Type"::Condition,OSynchEntityElement."Table No.",
        4,OSynchFilter.Type::CONST,0,0,'1');
      InsertOSycnhFilter(OSynchDependency."Record GUID",OSynchFilter."Filter Type"::"Table Relation",
        OSynchEntity1."Table No.",1,OSynchFilter.Type::FIELD,OSynchEntityElement."Table No.",5,'');

      OSynchDependency.Condition := ComposeFilterExpression(OSynchDependency."Record GUID",0);
      OSynchDependency."Table Relation" := ComposeFilterExpression(OSynchDependency."Record GUID",1);
      OSynchDependency.MODIFY;

      InsertOSynchField(OSynchEntity.Code,OSynchEntityElement."Element No.",OSynchEntityElement."Table No.",
        OSynchEntityElement."Outlook Collection",'',FALSE,FALSE,0,7,FORMAT(FALSE),1);

      InsertOSynchField(OSynchEntity.Code,OSynchEntityElement."Element No.",OSynchEntityElement."Table No.",
        OSynchEntityElement."Outlook Collection",'Name',FALSE,TRUE,5050,2,'',2);
      OSynchField.RESET;
      OSynchField.SETRANGE("Synch. Entity Code",OSynchEntity.Code);
      OSynchField.SETRANGE("Element No.",OSynchEntityElement."Element No.");
      IF OSynchField.FINDLAST THEN BEGIN
        OSynchEntityElement.CALCFIELDS("Master Table No.");
        InsertOSycnhFilter(OSynchField."Record GUID",OSynchFilter."Filter Type"::"Table Relation",OSynchField."Table No.",
          1,OSynchFilter.Type::FIELD,OSynchField."Master Table No.",5,'');
        InsertOSycnhFilter(OSynchField."Record GUID",OSynchFilter."Filter Type"::Condition,OSynchEntityElement."Table No.",
          4,OSynchFilter.Type::CONST,0,0,'0');

        OSynchField."Table Relation" := ComposeFilterExpression(OSynchField."Record GUID",1);
        OSynchField.Condition := ComposeFilterExpression(OSynchField."Record GUID",0);
        OSynchField.MODIFY;
      END;

      InsertOSynchField(OSynchEntity.Code,OSynchEntityElement."Element No.",OSynchEntityElement."Table No.",
        OSynchEntityElement."Outlook Collection",'Name',FALSE,TRUE,13,2,'',2);
      OSynchField.RESET;
      OSynchField.SETRANGE("Synch. Entity Code",OSynchEntity.Code);
      OSynchField.SETRANGE("Element No.",OSynchEntityElement."Element No.");
      IF OSynchField.FINDLAST THEN BEGIN
        OSynchEntityElement.CALCFIELDS("Master Table No.");
        InsertOSycnhFilter(OSynchField."Record GUID",OSynchFilter."Filter Type"::"Table Relation",OSynchField."Table No.",
          1,OSynchFilter.Type::FIELD,OSynchField."Master Table No.",5,'');
        InsertOSycnhFilter(OSynchField."Record GUID",OSynchFilter."Filter Type"::Condition,OSynchEntityElement."Table No.",
          4,OSynchFilter.Type::CONST,0,0,'1');

        OSynchField."Table Relation" := ComposeFilterExpression(OSynchField."Record GUID",1);
        OSynchField.Condition := ComposeFilterExpression(OSynchField."Record GUID",0);
        OSynchField.MODIFY;
      END;
    END;

    LOCAL PROCEDURE InsertOSycnhEntity@14(SynchEntityCode@1000 : Code[10];DescriptionString@1001 : Text[80];TableID@1002 : Integer;OutlookItem@1003 : Text[80]);
    BEGIN
      WITH OSynchEntity DO BEGIN
        INIT;
        Code := SynchEntityCode;
        Description := DescriptionString;
        "Table No." := TableID;
        "Outlook Item" := OutlookItem;
        CALCFIELDS("Table Name");
        INSERT(TRUE);
      END;
    END;

    LOCAL PROCEDURE InsertOSynchEntityElement@23(SynchEntityCode@1000 : Code[10];TableID@1001 : Integer;OutlookCollection@1002 : Text[80]);
    BEGIN
      WITH OSynchEntityElement DO BEGIN
        INIT;
        "Synch. Entity Code" := SynchEntityCode;
        "Element No." := "Element No." + 10000;
        "Table No." := TableID;
        "Outlook Collection" := OutlookCollection;
        "Record GUID" := CREATEGUID;
        INSERT;
      END;
    END;

    LOCAL PROCEDURE InsertOSycnhFilter@40(RecordGUID@1000 : GUID;FlterType@1001 : Integer;TableID@1002 : Integer;FieldID@1003 : Integer;CaseType@1004 : Integer;MasterTableID@1005 : Integer;MasterFieldID@1006 : Integer;ValueString@1007 : Text[80]);
    BEGIN
      WITH OSynchFilter DO BEGIN
        INIT;
        "Record GUID" := RecordGUID;
        "Filter Type" := FlterType;
        "Line No." := "Line No." + 10000;
        "Table No." := TableID;
        VALIDATE("Field No.",FieldID);
        Type := CaseType;
        "Master Table No." := MasterTableID;

        IF MasterFieldID <> 0 THEN
          VALIDATE("Master Table Field No.",MasterFieldID)
        ELSE
          VALIDATE(Value,ValueString);

        INSERT;
      END;
    END;

    LOCAL PROCEDURE InsertOSynchField@37(SynchEntityCode@1000 : Code[10];ElementNo@1001 : Integer;MasterTableID@1002 : Integer;OutlookObject@1003 : Text[80];OutlookProperty@1004 : Text[80];UserDefined@1005 : Boolean;SearchField@1006 : Boolean;TableID@1007 : Integer;FieldID@1008 : Integer;DefaulfValue@1009 : Text[250];ReadOnlyStatus@1010 : Integer);
    BEGIN
      WITH OSynchField DO BEGIN
        INIT;
        "Synch. Entity Code" := SynchEntityCode;
        "Element No." := ElementNo;
        "Line No." := "Line No." + 10000;
        "Master Table No." := MasterTableID;
        "Table No." := TableID;
        "Outlook Object" := OutlookObject;
        "User-Defined" := UserDefined;
        "Search Field" := SearchField;
        "Field No." := FieldID;
        "Record GUID" := CREATEGUID;
        "Field Default Value" := DefaulfValue;
        IF TableID = 0 THEN
          Field.GET(MasterTableID,FieldID)
        ELSE
          Field.GET(TableID,FieldID);
        "Field Name" := Field."Field Caption";
        "Outlook Property" := OutlookProperty;
        "Read-Only Status" := ReadOnlyStatus;
        INSERT;
      END;
    END;

    LOCAL PROCEDURE InsertOOptionCorrelation@20(SynchEntityCode@1001 : Code[10];ElementNo@1000 : Integer;FieldLineNo@1002 : Integer;OutlookValue@1004 : Text[80];OptionID@1005 : Integer;EnumerationID@1003 : Integer);
    BEGIN
      WITH OSynchOptionCorrel DO BEGIN
        INIT;
        "Element No." := ElementNo;
        "Field Line No." := FieldLineNo;
        "Line No." := "Line No." + 10000;
        VALIDATE("Synch. Entity Code",SynchEntityCode);
        VALIDATE("Outlook Value",OutlookValue);
        VALIDATE("Option No.",OptionID);
        "Enumeration No." := EnumerationID;
        INSERT;
      END;
    END;

    LOCAL PROCEDURE InsertODependency@24(SynchEntityCode@1001 : Code[10];ElementNo@1000 : Integer;DependentEntityCode@1002 : Code[10]);
    VAR
      OSynchEntity1@1003 : Record 5300;
    BEGIN
      WITH OSynchDependency DO BEGIN
        IF NOT OSynchEntity1.GET(DependentEntityCode) THEN BEGIN
          CASE DependentEntityCode OF
            Text111:
              CreateDefaultContComp(DependentEntityCode);
            Text110:
              CreateDefaultContPers(DependentEntityCode);
            Text112:
              CreateDefaultContSp(DependentEntityCode);
          END;
          OSynchEntity.GET(SynchEntityCode);
        END;
        INIT;
        "Synch. Entity Code" := SynchEntityCode;
        "Element No." := ElementNo;
        VALIDATE("Depend. Synch. Entity Code",DependentEntityCode);
        "Record GUID" := CREATEGUID;
        INSERT;
      END;
    END;

    PROCEDURE CheckPKFieldsQuantity@21(TableID@1000 : Integer) : Boolean;
    VAR
      TempRecRef@1001 : RecordRef;
      KeyRef@1002 : KeyRef;
    BEGIN
      IF TableID = 0 THEN
        EXIT(TRUE);

      TempRecRef.OPEN(TableID,TRUE);
      KeyRef := TempRecRef.KEYINDEX(1);
      IF KeyRef.FIELDCOUNT <= 3 THEN
        EXIT(TRUE);

      ERROR(Text011,TempRecRef.CAPTION);
    END;

    PROCEDURE CheckOEnumeration@32(OSynchFieldIn@1001 : Record 5304) IsEnumeration : Boolean;
    VAR
      Counter@1002 : Integer;
      Counter1@1005 : Integer;
    BEGIN
      IF ISCLEAR(OObjLibrary) THEN
        IF NOT CREATE(OObjLibrary,FALSE,TRUE) THEN
          ERROR(Text014);

      IF OSynchFieldIn."Element No." = 0 THEN BEGIN
        OObjInfo := OObjLibrary.GetItem(OSynchFieldIn."Outlook Object");
        FOR Counter := 1 TO OObjInfo.PropertiesCount DO BEGIN
          OPropertyInfo := OObjInfo.GetProperty(Counter);
          IF NOT OPropertyInfo.ReturnsCollection AND (OPropertyInfo.name = OSynchFieldIn."Outlook Property") THEN
            IF OPropertyInfo.ReturnsEnumeration THEN
              IsEnumeration := TRUE;
        END;
      END ELSE BEGIN
        OSynchEntity.GET(OSynchFieldIn."Synch. Entity Code");
        OObjInfo := OObjLibrary.GetItem(OSynchEntity."Outlook Item");
        FOR Counter := 1 TO OObjInfo.PropertiesCount DO BEGIN
          OPropertyInfo := OObjInfo.GetProperty(Counter);
          IF OPropertyInfo.ReturnsCollection AND (OPropertyInfo.name = OSynchFieldIn."Outlook Object") THEN BEGIN
            OObjInfo1 := OPropertyInfo.ReturnedCollectionElement;
            FOR Counter1 := 1 TO OObjInfo1.PropertiesCount DO BEGIN
              OPropertyInfo1 := OObjInfo1.GetProperty(Counter1);
              IF OPropertyInfo1.name = OSynchFieldIn."Outlook Property" THEN
                IF OPropertyInfo1.ReturnsEnumeration THEN
                  IsEnumeration := TRUE;
            END;
          END;
        END;
      END;
    END;

    PROCEDURE InsertOSynchDefaults@34();
    VAR
      OSynchEntity@1000 : Record 5300;
      WebService@1102601000 : Record 2000000076;
      OSynchTypeConversion@1001 : Codeunit 5302;
      OSynchEntityRef@1002 : RecordRef;
      CodeFieldRef@1003 : FieldRef;
      TempStr1@1004 : Text[10];
    BEGIN
      IF OSynchEntity.FIND('-') THEN
        EXIT;

      OSynchEntityRef.OPEN(DATABASE::"Outlook Synch. Entity",TRUE);
      CodeFieldRef := OSynchEntityRef.FIELD(OSynchEntity.FIELDNO(Code));

      TempStr1 := Text132;
      OSynchTypeConversion.TruncateString(TempStr1,CodeFieldRef.LENGTH);
      CreateDefaultContPers(TempStr1);

      TempStr1 := Text133;
      OSynchTypeConversion.TruncateString(TempStr1,CodeFieldRef.LENGTH);
      CreateDefaultContComp(TempStr1);

      TempStr1 := Text134;
      OSynchTypeConversion.TruncateString(TempStr1,CodeFieldRef.LENGTH);
      CreateDefaultContSp(TempStr1);

      TempStr1 := Text130;
      OSynchTypeConversion.TruncateString(TempStr1,CodeFieldRef.LENGTH);
      CreateDefaultApp(TempStr1);

      TempStr1 := Text131;
      OSynchTypeConversion.TruncateString(TempStr1,CodeFieldRef.LENGTH);
      CreateDefaultTask(TempStr1);

      OSynchEntityRef.CLOSE;
      WebService.INIT;
      WebService."Object Type" := WebService."Object Type"::Codeunit;
      WebService."Service Name" := 'DynamicsNAVsynchOutlook'; // Do not translate
      WebService."Object ID" := CODEUNIT::"Outlook Synch. Dispatcher";
      WebService.Published := FALSE;
      IF WebService.INSERT THEN;
    END;

    LOCAL PROCEDURE InsertDefaultDependency@1102601044(OSynchEntity1@1102601000 : Record 5300;DependEntityElemCode@1102601001 : Code[10];DependEntityElemOCollection@1102601002 : Text[80]);
    BEGIN
      OSynchEntityElement.RESET;
      OSynchEntityElement.SETRANGE(OSynchEntityElement."Synch. Entity Code",DependEntityElemCode);
      OSynchEntityElement.SETRANGE(OSynchEntityElement."Outlook Collection",DependEntityElemOCollection);
      IF OSynchEntityElement.FINDFIRST THEN BEGIN
        InsertODependency(OSynchEntityElement."Synch. Entity Code",OSynchEntityElement."Element No.",OSynchEntity1.Code);
        OSynchDependency.GET(OSynchEntityElement."Synch. Entity Code",OSynchEntityElement."Element No.",OSynchEntity1.Code);
        IF DependEntityElemCode <> Text131 THEN
          IF OSynchEntity1.Code = Text112 THEN
            InsertOSycnhFilter(OSynchDependency."Record GUID",OSynchFilter."Filter Type"::Condition,OSynchEntityElement."Table No.",
              4,OSynchFilter.Type::CONST,0,0,'1')
          ELSE
            InsertOSycnhFilter(OSynchDependency."Record GUID",OSynchFilter."Filter Type"::Condition,OSynchEntityElement."Table No.",
              4,OSynchFilter.Type::CONST,0,0,'0');

        InsertOSycnhFilter(OSynchDependency."Record GUID",OSynchFilter."Filter Type"::"Table Relation",
          OSynchEntity1."Table No.",1,OSynchFilter.Type::FIELD,OSynchEntityElement."Table No.",5,'');

        IF DependEntityElemCode <> Text131 THEN
          OSynchDependency.Condition := ComposeFilterExpression(OSynchDependency."Record GUID",0);
        OSynchDependency."Table Relation" := ComposeFilterExpression(OSynchDependency."Record GUID",1);
        OSynchDependency.MODIFY;
      END
    END;

    BEGIN
    END.
  }
}
