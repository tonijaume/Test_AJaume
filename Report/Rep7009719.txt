OBJECT Report 7009719 Reservas Hotel
{
  OBJECT-PROPERTIES
  {
    Date=02/10/12;
    Time=12:00:00;
    Modified=Yes;
    Version List=AIC2009;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Hotel bookings;
               ESP=Reservas hotel];
    OnInitReport=BEGIN
                   vPaso:=FALSE;
                   IF NOT rInfemp.FIND('-') THEN
                     ERROR(Text000);
                   IF NOT rPar.FIND('-') THEN
                     ERROR(Text001);
                 END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        NewPagePerRecord=No;
        MaxIteration=1;
        DataItemVarName=Cabecera;
        PrintOnlyIfDetail=Yes;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18150;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1   ;Shape        ;0    ;423  ;18150;423  ;ShapeStyle=HorzLine }
            { 5   ;Label        ;16050;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Rooming List;
                                                                    ESP=Rooming List] }
            { 6   ;TextBox      ;0    ;0    ;4200 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=rInfemp.Name }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=18150;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 22  ;Shape        ;0    ;0    ;18150;423  ;ShapeStyle=HorzLine }
            { 45  ;TextBox      ;17550;423  ;600  ;423  ;SourceExpr=CurrReport.PAGENO }
            { 46  ;Label        ;16650;423  ;900  ;423  ;ParentControl=45;
                                                         VertAlign=Center;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=page;
                                                                    ESP=P gina] }
            { 47  ;TextBox      ;6750 ;423  ;4500 ;423  ;SourceExpr=FORMAT(TODAY,0,4)+' '+FORMAT(TIME,5)+' ('+USERID+')' }
            { 43  ;TextBox      ;0    ;423  ;3750 ;423  ;SourceExpr=cNombre.nom_delegacion(rPar.Delegacion) }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table7009724;
        DataItemTableView=SORTING(Hotel);
        NewPagePerRecord=No;
        PrintOnlyIfDetail=Yes;
        OnAfterGetRecord=BEGIN
                           CLEAR(matHab);
                           CLEAR(matCantHab);
                           CLEAR(matDesHab);
                         END;

        ReqFilterFields=Hotel;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table7009743;
        DataItemTableView=SORTING(Fecha entrada,Fecha salida,TourOperador Venta,Bono,N§ Responsable)
                          WHERE(Responsable=CONST(Yes));
        OnPreDataItem=BEGIN
                        IF filTour <> '' THEN
                          SETRANGE("TourOperador Venta", filTour);
                        IF filEntrada <> 0D THEN
                          SETRANGE("Fecha entrada", filEntrada);
                        IF filSalida <> 0D THEN
                          SETRANGE("Fecha salida", filSalida);
                        IF filOferta THEN BEGIN
                          SETRANGE("Hotel reservado", Hotel.Hotel);
                          SETRANGE("Hotel booking");
                        END
                        ELSE BEGIN
                          SETRANGE("Hotel reservado");
                          SETRANGE("Hotel booking", Hotel.Hotel);
                        END;
                      END;

        OnAfterGetRecord=BEGIN
                           // contamos las ni¤os y las terceras personas de las reservas
                           CLEAR(cmpTercera);
                           CLEAR(cmpNi¤o);
                           rRes.RESET;
                           rRes.SETCURRENTKEY(rRes.Delegacion,
                                              rRes."N§ Responsable");
                           rRes.SETRANGE(rRes."N§ Responsable", "Reserva Hotel"."N§ Reserva");
                           IF rRes.FIND('-') THEN
                             IF rParPer.FIND('-') THEN
                               REPEAT
                                 IF rRes."Tipo Persona" <> rParPer."Codigo Infant" THEN BEGIN
                                   IF rRes."N§ persona" > 2 THEN
                                     cmpTercera := cmpTercera + 1;
                                   IF rRes."Tipo Persona" = rParPer."Codigo Ni¤o" THEN
                                     cmpNi¤o := cmpNi¤o + 1;
                                 END;
                               UNTIL rRes.NEXT = 0;

                           // buscamos la informaci¢n sobre los vuelos
                           IF rVuelos.GET("Reserva Hotel"."Fecha entrada","Reserva Hotel"."Compa¤ia entrada","Reserva Hotel"."Vuelo entrada",
                                          "Reserva Hotel"."IATA origen entrada","Reserva Hotel"."IATA destino entrada") THEN
                             cmpHorLle := rVuelos."Hora Entrada";
                           IF rVuelos.GET("Reserva Hotel"."Fecha salida","Reserva Hotel"."Compa¤ia salida","Reserva Hotel"."Vuelo salida",
                                          "Reserva Hotel"."IATA origen salida","Reserva Hotel"."IATA destino salida") THEN
                             cmpHorSal := rVuelos."Hora Salida";

                           // rellenamos la matriz de tipos de habitacion
                           CLEAR(conHab);
                           REPEAT
                             conHab := conHab + 1;
                             IF matHab[conHab] = Habitacion THEN
                               matCantHab[conHab] := matCantHab[conHab] + 1;
                           UNTIL (matHab[conHab] = '') OR (matHab[conHab] = Habitacion) OR (conHab = 20);

                           IF matHab[conHab] = '' THEN BEGIN
                             matHab[conHab] := "Reserva Hotel".Habitacion;
                             matCantHab[conHab] := 1;
                             IF "Reserva Hotel"."Habitacion TO" <> '' THEN BEGIN
                               IF rConvHab.GET("Reserva Hotel".Delegacion, "Reserva Hotel"."Contrato compra",
                                               rConvHab."Tipo contrato"::Compra, "Reserva Hotel"."Habitacion TO") THEN
                                 matDesHab[conHab] := rConvHab.Descripcion;
                             END
                             ELSE BEGIN
                               rConvHab.RESET;
                               rConvHab.SETRANGE(Delegacion, "Reserva Hotel".Delegacion);
                               rConvHab.SETRANGE("N§ Contrato", "Reserva Hotel"."Contrato compra");
                               rConvHab.SETRANGE("Habitacion cupo", "Reserva Hotel".Habitacion);
                               IF rConvHab.FIND('-') THEN
                                 matDesHab[conHab] := rConvHab.Descripcion;
                             END;
                           END;
                         END;

        GroupTotalFields=Fecha entrada,Fecha salida;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=18150;
            SectionHeight=2115;
          }
          CONTROLS
          {
            { 60  ;Label        ;15300;1692 ;1200 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Dep.;
                                                                    ESP=Sal.] }
            { 61  ;TextBox      ;17100;846  ;1050 ;423  ;FontSize=8;
                                                         SourceExpr=Estancia }
            { 62  ;Label        ;15600;846  ;1350 ;423  ;ParentControl=61;
                                                         HorzAlign=Right;
                                                         VertAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 63  ;Label        ;13950;1692 ;1200 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Arriv.;
                                                                    ESP=Lleg.] }
            { 64  ;Label        ;13200;1692 ;600  ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=CHD;
                                                                    ESP=NI] }
            { 66  ;TextBox      ;13500;846  ;1650 ;423  ;FontSize=8;
                                                         SourceExpr="Fecha salida" }
            { 67  ;Label        ;11550;1692 ;750  ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Board;
                                                                    ESP=R‚g.] }
            { 68  ;Label        ;12450;1692 ;600  ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=3P;
                                                                    ESP=3P] }
            { 69  ;Label        ;11400;846  ;1950 ;423  ;ParentControl=66;
                                                         HorzAlign=Right;
                                                         VertAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 70  ;Label        ;10800;1692 ;600  ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Pax;
                                                                    ESP=Pax] }
            { 71  ;Label        ;9600 ;1692 ;1050 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Type;
                                                                    ESP=Tipo] }
            { 72  ;TextBox      ;9300 ;846  ;1650 ;423  ;FontSize=8;
                                                         SourceExpr="Fecha entrada" }
            { 73  ;Label        ;9000 ;1692 ;450  ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=No.;
                                                                    ESP=N§] }
            { 74  ;TextBox      ;3150 ;0    ;6600 ;423  ;FontSize=9;
                                                         SourceExpr=Hotel.Nombre }
            { 75  ;Label        ;7650 ;1692 ;1200 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Sex;
                                                                    ESP=Sexo] }
            { 76  ;Label        ;6900 ;846  ;2250 ;423  ;ParentControl=72;
                                                         HorzAlign=Right;
                                                         VertAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 77  ;Label        ;6750 ;1692 ;750  ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Age;
                                                                    ESP=Edad] }
            { 78  ;Label        ;1800 ;1692 ;4800 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Name;
                                                                    ESP=Nombre] }
            { 80  ;Label        ;16650;1692 ;1500 ;423  ;ParentControl=79;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=T.O.;
                                                                    ESP=T.O.] }
            { 81  ;TextBox      ;1050 ;0    ;1950 ;423  ;FontSize=9;
                                                         SourceExpr=Hotel.Hotel }
            { 82  ;Label        ;0    ;1692 ;1650 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Voucher;
                                                                    ESP=Bono] }
            { 83  ;Label        ;0    ;0    ;900  ;423  ;ParentControl=81;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Hotel;
                                                                    ESP=Hotel] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=18150;
            SectionHeight=2115;
            OnPreSection=BEGIN
                           IF NOT vPaso THEN BEGIN
                             vFecEntAnt:="Reserva Hotel"."Fecha entrada";
                             vFecSalAnt:="Reserva Hotel"."Fecha salida";
                           END;
                           IF (vFecEntAnt<>"Reserva Hotel"."Fecha entrada") OR
                              (vFecSalAnt<>"Reserva Hotel"."Fecha salida") THEN BEGIN
                             vFecEntAnt:="Reserva Hotel"."Fecha entrada";
                             vFecSalAnt:="Reserva Hotel"."Fecha salida";
                             CurrReport.SHOWOUTPUT(TRUE);
                             CurrReport.NEWPAGE;
                           END
                           ELSE BEGIN
                             IF vPaso THEN
                               CurrReport.SHOWOUTPUT(FALSE)
                             ELSE
                               vPaso:=TRUE;
                           END;
                         END;

          }
          CONTROLS
          {
            { 9   ;Label        ;0    ;1692 ;1650 ;423  ;ParentControl=8;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 12  ;Label        ;1800 ;1692 ;4800 ;423  ;ParentControl=11;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 15  ;Label        ;6750 ;1692 ;750  ;423  ;ParentControl=14;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 18  ;Label        ;7650 ;1692 ;1200 ;423  ;ParentControl=17;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 24  ;Label        ;9000 ;1692 ;450  ;423  ;ParentControl=23;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=No.;
                                                                    ESP=N§] }
            { 21  ;Label        ;9600 ;1692 ;1050 ;423  ;ParentControl=20;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Type;
                                                                    ESP=Tipo] }
            { 27  ;Label        ;10800;1692 ;600  ;423  ;ParentControl=26;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Pax;
                                                                    ESP=Pax] }
            { 30  ;Label        ;11550;1692 ;750  ;423  ;ParentControl=29;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Board;
                                                                    ESP=R‚g.] }
            { 10  ;Label        ;12450;1692 ;600  ;423  ;ParentControl=7;
                                                         HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=3P;
                                                                    ESP=3P] }
            { 16  ;Label        ;13200;1692 ;600  ;423  ;ParentControl=13;
                                                         HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 31  ;Label        ;13950;1692 ;1200 ;423  ;ParentControl=28;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Arriv.;
                                                                    ESP=Lleg.] }
            { 33  ;Label        ;15300;1692 ;1200 ;423  ;ParentControl=32;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Dep.;
                                                                    ESP=Sal.] }
            { 36  ;TextBox      ;9300 ;846  ;1650 ;423  ;FontSize=8;
                                                         SourceExpr="Fecha entrada" }
            { 37  ;Label        ;6900 ;846  ;2250 ;423  ;ParentControl=36;
                                                         HorzAlign=Right;
                                                         VertAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 38  ;TextBox      ;13500;846  ;1650 ;423  ;FontSize=8;
                                                         SourceExpr="Fecha salida" }
            { 39  ;Label        ;11400;846  ;1950 ;423  ;ParentControl=38;
                                                         HorzAlign=Right;
                                                         VertAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 40  ;TextBox      ;17100;846  ;1050 ;423  ;FontSize=8;
                                                         SourceExpr=Estancia }
            { 41  ;Label        ;15600;846  ;1350 ;423  ;ParentControl=40;
                                                         HorzAlign=Right;
                                                         VertAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 4   ;TextBox      ;3150 ;0    ;6600 ;423  ;FontSize=9;
                                                         SourceExpr=Hotel.Nombre }
            { 2   ;TextBox      ;1050 ;0    ;1950 ;423  ;FontSize=9;
                                                         SourceExpr=Hotel.Hotel }
            { 3   ;Label        ;0    ;0    ;900  ;423  ;ParentControl=2;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Hotel;
                                                                    ESP=Hotel] }
            { 108 ;Label        ;16650;1692 ;1500 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=T.O.;
                                                                    ESP=T.O.] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 8   ;TextBox      ;0    ;0    ;1650 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Bono }
            { 11  ;TextBox      ;1800 ;0    ;4800 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Nombre }
            { 14  ;TextBox      ;6750 ;0    ;750  ;423  ;HorzAlign=Right;
                                                         SourceExpr=Edad }
            { 17  ;TextBox      ;7650 ;0    ;1200 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Tipo Persona" }
            { 20  ;TextBox      ;9600 ;0    ;1050 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Habitacion }
            { 23  ;TextBox      ;9000 ;0    ;450  ;423  ;HorzAlign=Right;
                                                         SourceExpr="N§ Habitaciones" }
            { 26  ;TextBox      ;10800;0    ;600  ;423  ;HorzAlign=Right;
                                                         SourceExpr=Paxes }
            { 29  ;TextBox      ;11550;0    ;750  ;423  ;HorzAlign=Left;
                                                         SourceExpr=Regimen }
            { 7   ;TextBox      ;12450;0    ;600  ;423  ;HorzAlign=Center;
                                                         SourceExpr=cmpTercera }
            { 13  ;TextBox      ;13200;0    ;600  ;423  ;FontSize=7;
                                                         CaptionML=[ENU=CHD;
                                                                    ESP=NI];
                                                         SourceExpr=cmpNi¤o }
            { 32  ;TextBox      ;15300;0    ;1200 ;423  ;SourceExpr=cmpHorSal }
            { 28  ;TextBox      ;13950;0    ;1200 ;423  ;SourceExpr=cmpHorLle }
            { 79  ;TextBox      ;16650;0    ;1500 ;423  ;FontSize=8;
                                                         SourceExpr="TourOperador Venta" }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table7009743;
        DataItemTableView=SORTING(Delegacion,N§ Responsable)
                          WHERE(Responsable=CONST(No));
        DataItemVarName=Acompa¤ante;
        DataItemLink=N§ Responsable=FIELD(N§ Reserva);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=18150;
            SectionHeight=2115;
          }
          CONTROLS
          {
            { 84  ;TextBox      ;17100;846  ;1050 ;423  ;FontSize=8;
                                                         SourceExpr=Estancia }
            { 85  ;Label        ;15600;846  ;1350 ;423  ;ParentControl=84;
                                                         HorzAlign=Right;
                                                         VertAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 86  ;Label        ;15300;1692 ;1200 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Dep.;
                                                                    ESP=Sal.] }
            { 87  ;Label        ;13950;1692 ;1200 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Arriv.;
                                                                    ESP=Lleg.] }
            { 89  ;TextBox      ;13500;846  ;1650 ;423  ;FontSize=8;
                                                         SourceExpr="Fecha salida" }
            { 90  ;Label        ;13200;1692 ;600  ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=CHD;
                                                                    ESP=NI] }
            { 91  ;Label        ;12450;1692 ;600  ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=3P;
                                                                    ESP=3P] }
            { 92  ;Label        ;11400;846  ;1950 ;423  ;ParentControl=89;
                                                         HorzAlign=Right;
                                                         VertAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 93  ;Label        ;11550;1692 ;750  ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Board;
                                                                    ESP=R‚g.] }
            { 94  ;Label        ;10800;1692 ;600  ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Pax;
                                                                    ESP=Pax] }
            { 95  ;Label        ;9600 ;1692 ;1050 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Type;
                                                                    ESP=Tipo] }
            { 96  ;TextBox      ;9300 ;846  ;1650 ;423  ;FontSize=8;
                                                         SourceExpr="Fecha entrada" }
            { 97  ;Label        ;9000 ;1692 ;450  ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=No.;
                                                                    ESP=N§] }
            { 98  ;TextBox      ;3150 ;0    ;6600 ;423  ;FontSize=9;
                                                         SourceExpr=Hotel.Nombre }
            { 99  ;Label        ;7650 ;1692 ;1200 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Sex;
                                                                    ESP=Sexo] }
            { 100 ;Label        ;6900 ;846  ;2250 ;423  ;ParentControl=96;
                                                         HorzAlign=Right;
                                                         VertAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 101 ;Label        ;6750 ;1692 ;750  ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Age;
                                                                    ESP=Edad] }
            { 102 ;Label        ;1800 ;1692 ;4800 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Name;
                                                                    ESP=Nombre] }
            { 105 ;TextBox      ;1050 ;0    ;1950 ;423  ;FontSize=9;
                                                         SourceExpr=Hotel.Hotel }
            { 106 ;Label        ;0    ;1692 ;1650 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Voucher;
                                                                    ESP=Bono] }
            { 107 ;Label        ;0    ;0    ;900  ;423  ;ParentControl=105;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Hotel;
                                                                    ESP=Hotel] }
            { 109 ;Label        ;16650;1692 ;1500 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=T.O.;
                                                                    ESP=T.O.] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 19  ;TextBox      ;1800 ;0    ;4800 ;423  ;SourceExpr=Nombre }
            { 42  ;TextBox      ;6750 ;0    ;750  ;423  ;SourceExpr=Edad }
            { 44  ;TextBox      ;7650 ;0    ;1200 ;423  ;SourceExpr="Tipo Persona" }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=Habitaciones;
        OnPreDataItem=BEGIN
                        CLEAR(conHab);
                      END;

        OnAfterGetRecord=BEGIN
                           conHab:=conHab+1;
                           IF (conHab>20) THEN
                             CurrReport.BREAK;
                           IF matHab[conHab]='' THEN
                             CurrReport.BREAK;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=18150;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 48  ;Label        ;2250 ;423  ;2700 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Room code;
                                                                    ESP=C¢digo habitaci¢n] }
            { 49  ;Label        ;5100 ;423  ;6300 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Description;
                                                                    ESP=Descripci¢n] }
            { 50  ;Label        ;11550;423  ;1500 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Amount;
                                                                    ESP=Cantidad] }
          }
           }
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=18150;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 54  ;TextBox      ;3150 ;0    ;6600 ;423  ;FontSize=9;
                                                         SourceExpr=Hotel.Nombre }
            { 55  ;TextBox      ;1050 ;0    ;1950 ;423  ;FontSize=9;
                                                         SourceExpr=Hotel.Hotel }
            { 56  ;Label        ;0    ;0    ;900  ;423  ;ParentControl=55;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Hotel;
                                                                    ESP=Hotel] }
            { 57  ;Label        ;2250 ;846  ;2700 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Room code;
                                                                    ESP=C¢digo habitaci¢n] }
            { 58  ;Label        ;5100 ;846  ;6300 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Description;
                                                                    ESP=Descripci¢n] }
            { 59  ;Label        ;11550;846  ;1500 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Amount;
                                                                    ESP=Cantidad] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 51  ;TextBox      ;2250 ;0    ;2700 ;423  ;SourceExpr=matHab[conHab] }
            { 52  ;TextBox      ;5100 ;0    ;6300 ;423  ;SourceExpr=matDesHab[conHab] }
            { 53  ;TextBox      ;11550;0    ;1500 ;423  ;SourceExpr=matCantHab[conHab] }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
      CaptionML=[ENU=Hotel bookings;
                 ESP=Reservas hotel];
      OnOpenForm=BEGIN
                   RequestOptionsForm.ACTIVATE;
                 END;

    }
    CONTROLS
    {
      { 1   ;TextBox      ;3300 ;220  ;3080 ;440  ;SourceExpr=filTour;
                                                   TableRelation=TourOperador.TourOperador }
      { 2   ;Label        ;220  ;220  ;2970 ;440  ;ParentControl=1;
                                                   CaptionML=[ENU=Tour Operator;
                                                              ESP=Tour Operador] }
      { 3   ;TextBox      ;3300 ;770  ;1650 ;440  ;SourceExpr=filEntrada }
      { 4   ;Label        ;220  ;770  ;2970 ;440  ;ParentControl=3;
                                                   CaptionML=[ENU=Check-in Date;
                                                              ESP=Fecha entrada] }
      { 5   ;TextBox      ;3300 ;1320 ;1650 ;440  ;SourceExpr=filSalida }
      { 6   ;Label        ;220  ;1320 ;2970 ;440  ;ParentControl=5;
                                                   CaptionML=[ENU=Check-out Date;
                                                              ESP=Fecha salida] }
      { 7   ;CheckBox     ;3300 ;1870 ;440  ;440  ;ShowCaption=No;
                                                   SourceExpr=filOferta }
      { 8   ;Label        ;220  ;1870 ;2970 ;440  ;ParentControl=7;
                                                   CaptionML=[ENU=Offer Hotel;
                                                              ESP=Hotel oferta] }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text000@1103355027 : TextConst 'ENU=Company information chart does not exist;ESP=La tabla informacion empresa no existe';
      Text001@1103355028 : TextConst 'ENU=Parameters chart of the D.B do not exist;ESP=La tabla parametros del la B.D. no existe';
      rRes@1103355000 : Record 7009743;
      rParPer@1103355001 : Record 7009701;
      rVuelos@1103355002 : Record 7009754;
      rInfemp@1103355003 : Record 79;
      rPar@1103355004 : Record 7009700;
      rHab@1103355005 : Record 7009711;
      rConvHab@1103355006 : Record 7009731;
      cNombre@1103355007 : Codeunit 7009702;
      filTour@1103355008 : Code[10];
      filEntrada@1103355009 : Date;
      filSalida@1103355010 : Date;
      filOferta@1103355011 : Boolean;
      cmpTercera@1103355012 : Integer;
      cmpNi¤o@1103355013 : Integer;
      cmpHotel@1103355014 : Code[10];
      cmpHorLle@1103355015 : Time;
      cmpHorSal@1103355016 : Time;
      conHab@1103355017 : Integer;
      vTourAnt@1103355018 : Code[10];
      vFecEntAnt@1103355019 : Date;
      vFecSalAnt@1103355020 : Date;
      vHotAnt@1103355021 : Code[10];
      vPaso@1103355022 : Boolean;
      vHotCamb@1103355023 : Boolean;
      matHab@1103355024 : ARRAY [20] OF Code[10];
      matCantHab@1103355025 : ARRAY [20] OF Integer;
      matDesHab@1103355026 : ARRAY [20] OF Text[60];

    BEGIN
    {
      ## AJS 05.02.2010

        .- La descripcion de los tipos de habitacion ha pasado a ser de 60 caracteres
    }
    END.
  }
  RDLDATA
  {
  }
}
