OBJECT Report 7010442 SERRA - Factur Zona-Dia-Codigo
{
  OBJECT-PROPERTIES
  {
    Date=11/11/14;
    Time=17:38:08;
    Version List=TRANSFER,INV;
  }
  PROPERTIES
  {
    CaptionML=ESP=SERRA - Factur Zona-Dia-Codigo;
    TopMargin=0;
    BottomMargin=0;
    LeftMargin=0;
    OnInitReport=BEGIN
                   ConfCG.GET;
                   NoCopias:=1;
                 END;

    HorzGrid=210;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table36;
        DataItemTableView=SORTING(Document Type,No.);
        NewPagePerRecord=Yes;
        ReqFilterHeadingML=ESP=Facturas venta;
        OnPreDataItem=BEGIN
                        InfoEmpresa.GET;
                        InfoEmpresa.CALCFIELDS(Picture);
                        FormatDire.Company(DirEmpresa,InfoEmpresa);
                        vServicio := '';
                      END;

        OnAfterGetRecord=VAR
                           rLV@1100244000 : Record 37;
                           lwBol@1103355000 : Boolean;
                         BEGIN
                           //RRT. Buscamos el c¢digo de servicio asociado a la factura.
                           IF vServicio = '' THEN BEGIN
                             rLV.RESET;
                             rLV.SETCURRENTKEY("Document Type","Document No.");
                             rLV.SETRANGE("Document Type","Document Type");
                             rLV.SETRANGE("Document No.","No.");
                             rLV.SETFILTER(Servicio,'<>%1','');
                             IF rLV.FIND('-') THEN
                               vServicio := rLV.Servicio;
                           END;
                           //END.RRT.

                           IF "Salesperson Code" = '' THEN BEGIN
                             RepreVtasComp.INIT;
                             DescriVendedor := '';
                           END ELSE BEGIN
                             RepreVtasComp.GET("Salesperson Code");
                             DescriVendedor := Text000;
                           END;
                           IF "Your Reference" = '' THEN
                             DescriRefer := ''
                           ELSE
                             DescriRefer := FIELDCAPTION("Your Reference");
                           IF "VAT Registration No." = '' THEN
                             TextoCIF := ''
                           ELSE
                             TextoCIF := FIELDCAPTION("VAT Registration No.");
                           IF "Currency Code" = '' THEN BEGIN
                             ConfCG.TESTFIELD("LCY Code");
                             TotalTexto := STRSUBSTNO(Text001,ConfCG."LCY Code");
                             TextoTotIVAIncl := STRSUBSTNO(Text002,ConfCG."LCY Code");
                           END ELSE BEGIN
                             TotalTexto := STRSUBSTNO(Text001,"Currency Code");
                             TextoTotIVAIncl := STRSUBSTNO(Text002,"Currency Code");
                           END;
                           FormatDire.SalesHeaderBillTo(DirClie, "Sales Header");
                           Clie.GET("Bill-to Customer No.");

                           IF "Payment Terms Code" = '' THEN
                             TerminosPago.INIT
                           ELSE
                             TerminosPago.GET("Payment Terms Code");
                           IF "Payment Method Code" = '' THEN
                             FormaPago.INIT
                           ELSE
                             FormaPago.GET("Payment Method Code");
                           IF "Shipment Method Code" = '' THEN
                             CondEnv.INIT
                           ELSE
                             CondEnv.GET("Shipment Method Code");

                           FormatDire.SalesHeaderBillTo(EnvADir, "Sales Header");
                           MostrarDireEnvio := "Sell-to Customer No." <> "Bill-to Customer No.";
                           FOR i := 1 TO ARRAYLEN(EnvADir) DO
                             IF EnvADir[i] <> DirClie[i] THEN
                               MostrarDireEnvio := TRUE;

                           w_base_normal     := 0;
                           w_iva_normal      := 0;
                           w_impiva_normal   := 0;
                           w_total_normal    := 0;
                           w_base_maletas    := 0;
                           w_iva_maletas     := 0;
                           w_impiva_maletas  := 0;
                           w_total_maletas   := 0;
                           w_total_impresion := 0;

                           // ---- Obtener el contrato de venta para ver si hay que mostrar en cada linea el total ----
                           // ---- con el IVA incluido o no.

                           rCon.RESET; rCon.INIT;
                           // JPT 27/12/05 Cambio a las nuevas funciones de calculo
                           // cCalculo.busca_contrato_venta(rCon, "Bill-to Customer No.", "Shortcut Dimension 2 Code",
                           //                              "Posting Date", "Shortcut Dimension 1 Code");
                           cCalcR.BuscaContratoVentaReal(rCon, "Bill-to Customer No.", "Shortcut Dimension 2 Code",
                                                         "Posting Date", "Shortcut Dimension 1 Code");


                           IF NOT EVALUATE(lwBol,GETFILTER("Imprime Logo")) THEN
                             CLEAR(lwBol);

                           wImpMail := lwBol;

                           // ---- Buscar la prefactura que ha originado esta factura y el touroperador para mostrar ----
                           // ---- su nombre en el impreso de la factura                                             ----

                           rPreFact.RESET; rPreFact.INIT;
                           rPreFact.SETRANGE("Nß Factura", "Sales Header"."No.");
                           IF rPreFact.FIND('-') THEN
                             ;

                           // 10/04/08 AJF - Incluyo este cambio de 22/09/05 hecho en la factura detallada,
                           //para que coincida el funcionamiento.
                           // 22/09/05 incluyo esto por si no ha encontrado el contrato, lo pille de la prefactura
                           IF rCon."Nß Contrato"='' THEN BEGIN
                             rCon.RESET;
                             //rCon.SETRANGE(Garaje       , rPreFact.Garaje);
                             rCon.SETRANGE("Nß Contrato", rPreFact."Nß Contrato");
                             IF NOT rCon.FIND('-') THEN
                               CLEAR(rCon);
                           END;


                           IF rPreFact.Touroperador <> '' THEN
                             rTo.GET(rPreFact.Touroperador)
                           ELSE
                             rTo.INIT;

                           IF wImpMail THEN
                            NoCopias:=0;


                           // JPT 01/12/04 Buscamos las l°neas de IVA
                           cFunFact.GetIvaFactura("Sales Header",1,rTempIVABase   , rCon."Maletas incluidas")   ; // Iva Base
                           cFunFact.GetIvaFactura("Sales Header",2,rTempIVAMaletas, rCon."Maletas incluidas"); // Iva Maletas
                           wHayIVAmaletas := rTempIVAMaletas.FIND('-');
                         END;

        ReqFilterFields=No.,Sell-to Customer No.,No. Printed;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        NewPagePerRecord=Yes;
        DataItemVarName=BucleCopia;
        OnPreDataItem=BEGIN
                        //-$001NoBucles := ABS(NoCopias) + Clie."Invoice Copies" + 1;
                        NoBucles := ABS(NoCopias) + Clie."Invoice Copies"; //+$001
                        IF NoBucles <= 0 THEN
                          NoBucles := 1;
                        TextoCopia := '';
                        SETRANGE(Number,1,NoBucles);
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number > 1 THEN
                             TextoCopia := Text003;
                           CurrReport.PAGENO := 1;
                           w_total_impresion := 0; // JPT 11/06/06 Inicializamos el total parcial
                         END;

        OnPostDataItem=BEGIN
                         IF NOT CurrReport.PREVIEW THEN
                           ContarVtaImpresa.RUN("Sales Header");
                       END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=19740;
            SectionHeight=1269;
            KeepWithNext=No;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(wImpMail);
                         END;

          }
          CONTROLS
          {
            { 1100217002;Label  ;1260 ;846  ;16800;423  ;HorzAlign=Center;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=INSCRITA EN EL REGISTRO MERCANTIL DE EIVISSA - TOMO 277, LIBRO 216, FOLIO 203, SEC.3ß,HOJA 5330, INSCRIPCI‡N 1¶ - C.I.F. A 07051451 }
            { 1100217003;Label  ;8820 ;423  ;9240 ;423  ;HorzAlign=Left;
                                                         FontSize=7;
                                                         CaptionML=ESP=Crta. de San Antonio, Km. 2.5 Bß de Can Negre 07800 IBIZA }
            { 1100217004;Label  ;1260 ;423  ;7560 ;423  ;HorzAlign=Right;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=ESP="Domicilio social y administrativo: " }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=BuclePag;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19740;
            SectionHeight=3384;
            KeepWithNext=No;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(wImpMail);
                         END;

          }
          CONTROLS
          {
            { 1100217000;PictureBox;1260;0  ;18480;2961 ;SourceExpr=InfoEmpresa.Picture }
            { 1100217001;Shape  ;1260 ;2961 ;18480;423  ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19740;
            SectionHeight=3384;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(NOT wImpMail);
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19740;
            SectionHeight=3384;
          }
          CONTROLS
          {
            { 4   ;TextBox      ;11550;0    ;6300 ;423  ;FontSize=9;
                                                         SourceExpr=DirClie[1] }
            { 8   ;TextBox      ;11550;846  ;6300 ;423  ;FontSize=9;
                                                         SourceExpr=DirClie[3] }
            { 10  ;TextBox      ;11550;1269 ;6300 ;423  ;FontSize=9;
                                                         SourceExpr=DirClie[4] }
            { 12  ;TextBox      ;11550;1692 ;6300 ;423  ;FontSize=9;
                                                         SourceExpr=DirClie[5] }
            { 15  ;TextBox      ;11550;423  ;6300 ;423  ;FontSize=9;
                                                         SourceExpr=DirClie[2] }
            { 29  ;TextBox      ;11550;2115 ;2310 ;423  ;FontSize=9;
                                                         SourceExpr=TextoCIF }
            { 30  ;TextBox      ;14070;2115 ;3780 ;423  ;FontSize=9;
                                                         SourceExpr="Sales Header"."VAT Registration No." }
            { 1   ;TextBox      ;3360 ;423  ;4410 ;423  ;FontSize=9;
                                                         SourceExpr=FORMAT("Sales Header"."Posting Date",0,4) }
            { 35  ;TextBox      ;5880 ;1269 ;1680 ;423  ;FontSize=9;
                                                         SourceExpr=STRSUBSTNO(Text004,FORMAT(CurrReport.PAGENO)) }
            { 54  ;TextBox      ;3360 ;1269 ;2100 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr="Sales Header"."No." }
            { 112 ;Label        ;11550;2538 ;2310 ;423  ;FontSize=9;
                                                         LeaderDots=Yes;
                                                         CaptionML=ESP=Touroperador }
            { 113 ;TextBox      ;14070;2538 ;3780 ;423  ;FontSize=9;
                                                         SourceExpr=rTo.Nombre }
            { 2   ;TextBox      ;3360 ;2115 ;2100 ;423  ;FontSize=9;
                                                         SourceExpr=vServicio }
            { 1103350018;TextBox;3360 ;846  ;2100 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Sales Header"."Document Type" }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table37;
        DataItemTableView=SORTING(Document Type,Document No.,Line No.)
                          ORDER(Ascending);
        OnPreDataItem=BEGIN
                        LinImporIVA.DELETEALL;

                        MasLins := FIND('+');
                        WHILE MasLins AND (Description = '') AND ("No." = '') AND (Quantity = 0) AND (Amount = 0) DO
                          MasLins := NEXT(-1) <> 0;
                        IF NOT MasLins THEN
                          CurrReport.BREAK;
                        SETRANGE("Line No.",0,"Line No.");

                        _BuscaTipoServicio; //+$005

                        CurrReport.CREATETOTALS(Amount, "Amount Including VAT", "Inv. Discount Amount", "Pmt. Disc. Given Amount", w_importe_impresion);
                      END;

        OnAfterGetRecord=BEGIN
                           wPrimeraLinea := "Sales Line"."Nß Parte" <> wNoParte;
                           IF wPrimeraLinea THEN
                             wNoParte := "Sales Line"."Nß Parte";

                           IF ConfRegistroIVA.GET("Sales Line"."VAT Bus. Posting Group",
                                                  "Sales Line"."VAT Prod. Posting Group") THEN
                             IF ConfRegistroIVA."VAT+EC %" <> 0 THEN
                             BEGIN
                               LinImporIVA.INIT;
                               LinImporIVA."VAT %"             := ConfRegistroIVA."VAT %";
                               LinImporIVA."EC %"              := ConfRegistroIVA."EC %";
                               LinImporIVA."VAT+EC Base"       := "Sales Line".Amount;
                               LinImporIVA."Amount Including VAT+EC" := "Sales Line"."Amount Including VAT";

                               LinImporIVA.InsertLine;
                             END;

                           IF "Description 2" = Text005 THEN BEGIN
                             IF NOT rCon."Maletas incluidas" THEN BEGIN
                               w_base_maletas   := w_base_maletas + Amount;
                               w_iva_maletas    := "VAT %";
                               w_impiva_maletas := w_impiva_maletas + ("Amount Including VAT" - Amount);
                               w_total_maletas  := w_total_maletas + "Amount Including VAT";
                             END
                             ELSE BEGIN
                               w_base_maletas   := w_base_maletas + "Importe Impresion";
                               w_iva_maletas    := "VAT %";
                               w_impiva_maletas := w_impiva_maletas + ("Importe Impresion con" - "Importe Impresion");
                               w_total_maletas  := w_total_maletas + "Importe Impresion con";

                               w_base_normal   := w_base_normal - "Importe Impresion";
                               w_impiva_normal := w_impiva_normal - ("Importe Impresion con" - "Importe Impresion");
                               w_total_normal  := w_total_normal - "Importe Impresion con";
                             END;
                           END
                           ELSE BEGIN
                             IF "Description 2" = Text006 THEN
                               w_iva_normal    := "VAT %";
                             w_base_normal   := w_base_normal + Amount;
                             w_impiva_normal := w_impiva_normal + ("Amount Including VAT" - Amount);
                             w_total_normal  := w_total_normal + "Amount Including VAT";

                             // ---- En funcion de las condiciones de contrato se muestra el importe con el IVA ya ----
                             // ---- incluido o sin incluir                                                        ----

                             IF rCon."Impuestos incluidos" THEN
                               w_importe_impresion := "Amount Including VAT"
                             ELSE
                               w_importe_impresion := Amount;
                             w_total_impresion   := w_total_impresion + w_importe_impresion
                           END;

                           IF "Description 2" <> Text007 THEN BEGIN
                             w_primera_zona := TRUE;
                             w_pax_zona     := 0;
                             w_importe_zona := 0;
                           END
                           ELSE BEGIN
                             w_pax_zona     := w_pax_zona + Paxes;
                             IF rCon."Impuestos incluidos" THEN BEGIN
                               w_importe_zona   := w_importe_zona + "Importe Impresion con";
                               w_zona_impresion := "Importe Impresion con";
                             END
                             ELSE BEGIN
                               w_importe_zona   := w_importe_zona + "Importe Impresion";
                               w_zona_impresion := "Importe Impresion";
                             END;
                           END;

                           _GetDescripciones; //+$005

                           // AJF 09/06/08
                           // Desglosamos los ni§os en las l°neas de resumen por zona.
                           IF Plazas > 0 THEN
                             wDesgloseADNI := STRSUBSTNO('%1/%2',Plazas - "Ni§os Facturados" , "Ni§os Facturados")
                           ELSE
                             wDesgloseADNI :='';

                           // Creada variable auxiliar para controlar cuando hacer el total del resumen x zona
                           //
                           rLin.COPY("Sales Line");
                           IF rLin.NEXT = 0 THEN
                             rLin.INIT;
                         END;

        DataItemLinkReference=Sales Header;
        DataItemLink=Document Type=FIELD(Document Type),
                     Document No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=19740;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(rTipoServicio."Tipo fijo" = rTipoServicio."Tipo fijo"::Excursion); //+$005
                         END;

          }
          CONTROLS
          {
            { 1000000000;Label  ;1470 ;0    ;1260 ;846  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Fecha }
            { 1000000001;Label  ;2940 ;0    ;5040 ;846  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Servicio }
            { 1000000005;Label  ;8190 ;0    ;840  ;846  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Bus }
            { 1000000006;Label  ;9240 ;0    ;1680 ;846  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Parte }
            { 1000000007;Label  ;11130;0    ;4410 ;846  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Origen }
            { 1000000009;Label  ;15750;0    ;630  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Pax }
            { 1000000010;Label  ;16590;0    ;630  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=P. Fac }
            { 1000000011;Label  ;17430;0    ;2310 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Importe }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19740;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(rTipoServicio."Tipo fijo" = rTipoServicio."Tipo fijo"::Traslado); //+$005
                         END;

          }
          CONTROLS
          {
            { 47  ;Label        ;17430;0    ;2310 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Importe }
            { 9   ;Label        ;1470 ;0    ;1260 ;846  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Fecha }
            { 11  ;Label        ;2940 ;0    ;1260 ;846  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Servicio }
            { 17  ;Label        ;5670 ;0    ;1470 ;846  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Vuelo }
            { 20  ;Label        ;7350 ;0    ;630  ;846  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Letra }
            { 23  ;Label        ;8190 ;0    ;840  ;846  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Bus }
            { 26  ;Label        ;9240 ;0    ;1680 ;846  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Parte }
            { 31  ;Label        ;11130;0    ;2100 ;846  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Origen }
            { 32  ;Label        ;13440;0    ;2100 ;846  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Destino }
            { 39  ;Label        ;15750;0    ;630  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Pax }
            { 40  ;Label        ;16590;0    ;630  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=P. Fac }
            { 59  ;Label        ;4410 ;0    ;1050 ;846  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Hora }
          }
           }
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=19740;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 55  ;Label        ;13440;0    ;3570 ;423  ;ParentControl=56;
                                                         FontSize=9;
                                                         LeaderDots=Yes }
            { 56  ;TextBox      ;17430;0    ;2310 ;423  ;FontSize=9;
                                                         CaptionML=ESP=Suma;
                                                         SourceExpr=w_importe_impresion;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19740;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((Type = Type::"G/L Account") AND
                                                 ("Description 2" = Text006) AND
                                                 (rTipoServicio."Tipo fijo" = rTipoServicio."Tipo fijo"::Excursion)
                                                ); //+$005
                         END;

          }
          CONTROLS
          {
            { 1000000012;TextBox;17430;0    ;2310 ;423  ;FontSize=9;
                                                         BlankZero=Yes;
                                                         SourceExpr=w_importe_impresion;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 1000000013;TextBox;1470 ;0    ;1260 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr="Fecha servicio" }
            { 1000000014;TextBox;2940 ;0    ;5040 ;423  ;FontSize=9;
                                                         SourceExpr=DescriServicio }
            { 1000000017;TextBox;8190 ;0    ;840  ;423  ;FontSize=9;
                                                         SourceExpr=Bus }
            { 1000000018;TextBox;9240 ;0    ;1680 ;423  ;FontSize=9;
                                                         SourceExpr="Nß Parte" }
            { 1000000019;TextBox;11130;0    ;4410 ;423  ;FontSize=9;
                                                         SourceExpr=DescriDestino }
            { 1000000021;TextBox;15750;0    ;630  ;423  ;FontSize=9;
                                                         BlankZero=Yes;
                                                         SourceExpr=Paxes }
            { 1000000022;TextBox;16590;0    ;630  ;423  ;FontSize=9;
                                                         SourceExpr=Plazas }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19740;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((Type = Type::"G/L Account") AND
                                                 ("Description 2" = Text006) AND
                                                 (rTipoServicio."Tipo fijo" = rTipoServicio."Tipo fijo"::Traslado)
                                                ); //+$005
                         END;

          }
          CONTROLS
          {
            { 63  ;TextBox      ;17430;0    ;2310 ;423  ;FontSize=9;
                                                         BlankZero=Yes;
                                                         SourceExpr=w_importe_impresion;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 5   ;TextBox      ;1470 ;0    ;1260 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr="Fecha servicio" }
            { 14  ;TextBox      ;2940 ;0    ;1260 ;423  ;FontSize=9;
                                                         SourceExpr=Servicio }
            { 18  ;TextBox      ;5670 ;0    ;1470 ;423  ;FontSize=9;
                                                         SourceExpr=Vuelo }
            { 21  ;TextBox      ;7350 ;0    ;630  ;423  ;FontSize=9;
                                                         SourceExpr=Letra }
            { 24  ;TextBox      ;8190 ;0    ;840  ;423  ;FontSize=9;
                                                         SourceExpr=Bus }
            { 27  ;TextBox      ;9240 ;0    ;1680 ;423  ;FontSize=9;
                                                         SourceExpr="Nß Parte" }
            { 33  ;TextBox      ;11130;0    ;2100 ;423  ;FontSize=9;
                                                         SourceExpr=Origen }
            { 37  ;TextBox      ;13440;0    ;2100 ;423  ;FontSize=9;
                                                         SourceExpr=Destino }
            { 41  ;TextBox      ;15750;0    ;630  ;423  ;FontSize=9;
                                                         BlankZero=Yes;
                                                         SourceExpr=Paxes }
            { 43  ;TextBox      ;16590;0    ;630  ;423  ;FontSize=9;
                                                         SourceExpr=Plazas }
            { 60  ;TextBox      ;4410 ;0    ;1050 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         CaptionML=ESP=Hora;
                                                         SourceExpr=Hora;
                                                         Format=<Hours24,2>:<Minutes,2> }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19740;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((Type = Type::"G/L Account") AND ("Description 2" = Text008));
                         END;

          }
          CONTROLS
          {
            { 50  ;TextBox      ;13440;0    ;2100 ;423  ;FontSize=9;
                                                         SourceExpr=Destino }
            { 53  ;TextBox      ;15750;0    ;630  ;423  ;FontSize=9;
                                                         BlankZero=Yes;
                                                         SourceExpr=Paxes }
            { 57  ;TextBox      ;16590;0    ;630  ;423  ;FontSize=9;
                                                         SourceExpr=Plazas }
            { 58  ;TextBox      ;17430;0    ;2310 ;423  ;FontSize=9;
                                                         BlankZero=Yes;
                                                         SourceExpr=w_importe_impresion;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 6   ;TextBox      ;11130;0    ;2100 ;423  ;FontSize=9;
                                                         SourceExpr=Origen }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19740;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((ReferenciaLinea <> '') AND ("Description 2" = Text006)); //+$005
                         END;

          }
          CONTROLS
          {
            { 1000000024;TextBox;1470 ;0    ;6510 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr=ReferenciaLinea }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19740;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((("Description 2" = Text009) OR ("Description 2" = Text010)) AND (NOT wPrimeraLinea)) ;
                         END;

          }
          CONTROLS
          {
            { 95  ;TextBox      ;13440;0    ;3780 ;423  ;FontSize=9;
                                                         SourceExpr=Description }
            { 109 ;TextBox      ;17430;0    ;2310 ;423  ;FontSize=9;
                                                         BlankZero=Yes;
                                                         SourceExpr=w_importe_impresion;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19740;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((("Description 2" = Text009) OR ("Description 2" = Text010)) AND  wPrimeraLinea) ;
                         END;

          }
          CONTROLS
          {
            { 3   ;TextBox      ;13440;0    ;3780 ;423  ;FontSize=9;
                                                         SourceExpr=Description }
            { 19  ;TextBox      ;17430;0    ;2310 ;423  ;FontSize=9;
                                                         BlankZero=Yes;
                                                         SourceExpr=w_importe_impresion;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 22  ;TextBox      ;9240 ;0    ;1680 ;423  ;FontSize=9;
                                                         SourceExpr="Nß Parte" }
            { 36  ;TextBox      ;8190 ;0    ;840  ;423  ;FontSize=9;
                                                         SourceExpr=Bus }
            { 52  ;TextBox      ;2940 ;0    ;1260 ;423  ;FontSize=9;
                                                         SourceExpr=Servicio }
            { 67  ;TextBox      ;1470 ;0    ;1260 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr="Fecha servicio" }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19740;
            SectionHeight=1269;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(("Description 2" = Text007) AND (w_primera_zona));
                         END;

          }
          CONTROLS
          {
            { 64  ;Label        ;3990 ;0    ;2730 ;423  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=ESP=Resumen }
            { 65  ;Label        ;7140 ;0    ;2610 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Zona }
            { 66  ;Label        ;9900 ;0    ;750  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Pax }
            { 75  ;Label        ;10800;0    ;1260 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Plazas }
            { 76  ;Label        ;12180;0    ;1800 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Precio }
            { 77  ;Label        ;14130;0    ;1800 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Importe }
            { 78  ;TextBox      ;9900 ;846  ;750  ;423  ;FontSize=8;
                                                         DecimalPlaces=0:2;
                                                         BlankZero=Yes;
                                                         SourceExpr=Paxes }
            { 79  ;TextBox      ;10800;846  ;1260 ;423  ;FontSize=8;
                                                         DecimalPlaces=0:2;
                                                         BlankZero=Yes;
                                                         SourceExpr=wDesgloseADNI }
            { 80  ;TextBox      ;14130;846  ;1800 ;423  ;FontSize=8;
                                                         SourceExpr=w_zona_impresion;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 81  ;TextBox      ;7140 ;846  ;2610 ;423  ;FontSize=8;
                                                         SourceExpr=Zona }
            { 82  ;TextBox      ;12180;846  ;1800 ;423  ;FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr="Precio Impresion" }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19740;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(("Description 2" = Text007) AND (NOT w_primera_zona));
                           IF "Description 2" = Text007 THEN
                             w_primera_zona := FALSE;
                         END;

          }
          CONTROLS
          {
            { 7   ;TextBox      ;7140 ;0    ;2640 ;423  ;FontSize=8;
                                                         SourceExpr=Zona }
            { 83  ;TextBox      ;9930 ;0    ;750  ;423  ;FontSize=8;
                                                         DecimalPlaces=0:2;
                                                         BlankZero=Yes;
                                                         SourceExpr=Paxes }
            { 84  ;TextBox      ;10830;0    ;1260 ;423  ;FontSize=8;
                                                         DecimalPlaces=0:2;
                                                         BlankZero=Yes;
                                                         SourceExpr=wDesgloseADNI }
            { 87  ;TextBox      ;12180;0    ;1800 ;423  ;FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr="Precio Impresion" }
            { 88  ;TextBox      ;14130;0    ;1800 ;423  ;FontSize=8;
                                                         SourceExpr=w_zona_impresion;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19740;
            SectionHeight=1269;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(("Description 2" = Text007) AND
                                                 (rLin."Description 2" <> Text007));
                         END;

          }
          CONTROLS
          {
            { 89  ;Label        ;7140 ;423  ;2610 ;423  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=ESP=Total Resumen }
            { 91  ;TextBox      ;9900 ;423  ;750  ;423  ;FontSize=8;
                                                         DecimalPlaces=0:2;
                                                         SourceExpr=w_pax_zona }
            { 93  ;TextBox      ;14070;423  ;1890 ;423  ;FontSize=8;
                                                         SourceExpr=w_importe_zona;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 96  ;Shape        ;9888 ;0    ;6090 ;423  ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19740;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 85  ;Label        ;13650;423  ;3570 ;423  ;ParentControl=86;
                                                         FontSize=9;
                                                         LeaderDots=Yes }
            { 86  ;TextBox      ;17430;423  ;2310 ;423  ;FontSize=9;
                                                         CaptionML=ESP=Suma;
                                                         SourceExpr=w_importe_impresion;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19740;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 62  ;Label        ;14490;423  ;2700 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=ESP=Totales }
            { 61  ;TextBox      ;17430;423  ;2310 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=w_importe_impresion;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=Lineas Iva;
        OnPreDataItem=BEGIN
                        CurrReport.CREATETOTALS(LinImporIVA."VAT+EC Base",LinImporIVA."VAT Amount",LinImporIVA."EC Amount",
                                                LinImporIVA."Amount Including VAT+EC", LinImporIVA."Line Amount", LinImporIVA."Invoice Discount Amount");

                        rTempIVABase.RESET;
                        rTempIVAMaletas.RESET;

                        CLEAR(wClaseIVA);
                        IF rTempIVABase.FIND('-') THEN
                          wClaseIVA := wClaseIVA::Base
                        ELSE
                          IF rTempIVAMaletas.FIND('-') THEN
                            wClaseIVA := wClaseIVA::Maletas;
                      END;

        OnAfterGetRecord=BEGIN
                           IF wClaseIVA=0 THEN
                             CurrReport.BREAK;

                           IF wHayIVAmaletas THEN
                             wTexto := FORMAT(wClaseIVA);

                           // AJF 09/04/08
                           wDescuento := 0;

                           CASE wClaseIVA OF
                             wClaseIVA::Base : BEGIN
                               // AJF 09/04/08
                               wDescuento := "Sales Header"."Invoice Discount Value";
                               LinImporIVA := rTempIVABase;
                               IF rTempIVABase.NEXT=0 THEN BEGIN
                                 IF rTempIVAMaletas.FIND('-') THEN
                                   wClaseIVA := wClaseIVA::Maletas
                                 ELSE
                                   wClaseIVA := 0;
                               END;
                             END;
                             wClaseIVA::Maletas: BEGIN
                               // AJF 09/04/08
                               IF rCon."Descuento sobre maletas" THEN
                                 wDescuento := "Sales Header"."Invoice Discount Value";
                               LinImporIVA := rTempIVAMaletas;
                               IF rTempIVAMaletas.NEXT=0 THEN
                                 wClaseIVA := 0;
                             END;
                           END;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=19740;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 1103355014;Label  ;6090 ;846  ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=Base }
            { 1103355015;Label  ;8400 ;846  ;1050 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=% DTO }
            { 1103355016;Label  ;9660 ;846  ;1890 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=Descuento }
            { 1103355017;Shape  ;6090 ;1269 ;13650;423  ;ShapeStyle=HorzLine }
            { 1103355018;Label  ;11760;846  ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=Base Neta }
            { 1103355019;Label  ;14070;846  ;1050 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=% IVA }
            { 1103355020;Label  ;15330;846  ;1890 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=Importe IVA }
            { 1103355021;Label  ;17430;846  ;2310 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=Total }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19740;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1103350005;TextBox;6090 ;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=No;
                                                         BlankZero=Yes;
                                                         SourceExpr=LinImporIVA."VAT+EC Base";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 1103350006;TextBox;14070;0    ;1050 ;423  ;FontSize=9;
                                                         BlankZero=Yes;
                                                         SourceExpr=LinImporIVA."VAT %" }
            { 1103350007;TextBox;15330;0    ;1890 ;423  ;FontSize=9;
                                                         BlankZero=Yes;
                                                         SourceExpr=LinImporIVA."VAT Amount" + LinImporIVA."EC Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 1103350008;TextBox;17430;0    ;2310 ;423  ;FontSize=9;
                                                         FontBold=No;
                                                         BlankZero=Yes;
                                                         SourceExpr=LinImporIVA."Amount Including VAT+EC";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 1103350009;TextBox;3570 ;0    ;2310 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         SourceExpr=wTexto }
            { 1103355022;TextBox;8400 ;0    ;1050 ;423  ;FontSize=9;
                                                         DecimalPlaces=2:2;
                                                         BlankZero=Yes;
                                                         SourceExpr=wDescuento }
            { 1103355023;TextBox;9660 ;0    ;1890 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=No;
                                                         DecimalPlaces=0:2;
                                                         BlankZero=Yes;
                                                         SourceExpr=LinImporIVA."Invoice Discount Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 1103355028;TextBox;11760;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=No;
                                                         BlankZero=Yes;
                                                         SourceExpr=LinImporIVA."VAT+EC Base" + LinImporIVA."Invoice Discount Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19740;
            SectionHeight=846;
            OnPreSection=BEGIN
                           IF "Sales Header"."Currency Code" = '' THEN BEGIN
                             w_importe_divisa := 0;
                             w_texto_divisa   := '';
                           END
                           ELSE BEGIN
                             w_importe_divisa :=
                               ROUND(
                                 TipoCambDivisa.ExchangeAmtFCYToLCY("Sales Header"."Posting Date",
                                 "Sales Header"."Currency Code", LinImporIVA."Amount Including VAT+EC",
                                 "Sales Header"."Currency Factor"), ConfCG."Amount Rounding Precision");
                             w_texto_divisa   := ConfCG."LCY Code";
                           END;
                         END;

          }
          CONTROLS
          {
            { 1103350010;TextBox;6090 ;423  ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=LinImporIVA."VAT+EC Base";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 1103350011;TextBox;15330;423  ;1890 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=LinImporIVA."VAT Amount" + LinImporIVA."EC Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 1103350012;TextBox;17430;423  ;2310 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=LinImporIVA."Amount Including VAT+EC";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 1103350013;TextBox;3780 ;423  ;2100 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=w_importe_divisa;
                                                         AutoFormatType=1 }
            { 1103350014;TextBox;1470 ;423  ;2100 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=w_texto_divisa }
            { 1103350015;Shape  ;17430;423  ;2310 ;423   }
            { 1103355026;TextBox;9660 ;423  ;1890 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=LinImporIVA."Invoice Discount Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 1103355027;TextBox;11760;423  ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=LinImporIVA."VAT+EC Base" + LinImporIVA."Invoice Discount Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=5060;
      Height=440;
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1   ;TextBox      ;3410 ;0    ;1650 ;440  ;CaptionML=ESP=Nß copias;
                                                   SourceExpr=NoCopias }
      { 21  ;Label        ;0    ;0    ;3300 ;440  ;ParentControl=1 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text000@1100244053 : TextConst 'ESP=Vendedor';
      Text001@1100244054 : TextConst 'ESP=Total %1';
      Text002@1100244055 : TextConst 'ESP=Total %1 incl. IVA';
      Text003@1100244056 : TextConst 'ESP=COPIA';
      Text004@1100244057 : TextConst 'ESP=P†g. %1';
      Text005@1100244058 : TextConst 'ESP=MALETAS';
      Text006@1100244059 : TextConst 'ESP=LINEA BASE';
      Text007@1100244060 : TextConst 'ESP=RESUMEN ZONA';
      Text008@1100244061 : TextConst 'ESP=LINEA ZONA';
      Text009@1100244062 : TextConst 'ESP=SUPLEMENTO';
      Text010@1100244063 : TextConst 'ESP=EXTRA';
      Text011@1100244064 : TextConst 'ESP=Maletas';
      rPreFact@1100244000 : Record 7010415;
      rTo@1100244001 : Record 7010312;
      rCon@1100244002 : Record 7010403;
      ConfCG@1100244003 : Record 98;
      CondEnv@1100244004 : Record 10;
      TerminosPago@1100244005 : Record 3;
      FormaPago@1100244006 : Record 289;
      RepreVtasComp@1100244007 : Record 13;
      InfoEmpresa@1100244008 : Record 79;
      Clie@1100244009 : Record 18;
      LinImporIVA@1100244010 : TEMPORARY Record 290;
      ConfRegistroIVA@1100244011 : Record 325;
      rLin@1100244012 : Record 37;
      rDiv@1100244013 : Record 4;
      TipoCambDivisa@1100244014 : Record 330;
      rTempIVABase@1103350001 : TEMPORARY Record 290;
      rTempIVAMaletas@1103350000 : TEMPORARY Record 290;
      rTipoServicio@1000000000 : Record 7010319;
      ContarVtaImpresa@1100244015 : Codeunit 313;
      FormatDire@1100244016 : Codeunit 365;
      cCalcR@1100253000 : Codeunit 7010407;
      cFunFact@1103350002 : Codeunit 7010321;
      DirClie@1100244018 : ARRAY [8] OF Text[50];
      EnvADir@1100244019 : ARRAY [8] OF Text[50];
      DirEmpresa@1100244020 : ARRAY [8] OF Text[50];
      TextNoPedido@1100244021 : Text[30];
      DescriVendedor@1100244022 : Text[30];
      TextoCIF@1100244023 : Text[30];
      DescriRefer@1100244024 : Text[30];
      TotalTexto@1100244025 : Text[50];
      TextoTotIVAIncl@1100244026 : Text[50];
      wTexto@1103350003 : Text[150];
      MasLins@1100244027 : Boolean;
      NoCopias@1100244028 : Integer;
      NoBucles@1100244029 : Integer;
      TextoCopia@1100244030 : Text[30];
      MostrarDireEnvio@1100244031 : Boolean;
      i@1100244032 : Integer;
      w_base_normal@1100244033 : Decimal;
      w_iva_normal@1100244034 : Decimal;
      w_impiva_normal@1100244035 : Decimal;
      w_total_normal@1100244036 : Decimal;
      w_base_maletas@1100244037 : Decimal;
      w_iva_maletas@1100244038 : Decimal;
      w_impiva_maletas@1100244039 : Decimal;
      w_total_maletas@1100244040 : Decimal;
      w_pax_zona@1100244041 : Decimal;
      w_importe_zona@1100244042 : Decimal;
      w_importe_impresion@1100244043 : Decimal;
      w_total_impresion@1100244044 : Decimal;
      w_zona_impresion@1100244045 : Decimal;
      w_importe_divisa@1100244046 : Decimal;
      w_texto_divisa@1100244047 : Code[10];
      w_texto_maletas@1100244048 : Code[10];
      w_primera_zona@1100244049 : Boolean;
      vServicio@1100244050 : Code[10];
      wNoParte@1100244051 : Code[10];
      wPrimeraLinea@1100244052 : Boolean;
      wClaseIVA@1103350005 : ',Base,Maletas';
      wHayIVAmaletas@1103350004 : Boolean;
      wImpMail@1103355000 : Boolean;
      wDescuento@1103355001 : Decimal;
      wDesgloseADNI@1103355002 : Text[30];
      Text012@1000000001 : TextConst 'ESP=REGRESO';
      DescriServicio@1000000002 : Text[100];
      DescriDestino@1000000003 : Text[100];
      ReferenciaLinea@1000000004 : Code[30];

    LOCAL PROCEDURE _BuscaTipoServicio@1000000003();
    VAR
      lrSalesLine@1000000000 : Record 37;
      lrParte@1000000003 : Record 7010360;
    BEGIN
      // _BuscaTipoServicio

      lrSalesLine.COPYFILTERS("Sales Line");
      lrSalesLine.SETFILTER("Nß Parte", '<>%1', '');
      IF lrSalesLine.FIND('-') THEN
      BEGIN
        lrParte.GET(lrSalesLine."Nß Parte");

        rTipoServicio.GET(lrParte."Tipo Servicio");
      END;
    END;

    LOCAL PROCEDURE _GetDescripciones@1000000006();
    VAR
      lrParte@1000000000 : Record 7010360;
      lrCodigoServicio@1000000001 : Record 7010320;
      lrPunto@1000000002 : Record 7010315;
      lrParte2@1000000003 : Record 7010360;
    BEGIN
      // _GetDescripciones

      DescriServicio := '';
      DescriDestino   := '';
      ReferenciaLinea := '';

      IF NOT lrParte.GET(wNoParte) THEN
        EXIT;

      ReferenciaLinea := lrParte.Referencia;

      IF NOT lrCodigoServicio.GET("Sales Line".Servicio) THEN
        EXIT;

      IF lrParte."Origen creacion" = lrParte."Origen creacion"::"Recogida Automatica" THEN BEGIN
        DescriServicio := Text011;
        lrParte2.RESET;
        lrParte2.SETRANGE(lrParte2."Recogida Generada",lrParte."Nß Parte");
        IF lrParte2.FIND('-') THEN BEGIN
          IF lrCodigoServicio.GET(lrParte2."Codigo Servicio") THEN
            DescriServicio := DescriServicio + ' ' + lrCodigoServicio.Descripcion;
        END;
      END ELSE
        DescriServicio := lrCodigoServicio.Descripcion;

      DescriDestino := "Sales Line".Destino;
      IF lrPunto.GET("Sales Line".Destino) AND
         (lrParte."Origen creacion" <> lrParte."Origen creacion"::"Recogida Automatica") THEN
        DescriDestino := lrPunto.Descripci¢n;
    END;

    BEGIN
    {
      JPT 31/07/09 Cambio clave de lineas SORTING(Document Type,Document No.,Fecha servicio,Servicio,Hora)  a
                                          SORTING(Document Type,Document No.,Line No.)

      $001 AJS 25022014 Ibizatours ha pedido que se dejen de imprimir dos copias

      $002 AJS 27022014 Nuevo formato para Autocares SERRA

      $003 AJS 28052014 Modifico el caption del report

      $005 AJS 24072014 Vamos a crear un formato distinto si estamos facturado excursiones o traslados

      $006 AJS 22102014 Amplio la variable ReferenciaLinea a Code30
    }
    END.
  }
  RDLDATA
  {
  }
}
