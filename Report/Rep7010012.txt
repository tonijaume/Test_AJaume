OBJECT Report 7010012 Test - Factura estandar venta
{
  OBJECT-PROPERTIES
  {
    Date=02/10/12;
    Time=12:00:00;
    Modified=Yes;
    Version List=AIC2009,GOC;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Test - sale standard invoice;
               ESP=Test - Factura estandar venta];
    OnInitReport=BEGIN
                   ConfCG.GET;
                 END;

    HorzGrid=210;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table36;
        DataItemTableView=SORTING(Document Type,No.);
        NewPagePerRecord=Yes;
        ReqFilterHeadingML=[ENU=Sale invoices log;
                            ESP=Hist¢rico facturas venta];
        OnPreDataItem=BEGIN
                        InfoEmpresa.GET;
                        FormatDire.Company(DirEmpresa,InfoEmpresa);
                        IF NOT rPar.FIND('-') THEN
                          ERROR(Text000);
                      END;

        OnAfterGetRecord=VAR
                           TextoTemporal@1103355000 : Text[30];
                         BEGIN
                           IF "Salesperson Code" = '' THEN BEGIN
                             RepreVtasComp.INIT;
                             DescriVendedor := '';
                           END ELSE BEGIN
                             RepreVtasComp.GET("Salesperson Code");
                             DescriVendedor := Text001;
                           END;
                           IF "Your Reference" = '' THEN
                             DescriRefer := ''
                           ELSE
                             DescriRefer := FIELDCAPTION("Your Reference");
                           IF "VAT Registration No." = '' THEN
                             TextoCIF := ''
                           ELSE
                             TextoCIF := FIELDCAPTION("VAT Registration No.");
                           IF rPar."Texto impuesto en Factura" = '' THEN
                             TextoTemporal := Text002
                           ELSE
                             TextoTemporal := rPar."Texto impuesto en Factura";
                           IF "Currency Code" = '' THEN BEGIN
                             ConfCG.TESTFIELD("LCY Code");
                             TotalTexto      := STRSUBSTNO(Text003, ConfCG."LCY Code");
                             TextoTotIVAIncl := STRSUBSTNO(Text004, ConfCG."LCY Code",
                                                           TextoTemporal);
                           END ELSE BEGIN
                             TotalTexto      := STRSUBSTNO(Text003, "Currency Code");
                             TextoTotIVAIncl := STRSUBSTNO(Text004, "Currency Code", TextoTemporal);
                           END;
                           FormatDire.SalesHeaderSellTo(DirClie, "Sales Header");
                           Clie.GET("Bill-to Customer No.");

                           IF "Payment Terms Code" = '' THEN
                             TerminosPago.INIT
                           ELSE
                             TerminosPago.GET("Payment Terms Code");
                           IF "Payment Method Code" = '' THEN
                             FormaPago.INIT
                           ELSE
                             FormaPago.GET("Payment Method Code");
                           IF "Shipment Method Code" = '' THEN
                             CondEnv.INIT
                           ELSE
                             CondEnv.GET("Shipment Method Code");

                           FormatDire.SalesHeaderShipTo(EnvADir, "Sales Header");
                           MostrarDireEnvio := "Sell-to Customer No." <> "Bill-to Customer No.";
                           FOR i := 1 TO ARRAYLEN(EnvADir) DO
                             IF EnvADir[i] <> DirClie[i] THEN
                               MostrarDireEnvio := TRUE;

                           TextoImpuesto    := Text005 + TextoTemporal;
                           TextoBase        := Text006 + TextoTemporal;
                           TextoPorcen      := '% ' + TextoTemporal;
                           TextoEspecificar := Text007 + TextoTemporal;

                           // AJS 23.11.2005
                           // Mostrar el logo en el lay-out del informe

                           InfoEmpresa.CALCFIELDS(Picture);

                           // AJS 23.02.2007
                           // Mostrar la descripcion del grupo de NCF de la factura

                           IF NOT rCodNCF.GET(rCodNCF."Tipo grupo"::Ventas, "Sales Header"."Cod. Grupo NCF") THEN
                             CLEAR(rCodNCF);

                           //$001

                           IF rBank.GET(Clie."Default Bank Acc. Code") THEN
                             MontarDatosBanco;

                           // $003
                           CLEAR(wDescrpNCF);
                           CASE "Document Type" OF
                             "Document Type"::Invoice:       wDescrpNCF := rCodNCF."Descripcion Factura";
                             "Document Type"::"Credit Memo": wDescrpNCF := rCodNCF."Descripcion Abonos";
                           END;
                         END;

        ReqFilterFields=No.,Sell-to Customer No.,No. Printed;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        NewPagePerRecord=Yes;
        DataItemVarName=BucleCopia;
        OnPreDataItem=BEGIN
                        NoBucles := ABS(NoCopias) + Clie."Invoice Copies" + 1;
                        IF NoBucles <= 0 THEN
                          NoBucles := 1;
                        TextoCopia := '';
                        SETRANGE(Number,1,NoBucles);
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number > 1 THEN
                             TextoCopia := Text008;
                           CurrReport.PAGENO := 1;
                         END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=BuclePag;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19110;
            SectionHeight=9306;
          }
          CONTROLS
          {
            { 4   ;TextBox      ;0    ;3807 ;7560 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=DirClie[1] }
            { 6   ;TextBox      ;0    ;4230 ;7560 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=DirClie[2] }
            { 8   ;TextBox      ;0    ;4653 ;7560 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=DirClie[3] }
            { 10  ;TextBox      ;0    ;5076 ;7560 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=DirClie[4] }
            { 12  ;TextBox      ;0    ;5922 ;7560 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=DirClie[5] }
            { 15  ;TextBox      ;0    ;6345 ;7560 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=DirClie[6] }
            { 28  ;TextBox      ;13230;4230 ;4410 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr="Sales Header"."Posting Date" }
            { 29  ;TextBox      ;0    ;5499 ;2310 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=TextoCIF }
            { 30  ;TextBox      ;2520 ;5499 ;5040 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr="Sales Header"."VAT Registration No." }
            { 33  ;TextBox      ;0    ;8037 ;3150 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=DescriVendedor }
            { 34  ;TextBox      ;3360 ;8037 ;6300 ;423  ;FontSize=10;
                                                         SourceExpr=RepreVtasComp.Name }
            { 35  ;Label        ;10290;3807 ;2730 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Invoice No.;
                                                                    ESP=N§ Factura] }
            { 36  ;TextBox      ;13230;3807 ;4410 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr="Sales Header"."No." }
            { 37  ;TextBox      ;0    ;8460 ;3150 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=DescriRefer }
            { 38  ;TextBox      ;3360 ;8460 ;6300 ;423  ;FontSize=10;
                                                         SourceExpr="Sales Header"."Your Reference" }
            { 3   ;TextBox      ;0    ;6768 ;7560 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=DirClie[7] }
            { 48  ;TextBox      ;0    ;7191 ;7560 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=DirClie[8] }
            { 53  ;Label        ;10290;4230 ;2730 ;423  ;ParentControl=28;
                                                         FontSize=9;
                                                         FontBold=Yes }
            { 54  ;TextBox      ;13230;4653 ;4410 ;423  ;FontSize=9;
                                                         SourceExpr=FORMAT("Sales Header"."Document Date",0,4) }
            { 1   ;Label        ;10290;4653 ;2730 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Date of issue;
                                                                    ESP=Fecha Emision] }
            { 16  ;PictureBox   ;0    ;0    ;8820 ;2538 ;SourceExpr=InfoEmpresa.Picture }
            { 17  ;TextBox      ;5670 ;2538 ;2520 ;423  ;FontSize=9;
                                                         CaptionML=[ENU=VAT Registration No.;
                                                                    ESP=CIF/NIF];
                                                         SourceExpr=InfoEmpresa."VAT Registration No." }
            { 18  ;Label        ;4620 ;2538 ;1050 ;423  ;ParentControl=17;
                                                         FontSize=9;
                                                         CaptionML=[ENU=RNC;
                                                                    ESP=RNC.] }
            { 19  ;TextBox      ;16380;2961 ;2730 ;423  ;FontSize=9;
                                                         CaptionML=[ENU=No. Fax;
                                                                    ESP=N§ fax];
                                                         SourceExpr=InfoEmpresa."Fax No." }
            { 20  ;Label        ;15540;2961 ;840  ;423  ;ParentControl=19;
                                                         FontSize=9;
                                                         CaptionML=[ENU=Fax.;
                                                                    ESP=Fax.] }
            { 21  ;TextBox      ;12600;2961 ;2730 ;423  ;FontSize=9;
                                                         CaptionML=[ENU=Phone No.;
                                                                    ESP=N§ telfono];
                                                         SourceExpr=InfoEmpresa."Phone No." }
            { 22  ;Label        ;11970;2961 ;630  ;423  ;ParentControl=21;
                                                         FontSize=9;
                                                         CaptionML=[ENU=Phone;
                                                                    ESP=Tel.] }
            { 23  ;TextBox      ;0    ;2961 ;10290;423  ;FontSize=9;
                                                         SourceExpr=DirEmpresa[3]+' '+DirEmpresa[4]+' '+DirEmpresa[5] }
            { 24  ;Shape        ;0    ;3384 ;19110;423  ;ShapeStyle=HorzLine }
            { 1103355000;Label  ;10290;5499 ;2730 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=NCF;
                                                                    ESP=NCF] }
            { 1103355001;TextBox;13230;5499 ;5670 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr="Sales Header"."Comprobante Fiscal" }
            { 1103355002;TextBox;10290;6345 ;8610 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr=wDescrpNCF }
            { 1100253005;Label  ;0    ;2538 ;4620 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Go Caribic, S.R.L.;
                                                                    ESP=Go Caribic, S.R.L.] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table37;
        DataItemTableView=SORTING(Document Type,Document No.,Line No.);
        OnPreDataItem=BEGIN
                        LinImporIVA.DELETEALL;
                        MasLins := FIND('+');
                        WHILE MasLins AND (Description = '') AND ("No." = '') AND (Quantity = 0) AND (Amount = 0) DO
                          MasLins := NEXT(-1) <> 0;
                        IF NOT MasLins THEN
                          CurrReport.BREAK;
                        SETRANGE("Line No.",0,"Line No.");
                        CurrReport.CREATETOTALS(Amount,"Amount Including VAT","Inv. Discount Amount","Pmt. Disc. Given Amount");
                      END;

        OnAfterGetRecord=BEGIN
                           IF (Amount = 0) OR ("Amount Including VAT" = 0) THEN
                           BEGIN
                             IF "Sales Header"."Prices Including VAT" THEN BEGIN
                               "Amount Including VAT" := "Line Amount";
                               Amount                 := ROUND("Line Amount" / (1 + (("VAT %" + "EC %") / 100) ) );
                             END
                             ELSE BEGIN
                               Amount                 := "Line Amount";
                               "Amount Including VAT" := ROUND("Line Amount" * (1 + (("VAT %" + "EC %") / 100) ) );
                             END;
                             MODIFY;
                           END;

                           IF ConfRegistroIVA.GET("VAT Bus. Posting Group", "VAT Prod. Posting Group") THEN
                             IF ConfRegistroIVA."VAT+EC %" <> 0 THEN BEGIN
                               LinImporIVA.INIT;
                               LinImporIVA."VAT %" := ConfRegistroIVA."VAT %";
                               LinImporIVA."EC %" := ConfRegistroIVA."EC %";
                               LinImporIVA."VAT Identifier" := "VAT Identifier";
                               LinImporIVA."VAT Calculation Type" := "VAT Calculation Type";
                               LinImporIVA."Tax Group Code" := "Tax Group Code";
                               LinImporIVA."VAT+EC Base" := "Sales Line".Amount;
                               LinImporIVA."Amount Including VAT+EC" := "Sales Line"."Amount Including VAT";
                               LinImporIVA."Line Amount" := "Line Amount";
                               LinImporIVA."Pmt. Disc. Given Amount" := "Pmt. Disc. Given Amount";
                               IF "Allow Invoice Disc." THEN
                                 LinImporIVA."Inv. Disc. Base Amount" := "Line Amount";
                               LinImporIVA."Invoice Discount Amount" := "Inv. Discount Amount";
                               LinImporIVA.SetCurrencyCode("Sales Header"."Currency Code");
                               LinImporIVA."VAT Difference" := "VAT Difference";
                               LinImporIVA."EC Difference" := "EC Difference";
                               IF "Sales Header"."Prices Including VAT" THEN
                                 LinImporIVA."Prices Including VAT" := TRUE;

                               LinImporIVA.InsertLine;
                             END;
                         END;

        DataItemLinkReference=Sales Header;
        DataItemLink=Document Type=FIELD(Document Type),
                     Document No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19110;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 42  ;Label        ;0    ;0    ;10920;846  ;ParentControl=65;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 43  ;Label        ;11130;0    ;1470 ;846  ;ParentControl=66;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 45  ;Label        ;12810;0    ;2520 ;846  ;ParentControl=68;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 47  ;Label        ;15540;0    ;2520 ;846  ;ParentControl=70;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=19110;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 55  ;Label        ;11130;0    ;4200 ;423  ;ParentControl=56;
                                                         FontSize=9;
                                                         LeaderDots=Yes }
            { 56  ;TextBox      ;15540;0    ;2520 ;423  ;FontSize=9;
                                                         CaptionML=[ENU=Sum;
                                                                    ESP=Suma];
                                                         SourceExpr=Amount+"Inv. Discount Amount"+"Pmt. Disc. Given Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19110;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(Type = 0);
                         END;

          }
          CONTROLS
          {
            { 57  ;TextBox      ;0    ;0    ;10920;423  ;FontSize=9;
                                                         SourceExpr=Description }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19110;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(Type = Type::"G/L Account");
                         END;

          }
          CONTROLS
          {
            { 58  ;TextBox      ;0    ;0    ;10920;423  ;FontSize=9;
                                                         SourceExpr=Description }
            { 59  ;TextBox      ;11130;0    ;1470 ;423  ;FontSize=9;
                                                         BlankZero=Yes;
                                                         SourceExpr=Quantity }
            { 61  ;TextBox      ;12810;0    ;2520 ;423  ;FontSize=9;
                                                         BlankZero=Yes;
                                                         SourceExpr="Unit Price";
                                                         AutoFormatType=2;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
            { 63  ;TextBox      ;15540;0    ;2520 ;423  ;FontSize=9;
                                                         BlankZero=Yes;
                                                         SourceExpr=Amount+"Inv. Discount Amount"+"Pmt. Disc. Given Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19110;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(Type = Type::Item);
                         END;

          }
          CONTROLS
          {
            { 65  ;TextBox      ;0    ;0    ;10920;423  ;FontSize=9;
                                                         SourceExpr=Description }
            { 66  ;TextBox      ;11130;0    ;1470 ;423  ;FontSize=9;
                                                         BlankZero=Yes;
                                                         SourceExpr=Quantity }
            { 68  ;TextBox      ;12810;0    ;2520 ;423  ;FontSize=9;
                                                         BlankZero=Yes;
                                                         SourceExpr="Unit Price";
                                                         AutoFormatType=2;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
            { 70  ;TextBox      ;15540;0    ;2520 ;423  ;FontSize=9;
                                                         CaptionML=[ENU=Amount;
                                                                    ESP=Importe];
                                                         BlankZero=Yes;
                                                         SourceExpr=Amount+"Inv. Discount Amount"+"Pmt. Disc. Given Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19110;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(Type = Type::Resource);
                         END;

          }
          CONTROLS
          {
            { 72  ;TextBox      ;0    ;0    ;10920;423  ;FontSize=9;
                                                         SourceExpr=Description }
            { 73  ;TextBox      ;11130;0    ;1470 ;423  ;FontSize=9;
                                                         BlankZero=Yes;
                                                         SourceExpr=Quantity }
            { 75  ;TextBox      ;12810;0    ;2520 ;423  ;FontSize=9;
                                                         BlankZero=Yes;
                                                         SourceExpr="Unit Price";
                                                         AutoFormatType=2;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
            { 77  ;TextBox      ;15540;0    ;2520 ;423  ;FontSize=9;
                                                         BlankZero=Yes;
                                                         SourceExpr=Amount+"Inv. Discount Amount"+"Pmt. Disc. Given Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19110;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 85  ;Label        ;11130;423  ;4200 ;423  ;ParentControl=86;
                                                         FontSize=9;
                                                         LeaderDots=Yes }
            { 86  ;TextBox      ;15540;423  ;2520 ;423  ;FontSize=9;
                                                         CaptionML=[ENU=Sum;
                                                                    ESP=Suma];
                                                         SourceExpr=Amount+"Inv. Discount Amount"+"Pmt. Disc. Given Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19110;
            SectionHeight=423;
          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19110;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Inv. Discount Amount" <> 0);
                         END;

          }
          CONTROLS
          {
            { 87  ;Label        ;11130;0    ;4200 ;423  ;ParentControl=88;
                                                         FontSize=9 }
            { 88  ;TextBox      ;15540;0    ;2520 ;423  ;FontSize=9;
                                                         CaptionML=[ENU=Disc. Invoice amount;
                                                                    ESP=Importe dto. factura];
                                                         SourceExpr=-"Inv. Discount Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19110;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Pmt. Disc. Given Amount" <> 0);
                         END;

          }
          CONTROLS
          {
            { 99  ;Label        ;11130;0    ;4200 ;423  ;ParentControl=100;
                                                         FontSize=9 }
            { 100 ;TextBox      ;15540;0    ;2520 ;423  ;FontSize=9;
                                                         CaptionML=[ENU=disc p.p;
                                                                    ESP=Dto. P.P.];
                                                         SourceExpr=-"Pmt. Disc. Given Amount" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19110;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 90  ;TextBox      ;15540;0    ;2520 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=Amount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
            { 92  ;TextBox      ;15540;423  ;2520 ;423  ;FontSize=9;
                                                         SourceExpr="Amount Including VAT" - Amount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
            { 94  ;TextBox      ;15540;846  ;2520 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Amount Including VAT";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
            { 80  ;TextBox      ;11130;0    ;4200 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=TotalTexto }
            { 81  ;TextBox      ;11130;846  ;4200 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=TextoTotIVAIncl }
            { 2   ;TextBox      ;11130;423  ;4200 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=TextoImpuesto }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=ContadorIVA;
        OnPreDataItem=BEGIN
                        IF LinImporIVA.COUNT < 1 THEN
                          CurrReport.BREAK;
                        SETRANGE(Number,1,LinImporIVA.COUNT);
                        CurrReport.CREATETOTALS(LinImporIVA."VAT+EC Base",LinImporIVA."VAT Amount",LinImporIVA."EC Amount");
                      END;

        OnAfterGetRecord=BEGIN
                           LinImporIVA.GetLine(Number);
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19110;
            SectionHeight=2115;
          }
          CONTROLS
          {
            { 5   ;TextBox      ;2310 ;846  ;2100 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=TextoPorcen }
            { 7   ;TextBox      ;4620 ;846  ;2520 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=TextoBase }
            { 9   ;TextBox      ;7350 ;846  ;2520 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=TextoImpuesto }
            { 11  ;TextBox      ;0    ;0    ;6300 ;423  ;VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=TextoEspecificar }
          }
           }
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=19110;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 103 ;Label        ;0    ;0    ;2100 ;423  ;ParentControl=104;
                                                         FontSize=9;
                                                         LeaderDots=Yes }
            { 104 ;TextBox      ;4620 ;0    ;2520 ;423  ;FontSize=9;
                                                         CaptionML=[ENU=Sum;
                                                                    ESP=Suma];
                                                         SourceExpr=LinImporIVA."VAT+EC Base";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
            { 105 ;TextBox      ;7350 ;0    ;2520 ;423  ;FontSize=9;
                                                         SourceExpr=LinImporIVA."VAT Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19110;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 107 ;TextBox      ;2310 ;0    ;2100 ;423  ;FontSize=9;
                                                         CaptionML=[ENU=% VAT;
                                                                    ESP=% IVA];
                                                         SourceExpr=LinImporIVA."VAT %" }
            { 108 ;TextBox      ;4620 ;0    ;2520 ;423  ;FontSize=9;
                                                         CaptionML=[ENU=Base VAT+ER;
                                                                    ESP=Base IVA+RE];
                                                         SourceExpr=LinImporIVA."VAT+EC Base";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
            { 109 ;TextBox      ;7350 ;0    ;2520 ;423  ;FontSize=9;
                                                         CaptionML=[ENU=VAT Amount;
                                                                    ESP=Importe IVA];
                                                         SourceExpr=LinImporIVA."VAT Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19110;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 111 ;Label        ;0    ;423  ;2100 ;423  ;ParentControl=112;
                                                         FontSize=9;
                                                         LeaderDots=Yes }
            { 112 ;TextBox      ;4620 ;423  ;2520 ;423  ;FontSize=9;
                                                         CaptionML=[ENU=Sum;
                                                                    ESP=Suma];
                                                         SourceExpr=LinImporIVA."VAT+EC Base";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
            { 113 ;TextBox      ;7350 ;423  ;2520 ;423  ;FontSize=9;
                                                         SourceExpr=LinImporIVA."VAT Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19110;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 115 ;Label        ;0    ;423  ;2100 ;423  ;ParentControl=116;
                                                         FontSize=9;
                                                         FontBold=Yes }
            { 116 ;TextBox      ;4620 ;423  ;2520 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Total;
                                                                    ESP=Total];
                                                         SourceExpr=LinImporIVA."VAT+EC Base";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
            { 117 ;TextBox      ;7350 ;423  ;2520 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=LinImporIVA."VAT Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Header"."Currency Code" }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=Total;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19110;
            SectionHeight=0;
          }
          CONTROLS
          {
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=Total2;
        OnPreDataItem=BEGIN
                        IF NOT MostrarDireEnvio THEN
                          CurrReport.BREAK;
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19110;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 123 ;Label        ;0    ;0    ;6300 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Send to address;
                                                                    ESP=Env¡o a-Direcci¢n] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19110;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             "Sales Header"."Sell-to Customer No." <> "Sales Header"."Bill-to Customer No.";
                         END;

          }
          CONTROLS
          {
            { 125 ;TextBox      ;3360 ;0    ;2100 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr="Sales Header"."Sell-to Customer No." }
            { 124 ;Label        ;0    ;0    ;3150 ;423  ;ParentControl=125;
                                                         FontSize=9 }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19110;
            SectionHeight=3384;
          }
          CONTROLS
          {
            { 126 ;TextBox      ;0    ;0    ;6300 ;423  ;FontSize=9;
                                                         SourceExpr=EnvADir[1] }
            { 127 ;TextBox      ;0    ;423  ;6300 ;423  ;FontSize=9;
                                                         SourceExpr=EnvADir[2] }
            { 128 ;TextBox      ;0    ;846  ;6300 ;423  ;FontSize=9;
                                                         SourceExpr=EnvADir[3] }
            { 129 ;TextBox      ;0    ;1269 ;6300 ;423  ;FontSize=9;
                                                         SourceExpr=EnvADir[4] }
            { 130 ;TextBox      ;0    ;1692 ;6300 ;423  ;FontSize=9;
                                                         SourceExpr=EnvADir[5] }
            { 131 ;TextBox      ;0    ;2115 ;6300 ;423  ;FontSize=9;
                                                         SourceExpr=EnvADir[6] }
            { 51  ;TextBox      ;0    ;2538 ;6300 ;423  ;FontSize=9;
                                                         SourceExpr=EnvADir[7] }
            { 52  ;TextBox      ;0    ;2961 ;6300 ;423  ;FontSize=9;
                                                         SourceExpr=EnvADir[8] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=BancoCliente;
        OnPreDataItem=BEGIN
                        IF Clie."Default Bank Acc. Code" = '' THEN
                          CurrReport.BREAK;
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19110;
            SectionHeight=2115;
          }
          CONTROLS
          {
            { 1100253000;Label  ;0    ;0    ;3990 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Go Caribic Bank Details;
                                                                    ESP=Go Caribic Bank Details] }
            { 1100253001;TextBox;420  ;846  ;8190 ;423  ;FontSize=9;
                                                         SourceExpr=rBank.Name }
            { 1100253002;TextBox;420  ;1269 ;8190 ;423  ;FontSize=9;
                                                         SourceExpr=wDatosBanco[1] }
            { 1100253003;TextBox;420  ;1692 ;8190 ;423  ;FontSize=9;
                                                         SourceExpr=wDatosBanco[2] }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=5060;
      Height=440;
      CaptionML=[ENU=Test - sale standard invoice;
                 ESP=Test - Factura estandar venta];
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1   ;TextBox      ;3410 ;0    ;1650 ;440  ;CaptionML=[ENU=Copies No.;
                                                              ESP=N§ copias];
                                                   SourceExpr=NoCopias }
      { 21  ;Label        ;0    ;0    ;3300 ;440  ;ParentControl=1 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text000@1103355033 : TextConst 'ENU=Information does not exist in the local office parameters.;ESP=No existe informacion en el fichero de parametros de Delegacion.';
      Text001@1103355034 : TextConst 'ENU=Sales Representative;ESP=Representante';
      Text002@1103355035 : TextConst 'ENU=VAT;ESP=IVA';
      Text003@1103355036 : TextConst 'ENU=Total %1;ESP=Total %1';
      Text004@1103355037 : TextConst 'ENU=Total %1 incl. %2;ESP=Total %1 incl. %2';
      Text005@1103355038 : TextConst 'ENU=Amount;ESP=Importe';
      Text006@1103355039 : TextConst 'ENU=Base;ESP=Base';
      Text007@1103355040 : TextConst 'ENU=Specify amount;ESP=Especificar importe';
      Text008@1103355041 : TextConst 'ENU=COPY;ESP=COPIA';
      rBank@1100253000 : Record 270;
      rTipoCam@1103355000 : Record 330;
      rPar@1103355001 : Record 7009700;
      ConfCG@1103355002 : Record 98;
      CondEnv@1103355003 : Record 10;
      TerminosPago@1103355004 : Record 3;
      FormaPago@1103355005 : Record 289;
      RepreVtasComp@1103355006 : Record 13;
      InfoEmpresa@1103355007 : Record 79;
      Clie@1103355008 : Record 18;
      LinImporIVA@1103355009 : TEMPORARY Record 290;
      ConfRegistroIVA@1103355010 : Record 325;
      rCodNCF@1103355032 : Record 7009831;
      ContarFactVtaImpresa@1103355011 : Codeunit 315;
      FormatDire@1103355012 : Codeunit 365;
      DirClie@1103355013 : ARRAY [8] OF Text[50];
      EnvADir@1103355014 : ARRAY [8] OF Text[50];
      DirEmpresa@1103355015 : ARRAY [8] OF Text[50];
      TextNoPedido@1103355016 : Text[30];
      DescriVendedor@1103355017 : Text[30];
      TextoCIF@1103355018 : Text[30];
      DescriRefer@1103355019 : Text[30];
      TotalTexto@1103355020 : Text[50];
      TextoImpuesto@1103355021 : Text[30];
      TextoBase@1103355022 : Text[30];
      TextoPorcen@1103355023 : Text[30];
      TextoEspecificar@1103355024 : Text[30];
      TextoTotIVAIncl@1103355025 : Text[50];
      wDatosBanco@1100253001 : ARRAY [2] OF Text[100];
      MasLins@1103355026 : Boolean;
      NoCopias@1103355027 : Integer;
      NoBucles@1103355028 : Integer;
      TextoCopia@1103355029 : Text[30];
      MostrarDireEnvio@1103355030 : Boolean;
      i@1103355031 : Integer;
      wDescrpNCF@1100253002 : Text[30];

    PROCEDURE MontarDatosBanco@1100253000();
    BEGIN
      // MontarDatosBanco

      // Rellenar las lineas de wDatosBanco en funcion de lo solicitado por Go Caribic

      IF rBank.IBAN <> '' THEN BEGIN
        wDatosBanco[1] := 'IBAN: ' + rBank.IBAN;
        wDatosBanco[2] := '';
      END
      ELSE BEGIN
        rBank.TESTFIELD("SWIFT Code");
        rBank.TESTFIELD(ABA);
        wDatosBanco[1] := 'SWIFT: ' + rBank."SWIFT Code" + '   ABA: ' + rBank.ABA;
        wDatosBanco[2] := 'CCC No.: ' + rBank."CCC No.";
      END;
    END;

    BEGIN
    {
      $001 AJS 12012011 Mostrar la informacion del banco generico asignado al cliente

      $002 AJS 05032012 Si es una factura manual los campos Amount y Amount Including VAT vienen a cero
                        los calculo en Sales Line - OnAfterGetRecord

      $003 JPT 21/03/12 GOC-LP-12016 Incluir una descripcion de NCF para los abonos
    }
    END.
  }
  RDLDATA
  {
  }
}
