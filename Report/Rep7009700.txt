OBJECT Report 7009700 Comunicaci¢n Res. Hotel Venta
{
  OBJECT-PROPERTIES
  {
    Date=20/12/12;
    Time=11:30:46;
    Modified=Yes;
    Version List=AIC2009;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Sale hotel rest. Communication;
               ESP=Comunicaci¢n Res. Hotel Venta];
    OnInitReport=BEGIN
                   rInfEmp.FIND('-');
                   rPar.FIND('-');

                   FormatDire.Company(DirEmpresa,rInfEmp);
                 END;

    Orientation=Landscape;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        MaxIteration=1;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=24150;
            SectionHeight=2115;
          }
          CONTROLS
          {
            { 1   ;TextBox      ;0    ;0    ;8250 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=rInfEmp.Name }
            { 2   ;Label        ;19200;0    ;4950 ;423  ;HorzAlign=Right;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Bookings communication;
                                                                    ESP=Comunicaci¢n Reservas] }
            { 3   ;TextBox      ;0    ;1269 ;14700;423  ;FontSize=9;
                                                         SourceExpr=DirEmpresa[2]+' '+DirEmpresa[3]+' '+DirEmpresa[4] }
            { 4   ;TextBox      ;20400;1269 ;3750 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         CaptionML=[ENU=No. Fax 1;
                                                                    ESP=N§ Fax 1];
                                                         SourceExpr=rInfEmp."Fax No." }
            { 5   ;Label        ;16950;1269 ;3300 ;423  ;ParentControl=4;
                                                         HorzAlign=Left;
                                                         FontSize=9;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=No. Fax BOOKINGS;
                                                                    ESP=N§ Fax RESERVAS] }
            { 6   ;Shape        ;0    ;1692 ;24150;423  ;ShapeStyle=HorzLine }
            { 1103355003;Label  ;0    ;846  ;3300 ;423  ;ParentControl=1103355004;
                                                         HorzAlign=Left;
                                                         FontSize=9;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Email address;
                                                                    ESP=Direccion mail] }
            { 1103355004;TextBox;3450 ;846  ;11250;423  ;FontSize=9;
                                                         CaptionML=[ENU=No. Fax 1;
                                                                    ESP=N§ Fax 1];
                                                         SourceExpr=rInfEmp."E-Mail" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=24150;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 7   ;Label        ;0    ;0    ;24150;846  ;HorzAlign=Center;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Please confirm these bookings by the same way;
                                                                    ESP=Favor confirmar estas reservas por esta misma v¡a] }
            { 8   ;TextBox      ;23550;1269 ;600  ;423  ;HorzAlign=Right;
                                                         FontSize=10;
                                                         SourceExpr=CurrReport.PAGENO }
            { 9   ;Label        ;22200;1269 ;1350 ;423  ;ParentControl=8;
                                                         VertAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=page;
                                                                    ESP=P gina] }
            { 10  ;TextBox      ;10050;1269 ;5550 ;423  ;FontSize=10;
                                                         SourceExpr=FORMAT(TODAY,0,4)+' '+FORMAT(TIME,5)+' ('+USERID+')' }
            { 11  ;TextBox      ;0    ;1269 ;6450 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=cNombre.nom_delegacion(rPar.Delegacion) }
            { 12  ;Shape        ;0    ;846  ;24150;423  ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table7009743;
        DataItemTableView=SORTING(N§ envio hotel,Hotel booking,Hotel TO,TourOperador Venta,Fecha entrada,Fecha salida)
                          WHERE(Responsable=CONST(Yes));
        OnPreDataItem=BEGIN
                        wPrimerGrupo   := TRUE;
                        wPrimerPie     := TRUE;
                      END;

        OnAfterGetRecord=BEGIN
                           IF wNuevoHotel THEN BEGIN
                             IF rEnvios.GET(wNumEnvio, wHotel) THEN BEGIN
                               IF NOT EsReimpresion THEN BEGIN
                                 rEnvios.Paginas := CurrReport.PAGENO - 1;   // Restamos uno porque estamos ya en el siguiente hotel
                                 rEnvios.MODIFY;
                               END
                               ELSE BEGIN
                                 IF NOT CurrReport.PREVIEW THEN BEGIN
                                   rEnvios."Num Reenvio" += 1;
                                   rEnvios."Fecha ultimo reenvio" := TODAY;
                                   rEnvios.MODIFY;
                                 END;
                               END;
                             END;
                             wNuevoHotel   := FALSE;
                             wNuevoResumen := TRUE;
                           END;

                           IF wNuevoResumen THEN BEGIN
                             CLEAR(TabHabitacion);
                             CLEAR(TabRegimen);
                             wNuevoResumen := FALSE;
                           END;

                           wNumEnvio := "N§ envio hotel";
                           wHotel := "Hotel booking";

                           IF rPar."Codigos comunicar hotel" = rPar."Codigos comunicar hotel"::Propios THEN BEGIN
                             w_habitacion := Habitacion;

                             rHab.RESET;
                             rHab.SETRANGE(Delegacion       , Delegacion);
                             rHab.SETRANGE("N§ Contrato"    , "Contrato compra");
                             rHab.SETRANGE("Tipo contrato"  , rHab."Tipo contrato"::Compra);
                             rHab.SETRANGE("Habitacion cupo", w_habitacion);
                             IF rHab.FIND('-') THEN
                               wTextHabitacion := rHab.Descripcion
                             ELSE
                               wTextHabitacion := '';

                             w_regimen := Regimen;
                           END
                           ELSE BEGIN
                             IF "Habitacion TO" <> '' THEN BEGIN
                               w_habitacion := "Habitacion TO";

                               rHab.RESET;
                               rHab.SETRANGE(Delegacion     , Delegacion);
                               rHab.SETRANGE("N§ Contrato"  , "Contrato compra");
                               rHab.SETRANGE("Tipo contrato", rHab."Tipo contrato"::Compra);
                               rHab.SETRANGE("Habitacion TO", w_habitacion);
                               IF rHab.FIND('-') THEN
                                 wTextHabitacion := rHab.Descripcion
                               ELSE
                                 wTextHabitacion := '';
                             END
                             ELSE BEGIN
                               w_habitacion := Habitacion;

                               rHab.RESET;
                               rHab.SETRANGE(Delegacion       , Delegacion);
                               rHab.SETRANGE("N§ Contrato"    , "Contrato compra");
                               rHab.SETRANGE("Tipo contrato"  , rHab."Tipo contrato"::Compra);
                               rHab.SETRANGE("Habitacion cupo", w_habitacion);
                               IF rHab.FIND('-') THEN
                                 wTextHabitacion := rHab.Descripcion
                               ELSE
                                 wTextHabitacion := '';
                             END;

                             IF "Regimen TO" <> '' THEN
                               w_regimen := "Regimen TO"
                             ELSE
                               w_regimen := Regimen;
                           END;

                           // AJS 05.12.2003
                           // Buscar el hotel Touroperador para mostrar el nombre

                           rHotelTO.RESET;
                           rHotelTO.SETRANGE(TourOperador        , TourOperador);
                           rHotelTO.SETRANGE("Touroperador venta", "TourOperador Venta");
                           rHotelTO.SETRANGE("Hotel TO"          , "Hotel TO");
                           IF rHotelTO.FINDFIRST THEN
                             wNomHotelTO := rHotelTO."Nombre hotel TO"
                           ELSE BEGIN
                             rHotelTO.SETRANGE("Touroperador venta", '');
                             IF rHotelTO.FINDFIRST THEN
                               wNomHotelTO := rHotelTO."Nombre hotel TO"
                             ELSE
                               wNomHotelTO := '';
                           END;

                           // Rellenar las matrices de habitaciones y regimenes

                           BuscaHabitacion;
                           BuscaRegimen;

                           // AJS 25.03.2004
                           // Rellenar la fecha de emision, sino es PREVIEW, ni reimpresion

                           IF (NOT EsReimpresion) AND (NOT CurrReport.PREVIEW) THEN BEGIN
                             IF "Confirmacion hotel" THEN
                               "Fecha envio ult modificacion" := TODAY
                             ELSE
                               "Fecha envio alta" := TODAY;
                             MODIFY;
                           END;

                           IF rEnvios.Fecha = 0D THEN
                             rEnvios.Fecha := TODAY;

                           IF rEnvios.Fecha <> "Fecha envio alta" THEN
                             wTextModifica := Text001
                           ELSE
                             wTextModifica := Text002
                         END;

        OnPostDataItem=BEGIN
                         IF wNuevoHotel THEN BEGIN
                           IF rEnvios.GET(wNumEnvio, wHotel) THEN BEGIN
                             IF NOT EsReimpresion THEN BEGIN
                               rEnvios.Paginas := CurrReport.PAGENO;
                               rEnvios.MODIFY;
                             END
                             ELSE BEGIN
                               IF NOT CurrReport.PREVIEW THEN BEGIN
                                 rEnvios."Num Reenvio" += 1;
                                 rEnvios."Fecha ultimo reenvio" := TODAY;
                                 rEnvios.MODIFY;
                               END;
                             END;
                           END;
                         END;
                       END;

        ReqFilterFields=N§ envio hotel;
        GroupTotalFields=Hotel booking,Hotel TO,TourOperador Venta,Fecha entrada;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=24150;
            SectionHeight=2961;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT( wPrimerGrupo );

                           wPrimerGrupo := FALSE;
                         END;

            OnPostSection=BEGIN
                            wPrimerPie := TRUE;
                          END;

          }
          CONTROLS
          {
            { 74  ;Label        ;2250 ;2115 ;2250 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Rooms;
                                                                    ESP=Habitaciones] }
            { 75  ;Label        ;4650 ;2115 ;900  ;846  ;VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Reg.;
                                                                    ESP=Reg.] }
            { 76  ;Label        ;5700 ;2115 ;900  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Days;
                                                                    ESP=Dias] }
            { 77  ;Label        ;17250;2115 ;1650 ;846  ;VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Sale date;
                                                                    ESP=Fecha venta] }
            { 78  ;Label        ;6750 ;2115 ;1650 ;846  ;VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Check-out Date;
                                                                    ESP=Fecha salida] }
            { 79  ;Label        ;0    ;2115 ;2100 ;846  ;VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Voucher;
                                                                    ESP=Bono] }
            { 80  ;Label        ;8550 ;2115 ;5850 ;846  ;VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Name;
                                                                    ESP=Nombre] }
            { 81  ;Label        ;14550;2115 ;900  ;846  ;VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Age;
                                                                    ESP=Edad] }
            { 82  ;Label        ;0    ;423  ;2850 ;423  ;VertAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Tour Operator;
                                                                    ESP=Tour Operador] }
            { 83  ;TextBox      ;3000 ;423  ;6150 ;423  ;FontSize=10;
                                                         SourceExpr=cNombre.nom_touroperador("Reserva Hotel"."TourOperador Venta") }
            { 84  ;TextBox      ;3000 ;0    ;6150 ;423  ;FontSize=10;
                                                         SourceExpr=cNombre.nom_hotel("Reserva Hotel"."Hotel booking") }
            { 85  ;Label        ;0    ;0    ;2850 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Hotel;
                                                                    ESP=Hotel] }
            { 88  ;Label        ;15600;2115 ;1500 ;846  ;VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Person type;
                                                                    ESP=Tipo Persona] }
            { 89  ;Label        ;19050;2115 ;3150 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Hotel No confirmation;
                                                                    ESP=Num confirmacion hotel] }
            { 90  ;TextBox      ;13050;0    ;1650 ;423  ;FontSize=10;
                                                         SourceExpr="Fecha entrada" }
            { 91  ;Label        ;9750 ;0    ;3150 ;423  ;ParentControl=90;
                                                         HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes }
            { 92  ;TextBox      ;3000 ;846  ;6150 ;423  ;FontSize=10;
                                                         SourceExpr=wNomHotelTO }
            { 93  ;Label        ;0    ;846  ;2850 ;423  ;VertAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Hotel TTOO;
                                                                    ESP=Hotel TTOO] }
            { 102 ;Shape        ;19500;0    ;4650 ;1692  }
            { 103 ;Label        ;19650;0    ;2400 ;423  ;ParentControl=105;
                                                         VertAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Delivery;
                                                                    ESP=Envio] }
            { 104 ;Label        ;19650;423  ;2400 ;423  ;ParentControl=106;
                                                         HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Sending date;
                                                                    ESP=Fecha envio] }
            { 105 ;TextBox      ;22200;0    ;1500 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         SourceExpr=wNumEnvio }
            { 106 ;TextBox      ;22200;423  ;1950 ;423  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         SourceExpr=rEnvios.Fecha }
            { 107 ;TextBox      ;19650;846  ;4050 ;846  ;HorzAlign=Left;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         FontUnderline=No;
                                                         SourceExpr=wTextReimpresion }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=24150;
            SectionHeight=2961;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT( wPrimerGrupo );

                           wPrimerGrupo := FALSE;

                           IF CurrReport.TOTALSCAUSEDBY = "Reserva Hotel".FIELDNO("Hotel booking") THEN
                             CurrReport.PAGENO := 1;

                           IF rEnvios.GET("N§ envio hotel", "Hotel booking") THEN BEGIN
                             IF EsReimpresion THEN
                               wTextReimpresion := STRSUBSTNO(Text000, rEnvios."Num Reenvio" + 1)
                             ELSE
                               wTextReimpresion := '';
                           END
                           ELSE
                             rEnvios.Fecha := TODAY;
                         END;

            OnPostSection=BEGIN
                            wPrimerPie := TRUE;
                          END;

          }
          CONTROLS
          {
            { 13  ;Label        ;2250 ;2115 ;2250 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Rooms;
                                                                    ESP=Habitaciones] }
            { 14  ;Label        ;4650 ;2115 ;900  ;846  ;VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Reg.;
                                                                    ESP=Reg.] }
            { 15  ;Label        ;5700 ;2115 ;900  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Days;
                                                                    ESP=Dias] }
            { 16  ;Label        ;17250;2115 ;1650 ;846  ;VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Sale date;
                                                                    ESP=Fecha venta] }
            { 17  ;Label        ;6750 ;2115 ;1650 ;846  ;VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Check-out Date;
                                                                    ESP=Fecha salida] }
            { 18  ;Label        ;0    ;2115 ;2100 ;846  ;VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Voucher;
                                                                    ESP=Bono] }
            { 19  ;Label        ;8550 ;2115 ;5850 ;846  ;VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Name;
                                                                    ESP=Nombre] }
            { 20  ;Label        ;14550;2115 ;900  ;846  ;VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Age;
                                                                    ESP=Edad] }
            { 21  ;Label        ;0    ;423  ;2850 ;423  ;VertAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Tour Operator;
                                                                    ESP=Tour Operador] }
            { 22  ;TextBox      ;3000 ;423  ;6150 ;423  ;FontSize=10;
                                                         SourceExpr=cNombre.nom_touroperador("Reserva Hotel"."TourOperador Venta") }
            { 23  ;TextBox      ;3000 ;0    ;6150 ;423  ;FontSize=10;
                                                         SourceExpr=cNombre.nom_hotel("Reserva Hotel"."Hotel booking") }
            { 24  ;Label        ;0    ;0    ;2850 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Hotel;
                                                                    ESP=Hotel] }
            { 25  ;Label        ;19650;0    ;2400 ;423  ;ParentControl=26;
                                                         VertAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Delivery;
                                                                    ESP=Envio] }
            { 26  ;TextBox      ;22200;0    ;1500 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         SourceExpr=wNumEnvio }
            { 27  ;Label        ;15600;2115 ;1500 ;846  ;VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Person type;
                                                                    ESP=Tipo Persona] }
            { 28  ;Label        ;19050;2115 ;3150 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Hotel No confirmation;
                                                                    ESP=Num confirmacion hotel] }
            { 29  ;TextBox      ;13050;0    ;1650 ;423  ;FontSize=10;
                                                         SourceExpr="Fecha entrada" }
            { 30  ;Label        ;9750 ;0    ;3150 ;423  ;ParentControl=29;
                                                         HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes }
            { 31  ;TextBox      ;3000 ;846  ;6150 ;423  ;FontSize=10;
                                                         SourceExpr=wNomHotelTO }
            { 32  ;Label        ;0    ;846  ;2850 ;423  ;VertAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Hotel TTOO;
                                                                    ESP=Hotel TTOO] }
            { 96  ;TextBox      ;19650;846  ;4050 ;846  ;HorzAlign=Left;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         FontUnderline=No;
                                                         SourceExpr=wTextReimpresion }
            { 97  ;TextBox      ;22200;423  ;1950 ;423  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         SourceExpr=rEnvios.Fecha }
            { 98  ;Label        ;19650;423  ;2400 ;423  ;ParentControl=97;
                                                         HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Sending date;
                                                                    ESP=Fecha envio] }
            { 101 ;Shape        ;19500;0    ;4650 ;1692  }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=24150;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 33  ;TextBox      ;2250 ;0    ;2250 ;423  ;HorzAlign=Right;
                                                         FontSize=10;
                                                         SourceExpr=STRSUBSTNO(Text003, "N§ Habitaciones", w_habitacion) }
            { 34  ;TextBox      ;0    ;0    ;2100 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         SourceExpr=Bono }
            { 35  ;TextBox      ;4650 ;0    ;900  ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         SourceExpr=w_regimen }
            { 36  ;TextBox      ;5700 ;0    ;900  ;423  ;HorzAlign=Right;
                                                         FontSize=10;
                                                         SourceExpr=Estancia }
            { 37  ;TextBox      ;17250;0    ;1650 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         SourceExpr="Fecha venta" }
            { 38  ;TextBox      ;14550;0    ;900  ;423  ;HorzAlign=Right;
                                                         FontSize=10;
                                                         SourceExpr=Edad }
            { 39  ;TextBox      ;6750 ;0    ;1650 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         SourceExpr="Fecha salida" }
            { 40  ;TextBox      ;8550 ;0    ;5850 ;423  ;FontSize=10;
                                                         SourceExpr=Nombre }
            { 41  ;TextBox      ;15600;0    ;1500 ;423  ;FontSize=10;
                                                         SourceExpr="Tipo Persona" }
            { 42  ;TextBox      ;19050;0    ;3150 ;423  ;HorzAlign=Center;
                                                         FontSize=10;
                                                         SourceExpr="Num confirmacion hotel" }
            { 94  ;TextBox      ;22200;0    ;1950 ;423  ;HorzAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=wTextModifica }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=24150;
            SectionHeight=5499;
            OnPreSection=BEGIN

                           CASE CurrReport.TOTALSCAUSEDBY OF
                             FIELDNO("Hotel booking"):
                               ;
                             FIELDNO("Hotel TO"):
                               ;
                             FIELDNO("TourOperador Venta"):
                               ;
                             FIELDNO("Fecha entrada"):
                               ;
                           END;

                           IF CurrReport.TOTALSCAUSEDBY = FIELDNO("Hotel booking") THEN
                             wNuevoHotel := TRUE;

                           IF wPrimerPie THEN BEGIN
                             rRsv2.COPY("Reserva Hotel");
                             IF rRsv2.NEXT > 0 THEN BEGIN
                               IF ("TourOperador Venta" <> rRsv2."TourOperador Venta") OR
                                  ("Hotel TO" <> rRsv2."Hotel TO") OR
                                  ("Hotel booking" <> rRsv2."Hotel booking") THEN BEGIN
                                 CurrReport.SHOWOUTPUT( TRUE );
                                 wNuevoResumen   := TRUE;
                                 wSaltaSiguiente := TRUE;
                               END
                               ELSE BEGIN
                                 CurrReport.SHOWOUTPUT( FALSE );
                                 wNoMasGrupos := TRUE;
                               END;
                             END
                             ELSE
                               CurrReport.SHOWOUTPUT( TRUE );
                             wPrimerPie := FALSE;
                           END
                           ELSE
                             CurrReport.SHOWOUTPUT( FALSE );
                         END;

            OnPostSection=BEGIN
                            wPrimerGrupo := TRUE;

                            IF wSaltaSiguiente AND ( CurrReport.TOTALSCAUSEDBY <> FIELDNO("Fecha entrada")) THEN BEGIN
                              CurrReport.NEWPAGE;
                              wSaltaSiguiente := FALSE;
                            END
                            ELSE BEGIN
                              IF wNoMasGrupos THEN BEGIN
                                CurrReport.NEWPAGE;
                                wNoMasGrupos := FALSE;
                              END
                            END;
                          END;

          }
          CONTROLS
          {
            { 43  ;TextBox      ;450  ;1269 ;2100 ;423  ;FontSize=10;
                                                         SourceExpr=TabHabitacion[1][1] }
            { 44  ;TextBox      ;2700 ;1269 ;9750 ;423  ;FontSize=10;
                                                         SourceExpr=TabHabitacion[1][2] }
            { 45  ;Label        ;0    ;0    ;4950 ;423  ;VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=No;
                                                         CaptionML=[ENU=Codes summary;
                                                                    ESP=Resumen de codigos] }
            { 46  ;Label        ;150  ;423  ;24000;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         FontUnderline=No;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Rooms;
                                                                    ESP=Habitaciones] }
            { 47  ;TextBox      ;2700 ;1692 ;9750 ;423  ;FontSize=10;
                                                         SourceExpr=TabHabitacion[2][2] }
            { 48  ;TextBox      ;450  ;1692 ;2100 ;423  ;FontSize=10;
                                                         SourceExpr=TabHabitacion[2][1] }
            { 49  ;TextBox      ;2700 ;2538 ;9750 ;423  ;FontSize=10;
                                                         SourceExpr=TabHabitacion[3][2] }
            { 50  ;TextBox      ;450  ;2538 ;2100 ;423  ;FontSize=10;
                                                         SourceExpr=TabHabitacion[3][1] }
            { 51  ;TextBox      ;2700 ;2115 ;9750 ;423  ;FontSize=10;
                                                         SourceExpr=TabHabitacion[4][2] }
            { 52  ;TextBox      ;450  ;2115 ;2100 ;423  ;FontSize=10;
                                                         SourceExpr=TabHabitacion[4][1] }
            { 53  ;TextBox      ;2700 ;2961 ;9750 ;423  ;FontSize=10;
                                                         SourceExpr=TabHabitacion[5][2] }
            { 54  ;TextBox      ;450  ;2961 ;2100 ;423  ;FontSize=10;
                                                         SourceExpr=TabHabitacion[5][1] }
            { 55  ;TextBox      ;2250 ;5076 ;3900 ;423  ;FontSize=10;
                                                         SourceExpr=cNombre.nom_regimen(TabRegimen[5]) }
            { 56  ;TextBox      ;8550 ;4653 ;3900 ;423  ;FontSize=10;
                                                         SourceExpr=cNombre.nom_regimen(TabRegimen[4]) }
            { 57  ;TextBox      ;6750 ;4653 ;1650 ;423  ;FontSize=10;
                                                         SourceExpr=TabRegimen[4] }
            { 58  ;TextBox      ;450  ;5076 ;1650 ;423  ;FontSize=10;
                                                         SourceExpr=TabRegimen[5] }
            { 59  ;TextBox      ;2250 ;4653 ;3900 ;423  ;FontSize=10;
                                                         SourceExpr=cNombre.nom_regimen(TabRegimen[3]) }
            { 60  ;TextBox      ;450  ;4653 ;1650 ;423  ;FontSize=10;
                                                         SourceExpr=TabRegimen[3] }
            { 61  ;TextBox      ;8550 ;4230 ;3900 ;423  ;FontSize=10;
                                                         SourceExpr=cNombre.nom_regimen(TabRegimen[2]) }
            { 62  ;TextBox      ;6750 ;4230 ;1650 ;423  ;FontSize=10;
                                                         SourceExpr=TabRegimen[2] }
            { 63  ;TextBox      ;450  ;4230 ;1650 ;423  ;FontSize=10;
                                                         SourceExpr=TabRegimen[1] }
            { 64  ;TextBox      ;2250 ;4230 ;3900 ;423  ;FontSize=10;
                                                         SourceExpr=cNombre.nom_regimen(TabRegimen[1]) }
            { 65  ;Label        ;150  ;3384 ;12300;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         FontUnderline=No;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Boards;
                                                                    ESP=Regimenes] }
            { 66  ;Shape        ;150  ;846  ;24000;423  ;ShapeStyle=HorzLine }
            { 67  ;Shape        ;150  ;3807 ;12300;423  ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table7009762;
        DataItemTableView=SORTING(Delegacion,N§ Interno,N§ Periodo,N§ Reserva,Tipo Reserva,N§ Orden);
        DataItemLink=Delegacion=FIELD(Delegacion),
                     N§ Interno=FIELD(N§ Interno);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=24150;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 68  ;Label        ;9600 ;0    ;450  ;423  ;FontSize=10;
                                                         CaptionML=[ENU=***;
                                                                    ESP=***] }
            { 69  ;TextBox      ;600  ;0    ;8850 ;423  ;FontSize=10;
                                                         SourceExpr=Texto }
            { 70  ;Label        ;0    ;0    ;450  ;423  ;FontSize=10;
                                                         CaptionML=[ENU=***;
                                                                    ESP=***] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table7009743;
        DataItemTableView=SORTING(Delegacion,N§ Responsable,N§ Habitacion)
                          WHERE(Responsable=CONST(No));
        DataItemVarName=Acompa¤ante;
        DataItemLink=Delegacion=FIELD(Delegacion),
                     N§ Responsable=FIELD(N§ Reserva);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=24150;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 71  ;TextBox      ;15600;0    ;1500 ;423  ;FontSize=10;
                                                         SourceExpr="Tipo Persona" }
            { 72  ;TextBox      ;14550;0    ;900  ;423  ;FontSize=10;
                                                         SourceExpr=Edad }
            { 73  ;TextBox      ;8550 ;0    ;5850 ;423  ;FontSize=10;
                                                         SourceExpr=Nombre }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
      CaptionML=[ENU=Sale hotel rest. Communication;
                 ESP=Comunicaci¢n Res. Hotel Venta];
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text000@1103355029 : TextConst 'ENU=FORWARD No.%1;ESP=REENVIO N§ %1';
      Text001@1103355030 : TextConst 'ENU=MODIFICATION;ESP=MODIFICACION';
      Text002@1103355031 : TextConst 'ENU=New;ESP=Nueva';
      Text003@1103355032 : TextConst 'ENU=%1 x %2;ESP=%1 x %2';
      rInfEmp@1103355000 : Record 79;
      rPar@1103355001 : Record 7009700;
      rEnvios@1103355002 : Record 7009761;
      rHotelTO@1103355003 : Record 7009725;
      rHab@1103355004 : Record 7009731;
      rRsv2@1103355005 : Record 7009743;
      cNombre@1103355006 : Codeunit 7009702;
      FormatDire@1103355007 : Codeunit 365;
      wPrimerGrupo@1103355008 : Boolean;
      wPrimerPie@1103355009 : Boolean;
      wSaltaSiguiente@1103355010 : Boolean;
      wNoMasGrupos@1103355011 : Boolean;
      wNuevoHotel@1103355012 : Boolean;
      wNuevoResumen@1103355013 : Boolean;
      ImpresoAlgo@1103355014 : Boolean;
      EsReimpresion@1103355015 : Boolean;
      Preli@1103355016 : Boolean;
      DirEmpresa@1103355017 : ARRAY [8] OF Text[50];
      wNomHotelTO@1103355018 : Text[60];
      wTextHabitacion@1103355019 : Text[60];
      TabHabitacion@1103355020 : ARRAY [10,2] OF Text[60];
      wTextModifica@1103355021 : Text[30];
      wTextReimpresion@1103355022 : Text[30];
      wNumEnvio@1103355023 : Integer;
      wIndice@1103355024 : Integer;
      wHotel@1103355025 : Code[20];
      w_habitacion@1103355026 : Code[10];
      w_regimen@1103355027 : Code[10];
      TabRegimen@1103355028 : ARRAY [10] OF Code[10];

    PROCEDURE Definitivo@1() : Boolean;
    BEGIN
      EXIT((NOT Preli) AND ImpresoAlgo);
    END;

    PROCEDURE Reimpresion@2(par_reimpresion@1103355000 : Boolean);
    BEGIN
      EsReimpresion := par_reimpresion;
    END;

    PROCEDURE BuscaHabitacion@4();
    BEGIN
      // BuscaHabitacion
      //
      wIndice := 0;
      REPEAT
        wIndice += 1;
        IF TabHabitacion[wIndice][1] = '' THEN BEGIN
          TabHabitacion[wIndice][1] := w_habitacion;
          TabHabitacion[wIndice][2] := wTextHabitacion;
        END;
      UNTIL TabHabitacion[wIndice][1] = w_habitacion;
    END;

    PROCEDURE BuscaRegimen@5();
    BEGIN
      // BuscaRegimen
      //
      wIndice := 0;
      REPEAT
        wIndice += 1;
        IF TabRegimen[wIndice] = '' THEN
          TabRegimen[wIndice] := w_regimen;
      UNTIL TabRegimen[wIndice] = w_regimen;
    END;

    BEGIN
    {
      ## AJF 29/06/09

        .- (09/00319) cambio c¢digos de hotel de code10 a code20.

      ## AJS 03.02.2010

        .- Amplio los controles que muestran la descripcion de las habitaciones en el resumen

      ## AJS 05.02.2010

        .- La Descripcion del tipo de habitacion es ahora de 60 caracteres, reestructurar el resumen de habitaciones

      $001 AJS 20122012 Muevo el codigo para que el texto reserva NUEVA o MODIFICADA este en OnAfterGetRecord
    }
    END.
  }
  RDLDATA
  {
  }
}
