OBJECT Report 7009709 Emision Valoracion
{
  OBJECT-PROPERTIES
  {
    Date=01/01/13;
    Time=23:16:35;
    Modified=Yes;
    Version List=AIC2009;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Hotel closure valoration;
               ESP=Emision Valoracion];
    OnInitReport=BEGIN
                   rEmpresa.FINDFIRST;
                   rDelegacion.FINDFIRST;
                 END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=diPagina;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18000;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1   ;Shape        ;0    ;423  ;18000;423  ;ShapeStyle=HorzLine }
            { 2   ;Label        ;11250;0    ;6750 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Vouchers assessment;
                                                                    ESP=Valoraci¢n Bonos] }
            { 3   ;TextBox      ;0    ;0    ;5400 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=rEmpresa.Name }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=18000;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 4   ;TextBox      ;4800 ;423  ;7050 ;423  ;HorzAlign=Center;
                                                         SourceExpr=FORMAT(TODAY,0,4) + ' / ' + FORMAT(TIME,0,0) + ' / ' + USERID }
            { 6   ;TextBox      ;14850;423  ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=Text007 + FORMAT(CurrReport.PAGENO) }
            { 5   ;Shape        ;0    ;0    ;18000;423  ;ShapeStyle=HorzLine }
            { 7   ;TextBox      ;0    ;423  ;3600 ;423  ;SourceExpr=fNoms.nom_delegacion(rDelegacion.Delegacion) }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table7010018;
        DataItemTableView=SORTING(Delegacion,TourOperador,Hotel Pago,N§ cierre delegacion);
        DataItemVarName=diBono;
        OnPreDataItem=BEGIN
                        IF GETFILTER("N§ cierre delegacion") = '' THEN
                          ERROR(Text004);

                        IF STRPOS(GETFILTER("N§ cierre delegacion"), '..') > 0 THEN
                          ERROR(Text005);

                        wBono_Ant    := '';
                        wResp_Ant    := 0;

                        _IniciaConceptos;
                      END;

        OnAfterGetRecord=BEGIN
                           // saltamos al siguiente n§ de bono
                           IF (wBono_Ant = Bono) AND (wResp_Ant = "N§ Responsable") THEN
                             CurrReport.SKIP()
                           ELSE BEGIN
                             wBono_Ant := Bono;
                             wResp_Ant := "N§ Responsable";
                           END;

                           // buscamos el resumen de reserva del cierre
                           rResReserva.RESET;
                           IF NOT rResReserva.GET(Delegacion, "N§ Reserva", "N§ cierre delegacion") THEN
                             CLEAR(rResReserva);
                         END;

        ReqFilterFields=TourOperador,N§ cierre delegacion;
        TotalFields=Coste,Ingreso;
        GroupTotalFields=Hotel Pago;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18000;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 32  ;TextBox      ;1950 ;423  ;1350 ;423  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         SourceExpr="N§ cierre delegacion" }
            { 34  ;Label        ;0    ;423  ;1800 ;423  ;ParentControl=32;
                                                         VertAlign=Bottom;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Closure No;
                                                                    ESP=N§ cierre] }
          }
           }
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=18000;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 37  ;Label        ;4500 ;0    ;2850 ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Hotel;
                                                                    ESP=Hotel] }
            { 38  ;Label        ;7500 ;0    ;2850 ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Name;
                                                                    ESP=Nombre] }
            { 39  ;Label        ;10500;0    ;1050 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Check-out Date;
                                                                    ESP=Fecha salida] }
            { 40  ;Label        ;11700;0    ;600  ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Reg.;
                                                                    ESP=Reg.] }
            { 41  ;Label        ;12450;0    ;750  ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Room;
                                                                    ESP=Hab.] }
            { 42  ;Label        ;13350;0    ;600  ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Quant.;
                                                                    ESP=Cant] }
            { 43  ;Label        ;14100;0    ;600  ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Sta.;
                                                                    ESP=Est.] }
            { 44  ;Label        ;14850;0    ;1500 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Cost;
                                                                    ESP=Coste] }
            { 45  ;Label        ;16500;0    ;1500 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Income;
                                                                    ESP=Ingreso] }
            { 49  ;Label        ;12450;846  ;2250 ;423  ;FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Previous sum;
                                                                    ESP=Suma anterior] }
            { 50  ;TextBox      ;14850;846  ;1500 ;423  ;SourceExpr=Coste }
            { 51  ;TextBox      ;16500;846  ;1500 ;423  ;SourceExpr=Ingreso }
            { 56  ;Label        ;1650 ;0    ;1050 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Arrival Date;
                                                                    ESP=Fecha llegada] }
            { 57  ;Label        ;2850 ;0    ;1500 ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Voucher;
                                                                    ESP=Bono] }
            { 1100217001;Label  ;0    ;0    ;1500 ;846  ;ParentControl=1100217000;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=18000;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 11  ;Label        ;1650 ;0    ;1050 ;846  ;ParentControl=10;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Arrival Date;
                                                                    ESP=Fecha llegada] }
            { 9   ;Label        ;2850 ;0    ;1500 ;846  ;ParentControl=8;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Voucher;
                                                                    ESP=Bono] }
            { 19  ;Label        ;4500 ;0    ;2850 ;846  ;ParentControl=18;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Hotel;
                                                                    ESP=Hotel] }
            { 13  ;Label        ;7500 ;0    ;2850 ;846  ;ParentControl=12;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Name;
                                                                    ESP=Nombre] }
            { 21  ;Label        ;10500;0    ;1050 ;846  ;ParentControl=20;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Check-out Date;
                                                                    ESP=Fecha salida] }
            { 15  ;Label        ;11700;0    ;600  ;846  ;ParentControl=14;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Reg.;
                                                                    ESP=Reg.] }
            { 17  ;Label        ;12450;0    ;750  ;846  ;ParentControl=16;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Room;
                                                                    ESP=Hab.] }
            { 23  ;Label        ;13350;0    ;600  ;846  ;ParentControl=22;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Quant.;
                                                                    ESP=Cant] }
            { 25  ;Label        ;14100;0    ;600  ;846  ;ParentControl=24;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Sta.;
                                                                    ESP=Est.] }
            { 27  ;Label        ;14850;0    ;1500 ;846  ;ParentControl=26;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Cost;
                                                                    ESP=Coste] }
            { 29  ;Label        ;16500;0    ;1500 ;846  ;ParentControl=28;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Income;
                                                                    ESP=Ingreso] }
            { 1100217002;Label  ;0    ;0    ;1500 ;846  ;ParentControl=1100217000;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18000;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 8   ;TextBox      ;2850 ;0    ;1500 ;423  ;SourceExpr=Bono }
            { 10  ;TextBox      ;1650 ;0    ;1050 ;423  ;SourceExpr="Fecha llegada" }
            { 12  ;TextBox      ;7500 ;0    ;2850 ;423  ;SourceExpr="Nombre responsable" }
            { 14  ;TextBox      ;11700;0    ;600  ;423  ;SourceExpr=rResReserva.Regimen }
            { 16  ;TextBox      ;12450;0    ;750  ;423  ;SourceExpr=rResReserva.Habitacion }
            { 18  ;TextBox      ;4500 ;0    ;2850 ;423  ;SourceExpr=fNoms.nom_hotel("Hotel Pago") }
            { 20  ;TextBox      ;10500;0    ;1050 ;423  ;SourceExpr="Fecha salida" }
            { 22  ;TextBox      ;13350;0    ;600  ;423  ;SourceExpr=rResReserva."N§ Habitaciones" }
            { 24  ;TextBox      ;14100;0    ;600  ;423  ;SourceExpr=rResReserva.Estancia }
            { 26  ;TextBox      ;14850;0    ;1500 ;423  ;SourceExpr=Coste }
            { 28  ;TextBox      ;16500;0    ;1500 ;423  ;SourceExpr=Ingreso }
            { 1100217000;TextBox;0    ;0    ;1500 ;423  ;SourceExpr=TourOperador }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=18000;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 30  ;TextBox      ;14850;0    ;1500 ;423  ;SourceExpr=Coste }
            { 31  ;TextBox      ;16500;0    ;1500 ;423  ;SourceExpr=Ingreso }
            { 33  ;Label        ;12450;0    ;2250 ;423  ;FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Total Hotel;
                                                                    ESP=Total Hotel] }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=18000;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 46  ;TextBox      ;14850;0    ;1500 ;423  ;SourceExpr=Coste }
            { 47  ;TextBox      ;16500;0    ;1500 ;423  ;SourceExpr=Ingreso }
            { 48  ;Label        ;12450;0    ;2250 ;423  ;FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Sum and continue;
                                                                    ESP=Suma y sigue] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table7010019;
        DataItemTableView=SORTING(Delegacion,TourOperador,Bono,N§ Reserva,N§ Secuencia,N§ Orden,Concepto,Codigo Extra)
                          WHERE(Coste/Ingreso=CONST(Coste));
        DataItemVarName=diDetCoste;
        OnAfterGetRecord=BEGIN
                           _AcumulaConcepto(Concepto, 0, Importe);

                           IF NOT wDetCoste THEN
                             CurrReport.SKIP;
                         END;

        DataItemLink=Delegacion=FIELD(Delegacion),
                     TourOperador=FIELD(TourOperador),
                     Bono=FIELD(Bono),
                     N§ Reserva=FIELD(N§ Reserva),
                     N§ Secuencia=FIELD(N§ Secuencia),
                     N§ Orden=FIELD(N§ Orden);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=18000;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1100217012;Label  ;4500 ;0    ;1050 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Costs;
                                                                    ESP=Costes] }
            { 1100217004;Label  ;5850 ;0    ;1950 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Concept;
                                                                    ESP=Concepto] }
            { 1100217006;Label  ;7950 ;0    ;1350 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Price;
                                                                    ESP=Precio] }
            { 1100217008;Label  ;9450 ;0    ;1800 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Amount;
                                                                    ESP=Importe] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18000;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1100217003;TextBox;5850 ;0    ;1950 ;423  ;SourceExpr=Concepto }
            { 1100217005;TextBox;9450 ;0    ;1800 ;423  ;SourceExpr=Importe }
            { 1100217007;TextBox;7950 ;0    ;1350 ;423  ;SourceExpr=Precio }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table7010019;
        DataItemTableView=SORTING(Delegacion,TourOperador,Bono,N§ Reserva,N§ Secuencia,N§ Orden,Concepto,Codigo Extra)
                          WHERE(Coste/Ingreso=CONST(Ingreso));
        DataItemVarName=diDetIngreso;
        OnAfterGetRecord=BEGIN
                           _AcumulaConcepto(Concepto, 1, Importe);

                           IF NOT wDetIngreso THEN
                             CurrReport.SKIP;
                         END;

        DataItemLink=Delegacion=FIELD(Delegacion),
                     TourOperador=FIELD(TourOperador),
                     Bono=FIELD(Bono),
                     N§ Reserva=FIELD(N§ Reserva),
                     N§ Secuencia=FIELD(N§ Secuencia),
                     N§ Orden=FIELD(N§ Orden);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=18000;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1100217013;Label  ;4500 ;0    ;1200 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Incomes;
                                                                    ESP=Ingresos] }
            { 1100217014;Label  ;9450 ;0    ;1800 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Amount;
                                                                    ESP=Importe] }
            { 1100217015;Label  ;7950 ;0    ;1350 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Price;
                                                                    ESP=Precio] }
            { 1100217016;Label  ;5850 ;0    ;1950 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Concept;
                                                                    ESP=Concepto] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18000;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1100217009;TextBox;5850 ;0    ;1950 ;423  ;SourceExpr=Concepto }
            { 1100217010;TextBox;7950 ;0    ;1350 ;423  ;SourceExpr=Precio }
            { 1100217011;TextBox;9450 ;0    ;1800 ;423  ;SourceExpr=Importe }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(>=1));
        DataItemVarName=diResumenCoste;
        OnPreDataItem=BEGIN
                        _AgruparResumen(0);
                        SETRANGE(Number, 1, wLineasResumen);
                      END;

        OnAfterGetRecord=BEGIN
                           wIndice := Number + ((Number - 1)  * 4)
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=18000;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 1100217019;Label  ;0    ;0    ;4050 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Summary x concept - Costs;
                                                                    ESP=Resumen x concepto - Costes] }
            { 1100217035;Label  ;300  ;846  ;2250 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Concept;
                                                                    ESP=Concepto] }
            { 1100217036;Label  ;2850 ;846  ;1500 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Amount;
                                                                    ESP=Importe] }
            { 1100217037;Label  ;7350 ;846  ;1500 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Amount;
                                                                    ESP=Importe] }
            { 1100217038;Label  ;4800 ;846  ;2250 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Concept;
                                                                    ESP=Concepto] }
            { 1100217039;Label  ;11850;846  ;1500 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Amount;
                                                                    ESP=Importe] }
            { 1100217040;Label  ;9300 ;846  ;2250 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Concept;
                                                                    ESP=Concepto] }
            { 1100217041;Label  ;16500;846  ;1500 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Amount;
                                                                    ESP=Importe] }
            { 1100217042;Label  ;13950;846  ;2250 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Concept;
                                                                    ESP=Concepto] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18000;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1100217017;TextBox;2850 ;0    ;1500 ;423  ;BlankZero=Yes;
                                                         SourceExpr=wImpResumen[wIndice] }
            { 1100217018;TextBox;300  ;0    ;2250 ;423  ;SourceExpr=wCodResumen[wIndice] }
            { 1100217020;TextBox;7350 ;0    ;1500 ;423  ;BlankZero=Yes;
                                                         SourceExpr=wImpResumen[wIndice + 1] }
            { 1100217021;TextBox;4800 ;0    ;2250 ;423  ;SourceExpr=wCodResumen[wIndice + 1] }
            { 1100217022;TextBox;11850;0    ;1500 ;423  ;BlankZero=Yes;
                                                         SourceExpr=wImpResumen[wIndice + 2] }
            { 1100217023;TextBox;9300 ;0    ;2250 ;423  ;SourceExpr=wCodResumen[wIndice + 2] }
            { 1100217024;TextBox;16500;0    ;1500 ;423  ;BlankZero=Yes;
                                                         SourceExpr=wImpResumen[wIndice + 3] }
            { 1100217025;TextBox;13950;0    ;2250 ;423  ;SourceExpr=wCodResumen[wIndice + 3] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(>=1));
        DataItemVarName=diResumenIngreso;
        OnPreDataItem=BEGIN
                        _AgruparResumen(1);
                        SETRANGE(Number, 1, wLineasResumen);
                      END;

        OnAfterGetRecord=BEGIN
                           wIndice := Number + ((Number - 1)  * 4)
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=18000;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 1100217026;Label  ;0    ;0    ;4050 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Summary x concept - Incomes;
                                                                    ESP=Resumen x concepto - Ingresos] }
            { 1100217043;Label  ;16500;846  ;1500 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Amount;
                                                                    ESP=Importe] }
            { 1100217044;Label  ;13950;846  ;2250 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Concept;
                                                                    ESP=Concepto] }
            { 1100217045;Label  ;11850;846  ;1500 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Amount;
                                                                    ESP=Importe] }
            { 1100217046;Label  ;9300 ;846  ;2250 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Concept;
                                                                    ESP=Concepto] }
            { 1100217047;Label  ;7350 ;846  ;1500 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Amount;
                                                                    ESP=Importe] }
            { 1100217048;Label  ;4800 ;846  ;2250 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Concept;
                                                                    ESP=Concepto] }
            { 1100217049;Label  ;2850 ;846  ;1500 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Amount;
                                                                    ESP=Importe] }
            { 1100217050;Label  ;300  ;846  ;2250 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Concept;
                                                                    ESP=Concepto] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18000;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1100217027;TextBox;2850 ;0    ;1500 ;423  ;BlankZero=Yes;
                                                         SourceExpr=wImpResumen[wIndice] }
            { 1100217028;TextBox;300  ;0    ;2250 ;423  ;SourceExpr=wCodResumen[wIndice] }
            { 1100217029;TextBox;7350 ;0    ;1500 ;423  ;BlankZero=Yes;
                                                         SourceExpr=wImpResumen[wIndice + 1] }
            { 1100217030;TextBox;4800 ;0    ;2250 ;423  ;SourceExpr=wCodResumen[wIndice + 1] }
            { 1100217031;TextBox;11850;0    ;1500 ;423  ;BlankZero=Yes;
                                                         SourceExpr=wImpResumen[wIndice + 2] }
            { 1100217032;TextBox;9300 ;0    ;2250 ;423  ;SourceExpr=wCodResumen[wIndice + 2] }
            { 1100217033;TextBox;16500;0    ;1500 ;423  ;BlankZero=Yes;
                                                         SourceExpr=wImpResumen[wIndice + 3] }
            { 1100217034;TextBox;13950;0    ;2250 ;423  ;SourceExpr=wCodResumen[wIndice + 3] }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
      CaptionML=[ENU=Hotel closure valoration;
                 ESP=Emision Valoracion];
    }
    CONTROLS
    {
      { 1100217000;CheckBox;3630;220  ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=ESP=Mostrar detalle coste;
                                                   SourceExpr=wDetCoste }
      { 1100217001;Label  ;220  ;220  ;3300 ;440  ;ParentControl=1100217000 }
      { 1100217002;CheckBox;3630;770  ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=ESP=Mostrar detalle ingreso;
                                                   SourceExpr=wDetIngreso }
      { 1100217003;Label  ;220  ;770  ;3300 ;440  ;ParentControl=1100217002 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text004@1103355022 : TextConst 'ENU=Must specify a closure no.;ESP=Tiene que especificar un n§ de cierre';
      Text005@1103355023 : TextConst 'ENU=Must specify only one closure No.;ESP=Tiene que especificar s¢lo un n§ de cierre';
      Text006@1103355024 : TextConst 'ENU=There is no booking summary for this closure;ESP=No hay resumen de reserva para este cierre';
      Text007@1103355025 : TextConst 'ENU=page;ESP=P gina';
      rTMPConcept@1100217002 : TEMPORARY Record 7009716;
      rEmpresa@1103355000 : Record 79;
      rDelegacion@1103355001 : Record 7009700;
      fNoms@1103355002 : Codeunit 7009702;
      rHotel@1103355003 : Record 7009724;
      rResReserva@1103355007 : Record 7009771;
      wBono_Ant@1103355008 : Code[10];
      wResp_Ant@1103355009 : Integer;
      wLineasResumen@1100217006 : Integer;
      wIndice@1100217003 : Integer;
      wDetCoste@1100217000 : Boolean;
      wDetIngreso@1100217001 : Boolean;
      wCodResumen@1100217004 : ARRAY [20] OF Code[10];
      wImpResumen@1100217005 : ARRAY [20] OF Decimal;

    LOCAL PROCEDURE _IniciaConceptos@1100217000();
    BEGIN
      // _IniciaConceptos

      rTMPConcept.RESET;
      rTMPConcept.DELETEALL;
    END;

    LOCAL PROCEDURE _AcumulaConcepto@1100217003(pwConcepto@1100217000 : Code[10];pwCosteIngreso@1100217001 : Integer;pwImporte@1100217002 : Decimal);
    BEGIN
      // _AcumulaConcepto

      IF NOT rTMPConcept.GET(pwConcepto) THEN
      BEGIN
        CLEAR(rTMPConcept);
        rTMPConcept.Concepto        := pwConcepto;
        rTMPConcept."Coste/Ingreso" := pwCosteIngreso;
        rTMPConcept.INSERT;
      END;

      rTMPConcept.Importe += pwImporte;
      rTMPConcept.MODIFY;
    END;

    LOCAL PROCEDURE _AgruparResumen@1100217001(pwTipoLineas@1100217001 : Integer);
    VAR
      lwId@1100217000 : Integer;
    BEGIN
      // _AgruparResumen

      CLEAR(wCodResumen);
      CLEAR(wImpResumen);

      wLineasResumen := 0;

      rTMPConcept.RESET;
      rTMPConcept.SETRANGE("Coste/Ingreso", pwTipoLineas);
      IF rTMPConcept.FINDSET THEN
      BEGIN
        lwId := 0;
        REPEAT
          lwId += 1;
          wCodResumen[lwId] := rTMPConcept.Concepto;
          wImpResumen[lwId] := rTMPConcept.Importe;
        UNTIL rTMPConcept.NEXT = 0;
      END;

      wLineasResumen := lwId MOD 4;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}
