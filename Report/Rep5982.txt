OBJECT Report 5982 Maintenance Performance
{
  OBJECT-PROPERTIES
  {
    Date=14/08/09;
    Time=12:00:00;
    Version List=NAVW16.00.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Maintenance Performance;
               ESP=Rendimiento mantenimiento];
    OnInitReport=BEGIN
                   CurrentDate := WORKDATE;
                 END;

    OnPreReport=BEGIN
                  ServContractFilter := "Service Contract Header".GETFILTERS;
                END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table5965;
        DataItemTableView=SORTING(Responsibility Center,Service Zone Code,Status,Contract Group Code)
                          WHERE(Status=CONST(Signed),
                                Contract Type=CONST(Contract));
        OnPreDataItem=BEGIN
                        IF CurrentDate = 0D THEN
                          ERROR(Text000);

                        CurrReport.CREATETOTALS(AnnualAmount,ExpectedAmount,ActualAmount);
                      END;

        OnAfterGetRecord=BEGIN
                           ServContractLine.SETRANGE("Contract Type","Contract Type");
                           ServContractLine.SETRANGE("Contract No.","Contract No.");
                           ServContractLine.SETFILTER("Next Planned Service Date",'<>%1',0D);
                           IF NOT ServContractLine.FIND('-') THEN
                             CurrReport.SKIP;

                           AnnualAmount := 0;
                           ExpectedAmount := 0;
                           ActualAmount := 0;

                           AnnualServices := CalcNoOfVisits("Service Period","Starting Date",0D,TRUE);
                           ExpectedServices := CalcNoOfVisits("Service Period",
                             "Starting Date",ServContractLine."Next Planned Service Date",FALSE);

                           CLEAR(ServShptHeader);
                           ServShptHeader.SETCURRENTKEY("Contract No.","Posting Date");
                           ServShptHeader.SETRANGE("Contract No.","Contract No.");
                           ServShptHeader.SETRANGE("Posting Date",StartingDate,WORKDATE);
                           ActualServices := 0;
                           IF ServShptHeader.FIND('-') THEN
                             REPEAT
                               IF (ServShptHeader."Posting Date" >= StartingDate) AND (ServShptHeader."Posting Date" <= EndingDate) THEN
                                 ActualServices := ActualServices + 1
                             UNTIL ServShptHeader.NEXT = 0;

                           IF AnnualServices > 0 THEN BEGIN
                             RoundedAmount := ROUND("Annual Amount",1);
                             AnnualAmount := AnnualAmount + RoundedAmount;
                             ExpectedAmount := ExpectedAmount + ROUND((RoundedAmount / AnnualServices) * ExpectedServices,1);
                             ActualAmount := ActualAmount + ROUND((RoundedAmount / AnnualServices) * ActualServices,1);
                           END;

                           IF AnnualAmount = 0 THEN
                             CurrReport.SKIP;

                           IF ISSERVICETIER THEN
                             IF NOT RespCenter.GET("Service Contract Header"."Responsibility Center") THEN
                               CLEAR(RespCenter);
                         END;

        ReqFilterFields=Responsibility Center;
        GroupTotalFields=Responsibility Center;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=18150;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 6   ;TextBox      ;15750;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID;
                                                         DataSetFieldName=USERID }
            { 3   ;TextBox      ;0    ;423  ;9000 ;423  ;FontName=Helvetica;
                                                         FontSize=7;
                                                         SourceExpr=COMPANYNAME;
                                                         DataSetFieldName=COMPANYNAME }
            { 5   ;Label        ;16800;423  ;750  ;423  ;ParentControl=4;
                                                         DataSetFieldName=CurrReport_PAGENOCaption }
            { 1   ;Label        ;0    ;0    ;9000 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Maintenance Performance;
                                                                    ESP=Rendimiento mantenimiento];
                                                         DataSetFieldName=Maintenance_PerformanceCaption }
            { 2   ;TextBox      ;14850;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4);
                                                         DataSetFieldName=FORMAT_TODAY_0_4_ }
            { 4   ;TextBox      ;17550;423  ;450  ;423  ;CaptionML=[ENU=Page;
                                                                    ESP=P g.];
                                                         SourceExpr=CurrReport.PAGENO;
                                                         DataSetFieldName=CurrReport_PAGENO }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=18150;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((CurrReport.PAGENO = 1) AND (ServContractFilter <> ''));
                         END;

          }
          CONTROLS
          {
            { 19  ;TextBox      ;0    ;0    ;18000;423  ;FontBold=Yes;
                                                         SourceExpr="Service Contract Header".TABLECAPTION + ': ' + ServContractFilter;
                                                         DataSetFieldName=Service_Contract_Header__TABLECAPTION__________ServContractFilter }
            { 1000000000;TextBox;18000;0    ;150  ;423  ;Name=ServContractFilter;
                                                         Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr=ServContractFilter;
                                                         DataSetFieldName=ServContractFilter }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=18150;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(CurrReport.PAGENO = 1);
                         END;

          }
          CONTROLS
          {
            { 18  ;TextBox      ;0    ;0    ;18000;423  ;HorzAlign=Left;
                                                         FontName=Helvetica;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         SourceExpr=Text001 + FORMAT(CALCDATE('<-CY>',CurrentDate)) + ' .. ' + FORMAT(CurrentDate);
                                                         DataSetFieldName=Text001___FORMAT_CALCDATE____CY___CurrentDate______________FORMAT_CurrentDate_ }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=18150;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 10  ;Label        ;14400;0    ;1200 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontName=Helvetica;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Realized %;
                                                                    ESP=% Realizado];
                                                         DataSetFieldName=Realized__Caption }
            { 9   ;Label        ;11700;0    ;2550 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontName=Helvetica;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Realized Amount;
                                                                    ESP=Importe realizado];
                                                         DataSetFieldName=Realized_AmountCaption }
            { 8   ;Label        ;9000 ;0    ;2550 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontName=Helvetica;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Expected Amount;
                                                                    ESP=Importe esperado];
                                                         DataSetFieldName=Expected_AmountCaption }
            { 7   ;Label        ;6300 ;0    ;2550 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontName=Helvetica;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Annual Amount;
                                                                    ESP=Importe anual];
                                                         DataSetFieldName=Annual_AmountCaption }
            { 12  ;Label        ;0    ;0    ;1500 ;846  ;ParentControl=11;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         DataSetFieldName=Service_Contract_Header__Responsibility_Center_Caption }
            { 14  ;Label        ;1650 ;0    ;4500 ;846  ;ParentControl=13;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         DataSetFieldName=RespCenter_NameCaption }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=0;
          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=18150;
            SectionHeight=423;
            OnPreSection=BEGIN
                           IF ExpectedAmount <> 0 THEN
                             Percent := ROUND((ActualAmount / ExpectedAmount) * 100,1)
                           ELSE
                             Percent := 0;

                           IF NOT RespCenter.GET("Service Contract Header"."Responsibility Center") THEN
                             CLEAR(RespCenter);
                         END;

          }
          CONTROLS
          {
            { 17  ;TextBox      ;14400;0    ;1200 ;423  ;HorzAlign=Right;
                                                         FontName=Helvetica;
                                                         SourceExpr=Percent;
                                                         DataSetFieldName=Percent }
            { 32  ;TextBox      ;11700;0    ;2550 ;423  ;HorzAlign=Right;
                                                         FontName=Helvetica;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=ActualAmount;
                                                         DataSetFieldName=ActualAmount }
            { 27  ;TextBox      ;9000 ;0    ;2550 ;423  ;HorzAlign=Right;
                                                         FontName=Helvetica;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=ExpectedAmount;
                                                         DataSetFieldName=ExpectedAmount }
            { 25  ;TextBox      ;6300 ;0    ;2550 ;423  ;HorzAlign=Right;
                                                         FontName=Helvetica;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=AnnualAmount;
                                                         DataSetFieldName=AnnualAmount }
            { 11  ;TextBox      ;0    ;0    ;1500 ;423  ;SourceExpr="Responsibility Center";
                                                         DataSetFieldName=Service_Contract_Header__Responsibility_Center_ }
            { 13  ;TextBox      ;1650 ;0    ;4500 ;423  ;CaptionML=[ENU=Responsibility Center Name;
                                                                    ESP=Nombre centro responsabilidad];
                                                         SourceExpr=RespCenter.Name;
                                                         DataSetFieldName=RespCenter_Name }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18150;
            SectionHeight=846;
            OnPreSection=BEGIN
                           IF ExpectedAmount <> 0 THEN
                             Percent := ROUND((ActualAmount / ExpectedAmount) * 100,1)
                           ELSE
                             Percent := 0;
                         END;

          }
          CONTROLS
          {
            { 15  ;Label        ;3600 ;423  ;2550 ;423  ;HorzAlign=Right;
                                                         VertAlign=Center;
                                                         FontName=Helvetica;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Total;
                                                                    ESP=Total];
                                                         DataSetFieldName=TotalCaption }
            { 29  ;TextBox      ;6300 ;423  ;2550 ;423  ;HorzAlign=Right;
                                                         FontName=Helvetica;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=AnnualAmount;
                                                         DataSetFieldName=AnnualAmount_Control29 }
            { 24  ;TextBox      ;9000 ;423  ;2550 ;423  ;HorzAlign=Right;
                                                         FontName=Helvetica;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=ExpectedAmount;
                                                         DataSetFieldName=ExpectedAmount_Control24 }
            { 23  ;TextBox      ;11700;423  ;2550 ;423  ;HorzAlign=Right;
                                                         FontName=Helvetica;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=ActualAmount;
                                                         DataSetFieldName=ActualAmount_Control23 }
            { 20  ;TextBox      ;14400;423  ;1200 ;423  ;HorzAlign=Right;
                                                         FontName=Helvetica;
                                                         FontBold=Yes;
                                                         SourceExpr=Percent;
                                                         DataSetFieldName=Percent_Control20 }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
      { 1   ;Label        ;0    ;0    ;3300 ;440  ;ParentControl=2 }
      { 2   ;TextBox      ;3410 ;0    ;1650 ;440  ;CaptionML=[ENU=Current Date;
                                                              ESP=Fecha actual];
                                                   SourceExpr=CurrentDate }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[ENU=Options;
                             ESP=Opciones] }

      { 2   ;2   ;Field     ;
                  CaptionML=[ENU=Current Date;
                             ESP=Fecha actual];
                  SourceExpr=CurrentDate }

    }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=You must enter the current date.;ESP=Debe introducir la fecha actual.';
      Text001@1001 : TextConst 'ENU="Service Period: ";ESP="Periodo servicio: "';
      ServContractLine@1002 : Record 5964;
      ServShptHeader@1003 : Record 5990;
      RespCenter@1004 : Record 5714;
      AnnualServices@1005 : Decimal;
      ExpectedServices@1006 : Decimal;
      ActualServices@1007 : Decimal;
      RoundedAmount@1008 : Decimal;
      AnnualAmount@1009 : Decimal;
      ExpectedAmount@1010 : Decimal;
      ActualAmount@1011 : Decimal;
      Percent@1012 : Integer;
      ServContractFilter@1013 : Text[250];
      StartingDate@1014 : Date;
      EndingDate@1015 : Date;
      CurrentDate@1016 : Date;

    PROCEDURE CalcNoOfVisits@2(ServPeriod@1000 : DateFormula;FirstDate@1001 : Date;NextServiceDate@1002 : Date;AllYear@1003 : Boolean) : Integer;
    VAR
      TempDate@1004 : Date;
      i@1005 : Integer;
    BEGIN
      IF FORMAT(ServPeriod) <> '' THEN BEGIN
        i := 0;
        StartingDate := CALCDATE('<-CY>',CurrentDate);
        IF FirstDate > StartingDate THEN
          StartingDate := FirstDate;
        IF AllYear THEN
          EndingDate := CALCDATE('<+CY>',CurrentDate)
        ELSE
          EndingDate := CurrentDate;
        TempDate := StartingDate;
        REPEAT
          IF AllYear THEN BEGIN
            IF TempDate <= EndingDate THEN
              i := i + 1;
          END ELSE BEGIN
            IF (TempDate <= EndingDate) AND (CALCDATE(ServPeriod,TempDate) <= NextServiceDate) THEN
              i := i + 1;
          END;
          TempDate := CALCDATE(ServPeriod,TempDate);
        UNTIL TempDate >= EndingDate;
        EXIT(i);
      END ELSE
        EXIT(0);
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Body>
    <Height>5.07937cm</Height>
    <ReportItems>
      <Textbox Name="textbox3">
        <Height>0.423cm</Height>
        <Left>17.55cm</Left>
        <Style>
          <FontSize>7pt</FontSize>
          <TextAlign>Right</TextAlign>
          <VerticalAlign>Middle</VerticalAlign>
        </Style>
        <Top>0.423cm</Top>
        <Value>=Fields!CurrReport_PAGENO.Value</Value>
        <Visibility>
          <Hidden>=IIF(Fields!CurrReport_PAGENOCaption.Value="",True,False)</Hidden>
        </Visibility>
        <Width>0.45cm</Width>
        <ZIndex>9</ZIndex>
      </Textbox>
      <Textbox Name="textbox4">
        <Height>0.423cm</Height>
        <Left>14.75cm</Left>
        <Style>
          <FontSize>7pt</FontSize>
          <TextAlign>Right</TextAlign>
          <VerticalAlign>Middle</VerticalAlign>
        </Style>
        <Top>0.846cm</Top>
        <Value>=Fields!USERID.Value</Value>
        <Visibility>
          <Hidden>=IIF(Fields!CurrReport_PAGENOCaption.Value="",True,False)</Hidden>
        </Visibility>
        <Width>3.25cm</Width>
        <ZIndex>8</ZIndex>
      </Textbox>
      <Textbox Name="textbox5">
        <Height>0.423cm</Height>
        <Left>14.85cm</Left>
        <Style>
          <FontSize>7pt</FontSize>
          <Format>g</Format>
          <TextAlign>Right</TextAlign>
          <VerticalAlign>Middle</VerticalAlign>
        </Style>
        <Value>=Fields!FORMAT_TODAY_0_4_.Value</Value>
        <Width>3.15cm</Width>
        <ZIndex>7</ZIndex>
      </Textbox>
      <Textbox Name="textbox6">
        <Height>0.423cm</Height>
        <Left>16.8cm</Left>
        <Style>
          <FontSize>7pt</FontSize>
          <VerticalAlign>Middle</VerticalAlign>
        </Style>
        <Top>0.423cm</Top>
        <Value>=Fields!CurrReport_PAGENOCaption.Value</Value>
        <Width>0.75cm</Width>
        <ZIndex>6</ZIndex>
      </Textbox>
      <Textbox Name="textbox1">
        <Height>0.423cm</Height>
        <Style>
          <FontSize>7pt</FontSize>
          <VerticalAlign>Middle</VerticalAlign>
        </Style>
        <Top>0.423cm</Top>
        <Value>=Fields!COMPANYNAME.Value</Value>
        <Width>9cm</Width>
        <ZIndex>5</ZIndex>
      </Textbox>
      <Textbox Name="textbox2">
        <Height>0.423cm</Height>
        <Style>
          <FontSize>8pt</FontSize>
          <FontWeight>700</FontWeight>
          <VerticalAlign>Middle</VerticalAlign>
        </Style>
        <Value>=Fields!Maintenance_PerformanceCaption.Value</Value>
        <Width>9cm</Width>
        <ZIndex>4</ZIndex>
      </Textbox>
      <Textbox Name="Service_Contract_Header__TABLECAPTION__________ServContractFilter">
        <Height>0.423cm</Height>
        <Style>
          <FontSize>7pt</FontSize>
          <FontWeight>700</FontWeight>
          <VerticalAlign>Middle</VerticalAlign>
        </Style>
        <Top>1.692cm</Top>
        <Value>=First(Fields!Service_Contract_Header__TABLECAPTION__________ServContractFilter.Value)</Value>
        <Visibility>
          <Hidden>=IIF(Fields!ServContractFilter.Value="",True,False)</Hidden>
        </Visibility>
        <Width>18cm</Width>
        <ZIndex>3</ZIndex>
      </Textbox>
      <Textbox Name="Text001___FORMAT_CALCDATE____CY___CurrentDate______________FORMAT_CurrentDate_">
        <Height>0.846cm</Height>
        <Style>
          <FontSize>7pt</FontSize>
          <FontWeight>700</FontWeight>
          <TextAlign>Left</TextAlign>
        </Style>
        <Top>2.115cm</Top>
        <Value>=First(Fields!Text001___FORMAT_CALCDATE____CY___CurrentDate______________FORMAT_CurrentDate_.Value)</Value>
        <Visibility>
          <Hidden>=IIF(Fields!CurrReport_PAGENO.Value&gt;1,True,False)</Hidden>
        </Visibility>
        <Width>18cm</Width>
        <ZIndex>2</ZIndex>
      </Textbox>
      <Textbox Name="group2">
        <CanGrow>true</CanGrow>
        <Height>0.63492cm</Height>
        <Left>16.8254cm</Left>
        <Style>
          <Color>Red</Color>
          <PaddingBottom>2pt</PaddingBottom>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>2pt</PaddingTop>
        </Style>
        <Top>3.1746cm</Top>
        <Value>=Fields!Maintenance_PerformanceCaption.Value+chr(177)+
 Fields!COMPANYNAME.Value+chr(177)+Fields!FORMAT_TODAY_0_4_.Value+chr(177)+
 Fields!CurrReport_PAGENOCaption.Value+chr(177)+Fields!Service_Contract_Header__TABLECAPTION__________ServContractFilter.Value+chr(177)+
 Fields!Text001___FORMAT_CALCDATE____CY___CurrentDate______________FORMAT_CurrentDate_.Value+chr(177)+Fields!ServContractFilter.Value</Value>
        <Visibility>
          <Hidden>true</Hidden>
        </Visibility>
        <Width>0.1cm</Width>
        <ZIndex>1</ZIndex>
      </Textbox>
      <Table Name="Table1">
        <DataSetName>DataSet_Result</DataSetName>
        <Footer>
          <TableRows>
            <TableRow>
              <Height>0.846cm</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="TextBox16">
                      <Style>
                        <PaddingBottom>2pt</PaddingBottom>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <VerticalAlign>Middle</VerticalAlign>
                      </Style>
                      <Value />
                      <ZIndex>11</ZIndex>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="TotalCaption">
                      <CanGrow>true</CanGrow>
                      <Style>
                        <FontSize>7pt</FontSize>
                        <FontWeight>700</FontWeight>
                        <PaddingBottom>2pt</PaddingBottom>
                        <PaddingLeft>2.1cm</PaddingLeft>
                        <PaddingTop>0.423cm</PaddingTop>
                        <TextAlign>Right</TextAlign>
                      </Style>
                      <Value>=First(Fields!TotalCaption.Value)</Value>
                      <ZIndex>10</ZIndex>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="AnnualAmount_Control29">
                      <CanGrow>true</CanGrow>
                      <Style>
                        <FontSize>7pt</FontSize>
                        <FontWeight>700</FontWeight>
                        <Format>=First(Fields!AnnualAmount_Control29Format.Value)</Format>
                        <PaddingBottom>2pt</PaddingBottom>
                        <PaddingLeft>0.15cm</PaddingLeft>
                        <PaddingTop>0.423cm</PaddingTop>
                        <TextAlign>Right</TextAlign>
                      </Style>
                      <Value>=Sum(Fields!AnnualAmount.Value)</Value>
                      <ZIndex>9</ZIndex>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="ExpectedAmount_Control24">
                      <CanGrow>true</CanGrow>
                      <Style>
                        <FontSize>7pt</FontSize>
                        <FontWeight>700</FontWeight>
                        <Format>=First(Fields!ExpectedAmount_Control24Format.Value)</Format>
                        <PaddingBottom>2pt</PaddingBottom>
                        <PaddingLeft>0.15cm</PaddingLeft>
                        <PaddingTop>0.423cm</PaddingTop>
                        <TextAlign>Right</TextAlign>
                      </Style>
                      <Value>=Sum(Fields!ExpectedAmount.Value)</Value>
                      <ZIndex>8</ZIndex>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="ActualAmount_Control23">
                      <CanGrow>true</CanGrow>
                      <Style>
                        <FontSize>7pt</FontSize>
                        <FontWeight>700</FontWeight>
                        <Format>=First(Fields!ActualAmount_Control23Format.Value)</Format>
                        <PaddingBottom>2pt</PaddingBottom>
                        <PaddingLeft>0.15cm</PaddingLeft>
                        <PaddingTop>0.423cm</PaddingTop>
                        <TextAlign>Right</TextAlign>
                      </Style>
                      <Value>=Sum(Fields!ActualAmount.Value)</Value>
                      <ZIndex>7</ZIndex>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox11">
                      <Style>
                        <FontSize>7pt</FontSize>
                        <FontWeight>700</FontWeight>
                        <PaddingBottom>2pt</PaddingBottom>
                        <PaddingLeft>0.15cm</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>0.423cm</PaddingTop>
                        <TextAlign>Right</TextAlign>
                      </Style>
                      <Value>=code.CalcPct(Sum(Fields!ActualAmount.Value),Sum(Fields!ExpectedAmount.Value))</Value>
                      <Visibility>
                        <Hidden>=IIF(Fields!COMPANYNAME.Value="",True,False)</Hidden>
                      </Visibility>
                      <ZIndex>6</ZIndex>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
        </Footer>
        <Header>
          <TableRows>
            <TableRow>
              <Height>0.846cm</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Service_Contract_Header__Responsibility_Center_Caption">
                      <CanGrow>true</CanGrow>
                      <Style>
                        <FontSize>7pt</FontSize>
                        <FontWeight>700</FontWeight>
                        <PaddingBottom>2pt</PaddingBottom>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <VerticalAlign>Bottom</VerticalAlign>
                      </Style>
                      <Value>=First(Fields!Service_Contract_Header__Responsibility_Center_Caption.Value)</Value>
                      <ZIndex>17</ZIndex>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="RespCenter_NameCaption">
                      <CanGrow>true</CanGrow>
                      <Style>
                        <FontSize>7pt</FontSize>
                        <FontWeight>700</FontWeight>
                        <PaddingBottom>2pt</PaddingBottom>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <VerticalAlign>Bottom</VerticalAlign>
                      </Style>
                      <Value>=First(Fields!RespCenter_NameCaption.Value)</Value>
                      <ZIndex>16</ZIndex>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Annual_AmountCaption">
                      <CanGrow>true</CanGrow>
                      <Style>
                        <FontSize>7pt</FontSize>
                        <FontWeight>700</FontWeight>
                        <PaddingBottom>2pt</PaddingBottom>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <TextAlign>Right</TextAlign>
                        <VerticalAlign>Bottom</VerticalAlign>
                      </Style>
                      <Value>=First(Fields!Annual_AmountCaption.Value)</Value>
                      <ZIndex>15</ZIndex>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Expected_AmountCaption">
                      <CanGrow>true</CanGrow>
                      <Style>
                        <FontSize>7pt</FontSize>
                        <FontWeight>700</FontWeight>
                        <PaddingBottom>2pt</PaddingBottom>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <TextAlign>Right</TextAlign>
                        <VerticalAlign>Bottom</VerticalAlign>
                      </Style>
                      <Value>=First(Fields!Expected_AmountCaption.Value)</Value>
                      <ZIndex>14</ZIndex>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Realized_AmountCaption">
                      <CanGrow>true</CanGrow>
                      <Style>
                        <FontSize>7pt</FontSize>
                        <FontWeight>700</FontWeight>
                        <PaddingBottom>2pt</PaddingBottom>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <TextAlign>Right</TextAlign>
                        <VerticalAlign>Bottom</VerticalAlign>
                      </Style>
                      <Value>=First(Fields!Realized_AmountCaption.Value)</Value>
                      <ZIndex>13</ZIndex>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Realized__Caption">
                      <CanGrow>true</CanGrow>
                      <Style>
                        <FontSize>7pt</FontSize>
                        <FontWeight>700</FontWeight>
                        <PaddingBottom>2pt</PaddingBottom>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <TextAlign>Right</TextAlign>
                        <VerticalAlign>Bottom</VerticalAlign>
                      </Style>
                      <Value>=First(Fields!Realized__Caption.Value)</Value>
                      <ZIndex>12</ZIndex>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
        </Header>
        <TableColumns>
          <TableColumn>
            <Width>1.9cm</Width>
          </TableColumn>
          <TableColumn>
            <Width>4.65cm</Width>
          </TableColumn>
          <TableColumn>
            <Width>2.7cm</Width>
          </TableColumn>
          <TableColumn>
            <Width>2.7cm</Width>
          </TableColumn>
          <TableColumn>
            <Width>2.7cm</Width>
          </TableColumn>
          <TableColumn>
            <Width>1.4cm</Width>
          </TableColumn>
        </TableColumns>
        <TableGroups>
          <TableGroup>
            <Footer>
              <TableRows>
                <TableRow>
                  <Height>0.423cm</Height>
                  <TableCells>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="Service_Contract_Header__Responsibility_Center_">
                          <Style>
                            <FontSize>7pt</FontSize>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingTop>2pt</PaddingTop>
                          </Style>
                          <Value>=First(Fields!Service_Contract_Header__Responsibility_Center_.Value)</Value>
                          <ZIndex>5</ZIndex>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="RespCenter_Name">
                          <Style>
                            <FontSize>7pt</FontSize>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingLeft>0.15cm</PaddingLeft>
                            <PaddingTop>2pt</PaddingTop>
                          </Style>
                          <Value>=First(Fields!RespCenter_Name.Value)</Value>
                          <ZIndex>4</ZIndex>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="AnnualAmount">
                          <CanGrow>true</CanGrow>
                          <Style>
                            <FontSize>7pt</FontSize>
                            <Format>=First(Fields!AnnualAmountFormat.Value)</Format>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingLeft>0.15cm</PaddingLeft>
                            <PaddingTop>2pt</PaddingTop>
                            <TextAlign>Right</TextAlign>
                          </Style>
                          <Value>=Sum(Fields!AnnualAmount.Value)</Value>
                          <ZIndex>3</ZIndex>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="ExpectedAmount">
                          <CanGrow>true</CanGrow>
                          <Style>
                            <FontSize>7pt</FontSize>
                            <Format>=First(Fields!ExpectedAmountFormat.Value)</Format>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingLeft>0.15cm</PaddingLeft>
                            <PaddingTop>2pt</PaddingTop>
                            <TextAlign>Right</TextAlign>
                          </Style>
                          <Value>=Sum(Fields!ExpectedAmount.Value)</Value>
                          <ZIndex>2</ZIndex>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="ActualAmount">
                          <CanGrow>true</CanGrow>
                          <Style>
                            <FontSize>7pt</FontSize>
                            <Format>=First(Fields!ActualAmountFormat.Value)</Format>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingLeft>0.15cm</PaddingLeft>
                            <PaddingTop>2pt</PaddingTop>
                            <TextAlign>Right</TextAlign>
                          </Style>
                          <Value>=Sum(Fields!ActualAmount.Value)</Value>
                          <ZIndex>1</ZIndex>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="Percent">
                          <Style>
                            <FontSize>7pt</FontSize>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingLeft>0.15cm</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <TextAlign>Right</TextAlign>
                          </Style>
                          <Value>=code.CalcPct(Sum(Fields!ActualAmount.Value),Sum(Fields!ExpectedAmount.Value))</Value>
                          <Visibility>
                            <Hidden>=IIF(Fields!COMPANYNAME.Value="",True,False)</Hidden>
                          </Visibility>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                  </TableCells>
                </TableRow>
              </TableRows>
            </Footer>
            <Grouping Name="Table1_Group">
              <GroupExpressions>
                <GroupExpression>=Fields!Service_Contract_Header__Responsibility_Center_.Value</GroupExpression>
              </GroupExpressions>
            </Grouping>
          </TableGroup>
        </TableGroups>
        <Top>2.961cm</Top>
        <Width>16.05cm</Width>
      </Table>
    </ReportItems>
  </Body>
  <BottomMargin>2cm</BottomMargin>
  <Code>Public Function BlankZero(ByVal Value As Decimal)
    if Value = 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankPos(ByVal Value As Decimal)
    if Value &gt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankZeroAndPos(ByVal Value As Decimal)
    if Value &gt;= 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNeg(ByVal Value As Decimal)
    if Value &lt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNegAndZero(ByVal Value As Decimal)
    if Value &lt;= 0 then
        Return ""
    end if
    Return Value
End Function

Shared Data1 as Object
Shared Data2 as Object

Public Function GetData(Num as Integer, Group as integer) as Object
  if Group = 1 then
    Return Cstr(Choose(Num, Split(Cstr(Data1),Chr(177))))
  End If
  if Group = 2 then
    Return Cstr(Choose(Num, Split(Cstr(Data2),Chr(177))))
  End If
End Function

Public Function SetData(NewData as Object,Group as integer)
  If Group = 1 and NewData &lt;&gt; "" Then
    Data1 = NewData
  End If
  If Group = 2 and NewData &lt;&gt; "" Then
    Data2 = NewData
  End If
End Function

Shared Pct as Decimal 

Public Function CalcPct(ActAmount as Decimal, ExpAmount as Decimal) as Decimal 
    if ExpAmount &lt;&gt; 0 then
       Pct = 100 * ActAmount / ExpAmount
    else
       Pct = 0
    end if

    Return ROUND(Pct)
End Function
</Code>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Query>
        <CommandText />
        <DataSourceName>DummyDataSource</DataSourceName>
      </Query>
      <Fields>
        <Field Name="USERID">
          <DataField>USERID</DataField>
        </Field>
        <Field Name="COMPANYNAME">
          <DataField>COMPANYNAME</DataField>
        </Field>
        <Field Name="CurrReport_PAGENOCaption">
          <DataField>CurrReport_PAGENOCaption</DataField>
        </Field>
        <Field Name="Maintenance_PerformanceCaption">
          <DataField>Maintenance_PerformanceCaption</DataField>
        </Field>
        <Field Name="FORMAT_TODAY_0_4_">
          <DataField>FORMAT_TODAY_0_4_</DataField>
        </Field>
        <Field Name="CurrReport_PAGENO">
          <DataField>CurrReport_PAGENO</DataField>
        </Field>
        <Field Name="Service_Contract_Header__TABLECAPTION__________ServContractFilter">
          <DataField>Service_Contract_Header__TABLECAPTION__________ServContractFilter</DataField>
        </Field>
        <Field Name="ServContractFilter">
          <DataField>ServContractFilter</DataField>
        </Field>
        <Field Name="Text001___FORMAT_CALCDATE____CY___CurrentDate______________FORMAT_CurrentDate_">
          <DataField>Text001___FORMAT_CALCDATE____CY___CurrentDate______________FORMAT_CurrentDate_</DataField>
        </Field>
        <Field Name="Realized__Caption">
          <DataField>Realized__Caption</DataField>
        </Field>
        <Field Name="Realized_AmountCaption">
          <DataField>Realized_AmountCaption</DataField>
        </Field>
        <Field Name="Expected_AmountCaption">
          <DataField>Expected_AmountCaption</DataField>
        </Field>
        <Field Name="Annual_AmountCaption">
          <DataField>Annual_AmountCaption</DataField>
        </Field>
        <Field Name="Service_Contract_Header__Responsibility_Center_Caption">
          <DataField>Service_Contract_Header__Responsibility_Center_Caption</DataField>
        </Field>
        <Field Name="RespCenter_NameCaption">
          <DataField>RespCenter_NameCaption</DataField>
        </Field>
        <Field Name="Percent">
          <DataField>Percent</DataField>
        </Field>
        <Field Name="ActualAmount">
          <DataField>ActualAmount</DataField>
        </Field>
        <Field Name="ActualAmountFormat">
          <DataField>ActualAmountFormat</DataField>
        </Field>
        <Field Name="ExpectedAmount">
          <DataField>ExpectedAmount</DataField>
        </Field>
        <Field Name="ExpectedAmountFormat">
          <DataField>ExpectedAmountFormat</DataField>
        </Field>
        <Field Name="AnnualAmount">
          <DataField>AnnualAmount</DataField>
        </Field>
        <Field Name="AnnualAmountFormat">
          <DataField>AnnualAmountFormat</DataField>
        </Field>
        <Field Name="Service_Contract_Header__Responsibility_Center_">
          <DataField>Service_Contract_Header__Responsibility_Center_</DataField>
        </Field>
        <Field Name="RespCenter_Name">
          <DataField>RespCenter_Name</DataField>
        </Field>
        <Field Name="TotalCaption">
          <DataField>TotalCaption</DataField>
        </Field>
        <Field Name="AnnualAmount_Control29Format">
          <DataField>AnnualAmount_Control29Format</DataField>
        </Field>
        <Field Name="ExpectedAmount_Control24Format">
          <DataField>ExpectedAmount_Control24Format</DataField>
        </Field>
        <Field Name="ActualAmount_Control23Format">
          <DataField>ActualAmount_Control23Format</DataField>
        </Field>
        <Field Name="Service_Contract_Header_Contract_Type">
          <DataField>Service_Contract_Header_Contract_Type</DataField>
        </Field>
        <Field Name="Service_Contract_Header_Contract_No_">
          <DataField>Service_Contract_Header_Contract_No_</DataField>
        </Field>
      </Fields>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
  <DataSources>
    <DataSource Name="DummyDataSource">
      <ConnectionProperties>
        <ConnectString />
        <DataProvider>SQL</DataProvider>
      </ConnectionProperties>
      <rd:DataSourceID>ee33e4b1-f349-403b-8933-e2cdc4244fb7</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <InteractiveHeight>11in</InteractiveHeight>
  <InteractiveWidth>8.5in</InteractiveWidth>
  <Language>=User!Language</Language>
  <LeftMargin>1.5cm</LeftMargin>
  <PageHeight>29.7cm</PageHeight>
  <PageWidth>21cm</PageWidth>
  <TopMargin>2cm</TopMargin>
  <Width>18.5cm</Width>
  <rd:DrawGrid>true</rd:DrawGrid>
  <rd:ReportID>da5b7005-12f5-48c0-a2b5-834990a354cf</rd:ReportID>
  <rd:SnapToGrid>true</rd:SnapToGrid>
</Report>
    END_OF_RDLDatA
  }
}
