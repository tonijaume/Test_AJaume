OBJECT Report 7009761 Personas en destino
{
  OBJECT-PROPERTIES
  {
    Date=14/05/14;
    Time=16:43:31;
    Modified=Yes;
    Version List=AIC2009;
  }
  PROPERTIES
  {
    CaptionML=[ENU=People in destination;
               ESP=Personas en destino];
    OnInitReport=BEGIN
                   IF NOT rEmpresa.FIND('-') THEN
                     ERROR(Text000);
                   IF NOT rDelegacion.FIND('-') THEN
                     ERROR(Text001);
                   IF NOT rParPer.FIND('-') THEN
                     ERROR(Text002);
                 END;

    OnPreReport=BEGIN
                  LimpiarVuelosDia;
                END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        MaxIteration=1;
        DataItemVarName=Pagina;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=16350;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 10  ;TextBox      ;0    ;0    ;5400 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=rEmpresa.Name }
            { 14  ;Shape        ;0    ;423  ;16350;423  ;ShapeStyle=HorzLine }
            { 52  ;Label        ;13200;0    ;3150 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=People in destination;
                                                                    ESP=Personas en destino] }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=16350;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 54  ;TextBox      ;4800 ;423  ;7050 ;423  ;HorzAlign=Center;
                                                         SourceExpr=FORMAT(TODAY,0,4) + ' / ' + FORMAT(TIME,0,0) + ' / ' + USERID }
            { 55  ;TextBox      ;13200;423  ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=Text003 + FORMAT(CurrReport.PAGENO) }
            { 56  ;Shape        ;0    ;0    ;16350;423  ;ShapeStyle=HorzLine }
            { 57  ;TextBox      ;0    ;423  ;3600 ;423  ;SourceExpr=fNoms.nom_delegacion(rDelegacion.Delegacion) }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table7009742;
        DataItemTableView=SORTING(Hotel Booking,Bono);
        NewPagePerGroup=Yes;
        OnPreDataItem=BEGIN
                        CLEAR(TabTTOO);
                        CLEAR(TabADTTOO);
                        CLEAR(TabNITTOO);

                        rPar.FINDFIRST;

                        SETFILTER("Fecha entrada", '<=%1', wDia);
                        SETFILTER("Fecha salida" , '>=%1', wDia);
                      END;

        OnAfterGetRecord=BEGIN
                           rCabRsv.GET(Delegacion, "N§ Interno");

                           //-$001IF rCabRsv.TourOperador <> rPar."TourOperador Compra" THEN

                           IF (wTOControl <> '') AND
                              (rCabRsv.TourOperador <> wTOControl) THEN //+$001
                             CurrReport.SKIP;

                           rAcom.RESET;
                           rAcom.SETRANGE(Delegacion  , Delegacion);
                           rAcom.SETRANGE("N§ Interno", "N§ Interno");
                           IF rAcom.FINDFIRST THEN
                             wPersonasReserva := rAcom.COUNT
                           ELSE
                             wPersonasReserva := 0;

                           IF Salidas.GET("Fecha salida", "Compa¤ia salida", "Vuelo salida", "IATA origen salida",
                                          "IATA destino salida") THEN BEGIN
                             Salidas."Personas en vuelo" += wPersonasReserva;
                             Salidas.MODIFY;
                           END;

                           IF Llegadas.GET("Fecha entrada", "Compa¤ia entrada", "Vuelo entrada", "IATA origen entrada",
                                          "IATA destino entrada") THEN BEGIN
                             Llegadas."Personas en vuelo" += wPersonasReserva;
                             Llegadas.MODIFY;
                           END;

                           // AJS 01.06.2005
                           // Go Caribic solicita que los paxes salgan en el listado aunque el vuelo no este marcado como completado

                           IF (NOT ControlVueloEntrada) AND ("Fecha entrada" = wDia) THEN
                             CurrReport.SKIP;

                           IF (ControlVueloSalida) AND ("Fecha salida" = wDia) THEN
                             CurrReport.SKIP;

                           IF "Hotel Booking" <> Hot_Ant THEN BEGIN
                             nAd_Hotel := 0;
                             nNi_Hotel := 0;
                             nIn_Hotel := 0;
                             nOt_Hotel := 0;
                           END;

                           Hot_Ant := "Periodo reserva"."Hotel Booking";
                           IF rCabecera.GET(Delegacion, "N§ Interno") THEN
                             rCabecera.CALCFIELDS(Paxes);
                           IF NOT Generada THEN
                             CurrReport.SKIP;

                           IF NOT paquete_tiene_hotel THEN
                             CurrReport.SKIP;
                         END;

        ReqFilterFields=Hotel Booking;
        GroupTotalFields=Hotel Booking;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=16350;
            SectionHeight=2538;
          }
          CONTROLS
          {
            { 22  ;TextBox      ;2550 ;1269 ;4200 ;423  ;SourceExpr="Hotel Booking" + ' - ' + fNoms.nom_hotel("Hotel Booking" ) }
            { 28  ;Label        ;0    ;1269 ;2400 ;423  ;ParentControl=22;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Booking Hotel;
                                                                    ESP=Hotel booking] }
            { 36  ;Label        ;150  ;1692 ;2100 ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=TourOperator;
                                                                    ESP=TourOperador] }
            { 41  ;Label        ;2400 ;1692 ;1350 ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Voucher;
                                                                    ESP=Bono] }
            { 42  ;Label        ;11700;1692 ;2700 ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Name;
                                                                    ESP=Nombre] }
            { 44  ;Label        ;14550;1692 ;750  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Age;
                                                                    ESP=Edad] }
            { 45  ;Label        ;15450;1692 ;900  ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Sex;
                                                                    ESP=Sexo] }
            { 46  ;Label        ;8850 ;1692 ;750  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Paxes;
                                                                    ESP=Paxes] }
            { 47  ;Label        ;9750 ;1692 ;900  ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Room;
                                                                    ESP=Habitaci¢n] }
            { 48  ;Label        ;10800;1692 ;750  ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Board;
                                                                    ESP=R‚gimen] }
            { 49  ;Label        ;7350 ;1692 ;1350 ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Booked hotel;
                                                                    ESP=Hotel Reservado] }
            { 50  ;Label        ;5250 ;1692 ;1200 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Check-out Date;
                                                                    ESP=Fecha salida] }
            { 51  ;Label        ;3900 ;1692 ;1200 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Check-in Date;
                                                                    ESP=Fecha entrada] }
            { 53  ;Label        ;6600 ;1692 ;600  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Stay;
                                                                    ESP=Estancia] }
            { 7   ;TextBox      ;2700 ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         SourceExpr=wDia }
            { 58  ;Label        ;0    ;0    ;2550 ;423  ;VertAlign=Bottom;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Day;
                                                                    ESP=Dia] }
            { 59  ;Label        ;0    ;423  ;2550 ;423  ;VertAlign=Bottom;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Additional filters;
                                                                    ESP=Filtros adicionales] }
            { 60  ;TextBox      ;2700 ;423  ;13650;423  ;VertAlign=Bottom;
                                                         SourceExpr="Periodo reserva".GETFILTER("Hotel Booking") }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=16350;
            SectionHeight=2538;
          }
          CONTROLS
          {
            { 24  ;TextBox      ;2550 ;1269 ;4200 ;423  ;SourceExpr="Hotel Booking" + ' - ' + fNoms.nom_hotel("Hotel Booking" ) }
            { 25  ;Label        ;0    ;1269 ;2400 ;423  ;ParentControl=24;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Booking Hotel;
                                                                    ESP=Hotel booking] }
            { 11  ;Label        ;150  ;1692 ;2100 ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=TourOperator;
                                                                    ESP=TourOperador] }
            { 13  ;Label        ;2400 ;1692 ;1350 ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Voucher;
                                                                    ESP=Bono] }
            { 15  ;Label        ;11700;1692 ;2700 ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Name;
                                                                    ESP=Nombre] }
            { 9   ;Label        ;14550;1692 ;750  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Age;
                                                                    ESP=Edad] }
            { 17  ;Label        ;15450;1692 ;900  ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Sex;
                                                                    ESP=Sexo] }
            { 19  ;Label        ;8850 ;1692 ;750  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Paxes;
                                                                    ESP=Paxes] }
            { 21  ;Label        ;9750 ;1692 ;900  ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Room;
                                                                    ESP=Habitaci¢n] }
            { 43  ;Label        ;10800;1692 ;750  ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Board;
                                                                    ESP=R‚gimen] }
            { 23  ;Label        ;7350 ;1692 ;1350 ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Booked hotel;
                                                                    ESP=Hotel Reservado] }
            { 37  ;Label        ;5250 ;1692 ;1200 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Check-out Date;
                                                                    ESP=Fecha salida] }
            { 29  ;Label        ;3900 ;1692 ;1200 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Check-in Date;
                                                                    ESP=Fecha entrada] }
            { 20  ;Label        ;6600 ;1692 ;600  ;846  ;ParentControl=18;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 61  ;TextBox      ;2700 ;423  ;13650;423  ;VertAlign=Bottom;
                                                         SourceExpr="Periodo reserva".GETFILTER("Hotel Booking") }
            { 62  ;Label        ;0    ;423  ;2550 ;423  ;VertAlign=Bottom;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Additional filters;
                                                                    ESP=Filtros adicionales] }
            { 63  ;TextBox      ;2700 ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         SourceExpr=wDia }
            { 64  ;Label        ;0    ;0    ;2550 ;423  ;VertAlign=Bottom;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Day;
                                                                    ESP=Dia] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=16350;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 26  ;TextBox      ;150  ;0    ;2100 ;423  ;SourceExpr=rCabecera."TourOperador Venta" }
            { 27  ;TextBox      ;2400 ;0    ;1350 ;423  ;SourceExpr=rCabecera.Bono }
            { 30  ;TextBox      ;11700;0    ;2700 ;423  ;SourceExpr=rCabecera.Nombre }
            { 31  ;TextBox      ;3900 ;0    ;1200 ;423  ;SourceExpr="Fecha entrada" }
            { 32  ;TextBox      ;5250 ;0    ;1200 ;423  ;SourceExpr="Fecha salida" }
            { 33  ;TextBox      ;7350 ;0    ;1350 ;423  ;SourceExpr="Hotel reservado" }
            { 34  ;TextBox      ;14550;0    ;750  ;423  ;SourceExpr=rCabecera.Edad }
            { 35  ;TextBox      ;15450;0    ;900  ;423  ;SourceExpr=STRSUBSTNO('%1', rCabecera."Tipo Persona") }
            { 38  ;TextBox      ;8850 ;0    ;750  ;423  ;HorzAlign=Right;
                                                         SourceExpr=rCabecera.Paxes }
            { 39  ;TextBox      ;9750 ;0    ;900  ;423  ;SourceExpr=Habitacion }
            { 40  ;TextBox      ;10800;0    ;750  ;423  ;SourceExpr=Regimen }
            { 18  ;TextBox      ;6600 ;0    ;600  ;423  ;SourceExpr=Estancia }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=16350;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 81  ;TextBox      ;5400 ;423  ;900  ;423  ;HorzAlign=Right;
                                                         SourceExpr=nAd_Hotel }
            { 82  ;Label        ;3750 ;423  ;1500 ;423  ;ParentControl=81;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Adults;
                                                                    ESP=Adultos] }
            { 83  ;TextBox      ;8700 ;423  ;900  ;423  ;HorzAlign=Right;
                                                         SourceExpr=nNi_Hotel }
            { 84  ;Label        ;7050 ;423  ;1500 ;423  ;ParentControl=83;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Children;
                                                                    ESP=Ni¤os] }
            { 85  ;TextBox      ;12000;423  ;900  ;423  ;HorzAlign=Right;
                                                         SourceExpr=nIn_Hotel }
            { 86  ;Label        ;10350;423  ;1500 ;423  ;ParentControl=85;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Infants;
                                                                    ESP=Infants] }
            { 87  ;TextBox      ;5400 ;846  ;900  ;423  ;HorzAlign=Right;
                                                         SourceExpr=nAd_Total }
            { 88  ;Label        ;3750 ;846  ;1500 ;423  ;ParentControl=87;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Adults;
                                                                    ESP=Adultos] }
            { 89  ;TextBox      ;8700 ;846  ;900  ;423  ;HorzAlign=Right;
                                                         SourceExpr=nNi_Total }
            { 90  ;Label        ;7050 ;846  ;1500 ;423  ;ParentControl=89;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Children;
                                                                    ESP=Ni¤os] }
            { 91  ;TextBox      ;12000;846  ;900  ;423  ;HorzAlign=Right;
                                                         SourceExpr=nIn_Total }
            { 92  ;Label        ;10350;846  ;1500 ;423  ;ParentControl=91;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Infants;
                                                                    ESP=Infants] }
            { 93  ;Label        ;450  ;423  ;3150 ;423  ;LeaderDots=Yes;
                                                         CaptionML=[ENU=Hotel accumulated;
                                                                    ESP=Acumulado Hotel] }
            { 94  ;Label        ;450  ;846  ;3150 ;423  ;LeaderDots=Yes;
                                                         CaptionML=[ENU=Total accumulated;
                                                                    ESP=Acumulado Total] }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=16350;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 76  ;TextBox      ;5400 ;423  ;900  ;423  ;SourceExpr=nAd_Hotel }
            { 75  ;Label        ;3750 ;423  ;1500 ;423  ;ParentControl=76;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Adults;
                                                                    ESP=Adultos] }
            { 78  ;TextBox      ;8700 ;423  ;900  ;423  ;SourceExpr=nNi_Hotel }
            { 77  ;Label        ;7050 ;423  ;1500 ;423  ;ParentControl=78;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Children;
                                                                    ESP=Ni¤os] }
            { 80  ;TextBox      ;12000;423  ;900  ;423  ;SourceExpr=nIn_Hotel }
            { 79  ;Label        ;10350;423  ;1500 ;423  ;ParentControl=80;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Infants;
                                                                    ESP=Infants] }
            { 68  ;TextBox      ;5400 ;846  ;900  ;423  ;SourceExpr=nAd_Total }
            { 67  ;Label        ;3750 ;846  ;1500 ;423  ;ParentControl=68;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Adults;
                                                                    ESP=Adultos] }
            { 70  ;TextBox      ;8700 ;846  ;900  ;423  ;SourceExpr=nNi_Total }
            { 69  ;Label        ;7050 ;846  ;1500 ;423  ;ParentControl=70;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Children;
                                                                    ESP=Ni¤os] }
            { 72  ;TextBox      ;12000;846  ;900  ;423  ;SourceExpr=nIn_Total }
            { 71  ;Label        ;10350;846  ;1500 ;423  ;ParentControl=72;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Infants;
                                                                    ESP=Infants] }
            { 73  ;Label        ;450  ;423  ;3150 ;423  ;LeaderDots=Yes;
                                                         CaptionML=[ENU=Hotel accumulated;
                                                                    ESP=Acumulado Hotel] }
            { 74  ;Label        ;450  ;846  ;3150 ;423  ;LeaderDots=Yes;
                                                         CaptionML=[ENU=Total accumulated;
                                                                    ESP=Acumulado Total] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table7009748;
        DataItemTableView=SORTING(Delegacion,N§ Interno,N§ Acompa¤ante);
        OnPreDataItem=BEGIN
                        wPersonasReserva := 0;
                      END;

        OnAfterGetRecord=BEGIN
                           CASE "Tipo Persona" OF
                             rParPer."Codigo Adulto": BEGIN
                               wPersonasReserva += 1;

                               nAd_Hotel := nAd_Hotel + 1;
                               nAd_Total := nAd_Total + 1;

                              SumaAdultosTouroperador("Periodo reserva"."TourOperador Venta");
                             END;
                             rParPer."Codigo Ni¤o"  : BEGIN
                               wPersonasReserva += 1;

                               nNi_Hotel := nNi_Hotel + 1;
                               nNi_Total := nNi_Total + 1;

                              SumaNi¤osTouroperador("Periodo reserva"."TourOperador Venta");
                             END;

                             rParPer."Codigo Infant": BEGIN
                               wPersonasReserva += 1;

                               nIn_Hotel := nIn_Hotel + 1;
                               nIn_Total := nIn_Total + 1;

                              SumaInfantsTouroperador("Periodo reserva"."TourOperador Venta");
                             END;
                             ELSE BEGIN
                               nOt_Hotel := nOt_Hotel + 1;
                               nOt_Total := nOt_Total + 1;
                             END;
                           END;
                         END;

        OnPostDataItem=VAR
                         lrVuelo@1103355000 : Record 7009754;
                       BEGIN
                       END;

        DataItemLink=Delegacion=FIELD(Delegacion),
                     N§ Interno=FIELD(N§ Interno);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=16350;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("N§ Acompa¤ante" > 1);
                         END;

          }
          CONTROLS
          {
            { 8   ;TextBox      ;11700;0    ;2700 ;423  ;SourceExpr=Nombre }
            { 12  ;TextBox      ;14550;0    ;750  ;423  ;SourceExpr=Edad }
            { 16  ;TextBox      ;15450;0    ;900  ;423  ;SourceExpr="Tipo Persona" }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=ResumenTouroperador;
        OnPreDataItem=BEGIN
                        CurrReport.NEWPAGE;

                        SETRANGE(Number, 1, 50);
                      END;

        OnAfterGetRecord=BEGIN
                           IF TabTTOO[Number] = '' THEN
                             CurrReport.BREAK;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=16350;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 1   ;Label        ;3150 ;846  ;3150 ;423  ;FontBold=Yes;
                                                         LeaderDots=No;
                                                         CaptionML=[ENU=Summary x Touroperator;
                                                                    ESP=Resumen x Touroperador] }
            { 2   ;Label        ;6450 ;846  ;1200 ;423  ;HorzAlign=Right;
                                                         FontBold=Yes;
                                                         LeaderDots=No;
                                                         CaptionML=[ENU=Adults;
                                                                    ESP=Adultos] }
            { 3   ;Label        ;7800 ;846  ;1200 ;423  ;HorzAlign=Right;
                                                         FontBold=Yes;
                                                         LeaderDots=No;
                                                         CaptionML=[ENU=Children;
                                                                    ESP=Ni¤os] }
            { 123 ;Label        ;9150 ;846  ;1200 ;423  ;HorzAlign=Right;
                                                         FontBold=Yes;
                                                         LeaderDots=No;
                                                         CaptionML=[ENU=Infants;
                                                                    ESP=Infants] }
            { 126 ;Label        ;10500;846  ;1200 ;423  ;HorzAlign=Right;
                                                         FontBold=Yes;
                                                         LeaderDots=No;
                                                         CaptionML=[ENU=Total;
                                                                    ESP=Total] }
            { 127 ;Label        ;2700 ;0    ;3600 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=General summary;
                                                                    ESP=Resumen General] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=16350;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 4   ;TextBox      ;6450 ;0    ;1200 ;423  ;HorzAlign=Right;
                                                         SourceExpr=TabADTTOO[Number] }
            { 5   ;TextBox      ;7800 ;0    ;1200 ;423  ;HorzAlign=Right;
                                                         SourceExpr=TabNITTOO[Number] }
            { 6   ;TextBox      ;3750 ;0    ;2550 ;423  ;SourceExpr=TabTTOO[Number] }
            { 124 ;TextBox      ;9150 ;0    ;1200 ;423  ;HorzAlign=Right;
                                                         SourceExpr=TabINFTTOO[Number] }
            { 125 ;TextBox      ;10500;0    ;1200 ;423  ;HorzAlign=Right;
                                                         SourceExpr=TabADTTOO[Number]+TabNITTOO[Number]+TabINFTTOO[Number] }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=16350;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 128 ;TextBox      ;6450 ;0    ;1200 ;423  ;SourceExpr=nAd_Total }
            { 129 ;TextBox      ;7800 ;0    ;1200 ;423  ;SourceExpr=nNi_Total }
            { 130 ;TextBox      ;9150 ;0    ;1200 ;423  ;SourceExpr=nIn_Total }
            { 131 ;TextBox      ;10500;0    ;1200 ;423  ;SourceExpr=nAd_Total + nNi_Total + nIn_Total }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table7009754;
        DataItemTableView=SORTING(Fecha,Compa¤ia,Vuelo,Origen,Destino)
                          WHERE(Entrada/Salida=CONST(Entrada));
        DataItemVarName=Llegadas;
        OnPreDataItem=BEGIN
                        SETRANGE(Fecha, wDia);

                        CurrReport.CREATETOTALS(Llegadas."Personas en vuelo");
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=16350;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 96  ;Label        ;4200 ;0    ;1500 ;846  ;ParentControl=95;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 98  ;Label        ;5850 ;0    ;1500 ;846  ;ParentControl=97;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 100 ;Label        ;7500 ;0    ;1500 ;846  ;ParentControl=99;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 102 ;Label        ;9150 ;0    ;1500 ;846  ;ParentControl=101;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 65  ;Label        ;1650 ;0    ;2400 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Arrival flights;
                                                                    ESP=Vuelos de llegada] }
            { 112 ;Label        ;10800;0    ;1500 ;846  ;ParentControl=111;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 118 ;Label        ;12450;0    ;1200 ;846  ;ParentControl=117;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=16350;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 95  ;TextBox      ;4200 ;0    ;1500 ;423  ;SourceExpr=Compa¤ia }
            { 97  ;TextBox      ;5850 ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Vuelo }
            { 99  ;TextBox      ;7500 ;0    ;1500 ;423  ;SourceExpr=Origen }
            { 101 ;TextBox      ;9150 ;0    ;1500 ;423  ;SourceExpr=Destino }
            { 111 ;TextBox      ;10800;0    ;450  ;423  ;SourceExpr="Vuelo completado" }
            { 117 ;TextBox      ;12450;0    ;1200 ;423  ;SourceExpr="Personas en vuelo" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=16350;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 119 ;TextBox      ;12450;0    ;1200 ;423  ;VertAlign=Bottom;
                                                         SourceExpr="Personas en vuelo" }
            { 121 ;Label        ;9900 ;0    ;2400 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Total Arrival;
                                                                    ESP=Totales llegada] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table7009754;
        DataItemTableView=SORTING(Fecha,Compa¤ia,Vuelo,Origen,Destino)
                          WHERE(Entrada/Salida=CONST(Salida));
        DataItemVarName=Salidas;
        OnPreDataItem=BEGIN
                        SETRANGE(Fecha, wDia);

                        CurrReport.CREATETOTALS(Salidas."Personas en vuelo");
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=16350;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 104 ;Label        ;4200 ;0    ;1500 ;846  ;ParentControl=103;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 106 ;Label        ;5850 ;0    ;1500 ;846  ;ParentControl=105;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 108 ;Label        ;7500 ;0    ;1500 ;846  ;ParentControl=107;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 110 ;Label        ;9150 ;0    ;1500 ;846  ;ParentControl=109;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 66  ;Label        ;1650 ;0    ;2400 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Departure flights;
                                                                    ESP=Vuelos de salida] }
            { 114 ;Label        ;10800;0    ;1500 ;846  ;ParentControl=115;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 116 ;Label        ;12450;0    ;1200 ;846  ;ParentControl=113;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=16350;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 103 ;TextBox      ;4200 ;0    ;1500 ;423  ;SourceExpr=Compa¤ia }
            { 105 ;TextBox      ;5850 ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Vuelo }
            { 107 ;TextBox      ;7500 ;0    ;1500 ;423  ;SourceExpr=Origen }
            { 109 ;TextBox      ;9150 ;0    ;1500 ;423  ;SourceExpr=Destino }
            { 115 ;TextBox      ;10800;0    ;450  ;423  ;SourceExpr="Vuelo completado" }
            { 113 ;TextBox      ;12450;0    ;1200 ;423  ;SourceExpr="Personas en vuelo" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=16350;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 120 ;TextBox      ;12450;0    ;1200 ;423  ;VertAlign=Bottom;
                                                         SourceExpr="Personas en vuelo" }
            { 122 ;Label        ;9900 ;0    ;2400 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Totals departure;
                                                                    ESP=Totales salida] }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=14850;
      Height=11770;
      CaptionML=[ENU=People in destination;
                 ESP=Personas en destino];
      ActiveControlOnOpen=1;
      OnOpenForm=BEGIN
                   wDia := WORKDATE;

                   RequestOptionsForm.SubVuelos.FORM.PasarFiltroFecha(wDia);
                   RequestOptionsForm.UPDATE;
                 END;

    }
    CONTROLS
    {
      { 1   ;TextBox      ;3630 ;220  ;1650 ;440  ;InPage=-1;
                                                   CaptionML=[ENU=Date;
                                                              ESP=Fecha];
                                                   SourceExpr=wDia;
                                                   OnAfterValidate=BEGIN
                                                                     {*
                                                                     rVuelos.RESET;
                                                                     rVuelos.SETRANGE(Fecha, wDia);

                                                                     CLEAR(fTabVuelos);
                                                                     fTabVuelos.SETTABLEVIEW(rVuelos);
                                                                     fTabVuelos.LOOKUPMODE(TRUE);
                                                                     fTabVuelos.RUNMODAL;
                                                                     *}

                                                                     RequestOptionsForm.SubVuelos.FORM.PasarFiltroFecha(wDia);
                                                                     RequestOptionsForm.UPDATE;
                                                                   END;
                                                                    }
      { 2   ;Label        ;220  ;220  ;3300 ;440  ;ParentControl=1 }
      { 5   ;SubForm      ;220  ;1320 ;14410;10450;Name=SubVuelos;
                                                   Editable=No;
                                                   InPage=-1;
                                                   Border=No;
                                                   SubFormID=Form7009888 }
      { 1100217000;TextBox;3630 ;770  ;2310 ;440  ;CaptionML=[ENU=Touroperator;
                                                              ESP=Touroperador];
                                                   SourceExpr=wTOControl;
                                                   TableRelation=TourOperador;
                                                   OnAfterValidate=BEGIN
                                                                     {*
                                                                     rVuelos.RESET;
                                                                     rVuelos.SETRANGE(Fecha, wDia);

                                                                     CLEAR(fTabVuelos);
                                                                     fTabVuelos.SETTABLEVIEW(rVuelos);
                                                                     fTabVuelos.LOOKUPMODE(TRUE);
                                                                     fTabVuelos.RUNMODAL;
                                                                     *}

                                                                     RequestOptionsForm.SubVuelos.FORM.PasarFiltroFecha(wDia);
                                                                     RequestOptionsForm.UPDATE;
                                                                   END;
                                                                    }
      { 1100217001;Label  ;220  ;770  ;3300 ;440  ;ParentControl=1100217000;
                                                   InPage=-1 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text000@1103355030 : TextConst 'ENU=There is any company;ESP=No hay ninguna empresa';
      Text001@1103355031 : TextConst 'ENU=Agency parameters do not exist;ESP=No existen par metros de agencia';
      Text002@1103355032 : TextConst 'ENU=Person parameters do not exist;ESP=No existe par metros persona';
      Text003@1103355033 : TextConst 'ENU=page;ESP=P gina';
      rEmpresa@1103355000 : Record 79;
      rDelegacion@1103355001 : Record 7009700;
      rPeriodo@1103355002 : Record 7009742;
      rCabecera@1103355003 : Record 7009741;
      rAcom@1103355004 : Record 7009748;
      rVuelos@1103355005 : Record 7009754;
      rParPer@1103355006 : Record 7009701;
      rPar@1103355007 : Record 7009700;
      rCabRsv@1103355008 : Record 7009741;
      fNoms@1103355009 : Codeunit 7009702;
      fTabVuelos@1103355010 : Form 7009799;
      wTOControl@1100217000 : Code[10];
      wDia@1103355011 : Date;
      wIncluirEntradas@1103355012 : Boolean;
      wIncluirSalidas@1103355013 : Boolean;
      wTipoListado@1103355014 : 'Solo dia,Con Entradas,Con Salidas,Con Entradas-Salidas';
      Hot_Ant@1103355015 : Code[20];
      TabTTOO@1103355016 : ARRAY [50] OF Code[10];
      nAd_Hotel@1103355017 : Integer;
      nNi_Hotel@1103355018 : Integer;
      nIn_Hotel@1103355019 : Integer;
      nOt_Hotel@1103355020 : Integer;
      nAd_Total@1103355021 : Integer;
      nNi_Total@1103355022 : Integer;
      nIn_Total@1103355023 : Integer;
      nOt_Total@1103355024 : Integer;
      TabADTTOO@1103355025 : ARRAY [50] OF Integer;
      TabNITTOO@1103355026 : ARRAY [50] OF Integer;
      TabINFTTOO@1103355027 : ARRAY [50] OF Integer;
      wIndice@1103355028 : Integer;
      wPersonasReserva@1103355029 : Integer;

    PROCEDURE paquete_tiene_hotel@1() : Boolean;
    VAR
      lrPaqProd@1103355000 : Record 7009752;
    BEGIN
      // paquete_tiene_hotel

      lrPaqProd.SETRANGE(Paquete        , "Periodo reserva".Paquete);
      lrPaqProd.SETRANGE("Tipo Producto", lrPaqProd."Tipo Producto"::Hotel);
      EXIT(lrPaqProd.FINDFIRST);
    END;

    PROCEDURE SumaAdultosTouroperador@2(pwTTOO@1103355000 : Code[10]);
    BEGIN
      // SumaAdultosTouroperador

      wIndice := 0;

      REPEAT
        wIndice += 1;

        IF TabTTOO[wIndice] = '' THEN
          TabTTOO[wIndice] := pwTTOO;
      UNTIL TabTTOO[wIndice] = pwTTOO;

      TabADTTOO[wIndice] += 1;
    END;

    PROCEDURE SumaNi¤osTouroperador@3(pwTTOO@1103355000 : Code[10]);
    BEGIN
      // SumaNi¤osTouroperador

      wIndice := 0;

      REPEAT
        wIndice += 1;

        IF TabTTOO[wIndice] = '' THEN
          TabTTOO[wIndice] := pwTTOO;
      UNTIL TabTTOO[wIndice] = pwTTOO;

      TabNITTOO[wIndice] += 1;
    END;

    PROCEDURE SumaInfantsTouroperador@5(pwTTOO@1103355000 : Code[10]);
    BEGIN
      // SumaInfantsTouroperador

      wIndice := 0;

      REPEAT
        wIndice += 1;

        IF TabTTOO[wIndice] = '' THEN
          TabTTOO[wIndice] := pwTTOO;
      UNTIL TabTTOO[wIndice] = pwTTOO;

      TabINFTTOO[wIndice] += 1;
    END;

    PROCEDURE ControlVueloEntrada@4() : Boolean;
    VAR
      lrVuelo@1103355000 : Record 7009754;
    BEGIN
      // ControlVueloEntrada

      WITH "Periodo reserva" DO BEGIN

        // AJS 13.07.2005
        // Si la linea no tiene vuelo de entrada tiene que salir cuando todos los vuelos de entrada estan completados

        IF "Vuelo entrada" = '' THEN BEGIN
          lrVuelo.RESET;
          lrVuelo.SETRANGE(Fecha             , "Fecha entrada");
          lrVuelo.SETRANGE("Entrada/Salida"  , lrVuelo."Entrada/Salida"::Entrada);
          lrVuelo.SETRANGE("Vuelo completado", FALSE);
          IF lrVuelo.FINDFIRST THEN
            EXIT(FALSE)
          ELSE
            EXIT(TRUE);
        END;

        IF lrVuelo.GET("Fecha entrada", "Compa¤ia entrada", "Vuelo entrada", "IATA origen entrada", "IATA destino entrada") THEN
          EXIT(lrVuelo."Vuelo completado")
        ELSE
          EXIT(TRUE);
      END;
    END;

    PROCEDURE ControlVueloSalida@6() : Boolean;
    VAR
      lrVuelo@1103355000 : Record 7009754;
    BEGIN
      // ControlVueloSalida

      WITH "Periodo reserva" DO BEGIN

        // Si la linea no tiene vuelo de salida siempre saldra en el informe

        IF "Vuelo salida" = '' THEN BEGIN

          // AJS 13.07.2005
          // Los que no tienen vuelo de salida dejaran de salir si todos los vuelos de salida del dia estan completados

          lrVuelo.RESET;
          lrVuelo.SETRANGE(Fecha             , "Fecha salida");
          lrVuelo.SETRANGE("Entrada/Salida"  , lrVuelo."Entrada/Salida"::Salida);
          lrVuelo.SETRANGE("Vuelo completado", FALSE);
          IF lrVuelo.FINDFIRST THEN
            EXIT(FALSE)
          ELSE
            EXIT(TRUE);
        END;

        IF lrVuelo.GET("Fecha salida", "Compa¤ia salida", "Vuelo salida", "IATA origen salida", "IATA destino salida") THEN
          EXIT(lrVuelo."Vuelo completado")
        ELSE
          EXIT(TRUE);
      END;
    END;

    PROCEDURE LimpiarVuelosDia@9();
    VAR
      lrPlanVuelo@1103355000 : Record 7009754;
    BEGIN
      // LimpiarVuelosDia

      lrPlanVuelo.RESET;
      lrPlanVuelo.SETRANGE(Fecha, wDia);
      IF lrPlanVuelo.FINDSET(TRUE) THEN
        lrPlanVuelo.MODIFYALL("Personas en vuelo", 0);
    END;

    BEGIN
    {
      ## AJF 29/06/09

        .- (09/00319) cambio c¢digos de hotel de code10 a code20.

      $001 AJS 14052014 Nueva opcion para indicar el touroperador de control, no funcionar con el parametro fijo
    }
    END.
  }
  RDLDATA
  {
  }
}
