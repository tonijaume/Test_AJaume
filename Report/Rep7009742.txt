OBJECT Report 7009742 Resumen operaciones
{
  OBJECT-PROPERTIES
  {
    Date=14/04/14;
    Time=11:11:47;
    Modified=Yes;
    Version List=AIC2009;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Operations summary;
               ESP=Resumen operaciones];
    OnPreReport=BEGIN
                  rEmp.FINDFIRST;
                  rPar.FINDFIRST;
                  rParPer.FINDFIRST;
                  rParInt.FINDFIRST;
                END;

    Orientation=Landscape;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table7009742;
        DataItemTableView=SORTING(Delegacion,TourOperador Venta,Zona hotel,Hotel Booking,Fecha entrada);
        OnPreDataItem=BEGIN
                        IF w_dia_desde = 0D THEN
                          ERROR(Text004);

                        CLEAR(w_ad_entrada);
                        CLEAR(w_ni_entrada);
                        CLEAR(w_ele_entrada);
                        CLEAR(w_ad_salida);
                        CLEAR(w_ni_salida);
                        CLEAR(w_ele_salida);
                        CLEAR(w_ad_estancia);
                        CLEAR(w_ni_estancia);
                        CLEAR(w_ele_estancia);
                        i_hotel    := 1;
                        i_transfer := 2;
                        i_ht       := 3;

                        w_ant_zona := '';
                        w_ant_hotel := '';
                        w_ant_to := '';

                        IF NOT imprimir_to THEN
                          SETCURRENTKEY(Delegacion,
                                        "Zona hotel",
                                        "Hotel Booking",
                                        "Fecha entrada");
                        SETFILTER("Fecha entrada", '<=%1', w_dia_hasta);
                        SETFILTER("Fecha salida" , '>=%1', w_dia_desde);

                        //+$001
                        IF w_paquete <> '' THEN
                          wTipoPaquetePar := _GetTipoPaquete(w_paquete);
                      END;

        OnAfterGetRecord=BEGIN
                           IF (w_paquete <> '') AND (w_paquete <> Paquete) THEN
                             CurrReport.SKIP;

                           IF "Hotel Booking" <> w_ant_hotel THEN BEGIN
                             CLEAR(w_ad_entrada_hotel);
                             CLEAR(w_ni_entrada_hotel);
                             CLEAR(w_ele_entrada_hotel);
                             CLEAR(w_ad_salida_hotel);
                             CLEAR(w_ni_salida_hotel);
                             CLEAR(w_ele_salida_hotel);
                             CLEAR(w_ad_estancia_hotel);
                             CLEAR(w_ni_estancia_hotel);
                             CLEAR(w_ele_estancia_hotel);
                             w_ant_hotel := "Hotel Booking";
                           END;
                           IF "Zona hotel" <> w_ant_zona THEN BEGIN
                             CLEAR(w_ad_entrada_hotel);
                             CLEAR(w_ni_entrada_hotel);
                             CLEAR(w_ele_entrada_hotel);
                             CLEAR(w_ad_salida_hotel);
                             CLEAR(w_ni_salida_hotel);
                             CLEAR(w_ele_salida_hotel);
                             CLEAR(w_ad_estancia_hotel);
                             CLEAR(w_ni_estancia_hotel);
                             CLEAR(w_ele_estancia_hotel);

                             CLEAR(w_ad_entrada_zona);
                             CLEAR(w_ni_entrada_zona);
                             CLEAR(w_ele_entrada_zona);
                             CLEAR(w_ad_salida_zona);
                             CLEAR(w_ni_salida_zona);
                             CLEAR(w_ele_salida_zona);
                             CLEAR(w_ad_estancia_zona);
                             CLEAR(w_ni_estancia_zona);
                             CLEAR(w_ele_estancia_zona);
                             w_ant_zona := "Zona hotel";
                           END;
                           IF "TourOperador Venta" <> w_ant_to THEN BEGIN
                             CLEAR(w_ad_entrada_to);
                             CLEAR(w_ni_entrada_to);
                             CLEAR(w_ele_entrada_to);
                             CLEAR(w_ad_salida_to);
                             CLEAR(w_ni_salida_to);
                             CLEAR(w_ele_salida_to);
                             CLEAR(w_ad_estancia_to);
                             CLEAR(w_ni_estancia_to);
                             CLEAR(w_ele_estancia_to);
                             w_ant_to := "TourOperador Venta";
                             IF imprimir_to THEN BEGIN
                               CLEAR(w_ad_entrada_hotel);
                               CLEAR(w_ni_entrada_hotel);
                               CLEAR(w_ele_entrada_hotel);
                               CLEAR(w_ad_salida_hotel);
                               CLEAR(w_ni_salida_hotel);
                               CLEAR(w_ele_salida_hotel);
                               CLEAR(w_ad_estancia_hotel);
                               CLEAR(w_ni_estancia_hotel);
                               CLEAR(w_ele_estancia_hotel);

                               CLEAR(w_ad_entrada_zona);
                               CLEAR(w_ni_entrada_zona);
                               CLEAR(w_ele_entrada_zona);
                               CLEAR(w_ad_salida_zona);
                               CLEAR(w_ni_salida_zona);
                               CLEAR(w_ele_salida_zona);
                               CLEAR(w_ad_estancia_zona);
                               CLEAR(w_ni_estancia_zona);
                               CLEAR(w_ele_estancia_zona);
                               w_ant_zona := "Zona hotel";
                             END;
                           END;
                           w_ad_rsv  := 0;
                           w_ni_rsv  := 0;
                           w_ele_rsv := 0;
                           w_if_rsv  := 0;

                           cuenta_personas(w_ad_rsv, w_ni_rsv, w_if_rsv, w_ele_rsv);

                           wTipoPaquete := _GetTipoPaquete(Paquete); //+$001

                           IF ("Fecha entrada" >= w_dia_desde) AND ("Fecha entrada" <= w_dia_hasta) THEN BEGIN
                             IF (wTipoPaquete = wTipoPaquete::SoloHotel) AND
                                ((w_paquete = '') OR (wTipoPaquetePar = wTipoPaquetePar::SoloHotel)) THEN
                             BEGIN
                               w_ad_entrada_hotel[i_hotel]  := w_ad_entrada_hotel[i_hotel] + w_ad_rsv;
                               w_ni_entrada_hotel[i_hotel]  := w_ni_entrada_hotel[i_hotel] + w_ni_rsv;
                               w_ele_entrada_hotel[i_hotel] := w_ele_entrada_hotel[i_hotel] + w_ele_rsv;
                               w_ad_entrada_zona[i_hotel]   := w_ad_entrada_zona[i_hotel] + w_ad_rsv;
                               w_ni_entrada_zona[i_hotel]   := w_ni_entrada_zona[i_hotel] + w_ni_rsv;
                               w_ele_entrada_zona[i_hotel]  := w_ele_entrada_zona[i_hotel] + w_ele_rsv;
                               w_ad_entrada_to[i_hotel]     := w_ad_entrada_to[i_hotel] + w_ad_rsv;
                               w_ni_entrada_to[i_hotel]     := w_ni_entrada_to[i_hotel] + w_ni_rsv;
                               w_ele_entrada_to[i_hotel]    := w_ele_entrada_to[i_hotel] + w_ele_rsv;
                               w_ad_entrada[i_hotel]        := w_ad_entrada[i_hotel] + w_ad_rsv;
                               w_ni_entrada[i_hotel]        := w_ni_entrada[i_hotel] + w_ni_rsv;
                               w_ele_entrada[i_hotel]       := w_ele_entrada[i_hotel] + w_ele_rsv;
                             END;

                             IF (wTipoPaquete = wTipoPaquete::SoloTransfer) AND
                                ((w_paquete = '') OR (wTipoPaquetePar = wTipoPaquetePar::SoloTransfer)) THEN
                             BEGIN
                               w_ad_entrada_hotel[i_transfer]  := w_ad_entrada_hotel[i_transfer] + w_ad_rsv;
                               w_ni_entrada_hotel[i_transfer]  := w_ni_entrada_hotel[i_transfer] + w_ni_rsv;
                               w_ele_entrada_hotel[i_transfer] := w_ele_entrada_hotel[i_transfer] + w_ele_rsv;
                               w_ad_entrada_zona[i_transfer]   := w_ad_entrada_zona[i_transfer] + w_ad_rsv;
                               w_ni_entrada_zona[i_transfer]   := w_ni_entrada_zona[i_transfer] + w_ni_rsv;
                               w_ele_entrada_zona[i_transfer]  := w_ele_entrada_zona[i_transfer] + w_ele_rsv;
                               w_ad_entrada_to[i_transfer]     := w_ad_entrada_to[i_transfer] + w_ad_rsv;
                               w_ni_entrada_to[i_transfer]     := w_ni_entrada_to[i_transfer] + w_ni_rsv;
                               w_ele_entrada_to[i_transfer]    := w_ele_entrada_to[i_transfer] + w_ele_rsv;
                               w_ad_entrada[i_transfer]        := w_ad_entrada[i_transfer] + w_ad_rsv;
                               w_ni_entrada[i_transfer]        := w_ni_entrada[i_transfer] + w_ni_rsv;
                               w_ele_entrada[i_transfer]       := w_ele_entrada[i_transfer] + w_ele_rsv;
                             END;

                             IF (wTipoPaquete = wTipoPaquete::"H+T") AND
                                ((w_paquete = '') OR (wTipoPaquetePar = wTipoPaquetePar::"H+T")) THEN
                             BEGIN
                               w_ad_entrada_hotel[i_ht]  := w_ad_entrada_hotel[i_ht] + w_ad_rsv;
                               w_ni_entrada_hotel[i_ht]  := w_ni_entrada_hotel[i_ht] + w_ni_rsv;
                               w_ele_entrada_hotel[i_ht] := w_ele_entrada_hotel[i_ht] + w_ele_rsv;
                               w_ad_entrada_zona[i_ht]   := w_ad_entrada_zona[i_ht] + w_ad_rsv;
                               w_ni_entrada_zona[i_ht]   := w_ni_entrada_zona[i_ht] + w_ni_rsv;
                               w_ele_entrada_zona[i_ht]  := w_ele_entrada_zona[i_ht] + w_ele_rsv;
                               w_ad_entrada_to[i_ht]     := w_ad_entrada_to[i_ht] + w_ad_rsv;
                               w_ni_entrada_to[i_ht]     := w_ni_entrada_to[i_ht] + w_ni_rsv;
                               w_ele_entrada_to[i_ht]    := w_ele_entrada_to[i_ht] + w_ele_rsv;
                               w_ad_entrada[i_ht]        := w_ad_entrada[i_ht] + w_ad_rsv;
                               w_ni_entrada[i_ht]        := w_ni_entrada[i_ht] + w_ni_rsv;
                               w_ele_entrada[i_ht]       := w_ele_entrada[i_ht] + w_ele_rsv;
                             END;
                           END;

                           IF ("Fecha salida" >= w_dia_desde) AND ("Fecha salida" <= w_dia_hasta) THEN BEGIN
                             IF (wTipoPaquete = wTipoPaquete::SoloHotel) AND
                                ((w_paquete = '') OR (wTipoPaquetePar = wTipoPaquetePar::SoloHotel)) THEN
                             BEGIN
                               w_ad_salida_hotel[i_hotel]  := w_ad_salida_hotel[i_hotel] + w_ad_rsv;
                               w_ni_salida_hotel[i_hotel]  := w_ni_salida_hotel[i_hotel] + w_ni_rsv;
                               w_ele_salida_hotel[i_hotel] := w_ele_salida_hotel[i_hotel] + w_ele_rsv;
                               w_ad_salida_zona[i_hotel]   := w_ad_salida_zona[i_hotel] + w_ad_rsv;
                               w_ni_salida_zona[i_hotel]   := w_ni_salida_zona[i_hotel] + w_ni_rsv;
                               w_ele_salida_zona[i_hotel]  := w_ele_salida_zona[i_hotel] + w_ele_rsv;
                               w_ad_salida_to[i_hotel]     := w_ad_salida_to[i_hotel] + w_ad_rsv;
                               w_ni_salida_to[i_hotel]     := w_ni_salida_to[i_hotel] + w_ni_rsv;
                               w_ele_salida_to[i_hotel]    := w_ele_salida_to[i_hotel] + w_ele_rsv;
                               w_ad_salida[i_hotel]        := w_ad_salida[i_hotel] + w_ad_rsv;
                               w_ni_salida[i_hotel]        := w_ni_salida[i_hotel] + w_ni_rsv;
                               w_ele_salida[i_hotel]       := w_ele_salida[i_hotel] + w_ele_rsv;
                             END;

                             IF (wTipoPaquete = wTipoPaquete::SoloTransfer) AND
                                ((w_paquete = '') OR (wTipoPaquetePar = wTipoPaquetePar::SoloTransfer)) THEN
                             BEGIN
                               w_ad_salida_hotel[i_transfer]  := w_ad_salida_hotel[i_transfer] + w_ad_rsv;
                               w_ni_salida_hotel[i_transfer]  := w_ni_salida_hotel[i_transfer] + w_ni_rsv;
                               w_ele_salida_hotel[i_transfer] := w_ele_salida_hotel[i_transfer] + w_ele_rsv;
                               w_ad_salida_zona[i_transfer]   := w_ad_salida_zona[i_transfer] + w_ad_rsv;
                               w_ni_salida_zona[i_transfer]   := w_ni_salida_zona[i_transfer] + w_ni_rsv;
                               w_ele_salida_zona[i_transfer]  := w_ele_salida_zona[i_transfer] + w_ele_rsv;
                               w_ad_salida_to[i_transfer]     := w_ad_salida_to[i_transfer] + w_ad_rsv;
                               w_ni_salida_to[i_transfer]     := w_ni_salida_to[i_transfer] + w_ni_rsv;
                               w_ele_salida_to[i_transfer]    := w_ele_salida_to[i_transfer] + w_ele_rsv;
                               w_ad_salida[i_transfer]        := w_ad_salida[i_transfer] + w_ad_rsv;
                               w_ni_salida[i_transfer]        := w_ni_salida[i_transfer] + w_ni_rsv;
                               w_ele_salida[i_transfer]       := w_ele_salida[i_transfer] + w_ele_rsv;
                             END;

                             IF (wTipoPaquete = wTipoPaquete::"H+T") AND
                                ((w_paquete = '') OR (wTipoPaquetePar = wTipoPaquetePar::"H+T")) THEN
                             BEGIN
                               w_ad_salida_hotel[i_ht]  := w_ad_salida_hotel[i_ht] + w_ad_rsv;
                               w_ni_salida_hotel[i_ht]  := w_ni_salida_hotel[i_ht] + w_ni_rsv;
                               w_ele_salida_hotel[i_ht] := w_ele_salida_hotel[i_ht] + w_ele_rsv;
                               w_ad_salida_zona[i_ht]   := w_ad_salida_zona[i_ht] + w_ad_rsv;
                               w_ni_salida_zona[i_ht]   := w_ni_salida_zona[i_ht] + w_ni_rsv;
                               w_ele_salida_zona[i_ht]  := w_ele_salida_zona[i_ht] + w_ele_rsv;
                               w_ad_salida_to[i_ht]     := w_ad_salida_to[i_ht] + w_ad_rsv;
                               w_ni_salida_to[i_ht]     := w_ni_salida_to[i_ht] + w_ni_rsv;
                               w_ele_salida_to[i_ht]    := w_ele_salida_to[i_ht] + w_ele_rsv;
                               w_ad_salida[i_ht]        := w_ad_salida[i_ht] + w_ad_rsv;
                               w_ni_salida[i_ht]        := w_ni_salida[i_ht] + w_ni_rsv;
                               w_ele_salida[i_ht]       := w_ele_salida[i_ht] + w_ele_rsv;
                             END;
                           END;

                           IF "Fecha salida" <> w_dia_hasta THEN BEGIN
                             IF (wTipoPaquete = wTipoPaquete::SoloHotel) AND
                                ((w_paquete = '') OR (wTipoPaquetePar = wTipoPaquetePar::SoloHotel)) THEN
                             BEGIN
                               w_ad_estancia_hotel[i_hotel]  := w_ad_estancia_hotel[i_hotel] + w_ad_rsv;
                               w_ni_estancia_hotel[i_hotel]  := w_ni_estancia_hotel[i_hotel] + w_ni_rsv;
                               w_ele_estancia_hotel[i_hotel] := w_ele_estancia_hotel[i_hotel] + w_ele_rsv;
                               w_ad_estancia_zona[i_hotel]   := w_ad_estancia_zona[i_hotel] + w_ad_rsv;
                               w_ni_estancia_zona[i_hotel]   := w_ni_estancia_zona[i_hotel] + w_ni_rsv;
                               w_ele_estancia_zona[i_hotel]  := w_ele_estancia_zona[i_hotel] + w_ele_rsv;
                               w_ad_estancia_to[i_hotel]     := w_ad_estancia_to[i_hotel] + w_ad_rsv;
                               w_ni_estancia_to[i_hotel]     := w_ni_estancia_to[i_hotel] + w_ni_rsv;
                               w_ele_estancia_to[i_hotel]    := w_ele_estancia_to[i_hotel] + w_ele_rsv;
                               w_ad_estancia[i_hotel]        := w_ad_estancia[i_hotel] + w_ad_rsv;
                               w_ni_estancia[i_hotel]        := w_ni_estancia[i_hotel] + w_ni_rsv;
                               w_ele_estancia[i_hotel]       := w_ele_estancia[i_hotel] + w_ele_rsv;
                             END;

                             IF (wTipoPaquete = wTipoPaquete::SoloTransfer) AND
                                ((w_paquete = '') OR (wTipoPaquetePar = wTipoPaquetePar::SoloTransfer)) THEN
                             BEGIN
                               w_ad_estancia_hotel[i_transfer]  := w_ad_estancia_hotel[i_transfer] + w_ad_rsv;
                               w_ni_estancia_hotel[i_transfer]  := w_ni_estancia_hotel[i_transfer] + w_ni_rsv;
                               w_ele_estancia_hotel[i_transfer] := w_ele_estancia_hotel[i_transfer] + w_ele_rsv;
                               w_ad_estancia_zona[i_transfer]   := w_ad_estancia_zona[i_transfer] + w_ad_rsv;
                               w_ni_estancia_zona[i_transfer]   := w_ni_estancia_zona[i_transfer] + w_ni_rsv;
                               w_ele_estancia_zona[i_transfer]  := w_ele_estancia_zona[i_transfer] + w_ele_rsv;
                               w_ad_estancia_to[i_transfer]     := w_ad_estancia_to[i_transfer] + w_ad_rsv;
                               w_ni_estancia_to[i_transfer]     := w_ni_estancia_to[i_transfer] + w_ni_rsv;
                               w_ele_estancia_to[i_transfer]    := w_ele_estancia_to[i_transfer] + w_ele_rsv;
                               w_ad_estancia[i_transfer]        := w_ad_estancia[i_transfer] + w_ad_rsv;
                               w_ni_estancia[i_transfer]        := w_ni_estancia[i_transfer] + w_ni_rsv;
                               w_ele_estancia[i_transfer]       := w_ele_estancia[i_transfer] + w_ele_rsv;
                             END;

                             IF (wTipoPaquete = wTipoPaquete::"H+T") AND
                                ((w_paquete = '') OR (wTipoPaquetePar = wTipoPaquetePar::"H+T")) THEN
                             BEGIN
                               w_ad_estancia_hotel[i_ht]  := w_ad_estancia_hotel[i_ht] + w_ad_rsv;
                               w_ni_estancia_hotel[i_ht]  := w_ni_estancia_hotel[i_ht] + w_ni_rsv;
                               w_ele_estancia_hotel[i_ht] := w_ele_estancia_hotel[i_ht] + w_ele_rsv;
                               w_ad_estancia_zona[i_ht]   := w_ad_estancia_zona[i_ht] + w_ad_rsv;
                               w_ni_estancia_zona[i_ht]   := w_ni_estancia_zona[i_ht] + w_ni_rsv;
                               w_ele_estancia_zona[i_ht]  := w_ele_estancia_zona[i_ht] + w_ele_rsv;
                               w_ad_estancia_to[i_ht]     := w_ad_estancia_to[i_ht] + w_ad_rsv;
                               w_ni_estancia_to[i_ht]     := w_ni_estancia_to[i_ht] + w_ni_rsv;
                               w_ele_estancia_to[i_ht]    := w_ele_estancia_to[i_ht] + w_ele_rsv;
                               w_ad_estancia[i_ht]        := w_ad_estancia[i_ht] + w_ad_rsv;
                               w_ni_estancia[i_ht]        := w_ni_estancia[i_ht] + w_ni_rsv;
                               w_ele_estancia[i_ht]       := w_ele_estancia[i_ht] + w_ele_rsv;
                             END;
                           END;
                         END;

        ReqFilterFields=Hotel Booking;
        GroupTotalFields=Delegacion,TourOperador Venta,Zona hotel,Hotel Booking;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=24200;
            SectionHeight=2538;
          }
          CONTROLS
          {
            { 1   ;TextBox      ;0    ;0    ;5400 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=rEmp.Name }
            { 2   ;Label        ;19500;0    ;4650 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Operations summary;
                                                                    ESP=Resumen operaciones] }
            { 3   ;Shape        ;0    ;423  ;24150;423  ;ShapeStyle=HorzLine }
            { 23  ;Label        ;0    ;1269 ;1800 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Dates;
                                                                    ESP=Fechas] }
            { 24  ;TextBox      ;1950 ;1269 ;1500 ;423  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         SourceExpr=w_dia_desde }
            { 25  ;Label        ;0    ;1692 ;1800 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Package;
                                                                    ESP=Paquete] }
            { 26  ;TextBox      ;1950 ;1692 ;1800 ;423  ;VertAlign=Bottom;
                                                         SourceExpr=w_paquete }
            { 28  ;TextBox      ;3600 ;1269 ;1500 ;423  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         SourceExpr=w_dia_hasta }
            { 61  ;Label        ;5400 ;1269 ;2000 ;1269 ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=People check-out Hotel;
                                                                    ESP=Personas Salida Hotel] }
            { 62  ;Label        ;7500 ;1269 ;2000 ;1269 ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=People check-in Hotel;
                                                                    ESP=Personas Entrada Hotel] }
            { 63  ;Label        ;9600 ;1269 ;2000 ;1269 ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=People Stay Hotel;
                                                                    ESP=Personas Estancia Hotel] }
            { 65  ;Label        ;11700;1269 ;2000 ;1269 ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=People check-out Transfer;
                                                                    ESP=Personas Salida Transfer] }
            { 67  ;Label        ;13800;1269 ;2000 ;1269 ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=People check-in Transfer;
                                                                    ESP=Personas Entrada Transfer] }
            { 68  ;Label        ;15900;1269 ;2000 ;1269 ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=People stay Transfer;
                                                                    ESP=Personas Estancia Transfer] }
            { 70  ;Label        ;18000;1269 ;2000 ;1269 ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=People check-out H+T;
                                                                    ESP=Personas Salida  H+T] }
            { 71  ;Label        ;20100;1269 ;2000 ;1269 ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=People check-in H+T;
                                                                    ESP=Personas Entrada H+T] }
            { 72  ;Label        ;22200;1269 ;2000 ;1269 ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=People stay H+T;
                                                                    ESP=Personas Estancia H+T] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=24200;
            SectionHeight=0;
          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=24200;
            SectionHeight=423;
            OnPreSection=BEGIN
                           imprimir := FALSE;
                           IF (w_ad_entrada_hotel[i_hotel] <> 0) OR (w_ni_entrada_hotel[i_hotel] <> 0) OR (w_ad_salida_hotel[i_hotel] <> 0) OR
                              (w_ni_salida_hotel[i_hotel] <> 0) OR (w_ad_estancia_hotel[i_hotel] <> 0) OR (w_ni_estancia_hotel[i_hotel] <> 0) OR
                              (w_ad_entrada_hotel[i_transfer] <> 0) OR (w_ni_entrada_hotel[i_transfer] <> 0) OR (w_ad_salida_hotel[i_transfer] <> 0) OR
                              (w_ni_salida_hotel[i_transfer] <> 0) OR (w_ad_estancia_hotel[i_transfer] <> 0) OR (w_ni_estancia_hotel[i_transfer] <> 0) OR
                              (w_ad_entrada_hotel[i_ht] <> 0) OR (w_ni_entrada_hotel[i_ht] <> 0) OR (w_ad_salida_hotel[i_ht] <> 0) OR
                              (w_ni_salida_hotel[i_ht] <> 0) OR (w_ad_estancia_hotel[i_ht] <> 0) OR (w_ni_estancia_hotel[i_ht] <> 0) THEN
                             imprimir := TRUE;

                           w_personas_entrada[i_hotel]     := STRSUBSTNO('%1/%2', w_ad_entrada_hotel[i_hotel],
                                                                                  w_ni_entrada_hotel[i_hotel]);
                           w_personas_salida[i_hotel]      := STRSUBSTNO('%1/%2', w_ad_salida_hotel[i_hotel],
                                                                                  w_ni_salida_hotel[i_hotel]);
                           w_personas_estancia[i_hotel]    := STRSUBSTNO('%1/%2', w_ad_estancia_hotel[i_hotel],
                                                                                  w_ni_estancia_hotel[i_hotel]);
                           w_personas_entrada[i_transfer]  := STRSUBSTNO('%1/%2', w_ad_entrada_hotel[i_transfer],
                                                                                  w_ni_entrada_hotel[i_transfer]);
                           w_personas_salida[i_transfer]   := STRSUBSTNO('%1/%2', w_ad_salida_hotel[i_transfer],
                                                                                  w_ni_salida_hotel[i_transfer]);
                           w_personas_estancia[i_transfer] := STRSUBSTNO('%1/%2', w_ad_estancia_hotel[i_transfer],
                                                                                  w_ni_estancia_hotel[i_transfer]);
                           w_personas_entrada[i_ht]        := STRSUBSTNO('%1/%2', w_ad_entrada_hotel[i_ht],
                                                                                  w_ni_entrada_hotel[i_ht]);
                           w_personas_salida[i_ht]         := STRSUBSTNO('%1/%2', w_ad_salida_hotel[i_ht],
                                                                                  w_ni_salida_hotel[i_ht]);
                           w_personas_estancia[i_ht]       := STRSUBSTNO('%1/%2', w_ad_estancia_hotel[i_ht],
                                                                                  w_ni_estancia_hotel[i_ht]);

                           CurrReport.SHOWOUTPUT((CurrReport.TOTALSCAUSEDBY = FIELDNO("Hotel Booking")) AND imprimir AND
                                                 imprimir_hotel);
                         END;

          }
          CONTROLS
          {
            { 15  ;TextBox      ;5400 ;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_salida[i_hotel] }
            { 16  ;TextBox      ;7500 ;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_entrada[i_hotel] }
            { 17  ;TextBox      ;9600 ;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_estancia[i_hotel] }
            { 14  ;TextBox      ;900  ;0    ;4350 ;423  ;LeaderDots=Yes;
                                                         SourceExpr=cNom.nom_hotel("Hotel Booking") }
            { 18  ;TextBox      ;11700;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_salida[i_transfer] }
            { 19  ;TextBox      ;13800;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_entrada[i_transfer] }
            { 20  ;TextBox      ;15900;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_estancia[i_transfer] }
            { 30  ;TextBox      ;18000;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_salida[i_ht] }
            { 31  ;TextBox      ;20100;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_entrada[i_ht] }
            { 32  ;TextBox      ;22200;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_estancia[i_ht] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=24200;
            SectionHeight=846;
            OnPreSection=BEGIN
                           imprimir := FALSE;
                           IF (w_ad_entrada_zona[i_hotel] <> 0) OR (w_ni_entrada_zona[i_hotel] <> 0) OR (w_ad_salida_zona[i_hotel] <> 0) OR
                              (w_ni_salida_zona[i_hotel] <> 0) OR (w_ad_estancia_zona[i_hotel] <> 0) OR (w_ni_estancia_zona[i_hotel] <> 0) OR
                              (w_ad_entrada_zona[i_transfer] <> 0) OR (w_ni_entrada_zona[i_transfer] <> 0) OR (w_ad_salida_zona[i_transfer] <> 0) OR
                              (w_ni_salida_zona[i_transfer] <> 0) OR (w_ad_estancia_zona[i_transfer] <> 0) OR (w_ni_estancia_zona[i_transfer] <> 0) OR
                              (w_ad_entrada_zona[i_ht] <> 0) OR (w_ni_entrada_zona[i_ht] <> 0) OR (w_ad_salida_zona[i_ht] <> 0) OR
                              (w_ni_salida_zona[i_ht] <> 0) OR (w_ad_estancia_zona[i_ht] <> 0) OR (w_ni_estancia_zona[i_ht] <> 0) THEN
                             imprimir := TRUE;

                           w_personas_entrada[i_hotel]     := STRSUBSTNO('%1/%2', w_ad_entrada_zona[i_hotel],
                                                                                  w_ni_entrada_zona[i_hotel]);
                           w_personas_salida[i_hotel]      := STRSUBSTNO('%1/%2', w_ad_salida_zona[i_hotel],
                                                                                  w_ni_salida_zona[i_hotel]);
                           w_personas_estancia[i_hotel]    := STRSUBSTNO('%1/%2', w_ad_estancia_zona[i_hotel],
                                                                                  w_ni_estancia_zona[i_hotel]);
                           w_personas_entrada[i_transfer]  := STRSUBSTNO('%1/%2', w_ad_entrada_zona[i_transfer],
                                                                                  w_ni_entrada_zona[i_transfer]);
                           w_personas_salida[i_transfer]   := STRSUBSTNO('%1/%2', w_ad_salida_zona[i_transfer],
                                                                                  w_ni_salida_zona[i_transfer]);
                           w_personas_estancia[i_transfer] := STRSUBSTNO('%1/%2', w_ad_estancia_zona[i_transfer],
                                                                                  w_ni_estancia_zona[i_transfer]);
                           w_personas_entrada[i_ht]        := STRSUBSTNO('%1/%2', w_ad_entrada_zona[i_ht],
                                                                                  w_ni_entrada_zona[i_ht]);
                           w_personas_salida[i_ht]         := STRSUBSTNO('%1/%2', w_ad_salida_zona[i_ht],
                                                                                  w_ni_salida_zona[i_ht]);
                           w_personas_estancia[i_ht]       := STRSUBSTNO('%1/%2', w_ad_estancia_zona[i_ht],
                                                                                  w_ni_estancia_zona[i_ht]);

                           CurrReport.SHOWOUTPUT((CurrReport.TOTALSCAUSEDBY = FIELDNO("Zona hotel")) AND imprimir);
                         END;

          }
          CONTROLS
          {
            { 21  ;TextBox      ;750  ;0    ;4500 ;423  ;LeaderDots=Yes;
                                                         SourceExpr=cNom.nom_zonafisica("Zona hotel") }
            { 27  ;Shape        ;0    ;423  ;24150;423  ;ShapeStyle=HorzLine }
            { 8   ;TextBox      ;22200;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_estancia[i_ht] }
            { 9   ;TextBox      ;20100;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_entrada[i_ht] }
            { 10  ;TextBox      ;18000;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_salida[i_ht] }
            { 11  ;TextBox      ;15900;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_estancia[i_transfer] }
            { 12  ;TextBox      ;13800;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_entrada[i_transfer] }
            { 13  ;TextBox      ;11700;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_salida[i_transfer] }
            { 33  ;TextBox      ;9600 ;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_estancia[i_hotel] }
            { 34  ;TextBox      ;7500 ;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_entrada[i_hotel] }
            { 35  ;TextBox      ;5400 ;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_salida[i_hotel] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=24200;
            SectionHeight=846;
            OnPreSection=BEGIN
                           imprimir := FALSE;
                           IF (w_ad_entrada_to[i_hotel] <> 0) OR (w_ni_entrada_to[i_hotel] <> 0) OR (w_ad_salida_to[i_hotel] <> 0) OR
                              (w_ni_salida_to[i_hotel] <> 0) OR (w_ad_estancia_to[i_hotel] <> 0) OR (w_ni_estancia_to[i_hotel] <> 0) OR
                              (w_ad_entrada_to[i_transfer] <> 0) OR (w_ni_entrada_to[i_transfer] <> 0) OR (w_ad_salida_to[i_transfer] <> 0) OR
                              (w_ni_salida_to[i_transfer] <> 0) OR (w_ad_estancia_to[i_transfer] <> 0) OR (w_ni_estancia_to[i_transfer] <> 0) OR
                              (w_ad_entrada_to[i_ht] <> 0) OR (w_ni_entrada_to[i_ht] <> 0) OR (w_ad_salida_to[i_ht] <> 0) OR
                              (w_ni_salida_to[i_ht] <> 0) OR (w_ad_estancia_to[i_ht] <> 0) OR (w_ni_estancia_to[i_ht] <> 0) THEN
                             imprimir := TRUE;

                           w_personas_entrada[i_hotel]     := STRSUBSTNO('%1/%2', w_ad_entrada_to[i_hotel],
                                                                                  w_ni_entrada_to[i_hotel]);
                           w_personas_salida[i_hotel]      := STRSUBSTNO('%1/%2', w_ad_salida_to[i_hotel],
                                                                                  w_ni_salida_to[i_hotel]);
                           w_personas_estancia[i_hotel]    := STRSUBSTNO('%1/%2', w_ad_estancia_to[i_hotel],
                                                                                  w_ni_estancia_to[i_hotel]);
                           w_personas_entrada[i_transfer]  := STRSUBSTNO('%1/%2', w_ad_entrada_to[i_transfer],
                                                                                  w_ni_entrada_to[i_transfer]);
                           w_personas_salida[i_transfer]   := STRSUBSTNO('%1/%2', w_ad_salida_to[i_transfer],
                                                                                  w_ni_salida_to[i_transfer]);
                           w_personas_estancia[i_transfer] := STRSUBSTNO('%1/%2', w_ad_estancia_to[i_transfer],
                                                                                  w_ni_estancia_to[i_transfer]);
                           w_personas_entrada[i_ht]        := STRSUBSTNO('%1/%2', w_ad_entrada_to[i_ht],
                                                                                  w_ni_entrada_to[i_ht]);
                           w_personas_salida[i_ht]         := STRSUBSTNO('%1/%2', w_ad_salida_to[i_ht],
                                                                                  w_ni_salida_to[i_ht]);
                           w_personas_estancia[i_ht]       := STRSUBSTNO('%1/%2', w_ad_estancia_to[i_ht],
                                                                                  w_ni_estancia_to[i_ht]);

                           CurrReport.SHOWOUTPUT((CurrReport.TOTALSCAUSEDBY = FIELDNO("TourOperador Venta")) AND imprimir
                                                 AND imprimir_to);
                         END;

          }
          CONTROLS
          {
            { 29  ;TextBox      ;0    ;0    ;5250 ;423  ;LeaderDots=Yes;
                                                         SourceExpr=cNom.nom_touroperador("TourOperador Venta") }
            { 48  ;Shape        ;0    ;423  ;24150;423  ;BorderWidth=2pt;
                                                         ShapeStyle=HorzLine }
            { 36  ;TextBox      ;22200;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_estancia[i_ht] }
            { 37  ;TextBox      ;20100;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_entrada[i_ht] }
            { 38  ;TextBox      ;18000;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_salida[i_ht] }
            { 39  ;TextBox      ;15900;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_estancia[i_transfer] }
            { 40  ;TextBox      ;13800;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_entrada[i_transfer] }
            { 41  ;TextBox      ;11700;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_salida[i_transfer] }
            { 42  ;TextBox      ;9600 ;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_estancia[i_hotel] }
            { 43  ;TextBox      ;7500 ;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_entrada[i_hotel] }
            { 44  ;TextBox      ;5400 ;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_salida[i_hotel] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=24200;
            SectionHeight=423;
            OnPreSection=BEGIN
                           w_personas_entrada[i_hotel]     := STRSUBSTNO('%1/%2', w_ad_entrada[i_hotel], w_ni_entrada[i_hotel]);
                           w_personas_salida[i_hotel]      := STRSUBSTNO('%1/%2', w_ad_salida[i_hotel], w_ni_salida[i_hotel]);
                           w_personas_estancia[i_hotel]    := STRSUBSTNO('%1/%2', w_ad_estancia[i_hotel], w_ni_estancia[i_hotel]);
                           w_personas_entrada[i_transfer]  := STRSUBSTNO('%1/%2', w_ad_entrada[i_transfer], w_ni_entrada[i_transfer]);
                           w_personas_salida[i_transfer]   := STRSUBSTNO('%1/%2', w_ad_salida[i_transfer], w_ni_salida[i_transfer]);
                           w_personas_estancia[i_transfer] := STRSUBSTNO('%1/%2', w_ad_estancia[i_transfer], w_ni_estancia[i_transfer]);
                           w_personas_entrada[i_ht]        := STRSUBSTNO('%1/%2', w_ad_entrada[i_ht], w_ni_entrada[i_ht]);
                           w_personas_salida[i_ht]         := STRSUBSTNO('%1/%2', w_ad_salida[i_ht], w_ni_salida[i_ht]);
                           w_personas_estancia[i_ht]       := STRSUBSTNO('%1/%2', w_ad_estancia[i_ht], w_ni_estancia[i_ht]);

                           CurrReport.SHOWOUTPUT(CurrReport.TOTALSCAUSEDBY = FIELDNO(Delegacion));
                         END;

          }
          CONTROLS
          {
            { 22  ;Label        ;0    ;0    ;5100 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Totals;
                                                                    ESP=Totales] }
            { 45  ;TextBox      ;5400 ;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_salida[i_hotel] }
            { 46  ;TextBox      ;7500 ;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_entrada[i_hotel] }
            { 47  ;TextBox      ;9600 ;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_estancia[i_hotel] }
            { 49  ;TextBox      ;13800;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_entrada[i_transfer] }
            { 50  ;TextBox      ;11700;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_salida[i_transfer] }
            { 51  ;TextBox      ;15900;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_estancia[i_transfer] }
            { 52  ;TextBox      ;18000;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_salida[i_ht] }
            { 53  ;TextBox      ;20100;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_entrada[i_ht] }
            { 54  ;TextBox      ;22200;0    ;2000 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_personas_estancia[i_ht] }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=24200;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 4   ;TextBox      ;9750 ;423  ;7050 ;423  ;HorzAlign=Center;
                                                         SourceExpr=FORMAT(TODAY,0,4) + ' / ' + FORMAT(TIME,0,0) + ' / ' + USERID }
            { 5   ;TextBox      ;21000;423  ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=Text005 + FORMAT(CurrReport.PAGENO) }
            { 6   ;Shape        ;0    ;0    ;24150;423  ;ShapeStyle=HorzLine }
            { 7   ;TextBox      ;0    ;423  ;3600 ;423  ;SourceExpr=cNom.nom_delegacion(rPar.Delegacion) }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=4950;
      Height=3300;
      CaptionML=[ENU=Operations summary;
                 ESP=Resumen operaciones];
    }
    CONTROLS
    {
      { 1   ;Label        ;220  ;220  ;2200 ;440  ;CaptionML=[ENU=Day from;
                                                              ESP=Dia desde] }
      { 2   ;TextBox      ;2530 ;220  ;1650 ;440  ;SourceExpr=w_dia_desde;
                                                   OnValidate=BEGIN
                                                                IF w_dia_hasta = 0D THEN
                                                                  w_dia_hasta := w_dia_desde;
                                                              END;
                                                               }
      { 3   ;Label        ;220  ;1430 ;2200 ;440  ;CaptionML=[ENU=Package;
                                                              ESP=Paquete] }
      { 4   ;TextBox      ;2530 ;1430 ;2200 ;440  ;SourceExpr=w_paquete;
                                                   TableRelation=Paquete }
      { 5   ;Label        ;220  ;770  ;2200 ;440  ;CaptionML=[ENU=Day to;
                                                              ESP=Dia hasta] }
      { 6   ;TextBox      ;2530 ;770  ;1650 ;440  ;SourceExpr=w_dia_hasta;
                                                   OnValidate=BEGIN
                                                                IF w_dia_desde <> 0D THEN
                                                                  IF w_dia_hasta < w_dia_desde THEN
                                                                    ERROR(Text006);
                                                              END;
                                                               }
      { 7   ;Label        ;220  ;2090 ;2200 ;440  ;CaptionML=[ENU=View hotel level;
                                                              ESP=Ver nivel hotel] }
      { 8   ;CheckBox     ;2530 ;2090 ;440  ;440  ;ShowCaption=No;
                                                   SourceExpr=imprimir_hotel }
      { 9   ;Label        ;220  ;2640 ;2200 ;440  ;CaptionML=[ENU=View TO level;
                                                              ESP=Ver nivel TO] }
      { 10  ;CheckBox     ;2530 ;2640 ;440  ;440  ;ShowCaption=No;
                                                   SourceExpr=imprimir_to }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text004@1103355070 : TextConst 'ENU=Must indicate a day from the list;ESP=Debe indicar un dia desde en el listado.';
      Text005@1103355071 : TextConst 'ENU=page;ESP=Pgina';
      Text006@1103355072 : TextConst 'ENU=Unable to indicate a previous date to than date from;ESP=No puede indicar una fecha hasta anterior a la fecha desde.';
      rParPer@1103355000 : Record 7009701;
      rEmp@1103355001 : Record 79;
      rPar@1103355002 : Record 7009700;
      rPer@1103355003 : Record 7009742;
      rTip@1103355004 : Record 7009715;
      rParInt@1103355005 : Record 7010081;
      cNom@1103355006 : Codeunit 7009702;
      w_ad_entrada@1103355007 : ARRAY [3] OF Integer;
      w_ad_entrada_hotel@1103355008 : ARRAY [3] OF Integer;
      w_ad_entrada_zona@1103355009 : ARRAY [3] OF Integer;
      w_ad_rsv@1103355010 : Integer;
      w_ad_entrada_to@1103355011 : ARRAY [3] OF Integer;
      w_ni_entrada@1103355012 : ARRAY [3] OF Integer;
      w_ni_entrada_hotel@1103355013 : ARRAY [3] OF Integer;
      w_ni_entrada_zona@1103355014 : ARRAY [3] OF Integer;
      w_ni_rsv@1103355015 : Integer;
      w_ni_entrada_to@1103355016 : ARRAY [3] OF Integer;
      w_ad_salida@1103355017 : ARRAY [3] OF Integer;
      w_ad_salida_hotel@1103355018 : ARRAY [3] OF Integer;
      w_ad_salida_zona@1103355019 : ARRAY [3] OF Integer;
      w_ad_salida_to@1103355020 : ARRAY [3] OF Integer;
      w_ni_salida@1103355021 : ARRAY [3] OF Integer;
      w_ni_salida_hotel@1103355022 : ARRAY [3] OF Integer;
      w_ni_salida_zona@1103355023 : ARRAY [3] OF Integer;
      w_ni_salida_to@1103355024 : ARRAY [3] OF Integer;
      w_ad_estancia@1103355025 : ARRAY [3] OF Integer;
      w_ad_estancia_hotel@1103355026 : ARRAY [3] OF Integer;
      w_ad_estancia_zona@1103355027 : ARRAY [3] OF Integer;
      w_ad_estancia_to@1103355028 : ARRAY [3] OF Integer;
      w_ni_estancia@1103355029 : ARRAY [3] OF Integer;
      w_ni_estancia_hotel@1103355030 : ARRAY [3] OF Integer;
      w_ni_estancia_zona@1103355031 : ARRAY [3] OF Integer;
      w_ni_estancia_to@1103355032 : ARRAY [3] OF Integer;
      w_ele_estancia@1103355033 : ARRAY [3] OF Integer;
      w_ele_estancia_hotel@1103355034 : ARRAY [3] OF Integer;
      w_ele_estancia_zona@1103355035 : ARRAY [3] OF Integer;
      w_ele_estancia_to@1103355036 : ARRAY [3] OF Integer;
      w_ele_entrada@1103355037 : ARRAY [3] OF Integer;
      w_ele_entrada_hotel@1103355038 : ARRAY [3] OF Integer;
      w_ele_entrada_zona@1103355039 : ARRAY [3] OF Integer;
      w_ele_entrada_to@1103355040 : ARRAY [3] OF Integer;
      w_ele_salida@1103355041 : ARRAY [3] OF Integer;
      w_ele_salida_hotel@1103355042 : ARRAY [3] OF Integer;
      w_ele_salida_zona@1103355043 : ARRAY [3] OF Integer;
      w_ele_salida_to@1103355044 : ARRAY [3] OF Integer;
      w_ele_rsv@1103355045 : Integer;
      w_if_rsv@1103355046 : Integer;
      w_ant_zona@1103355047 : Code[10];
      w_ant_hotel@1103355048 : Code[20];
      w_ant_to@1103355049 : Code[10];
      w_dia_desde@1103355050 : Date;
      w_dia_hasta@1103355051 : Date;
      w_filtro@1103355052 : Text[80];
      w_paquete@1103355053 : Code[10];
      imprimir@1103355054 : Boolean;
      imprimir_hotel@1103355055 : Boolean;
      imprimir_to@1103355056 : Boolean;
      i_hotel@1103355057 : Integer;
      i_transfer@1103355058 : Integer;
      i_ht@1103355059 : Integer;
      indice@1103355060 : Integer;
      w_personas_entrada@1103355061 : ARRAY [3] OF Text[30];
      w_personas_salida@1103355062 : ARRAY [3] OF Text[30];
      w_personas_estancia@1103355063 : ARRAY [3] OF Text[30];
      w_elementos_entrada@1103355064 : Text[30];
      w_elementos_salida@1103355065 : Integer;
      wTipoPaquete@1100217000 : 'SoloHotel,SoloTransfer,H+T,NoCuenta';
      wTipoPaquetePar@1100217001 : 'SoloHotel,SoloTransfer,H+T,NoCuenta';

    PROCEDURE cuenta_personas@8(VAR par_ad@1103355000 : Integer;VAR par_ni@1103355001 : Integer;VAR par_inf@1103355002 : Integer;VAR par_ele@1103355003 : Integer);
    VAR
      rRsvHot@1103355004 : Record 7009743;
      rRsvTra@1103355005 : Record 7009744;
      rEle@1103355006 : Record 7009792;
    BEGIN
      // cuenta_personas

      rRsvHot.RESET;
      rRsvHot.SETCURRENTKEY(Delegacion, "N Interno", "N Periodo");
      rRsvHot.SETRANGE(Delegacion  , "Periodo reserva".Delegacion);
      rRsvHot.SETRANGE("N Interno", "Periodo reserva"."N Interno");
      rRsvHot.SETRANGE("N Periodo", "Periodo reserva"."N Periodo");
      IF rRsvHot.FINDSET THEN
      BEGIN
        REPEAT
          CASE rRsvHot."Tipo Persona" OF
            rParPer."Codigo Adulto":
              par_ad := par_ad + 1;
            rParPer."Codigo Nio":
              par_ni := par_ni + 1;
            rParPer."Codigo Infant":
              par_inf := par_inf + 1;
          END;
        UNTIL rRsvHot.NEXT = 0;
      END
      ELSE
      BEGIN
        rRsvTra.RESET;
        rRsvTra.SETCURRENTKEY(Delegacion,"N Interno","N Periodo");
        rRsvTra.SETRANGE(Delegacion           , "Periodo reserva".Delegacion);
        rRsvTra.SETRANGE("N Interno"         , "Periodo reserva"."N Interno");
        rRsvTra.SETRANGE("N Periodo"         , "Periodo reserva"."N Periodo");
        rRsvTra.SETRANGE("Traslado en destino", FALSE); //+$002
        IF rRsvTra.FINDSET THEN
        BEGIN
          REPEAT
            CASE rRsvTra."Tipo Persona" OF
              rParPer."Codigo Adulto":
                par_ad := par_ad + 1;
              rParPer."Codigo Nio":
                par_ni := par_ni + 1;
              rParPer."Codigo Infant":
                par_inf := par_inf + 1;
            END;

            CLEAR(rEle);
            rEle.SETRANGE(Delegacion  , rRsvTra.Delegacion);
            rEle.SETRANGE("N Reserva", rRsvTra."N Reserva");
            rEle.SETRANGE(Humano      , FALSE);
            IF rEle.FINDSET THEN
            BEGIN
              REPEAT
                CLEAR(rTip);
                IF rTip.GET(rEle."Tipo elemento") AND (NOT rTip.Humano) THEN
                  par_ele := par_ele + rEle."Numero elementos";
              UNTIL rEle.NEXT = 0;
            END;
          UNTIL rRsvTra.NEXT = 0;
        END;
      END;
    END;

    LOCAL PROCEDURE _GetTipoPaquete@1100217001(pwPaquete@1100217000 : Code[10]) : Integer;
    VAR
      lrProdPaq@1100217001 : Record 7009752;
    BEGIN
      // _TipoPaquete

      lrProdPaq.RESET;
      lrProdPaq.SETRANGE(Paquete        , pwPaquete);
      lrProdPaq.SETRANGE("Tipo Producto", lrProdPaq."Tipo Producto"::Hotel);
      IF lrProdPaq.FINDFIRST THEN
      BEGIN
        lrProdPaq.SETRANGE("Tipo Producto", lrProdPaq."Tipo Producto"::Transfer);
        IF lrProdPaq.FINDFIRST THEN
          EXIT(wTipoPaquete::"H+T")
        ELSE
          EXIT(wTipoPaquete::SoloHotel);
      END
      ELSE
      BEGIN
        lrProdPaq.SETRANGE("Tipo Producto", lrProdPaq."Tipo Producto"::Transfer);
        IF lrProdPaq.FINDFIRST THEN
          EXIT(wTipoPaquete::SoloTransfer)
        ELSE
          EXIT(wTipoPaquete::NoCuenta);
      END;
    END;

    BEGIN
    {
      ## AJF 29/06/09

        .- (09/00319) cambio cdigos de hotel de code10 a code20.

      $001 AJS 06052013 Busco el tipo de paquete en funcion de los productos que tiene dentro

      $002 AJS 10042014 Este informe no debe mostrar los paxes de traslados en destino

      $003 AJS 14042014 La tabla elementos transportar transfer solo sirve para acumular suplementos
    }
    END.
  }
  RDLDATA
  {
  }
}
