OBJECT Report 104 Customer - Detail Trial Bal.
{
  OBJECT-PROPERTIES
  {
    Date=14/11/12;
    Time=16:06:06;
    Modified=Yes;
    Version List=AIC2009,NAVW16.00.01,NAVES6.00.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Customer - Detail Trial Bal.;
               ESP=Cliente - Movimientos];
    OnPreReport=BEGIN
                  CustFilter := Customer.GETFILTERS;
                  CustDateFilter := Customer.GETFILTER("Date Filter");
                  WITH "Cust. Ledger Entry" DO
                    IF PrintAmountsInLCY THEN BEGIN
                      AmountCaption := FIELDCAPTION("Amount (LCY)");
                      RemainingAmtCaption := FIELDCAPTION("Remaining Amt. (LCY)");
                    END ELSE BEGIN
                      AmountCaption := FIELDCAPTION(Amount);
                      RemainingAmtCaption := FIELDCAPTION("Remaining Amount");
                    END;
                END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table18;
        DataItemTableView=SORTING(No.);
        PrintOnlyIfDetail=Yes;
        OnPreDataItem=BEGIN
                        PageGroupNo := 1;
                        CurrReport.NEWPAGEPERRECORD := PrintOnlyOnePerPage;
                        CurrReport.CREATETOTALS("Cust. Ledger Entry"."Amount (LCY)",StartBalanceLCY, StartBalAdjLCY, Correction, ApplicationRounding,
                                                 "Cust. Ledger Entry"."Debit Amount (LCY)", "Cust. Ledger Entry"."Credit Amount (LCY)",
                                                 StartCustDebitAmount, StartCustCreditAmount);
                        StartBalanceLCYTotal := 0;
                        StartBalAdjLCYTotal := 0;
                        CustBalanceLCYTotal := 0;
                      END;

        OnAfterGetRecord=BEGIN
                           IF ISSERVICETIER THEN BEGIN
                             IF PrintOnlyOnePerPage THEN
                               PageGroupNo := PageGroupNo + 1;
                           END;

                           StartBalanceLCY := 0;
                           StartBalAdjLCY := 0;
                           IF CustDateFilter <> '' THEN BEGIN
                             IF GETRANGEMIN("Date Filter") <> 0D THEN BEGIN
                               SETRANGE("Date Filter",0D,GETRANGEMIN("Date Filter") - 1);
                               CALCFIELDS("Net Change (LCY)");
                               StartBalanceLCY := "Net Change (LCY)";
                               StartCustDebitAmount := "Cust. Ledger Entry"."Debit Amount (LCY)";
                               StartCustCreditAmount := "Cust. Ledger Entry"."Credit Amount (LCY)";
                             END;
                             SETFILTER("Date Filter",CustDateFilter);
                             CALCFIELDS("Net Change (LCY)");
                             StartBalAdjLCY := "Net Change (LCY)";
                             CustLedgEntry.SETCURRENTKEY("Customer No.","Posting Date");
                             CustLedgEntry.SETRANGE("Customer No.",Customer."No.");
                             CustLedgEntry.SETFILTER("Posting Date",CustDateFilter);
                             IF CustLedgEntry.FIND('-') THEN
                               REPEAT
                                 CustLedgEntry.SETFILTER("Date Filter",CustDateFilter);
                                 CustLedgEntry.CALCFIELDS("Amount (LCY)");
                                 StartBalAdjLCY := StartBalAdjLCY - CustLedgEntry."Amount (LCY)";
                                 "Detailed Cust. Ledg. Entry".SETCURRENTKEY("Cust. Ledger Entry No.","Entry Type","Posting Date");
                                 "Detailed Cust. Ledg. Entry".SETRANGE("Cust. Ledger Entry No.",CustLedgEntry."Entry No.");
                                 "Detailed Cust. Ledg. Entry".SETFILTER("Entry Type",'%1|%2',
                                   "Detailed Cust. Ledg. Entry"."Entry Type"::"Correction of Remaining Amount",
                                   "Detailed Cust. Ledg. Entry"."Entry Type"::"Appln. Rounding");
                                 "Detailed Cust. Ledg. Entry".SETFILTER("Posting Date",CustDateFilter);
                                 IF "Detailed Cust. Ledg. Entry".FIND('-') THEN
                                   REPEAT
                                     StartBalAdjLCY := StartBalAdjLCY - "Detailed Cust. Ledg. Entry"."Amount (LCY)";
                                   UNTIL "Detailed Cust. Ledg. Entry".NEXT = 0;
                                 "Detailed Cust. Ledg. Entry".RESET;
                               UNTIL CustLedgEntry.NEXT = 0;
                           END;
                           CurrReport.PRINTONLYIFDETAIL := ExcludeBalanceOnly OR (StartBalanceLCY = 0);
                           CustBalanceLCY := StartBalanceLCY + StartBalAdjLCY;
                           IF StartBalAdjLCY > 0 THEN BEGIN
                             StartCustDebitAmountAdj := StartBalAdjLCY;
                             StartCustCreditAmountAdj := 0;
                           END ELSE BEGIN
                             StartCustDebitAmountAdj := 0;
                             StartCustCreditAmountAdj := StartBalAdjLCY;
                           END;
                           StartBalanceLCYTotal := StartBalanceLCYTotal + StartBalanceLCY;
                           StartBalAdjLCYTotal := StartBalAdjLCYTotal + StartBalAdjLCY;
                           CustBalanceLCYTotal := CustBalanceLCYTotal + CustBalanceLCY;
                         END;

        ReqFilterFields=No.,Search Name,Customer Posting Group,Date Filter;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18150;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 1   ;Label        ;0    ;0    ;7500 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Customer - Detail Trial Bal.;
                                                                    ESP=Cliente - Movimientos];
                                                         DataSetFieldName=Customer___Detail_Trial_Bal_Caption }
            { 2   ;TextBox      ;15000;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4);
                                                         DataSetFieldName=FORMAT_TODAY_0_4_ }
            { 3   ;TextBox      ;0    ;423  ;7500 ;423  ;SourceExpr=STRSUBSTNO(Text000,CustDateFilter);
                                                         DataSetFieldName=STRSUBSTNO_Text000_CustDateFilter_ }
            { 4   ;Label        ;16950;423  ;750  ;423  ;ParentControl=5;
                                                         DataSetFieldName=CurrReport_PAGENOCaption }
            { 5   ;TextBox      ;17700;423  ;450  ;423  ;CaptionML=[ENU=Page;
                                                                    ESP=P g.];
                                                         SourceExpr=CurrReport.PAGENO;
                                                         DataSetFieldName=CurrReport_PAGENO }
            { 6   ;TextBox      ;0    ;846  ;7500 ;423  ;SourceExpr=COMPANYNAME;
                                                         DataSetFieldName=COMPANYNAME }
            { 7   ;TextBox      ;15900;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID;
                                                         DataSetFieldName=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18150;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(PrintAmountsInLCY);
                         END;

          }
          CONTROLS
          {
            { 8   ;Label        ;0    ;0    ;7500 ;423  ;CaptionML=[ENU=All amounts are in LCY;
                                                                    ESP=Importes en divisa local.];
                                                         DataSetFieldName=All_amounts_are_in_LCYCaption }
            { 42  ;TextBox      ;17850;0    ;150  ;423  ;Name=PrintAmountsInLCY;
                                                         Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr=PrintAmountsInLCY;
                                                         DataSetFieldName=PrintAmountsInLCY }
            { 74  ;TextBox      ;17700;0    ;150  ;423  ;Name=PrintOnlyOnePerPage;
                                                         Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr=PrintOnlyOnePerPage;
                                                         DataSetFieldName=PrintOnlyOnePerPage }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18150;
            SectionHeight=423;
          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18150;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((CurrReport.PAGENO = 1) AND NOT ExcludeBalanceOnly);
                         END;

          }
          CONTROLS
          {
            { 9   ;Label        ;0    ;0    ;12000;423  ;CaptionML=[ENU=This report also includes customers that only have balances.;
                                                                    ESP=S¢lo clientes con saldo.];
                                                         DataSetFieldName=This_report_also_includes_customers_that_only_have_balances_Caption }
            { 75  ;TextBox      ;18000;0    ;150  ;423  ;Name=ExcludeBalanceOnly;
                                                         Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr=ExcludeBalanceOnly;
                                                         DataSetFieldName=ExcludeBalanceOnly }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18150;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((CurrReport.PAGENO = 1) AND (CustFilter <> ''));
                         END;

          }
          CONTROLS
          {
            { 10  ;TextBox      ;0    ;0    ;18150;423  ;SourceExpr=Customer.TABLECAPTION + ': ' + CustFilter;
                                                         DataSetFieldName=Customer_TABLECAPTION__________CustFilter }
            { 18  ;TextBox      ;18000;0    ;150  ;423  ;Name=CustFilter;
                                                         Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr=CustFilter;
                                                         DataSetFieldName=CustFilter }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18150;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((CurrReport.PAGENO = 1) AND ((CustFilter <> '') OR NOT ExcludeBalanceOnly));
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18150;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 11  ;Label        ;0    ;0    ;1200 ;846  ;ParentControl=35;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         DataSetFieldName=Cust__Ledger_Entry__Posting_Date_Caption }
            { 12  ;Label        ;1350 ;0    ;750  ;846  ;ParentControl=36;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         DataSetFieldName=Cust__Ledger_Entry__Document_Type_Caption }
            { 13  ;Label        ;2250 ;0    ;1500 ;846  ;ParentControl=37;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         DataSetFieldName=Cust__Ledger_Entry__Document_No__Caption }
            { 14  ;Label        ;3900 ;0    ;4350 ;846  ;ParentControl=38;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1100002;Label     ;8400 ;0    ;1800 ;846  ;ParentControl=1100001;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         CaptionML=[ENU=Debit;
                                                                    ESP=Debe];
                                                         DataSetFieldName=DebitCaption }
            { 1100003;Label     ;10350;0    ;1800 ;846  ;ParentControl=1100000;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         CaptionML=[ENU=Credit;
                                                                    ESP=Haber];
                                                         DataSetFieldName=CreditCaption }
            { 54  ;TextBox      ;12300;0    ;1800 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         SourceExpr=RemainingAmtCaption;
                                                         DataSetFieldName=RemainingAmtCaption }
            { 57  ;Label        ;14250;0    ;1800 ;846  ;ParentControl=56;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         DataSetFieldName=CustBalanceLCY_Control56Caption }
            { 1100253000;Label  ;16200;0    ;900  ;846  ;ParentControl=51;
                                                         HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         CaptionML=[ENU=Currency;
                                                                    ESP=Divisa] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 22  ;TextBox      ;0    ;0    ;1500 ;423  ;FontBold=Yes;
                                                         SourceExpr="No.";
                                                         DataSetFieldName=Customer__No__ }
            { 23  ;TextBox      ;1650 ;0    ;4500 ;423  ;FontBold=Yes;
                                                         SourceExpr=Name;
                                                         DataSetFieldName=Customer_Name }
            { 24  ;Label        ;1650 ;423  ;1800 ;423  ;ParentControl=25;
                                                         DataSetFieldName=Customer__Phone_No__Caption }
            { 25  ;TextBox      ;3600 ;423  ;2550 ;423  ;SourceExpr="Phone No.";
                                                         DataSetFieldName=Customer__Phone_No__ }
            { 77  ;TextBox      ;18000;0    ;150  ;423  ;Name=PageGroupNo;
                                                         Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr=PageGroupNo;
                                                         DataSetFieldName=PageGroupNo }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 28  ;TextBox      ;14250;0    ;1800 ;423  ;SourceExpr=StartBalanceLCY;
                                                         AutoFormatType=1;
                                                         DataSetFieldName=StartBalanceLCY }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=423;
            OnPreSection=BEGIN
                             CurrReport.SHOWOUTPUT(StartBalAdjLCY <> 0);
                         END;

          }
          CONTROLS
          {
            { 26  ;Label        ;2700 ;0    ;3000 ;423  ;CaptionML=[ENU=Adj. of Opening Balance;
                                                                    ESP=Aj. saldo inicial];
                                                         DataSetFieldName=Adj__of_Opening_BalanceCaption }
            { 1100101;TextBox   ;10350;0    ;1800 ;423  ;SourceExpr=StartCustCreditAmountAdj;
                                                         AutoFormatType=1;
                                                         DataSetFieldName=StartCustCreditAmountAdj }
            { 1100100;TextBox   ;8400 ;0    ;1800 ;423  ;SourceExpr=StartCustDebitAmountAdj;
                                                         AutoFormatType=1;
                                                         DataSetFieldName=StartCustDebitAmountAdj }
            { 40  ;TextBox      ;14250;0    ;1800 ;423  ;SourceExpr=CustBalanceLCY;
                                                         AutoFormatType=1;
                                                         DataSetFieldName=CustBalanceLCY }
            { 1100006;TextBox   ;18000;0    ;150  ;423  ;Name=StartBalAdjLCY_CustBody;
                                                         Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr=StartBalAdjLCY;
                                                         DataSetFieldName=StartBalAdjLCY_CustBody }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18150;
            SectionHeight=1269;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(StartBalAdjLCY <> 0);
                         END;

          }
          CONTROLS
          {
            { 17  ;TextBox      ;16200;846  ;1800 ;423  ;FontBold=Yes;
                                                         SourceExpr=StartBalanceLCY + StartBalAdjLCY + "Cust. Ledger Entry"."Amount (LCY)" + Correction + ApplicationRounding;
                                                         AutoFormatType=1;
                                                         DataSetFieldName=StartBalanceLCY___StartBalAdjLCY____Cust__Ledger_Entry___Amount__LCY_____Correction___ApplicationRounding }
            { 47  ;TextBox      ;16200;0    ;1800 ;423  ;SourceExpr=StartBalanceLCY;
                                                         AutoFormatType=1;
                                                         DataSetFieldName=StartBalanceLCY_Control47 }
            { 50  ;Label        ;0    ;0    ;3600 ;423  ;CaptionML=[ENU=Total (LCY) Before Period;
                                                                    ESP=Total antes periodo (DL)];
                                                         DataSetFieldName=Total__LCY__Before_PeriodCaption }
            { 64  ;Label        ;0    ;846  ;2250 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Total (LCY);
                                                                    ESP=Total (DL)];
                                                         DataSetFieldName=Total__LCY_Caption }
            { 1100117;TextBox   ;10350;846  ;1800 ;423  ;FontBold=Yes;
                                                         SourceExpr=StartCustDebitAmount + DebitCorrection + DebitApplicationRounding;
                                                         AutoFormatType=1;
                                                         DataSetFieldName=StartCustDebitAmount___DebitCorrection___DebitApplicationRounding }
            { 1100005;TextBox   ;12300;846  ;1800 ;423  ;FontBold=Yes;
                                                         SourceExpr=StartCustCreditAmount + CreditCorrection + CreditApplicationRounding;
                                                         AutoFormatType=1;
                                                         DataSetFieldName=StartCustCreditAmount___CreditCorrection___CreditApplicationRounding }
            { 66  ;Label        ;0    ;423  ;3600 ;423  ;CaptionML=[ENU=Total Adj. of Opening Balance;
                                                                    ESP=Aj. total del saldo inicial];
                                                         DataSetFieldName=Total_Adj__of_Opening_BalanceCaption }
            { 1100107;TextBox   ;12300;423  ;1800 ;423  ;SourceExpr=StartCustCreditAmountAdj;
                                                         AutoFormatType=1;
                                                         DataSetFieldName=StartCustCreditAmountAdj_Control1100107 }
            { 1100106;TextBox   ;10350;423  ;1800 ;423  ;SourceExpr=StartCustDebitAmountAdj;
                                                         AutoFormatType=1;
                                                         DataSetFieldName=StartCustDebitAmountAdj_Control1100106 }
            { 68  ;TextBox      ;16200;423  ;1800 ;423  ;SourceExpr=StartBalanceLCY + StartBalAdjLCY;
                                                         AutoFormatType=1;
                                                         DataSetFieldName=StartBalanceLCY___StartBalAdjLCY }
            { 1103355000;TextBox;14250;846  ;1800 ;423  ;SourceExpr="Cust. Ledger Entry"."Remaining Amt. (LCY)";
                                                         AutoFormatType=1 }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18150;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(StartBalAdjLCY = 0);
                         END;

          }
          CONTROLS
          {
            { 30  ;Label        ;0    ;423  ;2250 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Total (LCY);
                                                                    ESP=Total (DL)];
                                                         DataSetFieldName=Total__LCY_Caption_Control30 }
            { 16  ;Label        ;0    ;0    ;3600 ;423  ;CaptionML=[ENU=Total (LCY) Before Period;
                                                                    ESP=Total antes periodo (DL)];
                                                         DataSetFieldName=Total__LCY__Before_PeriodCaption_Control16 }
            { 1100108;TextBox   ;10350;423  ;1800 ;423  ;FontBold=Yes;
                                                         SourceExpr=StartCustDebitAmount + DebitCorrection + DebitApplicationRounding;
                                                         AutoFormatType=1;
                                                         DataSetFieldName=StartCustDebitAmount___DebitCorrection___DebitApplicationRounding_Control1100108 }
            { 1100109;TextBox   ;12300;423  ;1800 ;423  ;FontBold=Yes;
                                                         SourceExpr=StartCustCreditAmount + CreditCorrection + CreditApplicationRounding;
                                                         AutoFormatType=1;
                                                         DataSetFieldName=StartCustCreditAmount___CreditCorrection___CreditApplicationRounding_Control1100109 }
            { 70  ;TextBox      ;16200;423  ;1800 ;423  ;FontBold=Yes;
                                                         SourceExpr=StartBalanceLCY + "Cust. Ledger Entry"."Amount (LCY)" + Correction + ApplicationRounding;
                                                         AutoFormatType=1;
                                                         DataSetFieldName=StartBalanceLCY____Cust__Ledger_Entry___Amount__LCY_____Correction___ApplicationRounding }
            { 71  ;TextBox      ;16200;0    ;1800 ;423  ;SourceExpr=StartBalanceLCY;
                                                         AutoFormatType=1;
                                                         DataSetFieldName=StartBalanceLCY_Control71 }
            { 1103355001;TextBox;14250;423  ;1800 ;423  ;SourceExpr="Cust. Ledger Entry"."Remaining Amt. (LCY)";
                                                         AutoFormatType=1 }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table21;
        DataItemTableView=SORTING(Customer No.,Posting Date);
        OnPreDataItem=BEGIN
                        CustLedgEntryExists := FALSE;
                        CurrReport.CREATETOTALS(CustAmount,CustDebit,CustCredit,"Amount (LCY)", CustRemainAmount);
                        IF ISSERVICETIER THEN BEGIN
                        StartCustDebitAmount := 0;
                        StartCustCreditAmount := 0;
                        END;
                      END;

        OnAfterGetRecord=BEGIN
                           CALCFIELDS(Amount,"Remaining Amount","Amount (LCY)","Remaining Amt. (LCY)","Debit Amount (LCY)","Credit Amount (LCY)",
                             "Debit Amount","Credit Amount");
                           CustLedgEntryExists := TRUE;
                           IF PrintAmountsInLCY THEN BEGIN
                             CustAmount := "Amount (LCY)";
                             CustDebit := "Debit Amount (LCY)";
                             CustCredit := "Credit Amount (LCY)";
                             CustRemainAmount := "Remaining Amt. (LCY)";
                             CustCurrencyCode := '';
                           END ELSE BEGIN
                             CustAmount := Amount;
                             CustDebit := "Debit Amount";
                             CustCredit := "Credit Amount";
                             CustRemainAmount := "Remaining Amount";
                             CustCurrencyCode := "Currency Code";
                           END;
                           //-$007CustBalanceLCY := CustBalanceLCY + "Amount (LCY)";
                           CustBalanceLCY := CustBalanceLCY + "Remaining Amt. (LCY)"; //+$007
                           StartCustCreditAmount := StartCustCreditAmount + "Credit Amount (LCY)";
                           StartCustDebitAmount := StartCustDebitAmount + "Debit Amount (LCY)";
                           IF ("Document Type" = "Document Type"::Payment) OR ("Document Type" = "Document Type"::Refund) THEN
                             CustEntryDueDate := 0D
                           ELSE
                             CustEntryDueDate := "Due Date";

                           IF ISSERVICETIER THEN BEGIN
                           StartCustCreditAmountTotal := StartCustCreditAmountTotal + "Credit Amount (LCY)";
                           StartCustDebitAmountTotal := StartCustDebitAmountTotal + "Debit Amount (LCY)";
                           END;

                           CustBalanceLCYTotal := CustBalanceLCYTotal + "Amount (LCY)";
                         END;

        ReqFilterFields=Open;
        DataItemLink=Customer No.=FIELD(No.),
                     Posting Date=FIELD(Date Filter),
                     Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                     Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                     Date Filter=FIELD(Date Filter);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=18150;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 33  ;Label        ;2700 ;0    ;3000 ;423  ;LeaderDots=Yes;
                                                         CaptionML=[ENU=Continued;
                                                                    ESP=Suma];
                                                         DataSetFieldName=ContinuedCaption }
            { 34  ;TextBox      ;14250;0    ;1800 ;423  ;SourceExpr=StartBalanceLCY + StartBalAdjLCY + "Amount (LCY)";
                                                         AutoFormatType=1;
                                                         DataSetFieldName=StartBalanceLCY___StartBalAdjLCY____Amount__LCY__ }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 35  ;TextBox      ;0    ;0    ;1200 ;423  ;HorzAlign=Right;
                                                         CaptionML=[ENU=Posting Date;
                                                                    ESP=Fecha registro];
                                                         SourceExpr=FORMAT("Posting Date");
                                                         DataSetFieldName=Cust__Ledger_Entry__Posting_Date_ }
            { 36  ;TextBox      ;1350 ;0    ;750  ;423  ;CaptionML=[ENU=Document Type;
                                                                    ESP=Tipo documento];
                                                         SourceExpr="Document Type";
                                                         DataSetFieldName=Cust__Ledger_Entry__Document_Type_ }
            { 37  ;TextBox      ;2250 ;0    ;1500 ;423  ;SourceExpr="Document No.";
                                                         DataSetFieldName=Cust__Ledger_Entry__Document_No__ }
            { 38  ;TextBox      ;3900 ;0    ;4350 ;423  ;SourceExpr=Description;
                                                         DataSetFieldName=Cust__Ledger_Entry_Description }
            { 1100000;TextBox   ;10350;0    ;1800 ;423  ;CaptionML=[ENU=Credit;
                                                                    ESP=Haber];
                                                         SourceExpr=CustCredit;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr=CustCurrencyCode;
                                                         DataSetFieldName=CustCredit }
            { 1100001;TextBox   ;8400 ;0    ;1800 ;423  ;CaptionML=[ENU=Debit;
                                                                    ESP=Debe];
                                                         SourceExpr=CustDebit;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr=CustCurrencyCode;
                                                         DataSetFieldName=CustDebit }
            { 41  ;TextBox      ;12300;0    ;1800 ;423  ;CaptionML=[ENU=Remaining Amount;
                                                                    ESP=Importe pendiente];
                                                         SourceExpr=CustRemainAmount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr=CustCurrencyCode;
                                                         DataSetFieldName=CustRemainAmount }
            { 45  ;TextBox      ;16950;0    ;1200 ;423  ;SourceExpr="Entry No.";
                                                         DataSetFieldName=Cust__Ledger_Entry__Entry_No__ }
            { 51  ;TextBox      ;16200;0    ;600  ;423  ;SourceExpr=CustCurrencyCode;
                                                         DataSetFieldName=CustCurrencyCode }
            { 56  ;TextBox      ;14250;0    ;1800 ;423  ;CaptionML=[ENU=Balance (LCY);
                                                                    ESP=Saldo (DL)];
                                                         SourceExpr=CustBalanceLCY;
                                                         AutoFormatType=1;
                                                         DataSetFieldName=CustBalanceLCY_Control56 }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=18150;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 46  ;Label        ;2700 ;423  ;3000 ;423  ;LeaderDots=Yes;
                                                         CaptionML=[ENU=Continued;
                                                                    ESP=Suma];
                                                         DataSetFieldName=ContinuedCaption_Control46 }
            { 59  ;TextBox      ;14250;423  ;1800 ;423  ;CaptionML=[ENU=Balance (LCY);
                                                                    ESP=Saldo (DL)];
                                                         SourceExpr=StartBalanceLCY + StartBalAdjLCY + "Amount (LCY)";
                                                         AutoFormatType=1;
                                                         DataSetFieldName=StartBalanceLCY___StartBalAdjLCY____Amount__LCY___Control59 }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table379;
        DataItemTableView=SORTING(Cust. Ledger Entry No.,Entry Type,Posting Date)
                          WHERE(Entry Type=CONST(Correction of Remaining Amount));
        OnPreDataItem=BEGIN
                        SETFILTER("Posting Date",CustDateFilter);
                        IF ISSERVICETIER THEN
                          Correction := 0;
                      END;

        OnAfterGetRecord=VAR
                           DtldCustLedgEntry@1000 : Record 379;
                         BEGIN
                           Correction := Correction + "Amount (LCY)";
                           IF Correction > 0 THEN BEGIN
                             DebitCorrection := Correction;
                             DebitCorrectionTotal := DebitCorrectionTotal + "Amount (LCY)";
                           END ELSE BEGIN
                             CreditCorrection := Correction;
                             CreditCorrectionTotal := CreditCorrectionTotal + "Amount (LCY)";
                           END;
                           CustBalanceLCY := CustBalanceLCY + "Amount (LCY)";
                           CustBalanceLCYTotal := CustBalanceLCYTotal + "Amount (LCY)"  ;
                         END;

        DataItemLink=Cust. Ledger Entry No.=FIELD(Entry No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18150;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 52  ;TextBox      ;2250 ;0    ;1500 ;423  ;SourceExpr="Cust. Ledger Entry"."Document No.";
                                                         DataSetFieldName=Cust__Ledger_Entry___Document_No__ }
            { 55  ;TextBox      ;1350 ;0    ;750  ;423  ;CaptionML=[ENU=Document Type;
                                                                    ESP=Tipo documento];
                                                         SourceExpr="Cust. Ledger Entry"."Document Type";
                                                         DataSetFieldName=Cust__Ledger_Entry___Document_Type_ }
            { 58  ;TextBox      ;3900 ;0    ;4350 ;423  ;SourceExpr="Entry Type";
                                                         DataSetFieldName=Detailed_Cust__Ledg__Entry__Entry_Type_ }
            { 1100102;TextBox   ;8400 ;0    ;1800 ;423  ;CaptionML=[ENU=Amount;
                                                                    ESP=Importe];
                                                         SourceExpr=DebitCorrection;
                                                         AutoFormatType=1;
                                                         DataSetFieldName=DebitCorrection }
            { 1100103;TextBox   ;10350;0    ;1800 ;423  ;CaptionML=[ENU=Amount;
                                                                    ESP=Importe];
                                                         SourceExpr=CreditCorrection;
                                                         AutoFormatType=1;
                                                         DataSetFieldName=CreditCorrection }
            { 61  ;TextBox      ;14250;0    ;1800 ;423  ;CaptionML=[ENU=Balance (LCY);
                                                                    ESP=Saldo (DL)];
                                                         SourceExpr=CustBalanceLCY;
                                                         AutoFormatType=1;
                                                         DataSetFieldName=CustBalanceLCY_Control61 }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table379;
        DataItemTableView=SORTING(Cust. Ledger Entry No.,Entry Type,Posting Date)
                          WHERE(Entry Type=CONST(Appln. Rounding));
        DataItemVarName=Detailed Cust. Ledg. Entry2;
        OnPreDataItem=BEGIN
                        SETFILTER("Posting Date",CustDateFilter);
                      END;

        OnAfterGetRecord=BEGIN
                           ApplicationRounding := ApplicationRounding + "Amount (LCY)";
                           IF ApplicationRounding > 0 THEN BEGIN
                             DebitApplicationRounding := ApplicationRounding;
                             DebitApplicationRoundingTotal := DebitApplicationRoundingTotal + DebitApplicationRounding;
                           END
                           ELSE BEGIN
                             CreditApplicationRounding := ApplicationRounding;
                             CreditApplicationRoundingTotal := CreditApplicationRoundingTotal + CreditApplicationRounding;
                           END;
                           CustBalanceLCY := CustBalanceLCY + "Amount (LCY)";
                           IF CONFIRM('%1 %2',TRUE,Text001,ApplicationRounding) THEN;
                           CustBalanceLCYTotal := CustBalanceLCYTotal + "Amount (LCY)";
                         END;

        DataItemLink=Cust. Ledger Entry No.=FIELD(Entry No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 29  ;TextBox      ;1350 ;0    ;750  ;423  ;CaptionML=[ENU=Document Type;
                                                                    ESP=Tipo documento];
                                                         SourceExpr="Cust. Ledger Entry"."Document Type";
                                                         DataSetFieldName=Cust__Ledger_Entry___Document_Type__Control29 }
            { 31  ;TextBox      ;2250 ;0    ;1500 ;423  ;SourceExpr="Cust. Ledger Entry"."Document No.";
                                                         DataSetFieldName=Cust__Ledger_Entry___Document_No___Control31 }
            { 32  ;TextBox      ;3900 ;0    ;4350 ;423  ;SourceExpr="Entry Type";
                                                         DataSetFieldName=Detailed_Cust__Ledg__Entry2__Entry_Type_ }
            { 1100104;TextBox   ;8400 ;0    ;1800 ;423  ;CaptionML=[ENU=Amount;
                                                                    ESP=Importe];
                                                         SourceExpr=DebitApplicationRounding;
                                                         AutoFormatType=1;
                                                         DataSetFieldName=DebitApplicationRounding }
            { 1100105;TextBox   ;10350;0    ;1800 ;423  ;CaptionML=[ENU=Amount;
                                                                    ESP=Importe];
                                                         SourceExpr=CreditApplicationRounding;
                                                         AutoFormatType=1;
                                                         DataSetFieldName=CreditApplicationRounding }
            { 73  ;TextBox      ;14250;0    ;1800 ;423  ;CaptionML=[ENU=Balance (LCY);
                                                                    ESP=Saldo (DL)];
                                                         SourceExpr=CustBalanceLCY;
                                                         AutoFormatType=1;
                                                         DataSetFieldName=CustBalanceLCY_Control73 }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        OnAfterGetRecord=BEGIN
                           IF NOT CustLedgEntryExists AND ((StartBalanceLCY = 0) OR ExcludeBalanceOnly) THEN BEGIN
                             StartBalanceLCY := 0;
                             CurrReport.SKIP;
                           END;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=1269;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(NOT PrintAmountsInLCY);
                         END;

          }
          CONTROLS
          {
            { 48  ;TextBox      ;1200 ;0    ;4500 ;423  ;FontBold=Yes;
                                                         SourceExpr=Customer.Name;
                                                         DataSetFieldName=Customer_Name_Control48 }
            { 62  ;TextBox      ;14250;0    ;1800 ;423  ;CaptionML=[ENU=Balance (LCY);
                                                                    ESP=Saldo (DL)];
                                                         SourceExpr=CustBalanceLCY;
                                                         AutoFormatType=1;
                                                         DataSetFieldName=CustBalanceLCY_Control62 }
            { 80  ;TextBox      ;17850;0    ;150  ;423  ;Name=StartBalanceLCY;
                                                         Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr=StartBalanceLCY;
                                                         DataSetFieldName=StartBalanceLCY_Control80 }
            { 81  ;TextBox      ;18000;0    ;150  ;423  ;Name=StartBalAdjLCY;
                                                         Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr=StartBalAdjLCY;
                                                         DataSetFieldName=StartBalAdjLCY_Control81 }
            { 1103355002;TextBox;12300;0    ;1800 ;423  ;CaptionML=[ENU=Remaining Amount;
                                                                    ESP=Importe pendiente];
                                                         SourceExpr=CustRemainAmount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr=CustCurrencyCode }
            { 1103355003;TextBox;16200;0    ;750  ;423  ;CaptionML=ENU=Applies-to Doc. No.;
                                                         SourceExpr=Customer."Currency Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(PrintAmountsInLCY);
                         END;

          }
          CONTROLS
          {
            { 15  ;TextBox      ;1200 ;0    ;4500 ;423  ;FontBold=Yes;
                                                         SourceExpr=Customer.Name;
                                                         DataSetFieldName=Customer_Name_Control15 }
            { 1100116;TextBox   ;10350;0    ;1800 ;423  ;FontBold=Yes;
                                                         SourceExpr=CustBalanceLCY - StartCustDebitAmount - StartCustDebitAmountAdj;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr=CustCurrencyCode;
                                                         DataSetFieldName=CustBalanceLCY___StartCustDebitAmount___StartCustDebitAmountAdj }
            { 1100004;TextBox   ;12300;0    ;1800 ;423  ;FontBold=Yes;
                                                         SourceExpr=CustBalanceLCY - StartCustCreditAmount - StartCustCreditAmountAdj;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr=CustCurrencyCode;
                                                         DataSetFieldName=CustBalanceLCY___StartCustCreditAmount___StartCustCreditAmountAdj }
            { 63  ;TextBox      ;16200;0    ;1800 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Balance (LCY);
                                                                    ESP=Saldo (DL)];
                                                         SourceExpr=CustBalanceLCY;
                                                         AutoFormatType=1;
                                                         DataSetFieldName=CustBalanceLCY_Control63 }
            { 1103355004;TextBox;14250;0    ;1800 ;423  ;CaptionML=[ENU=Remaining Amount;
                                                                    ESP=Importe pendiente];
                                                         SourceExpr=CustRemainAmount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr=CustCurrencyCode }
            { 1100015;TextBox   ;17850;423  ;150  ;423  ;Visible=No;
                                                         ForeColor=65535;
                                                         BackColor=16777215;
                                                         BackTransparent=Yes;
                                                         SourceExpr=StartBalanceLCYTotal;
                                                         DataSetFieldName=V_StartBalanceLCYTotal_Dataset }
            { 1100016;TextBox   ;17250;423  ;150  ;423  ;Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr=StartBalAdjLCYTotal;
                                                         DataSetFieldName=V_StartBalAdjLCYTotal_Dataset }
            { 1100017;TextBox   ;17550;423  ;150  ;423  ;Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr=CustBalanceLCYTotal;
                                                         DataSetFieldName=V_CustBalanceLCYTotal_Dataset }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=3850;
      Height=1980;
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1   ;CheckBox     ;3410 ;0    ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=[ENU=Show Amounts in LCY;
                                                              ESP=Muestra importes en DL];
                                                   SourceExpr=PrintAmountsInLCY }
      { 21  ;Label        ;0    ;0    ;3300 ;440  ;ParentControl=1 }
      { 2   ;CheckBox     ;3410 ;550  ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=[ENU=New Page per Customer;
                                                              ESP=P gina nueva por cliente];
                                                   SourceExpr=PrintOnlyOnePerPage }
      { 22  ;Label        ;0    ;550  ;3300 ;440  ;ParentControl=2 }
      { 3   ;CheckBox     ;3410 ;1540 ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=[ENU=Exclude Customers That Have a Balance Only;
                                                              ESP=Excluye s¢lo clientes con saldo a fecha];
                                                   SourceExpr=ExcludeBalanceOnly }
      { 23  ;Label        ;0    ;1100 ;3300 ;880  ;ParentControl=3;
                                                   VertAlign=Bottom;
                                                   MultiLine=Yes }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[ENU=Options;
                             ESP=Opciones] }

      { 1   ;2   ;Field     ;
                  CaptionML=[ENU=Show Amounts in LCY;
                             ESP=Muestra importes en DL];
                  SourceExpr=PrintAmountsInLCY }

      { 2   ;2   ;Field     ;
                  CaptionML=[ENU=New Page per Customer;
                             ESP=P gina nueva por cliente];
                  SourceExpr=PrintOnlyOnePerPage }

      { 3   ;2   ;Field     ;
                  CaptionML=[ENU=Exclude Customers That Have a Balance Only;
                             ESP=Excluye s¢lo clientes con saldo a fecha];
                  SourceExpr=ExcludeBalanceOnly;
                  MultiLine=Yes }

    }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=Period: %1;ESP=Periodo: %1';
      CustLedgEntry@1016 : Record 21;
      PrintAmountsInLCY@1001 : Boolean;
      PrintOnlyOnePerPage@1002 : Boolean;
      ExcludeBalanceOnly@1003 : Boolean;
      CustFilter@1004 : Text[250];
      CustDateFilter@1005 : Text[30];
      AmountCaption@1006 : Text[80];
      RemainingAmtCaption@1007 : Text[30];
      CustAmount@1008 : Decimal;
      CustRemainAmount@1009 : Decimal;
      CustBalanceLCY@1010 : Decimal;
      CustCurrencyCode@1011 : Code[10];
      CustEntryDueDate@1012 : Date;
      StartBalanceLCY@1013 : Decimal;
      StartBalAdjLCY@1015 : Decimal;
      Correction@1019 : Decimal;
      ApplicationRounding@1017 : Decimal;
      CustLedgEntryExists@1014 : Boolean;
      Text001@1018 : TextConst 'ENU=Appln Rounding:;ESP=Redondeo de liquidaci¢n:';
      PageGroupNo@1021 : Integer;
      StartCustDebitAmount@1100001 : Decimal;
      StartCustCreditAmount@1100000 : Decimal;
      CustCredit@1100002 : Decimal;
      CustDebit@1100003 : Decimal;
      StartCustDebitAmountAdj@1100004 : Decimal;
      StartCustCreditAmountAdj@1100005 : Decimal;
      DebitCorrection@1100006 : Decimal;
      CreditCorrection@1100007 : Decimal;
      DebitApplicationRounding@1100008 : Decimal;
      CreditApplicationRounding@1100009 : Decimal;
      StartCustCreditAmountTotal@1100011 : Decimal;
      StartCustDebitAmountTotal@1100012 : Decimal;
      DebitCorrectionTotal@1100013 : Decimal;
      CreditCorrectionTotal@1100014 : Decimal;
      DebitApplicationRoundingTotal@1100015 : Decimal;
      CreditApplicationRoundingTotal@1100016 : Decimal;
      StartBalanceLCYTotal@1100010 : Decimal;
      StartBalAdjLCYTotal@1100017 : Decimal;
      CustBalanceLCYTotal@1100018 : Decimal;

    BEGIN
    {
      // INCOMING

      $001 AJS 12012011 Eliminar las columnas "Cust. Ledger Entry"."Applies-to Doc. No." y "Cust. Ledger Entry"."Entry No."

      $002 AJS 12012011 Mover la columna que muestra la divisa del cliente junto a "Cust. Ledger Entry"."Remaining Amount"

      $003 AJS 12012011 Dar mas espacio a las columnas "Cust. Ledger Entry"."Document No." y "Cust. Ledger Entry".Description

      $004 Se ha sacado el campo Open (ReqFilterFields) en Cust. Ledger Entry

      $005 Se incluye un total para la columna "Cust. Ledger Entry"."Remaining Amt. (LCY)", en el pie correspondiente al
         final del cliente

      $006 Se incluye un CREATETOTALS de "Cust. Ledger Entry"."Remaining Amt. (LCY)" y de CustRemainAmount para mostrarlo
         en el pie de cada cliente

      $007 AJS 14112012 Cambio la columna Saldo DL para que sea la traduccion del importe pendiente no del importe
    }
    END.
  }
  RDLDATA
  {
  }
}
