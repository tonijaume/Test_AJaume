OBJECT Report 7010071 CNT - Lista pasajeros x servic
{
  OBJECT-PROPERTIES
  {
    Date=19/12/14;
    Time=[ 9:46:15];
    Modified=Yes;
    Version List=AIC2009,CNT;
  }
  PROPERTIES
  {
    LeftMargin=1000;
    Orientation=Landscape;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table7009796;
        DataItemTableView=SORTING(Fecha,Transportista,Numero Bus)
                          WHERE(Tipo transfer=CONST(Salida));
        NewPagePerRecord=Yes;
        DataItemVarName=diSalida;
        OnPreDataItem=BEGIN
                        rCompany.FINDFIRST;
                        rCompany.CALCFIELDS(Picture);

                        rParPer.FINDFIRST;

                        rAgrTMP.RESET;
                        rAgrTMP.DELETEALL;
                      END;

        OnAfterGetRecord=BEGIN
                           wAccion := _RetornarAccion(diSalida);

                           wAdultsSer  := 0;
                           wChildsSer  := 0;
                           wInfantsSer := 0;
                         END;

        ReqFilterFields=Fecha,Transportista,Tipo vehiculo,N§ Agrupacion;
        CalcFields=Nombre Transportista;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=27450;
            SectionHeight=3807;
          }
          CONTROLS
          {
            { 1100217000;Label  ;9150 ;0    ;6150 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=PASSENGERS LIST X SERVICE;
                                                                    ESP=LISTAS DE PASAJEROS X TRANSPORTE] }
            { 1100217001;PictureBox;0 ;0    ;7800 ;2961 ;SourceExpr=rCompany.Picture }
            { 1100217002;Label  ;7950 ;846  ;3600 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=SERVICE DATE;
                                                                    ESP=FECHA DE SERVICIO] }
            { 1100217003;TextBox;11700;846  ;1650 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr=Fecha }
            { 1100217004;Label  ;7950 ;1269 ;3600 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=VENDOR;
                                                                    ESP=PROVEEDOR] }
            { 1100217005;TextBox;11700;1269 ;5850 ;423  ;FontSize=9;
                                                         SourceExpr="Nombre Transportista" }
            { 1100217006;TextBox;11700;1692 ;1650 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr="Numero Bus" }
            { 1100217007;Label  ;7950 ;1692 ;3600 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=UNIT NUMBER;
                                                                    ESP=UNIDAD] }
            { 1100217008;Label  ;18000;0    ;3600 ;846  ;FontSize=9;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=SERVICE ID;
                                                                    ESP=ID SERVICIO] }
            { 1100217009;TextBox;21750;0    ;5250 ;846  ;HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontSize=14;
                                                         SourceExpr="N§ Agrupacion" }
            { 1100217010;Label  ;18000;1269 ;3600 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=TRANSFER GUIDE;
                                                                    ESP=TRASLADISTA] }
            { 1100217011;TextBox;21750;1269 ;5250 ;423  ;FontSize=9;
                                                         SourceExpr=_GetTrasladista(diSalida) }
            { 1100217012;TextBox;21750;1692 ;5250 ;423  ;FontSize=9;
                                                         SourceExpr=_GetMaletero(diSalida) }
            { 1100217013;Label  ;18000;1692 ;3600 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=PORTER;
                                                                    ESP=MALETERO] }
            { 1100217014;TextBox;11700;2538 ;1050 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr="Hora presentacion";
                                                         Format=<Hours24,2>:<Minutes,2> }
            { 1100217015;Label  ;7950 ;2538 ;3600 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=STARTING POINT;
                                                                    ESP=PRESENTACION] }
            { 1100217016;TextBox;12900;2538 ;5850 ;423  ;FontSize=9;
                                                         SourceExpr="Lugar presentacion" }
            { 1100217017;Label  ;0    ;3384 ;1650 ;423  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Action;
                                                                    ESP=Acci¢n] }
            { 1100217019;Label  ;1800 ;3384 ;1350 ;423  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Pick up;
                                                                    ESP=Hora] }
            { 1100217020;Label  ;3300 ;3384 ;5100 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Place;
                                                                    ESP=Ubicaci¢n] }
            { 1100217021;Label  ;8550 ;3384 ;5100 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Passenger Name;
                                                                    ESP=Nombre Pax] }
            { 1100217022;Label  ;13800;3384 ;1350 ;423  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Persons;
                                                                    ESP=Pax] }
            { 1100217023;Label  ;15300;3384 ;4800 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Touroperator;
                                                                    ESP=Touroperador] }
            { 1100217024;Label  ;20250;3384 ;2100 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Booking;
                                                                    ESP=Booking] }
            { 1100217025;Label  ;22500;3384 ;4800 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Destination;
                                                                    ESP=Destino] }
            { 1100217044;Label  ;18000;846  ;3600 ;423  ;ParentControl=1100217053;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=CAPACITY;
                                                                    ESP=CAPACIDAD] }
            { 1100217053;TextBox;21750;846  ;1650 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr="Capacidad Vehiculo" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=27450;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1100217091;TextBox;26850;423  ;600  ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1100217092;TextBox;0    ;423  ;3900 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=CURRENTDATETIME }
            { 1100217093;TextBox;24900;423  ;1950 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=Text004 }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table7009800;
        DataItemTableView=SORTING(N§ Agrupacion,Hora recogida);
        DataItemVarName=diRecSalida;
        DataItemLink=N§ Agrupacion=FIELD(N§ Agrupacion);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=27450;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1100217033;TextBox;13800;0    ;1350 ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         SourceExpr=wPaxSer }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table7009744;
        DataItemTableView=SORTING(Agrupacion salida,Hotel salida,Bono,Vuelo salida,Tipo Persona,Nombre);
        DataItemVarName=diRsvSalida;
        OnPreDataItem=BEGIN
                        wBonoAnt := '';
                      END;

        OnAfterGetRecord=BEGIN
                           IF Bono <> wBonoAnt THEN
                           BEGIN
                             wVuelo := "IATA origen salida" + ' ' + "Compa¤ia salida" + "Vuelo salida";

                             wAdults  := _GetPersons(diRsvSalida, rParPer."Codigo Adulto", diSalida."Tipo transfer");
                             wChilds  := _GetPersons(diRsvSalida, rParPer."Codigo Ni¤o", diSalida."Tipo transfer");
                             wInfants := _GetPersons(diRsvSalida, rParPer."Codigo Infant", diSalida."Tipo transfer");
                             wPax     := FORMAT(wAdults) + '.' + FORMAT(wChilds) + '.' + FORMAT(wInfants);

                             wAdultsSer  += wAdults;
                             wChildsSer  += wChilds;
                             wInfantsSer += wInfants;
                             wPaxSer     := FORMAT(wAdultsSer) + '.' + FORMAT(wChildsSer) + '.' + FORMAT(wInfantsSer);

                             wBonoAnt := Bono;
                           END
                           ELSE
                             CurrReport.SKIP;
                         END;

        DataItemLink=Agrupacion salida=FIELD(N§ Agrupacion),
                     Hotel salida=FIELD(Hotel),
                     Compa¤ia salida=FIELD(Compa¤ia),
                     Vuelo salida=FIELD(Vuelo),
                     IATA destino salida=FIELD(IATA);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=27450;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1100217018;TextBox;0    ;0    ;1650 ;423  ;HorzAlign=Center;
                                                         SourceExpr=wAccion }
            { 1100217026;TextBox;1800 ;0    ;1350 ;423  ;HorzAlign=Center;
                                                         SourceExpr=diRecSalida."Hora recogida";
                                                         Format=<Hours24,2>:<Minutes,2> }
            { 1100217027;TextBox;3300 ;0    ;5100 ;423  ;HorzAlign=Left;
                                                         SourceExpr=cNom.nom_hotel("Hotel salida") }
            { 1100217028;TextBox;8550 ;0    ;5100 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Nombre }
            { 1100217029;TextBox;13800;0    ;1350 ;423  ;HorzAlign=Center;
                                                         SourceExpr=wPax }
            { 1100217030;TextBox;15300;0    ;4800 ;423  ;HorzAlign=Left;
                                                         SourceExpr=cNom.nom_touroperador(TourOperador) }
            { 1100217031;TextBox;20250;0    ;2100 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Bono }
            { 1100217032;TextBox;22500;0    ;4800 ;423  ;HorzAlign=Left;
                                                         SourceExpr=wVuelo }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table7009796;
        DataItemTableView=SORTING(Fecha,Transportista,Numero Bus)
                          WHERE(Tipo transfer=CONST(Entrada));
        DataItemVarName=diEnlace;
        OnAfterGetRecord=BEGIN
                           wAccion := _RetornarAccion(diEnlace);

                           wAdultsSer  := 0;
                           wChildsSer  := 0;
                           wInfantsSer := 0;

                           rAgrTMP := diEnlace;
                           rAgrTMP.INSERT;
                         END;

        DataItemLink=Fecha=FIELD(Fecha),
                     Transportista=FIELD(Transportista),
                     Numero Bus=FIELD(Numero Bus);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=27450;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 1100217034;TextBox;3750 ;0    ;2850 ;846  ;HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontSize=14;
                                                         SourceExpr="N§ Agrupacion" }
            { 1100217035;Label  ;0    ;0    ;3600 ;846  ;FontSize=9;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=SERVICE ID;
                                                                    ESP=ID SERVICIO] }
            { 1100217036;Label  ;0    ;846  ;1650 ;423  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Action;
                                                                    ESP=Acci¢n] }
            { 1100217037;Label  ;1800 ;846  ;1350 ;423  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Pick up;
                                                                    ESP=Hora] }
            { 1100217038;Label  ;3300 ;846  ;5100 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Place;
                                                                    ESP=Ubicaci¢n] }
            { 1100217039;Label  ;8550 ;846  ;5100 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Passenger Name;
                                                                    ESP=Nombre Pax] }
            { 1100217040;Label  ;13800;846  ;1350 ;423  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Persons;
                                                                    ESP=Pax] }
            { 1100217041;Label  ;15300;846  ;4800 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Touroperator;
                                                                    ESP=Touroperador] }
            { 1100217042;Label  ;20250;846  ;2100 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Booking;
                                                                    ESP=Booking] }
            { 1100217043;Label  ;22500;846  ;4800 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Destination;
                                                                    ESP=Destino] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table7009800;
        DataItemTableView=SORTING(N§ Agrupacion,Hora recogida);
        DataItemVarName=diRecEnlace;
        DataItemLink=N§ Agrupacion=FIELD(N§ Agrupacion);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=27450;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1100217054;TextBox;13800;0    ;1350 ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         SourceExpr=wPaxSer }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table7009744;
        DataItemTableView=SORTING(Agrupacion entrada,Hotel entrada,Bono,Vuelo entrada,Tipo Persona,Nombre);
        DataItemVarName=diRsvEnlace;
        OnPreDataItem=BEGIN
                        wBonoAnt := '';
                      END;

        OnAfterGetRecord=VAR
                           lrTraDest@1100217000 : Record 7009916;
                         BEGIN
                           IF Bono <> wBonoAnt THEN
                           BEGIN
                             wVuelo := "IATA destino entrada" + ' ' + "Compa¤ia entrada" + "Vuelo entrada";

                             IF diEnlace."Traslado en destino" THEN
                             BEGIN
                               //. Buscamos el traslado en destino para el detalle
                               IF lrTraDest.GET(Delegacion, "N§ Interno", "N§ Periodo") THEN
                               BEGIN
                                 wOrigen  := lrTraDest."Descripcion origen";
                                 wDestino := lrTraDest."Descripcion destino";
                                 wHora    := diRecEnlace."Hora recogida";
                               END;
                             END
                             ELSE
                             BEGIN
                               wOrigen  := wVuelo;
                               wDestino := cNom.nom_hotel("Hotel entrada");
                               wHora    := "Hora entrada";
                             END;

                             wAdults  := _GetPersons(diRsvEnlace, rParPer."Codigo Adulto", diEnlace."Tipo transfer");
                             wChilds  := _GetPersons(diRsvEnlace, rParPer."Codigo Ni¤o", diEnlace."Tipo transfer");
                             wInfants := _GetPersons(diRsvEnlace, rParPer."Codigo Infant", diEnlace."Tipo transfer");
                             wPax     := FORMAT(wAdults) + '.' + FORMAT(wChilds) + '.' + FORMAT(wInfants);

                             wAdultsSer  += wAdults;
                             wChildsSer  += wChilds;
                             wInfantsSer += wInfants;
                             wPaxSer     := FORMAT(wAdultsSer) + '.' + FORMAT(wChildsSer) + '.' + FORMAT(wInfantsSer);

                             wBonoAnt := Bono;
                           END
                           ELSE
                             CurrReport.SKIP;
                         END;

        DataItemLink=Agrupacion entrada=FIELD(N§ Agrupacion),
                     Hotel entrada=FIELD(Hotel),
                     Compa¤ia entrada=FIELD(Compa¤ia),
                     Vuelo entrada=FIELD(Vuelo),
                     IATA origen entrada=FIELD(IATA);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=27450;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1100217045;TextBox;0    ;0    ;1650 ;423  ;HorzAlign=Center;
                                                         SourceExpr=wAccion }
            { 1100217046;TextBox;1800 ;0    ;1350 ;423  ;HorzAlign=Center;
                                                         SourceExpr=wHora;
                                                         Format=<Hours24,2>:<Minutes,2> }
            { 1100217047;TextBox;3300 ;0    ;5100 ;423  ;HorzAlign=Left;
                                                         SourceExpr=wOrigen }
            { 1100217048;TextBox;8550 ;0    ;5100 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Nombre }
            { 1100217049;TextBox;13800;0    ;1350 ;423  ;HorzAlign=Center;
                                                         SourceExpr=wPax }
            { 1100217050;TextBox;15300;0    ;4800 ;423  ;HorzAlign=Left;
                                                         SourceExpr=cNom.nom_touroperador(TourOperador) }
            { 1100217051;TextBox;20250;0    ;2100 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Bono }
            { 1100217052;TextBox;22500;0    ;4800 ;423  ;HorzAlign=Left;
                                                         SourceExpr=wDestino }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemTable=Table7009796;
        DataItemTableView=SORTING(Fecha,Transportista,Numero Bus)
                          WHERE(Tipo transfer=CONST(Entrada));
        NewPagePerRecord=Yes;
        DataItemVarName=diEntrada;
        OnPreDataItem=BEGIN
                        diSalida.COPYFILTER("N§ Agrupacion", "N§ Agrupacion");
                        diSalida.COPYFILTER(Fecha          , Fecha);
                        diSalida.COPYFILTER(Transportista  , Transportista);
                        diSalida.COPYFILTER("Tipo vehiculo", "Tipo vehiculo");
                      END;

        OnAfterGetRecord=BEGIN
                           //. Esta tabla temporal guarda las entradas que se han listado enlazadas con una salida
                           IF rAgrTMP.GET(diEntrada."N§ Agrupacion") THEN
                             CurrReport.SKIP;

                           wAccion := _RetornarAccion(diEntrada);

                           wAdultsSer  := 0;
                           wChildsSer  := 0;
                           wInfantsSer := 0;
                         END;

        CalcFields=Nombre Transportista;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=27450;
            SectionHeight=3807;
          }
          CONTROLS
          {
            { 1100217055;Label  ;9150 ;0    ;6150 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=PASSENGERS LIST X SERVICE;
                                                                    ESP=LISTAS DE PASAJEROS X TRANSPORTE] }
            { 1100217056;PictureBox;0 ;0    ;7800 ;2961 ;SourceExpr=rCompany.Picture }
            { 1100217057;Label  ;7950 ;846  ;3600 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=SERVICE DATE;
                                                                    ESP=FECHA DE SERVICIO] }
            { 1100217058;TextBox;11700;846  ;1650 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr=Fecha }
            { 1100217059;Label  ;7950 ;1269 ;3600 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=VENDOR;
                                                                    ESP=PROVEEDOR] }
            { 1100217060;TextBox;11700;1269 ;5850 ;423  ;FontSize=9;
                                                         SourceExpr="Nombre Transportista" }
            { 1100217061;TextBox;11700;1692 ;1650 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr="Numero Bus" }
            { 1100217062;Label  ;7950 ;1692 ;3600 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=UNIT NUMBER;
                                                                    ESP=UNIDAD] }
            { 1100217063;Label  ;18000;0    ;3600 ;846  ;FontSize=9;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=SERVICE ID;
                                                                    ESP=ID SERVICIO] }
            { 1100217064;TextBox;21750;0    ;5250 ;846  ;HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontSize=14;
                                                         SourceExpr="N§ Agrupacion" }
            { 1100217065;Label  ;18000;1269 ;3600 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=TRANSFER GUIDE;
                                                                    ESP=TRASLADISTA] }
            { 1100217066;TextBox;21750;1269 ;5250 ;423  ;FontSize=9;
                                                         SourceExpr=_GetTrasladista(diEntrada) }
            { 1100217067;TextBox;21750;1692 ;5250 ;423  ;FontSize=9;
                                                         SourceExpr=_GetMaletero(diEntrada) }
            { 1100217068;Label  ;18000;1692 ;3600 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=PORTER;
                                                                    ESP=MALETERO] }
            { 1100217069;TextBox;11700;2538 ;1050 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr="Hora presentacion";
                                                         Format=<Hours24,2>:<Minutes,2> }
            { 1100217070;Label  ;7950 ;2538 ;3600 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=STARTING POINT;
                                                                    ESP=PRESENTACION] }
            { 1100217071;TextBox;12900;2538 ;5850 ;423  ;FontSize=9;
                                                         SourceExpr="Lugar presentacion" }
            { 1100217072;Label  ;0    ;3384 ;1650 ;423  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Action;
                                                                    ESP=Acci¢n] }
            { 1100217073;Label  ;1800 ;3384 ;1350 ;423  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Pick up;
                                                                    ESP=Hora] }
            { 1100217074;Label  ;3300 ;3384 ;5100 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Place;
                                                                    ESP=Ubicaci¢n] }
            { 1100217075;Label  ;8550 ;3384 ;5100 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Passenger Name;
                                                                    ESP=Nombre Pax] }
            { 1100217076;Label  ;13800;3384 ;1350 ;423  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Persons;
                                                                    ESP=Pax] }
            { 1100217077;Label  ;15300;3384 ;4800 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Touroperator;
                                                                    ESP=Touroperador] }
            { 1100217078;Label  ;20250;3384 ;2100 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Booking;
                                                                    ESP=Booking] }
            { 1100217079;Label  ;22500;3384 ;4800 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Destination;
                                                                    ESP=Destino] }
            { 1100217080;Label  ;18000;846  ;3600 ;423  ;ParentControl=1100217081;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=CAPACITY;
                                                                    ESP=CAPACIDAD] }
            { 1100217081;TextBox;21750;846  ;1650 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr="Capacidad Vehiculo" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=27450;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1100217094;TextBox;26850;423  ;600  ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1100217095;TextBox;0    ;423  ;3900 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=CURRENTDATETIME }
            { 1100217096;TextBox;24900;423  ;1950 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=Text004 }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table7009800;
        DataItemTableView=SORTING(N§ Agrupacion,Hora recogida);
        DataItemVarName=diRecEntrada;
        DataItemLink=N§ Agrupacion=FIELD(N§ Agrupacion);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=27450;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1100217090;TextBox;13800;0    ;1350 ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         SourceExpr=wPaxSer }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table7009744;
        DataItemTableView=SORTING(Agrupacion entrada,Hotel entrada,Bono,Vuelo entrada,Tipo Persona,Nombre);
        DataItemVarName=diRsvEntrada;
        OnPreDataItem=BEGIN
                        wBonoAnt := '';
                      END;

        OnAfterGetRecord=VAR
                           lrTraDest@1100217000 : Record 7009916;
                         BEGIN
                           IF Bono <> wBonoAnt THEN
                           BEGIN
                             wVuelo := "IATA destino entrada" + ' ' + "Compa¤ia entrada" + "Vuelo entrada";

                             IF diEntrada."Traslado en destino" THEN
                             BEGIN
                               //. Buscamos el traslado en destino para el detalle
                               IF lrTraDest.GET(Delegacion, "N§ Interno", "N§ Periodo") THEN
                               BEGIN
                                 wOrigen  := lrTraDest."Descripcion origen";
                                 wDestino := lrTraDest."Descripcion destino";
                                 wHora    := diRecEntrada."Hora recogida";
                               END;
                             END
                             ELSE
                             BEGIN
                               wOrigen  := wVuelo;
                               wDestino := cNom.nom_hotel("Hotel entrada");
                               wHora    := "Hora entrada";
                             END;

                             wAdults  := _GetPersons(diRsvEntrada, rParPer."Codigo Adulto", diEntrada."Tipo transfer");
                             wChilds  := _GetPersons(diRsvEntrada, rParPer."Codigo Ni¤o", diEntrada."Tipo transfer");
                             wInfants := _GetPersons(diRsvEntrada, rParPer."Codigo Infant", diEntrada."Tipo transfer");
                             wPax     := FORMAT(wAdults) + '.' + FORMAT(wChilds) + '.' + FORMAT(wInfants);

                             wAdultsSer  += wAdults;
                             wChildsSer  += wChilds;
                             wInfantsSer += wInfants;
                             wPaxSer     := FORMAT(wAdultsSer) + '.' + FORMAT(wChildsSer) + '.' + FORMAT(wInfantsSer);

                             wBonoAnt := Bono;
                           END
                           ELSE
                             CurrReport.SKIP;
                         END;

        DataItemLink=Agrupacion entrada=FIELD(N§ Agrupacion),
                     Hotel entrada=FIELD(Hotel),
                     Compa¤ia entrada=FIELD(Compa¤ia),
                     Vuelo entrada=FIELD(Vuelo),
                     IATA origen entrada=FIELD(IATA);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=27450;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1100217082;TextBox;0    ;0    ;1650 ;423  ;HorzAlign=Center;
                                                         SourceExpr=wAccion }
            { 1100217083;TextBox;1800 ;0    ;1350 ;423  ;HorzAlign=Center;
                                                         SourceExpr=wHora;
                                                         Format=<Hours24,2>:<Minutes,2> }
            { 1100217084;TextBox;3300 ;0    ;5100 ;423  ;HorzAlign=Left;
                                                         SourceExpr=wOrigen }
            { 1100217085;TextBox;8550 ;0    ;5100 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Nombre }
            { 1100217086;TextBox;13800;0    ;1350 ;423  ;HorzAlign=Center;
                                                         SourceExpr=wPax }
            { 1100217087;TextBox;15300;0    ;4800 ;423  ;HorzAlign=Left;
                                                         SourceExpr=cNom.nom_touroperador(TourOperador) }
            { 1100217088;TextBox;20250;0    ;2100 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Bono }
            { 1100217089;TextBox;22500;0    ;4800 ;423  ;HorzAlign=Left;
                                                         SourceExpr=wDestino }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      rCompany@1100217000 : Record 79;
      rParPer@1100217008 : Record 7009701;
      rAgrTMP@1100217019 : TEMPORARY Record 7009796;
      cNom@1100217004 : Codeunit 7009702;
      wAccion@1100217001 : Text[30];
      Text003@1100217003 : TextConst 'ENU=Change zone;ESP=Cambio zona';
      Text004@1100217002 : TextConst 'ENU=Page;ESP=Pagina';
      wPax@1100217005 : Text[30];
      wVuelo@1100217006 : Text[30];
      wOrigen@1100217016 : Text[80];
      wDestino@1100217017 : Text[80];
      wPaxSer@1100217015 : Text[30];
      wBonoAnt@1100217007 : Code[10];
      wAdults@1100217009 : Integer;
      wChilds@1100217010 : Integer;
      wInfants@1100217011 : Integer;
      wAdultsSer@1100217012 : Integer;
      wChildsSer@1100217013 : Integer;
      wInfantsSer@1100217014 : Integer;
      wHora@1100217018 : Time;

    LOCAL PROCEDURE _GetTrasladista@1100217006(prAgr@1100217000 : Record 7009796) : Text[30];
    VAR
      rTrasladista@1100217001 : Record 7009904;
      rGuiaAgr@1100217002 : Record 7009905;
    BEGIN
      // _GetTrasladista

      rGuiaAgr.RESET;
      rGuiaAgr.SETRANGE ("Num.Agrupacion", prAgr."N§ Agrupacion");
      rGuiaAgr.SETFILTER("Cod.Guia"      , '<>%1', '');
      IF rGuiaAgr.FINDFIRST THEN
      BEGIN
        rTrasladista.GET(rGuiaAgr."Cod.Guia");
        EXIT(rTrasladista.Nombre);
      END;
    END;

    LOCAL PROCEDURE _GetMaletero@1100217000(prAgr@1100217000 : Record 7009796) : Text[30];
    VAR
      rMaletero@1100217001 : Record 7009900;
      rMaletAgr@1100217002 : Record 7009903;
    BEGIN
      // _GetTrasladista

      rMaletAgr.RESET;
      rMaletAgr.SETRANGE ("Num Agrupacion", prAgr."N§ Agrupacion");
      rMaletAgr.SETFILTER("Cod. Maletero" , '<>%1', '');
      IF rMaletAgr.FINDFIRST THEN
      BEGIN
        rMaletero.GET(rMaletAgr."Cod. Maletero");
        EXIT(rMaletero.Nombre);
      END;
    END;

    LOCAL PROCEDURE _RetornarAccion@1100217001(prAgr@1100217000 : Record 7009796) : Text[30];
    BEGIN
      // _RetornarAccion

      IF prAgr."Traslado en destino" THEN
        EXIT(Text003)
      ELSE
        EXIT(FORMAT(prAgr."Tipo transfer"));
    END;

    LOCAL PROCEDURE _GetPersons@1100217020(prRsv@1100217000 : Record 7009744;pwTipoPersona@1100217001 : Code[10];pwTipoAgrupacion@1100217003 : Integer) : Integer;
    VAR
      lrRsv@1100217002 : Record 7009744;
    BEGIN
      // _GetPersons

      lrRsv.RESET;
      lrRsv.SETCURRENTKEY(Delegacion, "N§ Interno", "N§ Periodo");
      lrRsv.SETRANGE(Delegacion    , prRsv.Delegacion);
      lrRsv.SETRANGE("N§ Interno"  , prRsv."N§ Interno");
      lrRsv.SETRANGE("N§ Periodo"  , prRsv."N§ Periodo");
      lrRsv.SETRANGE("Tipo Persona", pwTipoPersona);

      IF pwTipoAgrupacion = 0 THEN
        lrRsv.SETRANGE("Agrupacion entrada", prRsv."Agrupacion entrada")
      ELSE
        lrRsv.SETRANGE("Agrupacion salida", prRsv."Agrupacion salida");

      EXIT(lrRsv.COUNT);
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}
