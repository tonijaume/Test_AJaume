OBJECT Report 7010174 Informe C/I Excursiones
{
  OBJECT-PROPERTIES
  {
    Date=15/01/15;
    Time=10:55:38;
    Modified=Yes;
    Version List=AIC2009;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Report C/I Excursions;
               ESP=Informe C/I Excursiones];
    OnPreReport=BEGIN
                  rPar.FINDFIRST;
                END;

    Orientation=Landscape;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table7010163;
        DataItemTableView=SORTING(Estado,Fecha,Zona Excursion,Excursion)
                          WHERE(Estado=CONST(Confirmada));
        DataItemVarName=diServicio;
        OnPreDataItem=BEGIN
                        CurrReport.CREATETOTALS(w_ingreso, w_coste_servicio, w_margen, w_coste_autocar, w_coste_proveedor,
                                                w_coste_GO, w_coste_TO, w_coste_GV);

                        IF GETFILTER(Fecha) = '' THEN
                          w_filtro_fechas := Text000
                        ELSE
                          w_filtro_fechas := GETFILTER(Fecha);

                        IF GETFILTER(Excursion) = '' THEN
                          w_filtro_excursiones := Text000
                        ELSE
                          w_filtro_excursiones := GETFILTER(Excursion);

                        IF wTouroperador = '' THEN
                          w_filtro_touroperador := Text024
                        ELSE
                          w_filtro_touroperador := wTouroperador;

                        //. Vaciamos el temporal
                        CLEAR(rTempCI);
                        IF rTempCI.FINDSET(TRUE) THEN
                          rTempCI.DELETEALL;

                        IF wGenerarExcel THEN
                        BEGIN
                          wLinea := 0;

                          rExcel.RESET;
                          rExcel.DELETEALL;

                          wLinea += 1;
                          _InsertaExcel(1 , Text008              , TRUE , 2, '', 0);
                          _InsertaExcel(2 , w_filtro_fechas      , FALSE, 2, '', 0);
                          _InsertaExcel(5 , Text009              , TRUE , 2, '', 0);
                          _InsertaExcel(6 , w_filtro_excursiones , FALSE, 2, '', 0);
                          _InsertaExcel(9 , Text022              , TRUE , 2, '', 0);
                          _InsertaExcel(12, w_filtro_touroperador, FALSE, 2, '', 0); //+$003

                          wLinea += 2;
                          _InsertaExcel(1 , Text010, TRUE, 2, '', 0);
                          _InsertaExcel(2 , Text011, TRUE, 2, 'C' + STRSUBSTNO('%1', wLinea), 0); //+$004
                          _InsertaExcel(4 , Text028, TRUE, 2, '', 0); //+$005
                          _InsertaExcel(5 , Text012, TRUE, 4, '', 0);
                          _InsertaExcel(6 , Text013, TRUE, 4, '', 0);
                          _InsertaExcel(7 , Text014, TRUE, 4, '', 0);
                          _InsertaExcel(8 , Text015, TRUE, 4, '', 0);
                          _InsertaExcel(9 , Text016, TRUE, 4, '', 0);
                          _InsertaExcel(10, Text017, TRUE, 4, '', 0);
                          _InsertaExcel(11, Text018, TRUE, 4, '', 0);
                          _InsertaExcel(12, Text019, TRUE, 4, '', 0);
                          _InsertaExcel(13, Text027, TRUE, 4, '', 0); //+$003
                        END;
                      END;

        OnAfterGetRecord=VAR
                           rCI@1103355000 : Record 7010166;
                         BEGIN
                           CALCFIELDS("N§ Adultos", "N§ Ni¤os");

                           CosteIngresoServicio;

                           //. Si se ha marcado la opcion ocular sin coste Proveedor Excursi¢n No se ense¤a
                           IF wOcultarSinCostePE THEN
                             IF w_coste_proveedor = 0 THEN
                               CurrReport.SKIP;

                           w_margen    := w_ingreso - w_coste_servicio;
                           w_porciento := 0;
                           IF w_ingreso <> 0 THEN
                             w_porciento := ROUND((w_margen * 100) / w_ingreso);

                           // Rellenamos el temporal para realizar el resumen por codigo de excursion

                           IF NOT rTempCI.GET(Excursion, 0, 0) THEN BEGIN
                             rTempCI.INIT;
                             rTempCI.Delegacion := Excursion;
                             rTempCI.INSERT;
                           END;

                           rTempCI.Importe                      += w_ingreso;
                           rTempCI."Importe sin impuestos (DL)" += w_coste_servicio;
                           rTempCI."Importe con impuestos (DL)" += w_coste_proveedor;
                           rTempCI."Precio x Vehiculo"          += w_coste_autocar;
                           rTempCI."Importe sin Impuesto"       += w_coste_GO;
                           rTempCI."Importe con Impuesto"       += w_coste_GV;
                           rTempCI."Importe Validacion"         += w_coste_TO; //+$003
                           rTempCI.MODIFY;

                           IF wGenerarExcel THEN
                           BEGIN
                             wLinea += 1;
                             _InsertaExcel(1 , FORMAT(Fecha)               , (w_margen < 0), 2, '', 0);
                             _InsertaExcel(2 , Excursion                   , (w_margen < 0), 2, '', 0);
                             _InsertaExcel(3 , cNom.nom_producto(Excursion), (w_margen < 0), 2, '', 0); //+$004
                             _InsertaExcel(4 , rExc.NombreProveedorServicio(Excursion), (w_margen < 0), 2, '', 0); //+$005
                             _InsertaExcel(5 , FORMAT(w_ingreso)           , (w_margen < 0), 4, '', 0);
                             _InsertaExcel(6 , FORMAT(w_coste_servicio)    , (w_margen < 0), 4, '', 0);
                             _InsertaExcel(7 , FORMAT(w_margen)            , (w_margen < 0), 4, '', 0);
                             _InsertaExcel(8 , FORMAT(w_porciento)         , (w_margen < 0), 4, '', 0);
                             _InsertaExcel(9 , FORMAT(w_coste_autocar)     , (w_margen < 0), 4, '', 0);
                             _InsertaExcel(10, FORMAT(w_coste_proveedor)   , (w_margen < 0), 4, '', 0);
                             _InsertaExcel(11, FORMAT(w_coste_GO)          , (w_margen < 0), 4, '', 0);
                             _InsertaExcel(12, FORMAT(w_coste_GV)          , (w_margen < 0), 4, '', 0);
                             _InsertaExcel(13, FORMAT(w_coste_TO)          , (w_margen < 0), 4, '', 0); //+$003
                           END;
                         END;

        OnPostDataItem=BEGIN
                         IF wGenerarExcel THEN
                         BEGIN
                           rExcel.CreateBook;
                           rExcel.CreateSheet(Text023, CurrReport.OBJECTID, COMPANYNAME, USERID, FALSE, TRUE, '');
                         END;
                       END;

        ReqFilterFields=Fecha,Excursion;
        GroupTotalFields=Estado,Fecha;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=22950;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 1   ;TextBox      ;0    ;0    ;9750 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=COMPANYNAME }
            { 2   ;Label        ;17250;0    ;5700 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Report C/I Excursions;
                                                                    ESP=Informe C/I Excursiones] }
            { 3   ;Shape        ;0    ;423  ;22950;423  ;ShapeStyle=HorzLine }
            { 53  ;Label        ;0    ;846  ;2250 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Period;
                                                                    ESP=Periodo] }
            { 54  ;Label        ;6900 ;846  ;2400 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Excursions;
                                                                    ESP=Excursiones] }
            { 55  ;TextBox      ;2400 ;846  ;4050 ;423  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         SourceExpr=w_filtro_fechas }
            { 56  ;TextBox      ;9450 ;846  ;5400 ;423  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         SourceExpr=w_filtro_excursiones }
            { 1100217016;TextBox;18000;846  ;4950 ;423  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         SourceExpr=w_filtro_touroperador }
            { 1100217017;Label  ;15450;846  ;2400 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Touroperators;
                                                                    ESP=Touroperadores] }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=22950;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 12  ;Label        ;900  ;0    ;1200 ;846  ;ParentControl=11;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 15  ;Label        ;2250 ;0    ;1500 ;846  ;ParentControl=14;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 10  ;Label        ;3900 ;0    ;2100 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Income;
                                                                    ESP=Ingreso] }
            { 13  ;Label        ;6150 ;0    ;2100 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Cost;
                                                                    ESP=Coste] }
            { 16  ;Label        ;8400 ;0    ;2100 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Margin;
                                                                    ESP=Margen] }
            { 17  ;Label        ;11850;0    ;2100 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Carrier cost;
                                                                    ESP=Coste Autocar] }
            { 18  ;Label        ;14100;0    ;2100 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Supplier cost;
                                                                    ESP=Coste Proveedor] }
            { 21  ;Label        ;16350;0    ;2100 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Cost GO;
                                                                    ESP=Coste GO] }
            { 22  ;Label        ;10650;0    ;1050 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=% profits;
                                                                    ESP=% Benef.] }
            { 1100217000;Label  ;18600;0    ;2100 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Cost TO;
                                                                    ESP=Coste TO] }
            { 1100217001;Label  ;20850;0    ;2100 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Cost SG;
                                                                    ESP=Coste GV] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=22950;
            SectionHeight=423;
            OnPreSection=BEGIN
                           // JPT 01/07/05 Las excursiones con margen negativo tiene que salir en negrita
                           CurrReport.SHOWOUTPUT(w_margen>=0);
                         END;

          }
          CONTROLS
          {
            { 11  ;TextBox      ;900  ;0    ;1200 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Fecha }
            { 14  ;TextBox      ;2250 ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Excursion }
            { 23  ;TextBox      ;3900 ;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_ingreso }
            { 24  ;TextBox      ;6150 ;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_coste_servicio }
            { 25  ;TextBox      ;8400 ;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_margen }
            { 26  ;TextBox      ;11850;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_coste_autocar }
            { 27  ;TextBox      ;14100;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_coste_proveedor }
            { 30  ;TextBox      ;16350;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_coste_GO }
            { 31  ;TextBox      ;10650;0    ;1050 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_porciento }
            { 1100217002;TextBox;18600;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_coste_TO }
            { 1100217003;TextBox;20850;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_coste_GV }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=22950;
            SectionHeight=423;
            OnPreSection=BEGIN
                           // JPT 01/07/05 Las excursiones con margen negativo tiene que salir en negrita
                           CurrReport.SHOWOUTPUT(w_margen<0);
                         END;

          }
          CONTROLS
          {
            { 8   ;TextBox      ;900  ;0    ;1200 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=Fecha }
            { 9   ;TextBox      ;2250 ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=Excursion }
            { 57  ;TextBox      ;3900 ;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=w_ingreso }
            { 58  ;TextBox      ;6150 ;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=w_coste_servicio }
            { 59  ;TextBox      ;8400 ;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=w_margen }
            { 60  ;TextBox      ;11850;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=w_coste_autocar }
            { 61  ;TextBox      ;14100;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=w_coste_proveedor }
            { 64  ;TextBox      ;16350;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=w_coste_GO }
            { 65  ;TextBox      ;10650;0    ;1050 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=w_porciento }
            { 1100217004;TextBox;18600;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontBold=Yes;
                                                         SourceExpr=w_coste_TO }
            { 1100217005;TextBox;20850;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontBold=Yes;
                                                         SourceExpr=w_coste_GV }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=22950;
            SectionHeight=846;
            OnPreSection=BEGIN
                           IF CurrReport.TOTALSCAUSEDBY = FIELDNO(Fecha) THEN
                           BEGIN
                             CurrReport.SHOWOUTPUT(TRUE);

                             IF w_ingreso <> 0 THEN
                               w_porciento := ROUND((w_margen * 100) / w_ingreso);

                             IF wGenerarExcel THEN
                             BEGIN
                               wLinea += 1;
                               _InsertaExcel(1 , Text020                  , TRUE          , 2, 'B' + STRSUBSTNO('%1', wLinea), 0);
                               _InsertaExcel(5 , FORMAT(w_ingreso)        , (w_margen < 0), 4, '', 0);
                               _InsertaExcel(6 , FORMAT(w_coste_servicio) , (w_margen < 0), 4, '', 0);
                               _InsertaExcel(7 , FORMAT(w_margen)         , (w_margen < 0), 4, '', 0);
                               _InsertaExcel(8 , FORMAT(w_porciento)      , (w_margen < 0), 4, '', 0);
                               _InsertaExcel(9 , FORMAT(w_coste_autocar)  , (w_margen < 0), 4, '', 0);
                               _InsertaExcel(10, FORMAT(w_coste_proveedor), (w_margen < 0), 4, '', 0);
                               _InsertaExcel(11, FORMAT(w_coste_GO)       , (w_margen < 0), 4, '', 0);
                               _InsertaExcel(12, FORMAT(w_coste_GV)       , (w_margen < 0), 4, '', 0);
                               _InsertaExcel(13, FORMAT(w_coste_TO)       , (w_margen < 0), 4, '', 0); //+$003
                               wLinea += 1;
                             END;
                           END
                           ELSE
                             CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 32  ;Label        ;0    ;0    ;3750 ;423  ;FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Total Day;
                                                                    ESP=Total Diario] }
            { 52  ;Shape        ;0    ;423  ;22950;423  ;ShapeStyle=HorzLine }
            { 33  ;TextBox      ;3900 ;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_ingreso }
            { 34  ;TextBox      ;6150 ;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_coste_servicio }
            { 35  ;TextBox      ;8400 ;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_margen }
            { 36  ;TextBox      ;10650;0    ;1050 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_porciento }
            { 37  ;TextBox      ;11850;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_coste_autocar }
            { 38  ;TextBox      ;14100;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_coste_proveedor }
            { 41  ;TextBox      ;16350;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_coste_GO }
            { 1100217006;TextBox;18600;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_coste_TO }
            { 1100217007;TextBox;20850;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_coste_GV }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=22950;
            SectionHeight=423;
            OnPreSection=BEGIN
                           IF CurrReport.TOTALSCAUSEDBY = FIELDNO(Estado) THEN
                           BEGIN
                             CurrReport.SHOWOUTPUT(TRUE);

                             IF w_ingreso <> 0 THEN
                               w_porciento := ROUND((w_margen * 100) / w_ingreso);

                             IF wGenerarExcel THEN
                             BEGIN
                               wLinea += 1;
                               _InsertaExcel(1 , Text021                  , TRUE          , 2, 'B' + STRSUBSTNO('%1', wLinea), 0);
                               _InsertaExcel(5 , FORMAT(w_ingreso)        , (w_margen < 0), 4, '', 0);
                               _InsertaExcel(6 , FORMAT(w_coste_servicio) , (w_margen < 0), 4, '', 0);
                               _InsertaExcel(7 , FORMAT(w_margen)         , (w_margen < 0), 4, '', 0);
                               _InsertaExcel(8 , FORMAT(w_porciento)      , (w_margen < 0), 4, '', 0);
                               _InsertaExcel(9 , FORMAT(w_coste_autocar)  , (w_margen < 0), 4, '', 0);
                               _InsertaExcel(10, FORMAT(w_coste_proveedor), (w_margen < 0), 4, '', 0);
                               _InsertaExcel(11, FORMAT(w_coste_GO)       , (w_margen < 0), 4, '', 0);
                               _InsertaExcel(12, FORMAT(w_coste_GV)       , (w_margen < 0), 4, '', 0);
                               _InsertaExcel(13, FORMAT(w_coste_TO)       , (w_margen < 0), 4, '', 0); //+$003
                               wLinea += 1;
                             END;
                           END
                           ELSE
                             CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 51  ;Label        ;0    ;0    ;3750 ;423  ;FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Total;
                                                                    ESP=Total] }
            { 42  ;TextBox      ;3900 ;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_ingreso }
            { 43  ;TextBox      ;6150 ;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_coste_servicio }
            { 44  ;TextBox      ;8400 ;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_margen }
            { 45  ;TextBox      ;10650;0    ;1050 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_porciento }
            { 46  ;TextBox      ;11850;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_coste_autocar }
            { 47  ;TextBox      ;14100;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_coste_proveedor }
            { 50  ;TextBox      ;16350;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_coste_GO }
            { 1100217008;TextBox;18600;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_coste_TO }
            { 1100217009;TextBox;20850;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_coste_GV }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=22950;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 4   ;TextBox      ;8700 ;423  ;6600 ;423  ;HorzAlign=Center;
                                                         SourceExpr=FORMAT(TODAY,0,4) + ' / ' + FORMAT(TIME,0,0) + ' / ' + USERID }
            { 5   ;TextBox      ;19800;423  ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=Text007 + FORMAT(CurrReport.PAGENO) }
            { 6   ;Shape        ;0    ;0    ;22950;423  ;ShapeStyle=HorzLine }
            { 7   ;TextBox      ;0    ;423  ;4950 ;423  ;SourceExpr=cNom.nom_delegacion(rPar.Delegacion) }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=ResumenExc;
        OnPreDataItem=BEGIN
                        rTempCI.RESET;
                        wFin := NOT rTempCI.FINDFIRST;

                        IF wGenerarExcel THEN
                        BEGIN
                          wLinea := 0;

                          rExcel.DELETEALL;

                          wLinea += 1;
                          _InsertaExcel(1 , Text025              , TRUE , 2, 'C' + STRSUBSTNO('%1', wLinea), 0);

                          wLinea += 1;
                          _InsertaExcel(1 , Text008              , TRUE , 2, '', 0);
                          _InsertaExcel(2 , w_filtro_fechas      , FALSE, 2, '', 0);
                          _InsertaExcel(5 , Text009              , TRUE , 2, '', 0);
                          _InsertaExcel(6 , w_filtro_excursiones , FALSE, 2, '', 0);
                          _InsertaExcel(9 , Text022              , TRUE , 2, '', 0);
                          _InsertaExcel(11, w_filtro_touroperador, FALSE, 2, '', 0); //+$003

                          wLinea += 2;
                          _InsertaExcel(2 , Text011, TRUE, 2, 'C' + STRSUBSTNO('%1', wLinea), 0); //+$004
                          _InsertaExcel(4 , Text028, TRUE, 4, '', 0); //+$005
                          _InsertaExcel(5 , Text012, TRUE, 4, '', 0);
                          _InsertaExcel(6 , Text013, TRUE, 4, '', 0);
                          _InsertaExcel(7 , Text014, TRUE, 4, '', 0);
                          _InsertaExcel(8 , Text015, TRUE, 4, '', 0);
                          _InsertaExcel(9 , Text016, TRUE, 4, '', 0);
                          _InsertaExcel(10, Text017, TRUE, 4, '', 0);
                          _InsertaExcel(11, Text018, TRUE, 4, '', 0);
                          _InsertaExcel(12, Text019, TRUE, 4, '', 0);
                          _InsertaExcel(13, Text027, TRUE, 4, '', 0); //+$003
                        END;
                      END;

        OnAfterGetRecord=BEGIN
                           IF wFin THEN
                             CurrReport.BREAK;

                           wCodExcursion     := rTempCI.Delegacion;
                           w_ingreso         := rTempCI.Importe;
                           w_coste_servicio  := rTempCI."Importe sin impuestos (DL)";
                           w_coste_proveedor := rTempCI."Importe con impuestos (DL)";
                           w_coste_autocar   := rTempCI."Precio x Vehiculo";
                           w_coste_GO        := rTempCI."Importe sin Impuesto";
                           w_coste_GV        := rTempCI."Importe con Impuesto";
                           w_coste_TO        := rTempCI."Importe Validacion"; //+$003

                           w_margen    := w_ingreso - w_coste_servicio;
                           w_porciento := 0;
                           IF w_ingreso <> 0 THEN
                             w_porciento := ROUND((w_margen * 100) / w_ingreso);

                           wFin := rTempCI.NEXT=0;

                           IF wGenerarExcel THEN
                           BEGIN
                             wLinea += 1;
                             _InsertaExcel(2 , wCodExcursion                   , (w_margen < 0), 2, '', 0);
                             _InsertaExcel(3 , cNom.nom_producto(wCodExcursion), (w_margen < 0), 2, '', 0); //+$004
                             _InsertaExcel(4 , rExc.NombreProveedorServicio(wCodExcursion), (w_margen < 0), 2, '', 0); //+$005
                             _InsertaExcel(5 , FORMAT(w_ingreso)               , (w_margen < 0), 4, '', 0);
                             _InsertaExcel(6 , FORMAT(w_coste_servicio)        , (w_margen < 0), 4, '', 0);
                             _InsertaExcel(7 , FORMAT(w_margen)                , (w_margen < 0), 4, '', 0);
                             _InsertaExcel(8 , FORMAT(w_porciento)             , (w_margen < 0), 4, '', 0);
                             _InsertaExcel(9 , FORMAT(w_coste_autocar)         , (w_margen < 0), 4, '', 0);
                             _InsertaExcel(10, FORMAT(w_coste_proveedor)       , (w_margen < 0), 4, '', 0);
                             _InsertaExcel(11, FORMAT(w_coste_GO)              , (w_margen < 0), 4, '', 0);
                             _InsertaExcel(12, FORMAT(w_coste_GV)              , (w_margen < 0), 4, '', 0);
                             _InsertaExcel(13, FORMAT(w_coste_TO)              , (w_margen < 0), 4, '', 0); //+$003
                           END;
                         END;

        OnPostDataItem=BEGIN
                         IF wGenerarExcel THEN
                         BEGIN
                           rExcel.CreateSheet(Text026, CurrReport.OBJECTID, COMPANYNAME, USERID, TRUE, TRUE, '');
                           rExcel.GiveUserControl;
                         END;
                       END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=22950;
            SectionHeight=2961;
          }
          CONTROLS
          {
            { 66  ;TextBox      ;0    ;0    ;6300 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=COMPANYNAME }
            { 67  ;Label        ;17250;0    ;5700 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Report C/I Excursions;
                                                                    ESP=Informe C/I Excursiones] }
            { 68  ;Shape        ;0    ;423  ;22950;423  ;ShapeStyle=HorzLine }
            { 70  ;Label        ;6900 ;1269 ;2400 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Excursions;
                                                                    ESP=Excursiones] }
            { 71  ;TextBox      ;2400 ;1269 ;4050 ;423  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         SourceExpr=w_filtro_fechas }
            { 72  ;TextBox      ;9450 ;1269 ;5400 ;423  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         SourceExpr=w_filtro_excursiones }
            { 74  ;Label        ;450  ;1692 ;2700 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Excursion;
                                                                    ESP=Excursion] }
            { 75  ;Label        ;3300 ;1692 ;2100 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Income;
                                                                    ESP=Ingreso] }
            { 76  ;Label        ;5550 ;1692 ;2100 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Cost;
                                                                    ESP=Coste] }
            { 77  ;Label        ;7800 ;1692 ;2100 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Margin;
                                                                    ESP=Margen] }
            { 78  ;Label        ;11250;1692 ;2100 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Carrier cost;
                                                                    ESP=Coste Autocar] }
            { 79  ;Label        ;13500;1692 ;2100 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Suppl. Cost;
                                                                    ESP=Coste Prov.] }
            { 82  ;Label        ;15750;1692 ;2100 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Cost GO;
                                                                    ESP=Coste GO] }
            { 83  ;Label        ;10050;1692 ;1050 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=% profits;
                                                                    ESP=% Benef.] }
            { 95  ;Label        ;0    ;1269 ;2250 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Period;
                                                                    ESP=Periodo] }
            { 96  ;Label        ;0    ;846  ;5550 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Summary per excursion code;
                                                                    ESP=Resumen por Codigo Excursi¢n] }
            { 69  ;Shape        ;450  ;2538 ;21900;423  ;ShapeStyle=HorzLine }
            { 1100217010;Label  ;18000;1692 ;2100 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Cost TO;
                                                                    ESP=Coste TO] }
            { 1100217011;Label  ;20250;1692 ;2100 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Cost SG;
                                                                    ESP=Coste GV] }
            { 1100217018;TextBox;18000;1269 ;4950 ;423  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         SourceExpr=w_filtro_touroperador }
            { 1100217019;Label  ;15450;1269 ;2400 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Touroperators;
                                                                    ESP=Touroperadores] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=22950;
            SectionHeight=423;
            OnPreSection=BEGIN
                           // JPT 01/07/05 Las excursiones con margen negativo tiene que salir en negrita
                           CurrReport.SHOWOUTPUT(w_margen>=0);
                         END;

          }
          CONTROLS
          {
            { 85  ;TextBox      ;450  ;0    ;2700 ;423  ;HorzAlign=Left;
                                                         SourceExpr=wCodExcursion }
            { 86  ;TextBox      ;3300 ;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_ingreso }
            { 87  ;TextBox      ;5550 ;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_coste_servicio }
            { 88  ;TextBox      ;7800 ;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_margen }
            { 89  ;TextBox      ;11250;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_coste_autocar }
            { 90  ;TextBox      ;13500;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_coste_proveedor }
            { 93  ;TextBox      ;15750;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_coste_GO }
            { 94  ;TextBox      ;10050;0    ;1050 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_porciento }
            { 1100217012;TextBox;18000;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_coste_TO }
            { 1100217013;TextBox;20250;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=w_coste_GV }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=22950;
            SectionHeight=846;
            OnPreSection=BEGIN
                           // JPT 01/07/05 Las excursiones con margen negativo tiene que salir en negrita
                           CurrReport.SHOWOUTPUT(w_margen<0);
                         END;

          }
          CONTROLS
          {
            { 73  ;TextBox      ;450  ;0    ;2700 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=wCodExcursion }
            { 84  ;TextBox      ;3300 ;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=w_ingreso }
            { 97  ;TextBox      ;5550 ;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=w_coste_servicio }
            { 98  ;TextBox      ;7800 ;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=w_margen }
            { 99  ;TextBox      ;11250;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=w_coste_autocar }
            { 100 ;TextBox      ;13500;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=w_coste_proveedor }
            { 103 ;TextBox      ;15750;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=w_coste_GO }
            { 104 ;TextBox      ;10050;0    ;1050 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=w_porciento }
            { 1100217014;TextBox;20250;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontBold=Yes;
                                                         SourceExpr=w_coste_GV }
            { 1100217015;TextBox;18000;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontBold=Yes;
                                                         SourceExpr=w_coste_TO }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=22950;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 105 ;TextBox      ;8700 ;423  ;6600 ;423  ;HorzAlign=Center;
                                                         SourceExpr=FORMAT(TODAY,0,4) + ' / ' + FORMAT(TIME,0,0) + ' / ' + USERID }
            { 106 ;TextBox      ;19800;423  ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=Text007 + FORMAT(CurrReport.PAGENO) }
            { 107 ;Shape        ;0    ;0    ;22950;423  ;ShapeStyle=HorzLine }
            { 108 ;TextBox      ;0    ;423  ;4950 ;423  ;SourceExpr=cNom.nom_delegacion(rPar.Delegacion) }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=6710;
      Height=2530;
      CaptionML=[ENU=Report C/I Excursions;
                 ESP=Informe C/I Excursiones];
      OnOpenForm=BEGIN
                   w_divisa := '';
                   w_fecha_cambio := TODAY;
                 END;

    }
    CONTROLS
    {
      { 5   ;Label        ;220  ;770  ;3630 ;440  ;InPage=-1;
                                                   CaptionML=[ENU=Amount with taxes;
                                                              ESP=Importes con impuestos] }
      { 7   ;CheckBox     ;3960 ;770  ;440  ;440  ;ShowCaption=No;
                                                   SourceExpr=wImporteConImpuestos }
      { 9   ;CheckBox     ;3960 ;1320 ;440  ;440  ;InPage=-1;
                                                   ShowCaption=No;
                                                   CaptionML=[ENU=Not show without Supplier cost;
                                                              ESP=Ocultar Sin Coste Proveedor];
                                                   ToolTipML=[ENU=Not show excursions that dont have cost of supplier excursion;
                                                              ESP=Ocultar las excursiones que no tengan coste de Proveedor Excursion];
                                                   SourceExpr=wOcultarSinCostePE }
      { 10  ;Label        ;220  ;1320 ;3630 ;440  ;ParentControl=9 }
      { 1100217000;CheckBox;3960;1870 ;440  ;440  ;InPage=-1;
                                                   ShowCaption=No;
                                                   CaptionML=[ENU=Create excel;
                                                              ESP=Generar excel];
                                                   SourceExpr=wGenerarExcel }
      { 1100217001;Label  ;220  ;1870 ;3630 ;440  ;ParentControl=1100217000 }
      { 1100217002;TextBox;3960 ;220  ;2090 ;440  ;InPage=-1;
                                                   CaptionML=[ENU=Touroperator;
                                                              ESP=Touroperador];
                                                   SourceExpr=wTouroperador;
                                                   TableRelation=TourOperador }
      { 1100217003;Label  ;220  ;220  ;3630 ;440  ;ParentControl=1100217002 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text000@1103355025 : TextConst 'ENU=All;ESP=Todas';
      Text001@1103355026 : TextConst 'ENU=EXCI;ESP=EXCI';
      Text002@1103355027 : TextConst 'ENU=EXCC;ESP=EXCC';
      Text003@1103355028 : TextConst 'ENU=EXAC;ESP=EXAC';
      Text004@1103355029 : TextConst 'ENU=EXGV;ESP=EXGV';
      Text005@1103355030 : TextConst 'ENU=EXTO;ESP=EXTO';
      Text006@1103355031 : TextConst 'ENU=EXGO;ESP=EXGO';
      Text007@1103355032 : TextConst 'ENU=page;ESP=P gina';
      rExcel@1100217011 : Record 7009785;
      rTempCI@1100217000 : TEMPORARY Record 7010166;
      rTipoCam@1103355000 : Record 330;
      rDiv@1103355001 : Record 4;
      rPar@1103355002 : Record 7009700;
      rExc@1100217034 : Record 7009710;
      cNom@1103355003 : Codeunit 7009702;
      cVerMar@1100217001 : Codeunit 7010148;
      w_ingreso@1103355005 : Decimal;
      w_margen@1103355007 : Decimal;
      w_coste_servicio@1100217004 : Decimal;
      w_coste_autocar@1103355008 : Decimal;
      w_coste_proveedor@1103355009 : Decimal;
      w_coste_GO@1103355012 : Decimal;
      w_coste_TO@1100217002 : Decimal;
      w_coste_GV@1100217003 : Decimal;
      w_porciento@1103355013 : Decimal;
      wLinea@1100217006 : Integer;
      w_filtro_fechas@1103355014 : Text[80];
      w_filtro_excursiones@1103355015 : Text[80];
      w_filtro_touroperador@1100217026 : Text[80];
      w_divisa@1103355017 : Code[10];
      wDivisaIngreso@1103355019 : Code[10];
      wCodExcursion@1103355023 : Code[10];
      wTouroperador@1100217025 : Code[10];
      wFin@1103355024 : Boolean;
      wGenerarExcel@1100217005 : Boolean;
      wOcultarSinCostePE@1100217008 : Boolean;
      wImporteConImpuestos@1100217009 : Boolean;
      w_fecha_cambio@1100217007 : Date;
      Text008@1100217012 : TextConst 'ENU=Dates period;ESP=Periodo fechas';
      Text009@1100217013 : TextConst 'ENU=Excursions;ESP=Excursiones';
      Text010@1100217014 : TextConst 'ENU=Date;ESP=Fecha';
      Text011@1100217015 : TextConst 'ENU=Excursion;ESP=Excursion';
      Text012@1100217016 : TextConst 'ENU=Income;ESP=Ingreso';
      Text013@1100217017 : TextConst 'ENU=Cost;ESP=Coste';
      Text014@1100217018 : TextConst 'ENU=Margin;ESP=Margen';
      Text015@1100217019 : TextConst 'ENU=Benefit %;ESP=% Beneficio';
      Text016@1100217020 : TextConst 'ENU=Carrier Cost;ESP=Coste Autocar';
      Text017@1100217021 : TextConst 'ENU=Provider Cost;ESP=Coste Proveedor';
      Text018@1100217022 : TextConst 'ENU=O.G. Cost;ESP=Coste G.O.';
      Text019@1100217023 : TextConst 'ENU=S.G. Cost;ESP=Coste G.V.';
      Text020@1100217010 : TextConst 'ESP=Total Diario';
      Text021@1100217024 : TextConst 'ESP=Total';
      Text022@1100217027 : TextConst 'ESP=Touroperador';
      Text023@1100217028 : TextConst 'ENU=Services;ESP=Servicios';
      Text024@1100217029 : TextConst 'ENU=All;ESP=Todos';
      Text025@1100217030 : TextConst 'ENU=Excursions summary;ESP=Resumen por Codigo Excursion';
      Text026@1100217031 : TextConst 'ENU=Summary;ESP=Resumen';
      Text027@1100217032 : TextConst 'ENU=TO Cost;ESP=Coste TO';
      Text028@1100217033 : TextConst 'ENU=Vendor;ESP=Proveedor';

    LOCAL PROCEDURE _InsertaExcel@1100217000(pwColumna@1100217000 : Integer;pwTexto@1100217001 : Text[250];pwBold@1100217002 : Boolean;pwAlineaHor@1100217003 : Integer;pwFusionar@1100217004 : Text[30];pwBordeInferior@1100217005 : Integer);
    BEGIN
      // _InsertaExcel

      rExcel.INIT;
      rExcel.VALIDATE("Row No."                    , wLinea);
      rExcel.VALIDATE("Column No."                 , pwColumna);
      rExcel.VALIDATE("Cell Value as Text"         , pwTexto);
      rExcel.VALIDATE(Bold                         , pwBold);
      rExcel.VALIDATE("Texto Alineacion Horizontal", pwAlineaHor); // 2 - Izq, 3 - Cen, 4 - Der
      rExcel.VALIDATE("Fusionar hasta celda"       , pwFusionar);
      rExcel.VALIDATE("Tama¤o Fuente"              , 9);
      rExcel.VALIDATE("Borde Abaj"                 , pwBordeInferior);
      rExcel.INSERT;
    END;

    PROCEDURE CosteIngresoServicio@1100217006();
    BEGIN
      // CosteIngresoServicio

      w_ingreso         := 0;
      w_margen          := 0;
      w_coste_autocar   := 0;
      w_coste_proveedor := 0;
      w_coste_GO        := 0;
      w_coste_servicio  := 0;
      w_coste_TO        := 0;
      w_coste_GV        := 0;

      cVerMar.TotalesPorServicioConf(diServicio, w_ingreso, w_coste_servicio, w_coste_autocar, w_coste_proveedor,
                                     w_coste_GO, w_coste_TO, w_coste_GV, wImporteConImpuestos, wTouroperador);

      IF w_divisa <> '' THEN
      BEGIN
        w_ingreso         := rTipoCam.ExchangeAmtFCYToFCY(w_fecha_cambio, '', w_divisa, w_ingreso);
        w_coste_servicio  := rTipoCam.ExchangeAmtFCYToFCY(w_fecha_cambio, '', w_divisa, w_coste_servicio);
        w_coste_proveedor := rTipoCam.ExchangeAmtFCYToFCY(w_fecha_cambio, '', w_divisa, w_coste_proveedor);
        w_coste_autocar   := rTipoCam.ExchangeAmtFCYToFCY(w_fecha_cambio, '', w_divisa, w_coste_autocar);
        w_coste_GO        := rTipoCam.ExchangeAmtFCYToFCY(w_fecha_cambio, '', w_divisa, w_coste_GO);
        w_coste_TO        := rTipoCam.ExchangeAmtFCYToFCY(w_fecha_cambio, '', w_divisa, w_coste_TO);
        w_coste_GV        := rTipoCam.ExchangeAmtFCYToFCY(w_fecha_cambio, '', w_divisa, w_coste_GV);
      END;
    END;

    BEGIN
    {
      $001 AJF 05072011 (GOC-OC-11016) Se cambia el c lculo para que funcione directamente con los valores
                        en divisa local calculados en la l¡nea de C/I.

      $002 AJS 12112012 Apaisar el informe y mostrar las columnas de coste TO y coste GV

      $003 AJS 10072013 Mostrar la columna de coste touroperador en el EXCEL

      $004 AJS 10072013 Nueva columna Nombre excursion

      $005 AJS 15012015 Eliminar funciones obsoletas de cambio divisa
    }
    END.
  }
  RDLDATA
  {
  }
}
