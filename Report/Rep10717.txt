OBJECT Report 10717 Normalized Account Schedule
{
  OBJECT-PROPERTIES
  {
    Date=01/05/13;
    Time=[ 4:02:54];
    Modified=Yes;
    Version List=AIC2009,NAVES6.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Normalized Account Schedule;
               ESP=Esquema cuentas normalizado];
    OnPreReport=BEGIN
                  IF GeneralIdData AND (CloseDate = 0D) THEN
                    ERROR(Text1100000);

                  CompanyInfo.GET;
                  SplitCompanyName(CompanyInfo,CompName);

                  // AJS 20.11.2007, Personalizacion GOC
                  //"Acc. Schedule Name".FIND('-');

                  "Acc. Schedule Name".FIND('-');

                  IF AccSchedName <> '' THEN
                    "Acc. Schedule Name".GET(AccSchedName);


                  "Acc. Schedule Name".TESTFIELD("Default Column Layout");
                  ColumnLayoutName := "Acc. Schedule Name"."Default Column Layout";
                  // AccSchedManagement.SetAccSchedName(PrintAmountsInAddCurrency);
                  InitAccSched;
                  GLSetup.GET;
                END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        OnPreDataItem=BEGIN
                        IF NOT GeneralIdData THEN
                          CurrReport.BREAK;

                        IF ISSERVICETIER THEN
                          NextPageGroupNo := 0;
                      END;

        OnPostDataItem=BEGIN
                         CurrReport.NEWPAGE;
                       END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18300;
            SectionHeight=24957;
          }
          CONTROLS
          {
            { 1100000;TextBox   ;0    ;0    ;4830 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo."VAT Registration No.";
                                                         DataSetFieldName=CompanyInfo__VAT_Registration_No__ }
            { 1100001;TextBox   ;2730 ;1269 ;15300;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo.Name + ' ' + CompanyInfo."Name 2";
                                                         DataSetFieldName=CompanyInfo_Name_________CompanyInfo__Name_2_ }
            { 1100002;TextBox   ;1890 ;2538 ;15750;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo.Address + ' ' +CompanyInfo."Address 2";
                                                         DataSetFieldName=CompanyInfo_Address________CompanyInfo__Address_2_ }
            { 1100003;TextBox   ;840  ;3807 ;8820 ;423  ;FontSize=9;
                                                         SourceExpr=CompanyInfo.City;
                                                         DataSetFieldName=CompanyInfo_City }
            { 1100004;TextBox   ;1470 ;5076 ;3990 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo."Post Code";
                                                         DataSetFieldName=CompanyInfo__Post_Code_ }
            { 1100005;TextBox   ;10920;5076 ;4410 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo."Phone No.";
                                                         DataSetFieldName=CompanyInfo__Phone_No__ }
            { 1100006;TextBox   ;12450;3807 ;5250 ;423  ;FontSize=9;
                                                         SourceExpr=CompanyInfo.County;
                                                         DataSetFieldName=CompanyInfo_County }
            { 1100007;TextBox   ;2310 ;7614 ;15750;423  ;FontSize=9;
                                                         SourceExpr=CompanyInfo."CNAE Description";
                                                         DataSetFieldName=CompanyInfo__CNAE_Description_ }
            { 1100008;TextBox   ;3990 ;8883 ;840  ;423  ;FontSize=9;
                                                         SourceExpr=CompanyInfo."Industrial Classification";
                                                         DataSetFieldName=CompanyInfo__Industrial_Classification_ }
            { 1100009;TextBox   ;7770 ;18612;840  ;423  ;FontSize=9;
                                                         SourceExpr=NoOfPages;
                                                         DataSetFieldName=NoOfPages }
            { 1100010;TextBox   ;8820 ;17343;1470 ;423  ;FontSize=9;
                                                         SourceExpr=DATE2DMY(CloseDate,3);
                                                         DataSetFieldName=DATE2DMY_CloseDate_3_ }
            { 1100011;TextBox   ;10920;17343;1050 ;423  ;FontSize=9;
                                                         SourceExpr=DATE2DMY(CloseDate,2);
                                                         DataSetFieldName=DATE2DMY_CloseDate_2_ }
            { 1100012;TextBox   ;12390;17343;840  ;423  ;FontSize=9;
                                                         SourceExpr=DATE2DMY(CloseDate,1);
                                                         DataSetFieldName=DATE2DMY_CloseDate_1_ }
            { 1100013;TextBox   ;13440;12690;1260 ;423  ;FontSize=9;
                                                         SourceExpr=Personnel[1];
                                                         DataSetFieldName=Personnel_1_ }
            { 1100014;TextBox   ;13440;13536;1260 ;423  ;FontSize=9;
                                                         SourceExpr=Personnel[3];
                                                         DataSetFieldName=Personnel_3_ }
            { 1100015;TextBox   ;16380;12690;1260 ;423  ;FontSize=9;
                                                         SourceExpr=Personnel[2];
                                                         DataSetFieldName=Personnel_2_ }
            { 1100016;TextBox   ;16380;13536;1260 ;423  ;FontSize=9;
                                                         SourceExpr=Personnel[4];
                                                         DataSetFieldName=Personnel_4_ }
            { 1100063;TextBox   ;4950 ;0    ;150  ;423  ;Name=Integer.Number;
                                                         Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr=Integer.Number;
                                                         DataSetFieldName=Integer_Number }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemTable=Table84;
        NewPagePerRecord=Yes;
        OnPreDataItem=BEGIN
                        // AJS 20.11.2007, Personalizacion GOC

                        //IF AccSchedName <> '' THEN
                        //  "Acc. Schedule Name".SETRANGE(Name, AccSchedName);

                        IF "Acc. Schedule Name".GETRANGEMIN(Name) <> "Acc. Schedule Name".GETRANGEMAX(Name) THEN
                          ERROR(Text1100004);
                      END;

        OnAfterGetRecord=BEGIN
                           TESTFIELD(Standardized,TRUE);
                         END;

        ReqFilterFields=Name;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table85;
        DataItemTableView=SORTING(Schedule Name,Line No.);
        OnPreDataItem=BEGIN
                        IF ISSERVICETIER THEN
                          NextPageGroupNo := 1;
                      END;

        OnAfterGetRecord=VAR
                           AccScheduleLine@1100000 : Record 85;
                         BEGIN
                           PageNONO += 1;
                           IF NOT UsePreprintedForm THEN BEGIN
                             DisplayText[1] := UPPERCASE("Acc. Schedule Name".Description);
                             DisplayText[3] := Text1100006;
                             DisplayText[4] := Text1100007;
                             DisplayText[6] := Text1100008;

                             DisplayText[5] := UPPERCASE(FORMAT("Acc. Schedule Line".Type));
                             IF PageNONO = 1 THEN BEGIN
                               DisplayText[2] := "Acc. Schedule Line".TABLECAPTION + ': ' + AccSchedLineFilter;
                               IF PrintAmountsInAddCurrency THEN
                                 HeaderText := Text1100003 + GLSetup."Additional Reporting Currency"
                               ELSE BEGIN
                                 GLSetup.TESTFIELD("LCY Code");
                                 HeaderText := Text1100003 + GLSetup."LCY Code";
                               END;
                             END ELSE BEGIN
                               DisplayText[2] := '';
                               HeaderText := '';
                             END;
                           END ELSE BEGIN
                             HeaderText := '';
                             DisplayText[1] := '';
                             DisplayText[2] := '';
                             DisplayText[3] := '';
                             DisplayText[4] := '';
                             DisplayText[5] := '';
                             DisplayText[6] := '';
                           END;

                           PageGroupNo := NextPageGroupNo;
                           IF "Acc. Schedule Line"."New Page" THEN BEGIN
                             AccScheduleLine := "Acc. Schedule Line";
                             IF AccScheduleLine.NEXT <> 0 THEN
                               DisplayText[5] := UPPERCASE(FORMAT(AccScheduleLine.Type));
                             NextPageGroupNo += 1;
                           END;

                           FOR i := 1 TO MaxColumnsDisplayed DO BEGIN
                             ColumnValuesDisplayed[i] := 0;
                             ColumnValuesAsText[i] := '';
                           END;

                           IF UsePreprintedForm THEN
                             Description := ''
                           ELSE
                             Description := PADSTR('',Indentation * 2) + Description;
                         END;

        ReqFilterFields=Date Filter,Dimension 1 Filter,Dimension 2 Filter;
        DataItemLink=Schedule Name=FIELD(Name);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18300;
            SectionHeight=6768;
            KeepWithNext=No;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := NOT (GeneralIdData AND (CurrReport.PAGENO = 1));
                         END;

          }
          CONTROLS
          {
            { 1100017;TextBox   ;1800 ;0    ;16200;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=DisplayText[1];
                                                         DataSetFieldName=DisplayText_1_ }
            { 1100018;TextBox   ;0    ;846  ;18150;423  ;SourceExpr=HeaderText;
                                                         DataSetFieldName=HeaderText }
            { 1100019;TextBox   ;0    ;1269 ;18150;423  ;SourceExpr=DisplayText[2];
                                                         DataSetFieldName=DisplayText_2_ }
            { 1100020;TextBox   ;750  ;2115 ;4050 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=DisplayText[3];
                                                         DataSetFieldName=DisplayText_3_ }
            { 1100021;TextBox   ;750  ;3807 ;8250 ;423  ;FontSize=9;
                                                         SourceExpr=CompName[1];
                                                         DataSetFieldName=CompName_1_ }
            { 1100022;TextBox   ;750  ;3384 ;4050 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=DisplayText[4];
                                                         DataSetFieldName=DisplayText_4_ }
            { 1100023;TextBox   ;4950 ;2115 ;4200 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo."VAT Registration No.";
                                                         DataSetFieldName=CompanyInfo__VAT_Registration_No___Control1100023 }
            { 1100024;TextBox   ;750  ;4653 ;8250 ;423  ;FontSize=9;
                                                         SourceExpr=CompName[2];
                                                         DataSetFieldName=CompName_2_ }
            { 1100025;TextBox   ;6150 ;5922 ;2100 ;423  ;FontSize=9;
                                                         SourceExpr=DisplayText[5];
                                                         DataSetFieldName=DisplayText_5_ }
            { 1100026;TextBox   ;13050;5922 ;900  ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         SourceExpr=FiscalYearTxt1;
                                                         DataSetFieldName=FiscalYearTxt1 }
            { 1100027;TextBox   ;10500;5922 ;2400 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=DisplayText[6];
                                                         DataSetFieldName=DisplayText_6_ }
            { 1100028;TextBox   ;14550;5922 ;2400 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=DisplayText[6];
                                                         DataSetFieldName=DisplayText_6__Control1100028 }
            { 1100029;TextBox   ;17100;5922 ;900  ;423  ;HorzGlue=Right;
                                                         HorzAlign=Right;
                                                         FontSize=9;
                                                         SourceExpr=FiscalYearTxt2;
                                                         DataSetFieldName=FiscalYearTxt2 }
            { 1100064;TextBox   ;11700;2961 ;150  ;423  ;Name="Acc. Schedule Line".Underline;
                                                         Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr="Acc. Schedule Line".Underline;
                                                         DataSetFieldName=Acc__Schedule_Line__Underline }
            { 1100067;TextBox   ;9000 ;2961 ;150  ;423  ;Name=PageGroupNo;
                                                         Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr=PageGroupNo;
                                                         DataSetFieldName=PageGroupNo }
            { 1100055;TextBox   ;9300 ;2961 ;150  ;423  ;Name=ShowLine(TRUE,FALSE,FALSE);
                                                         Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr=ShowLine(TRUE,FALSE,FALSE);
                                                         DataSetFieldName=ShowLine_TRUE_FALSE_FALSE_ }
            { 1100056;TextBox   ;9600 ;2961 ;150  ;423  ;Name=ShowLine(TRUE,TRUE,FALSE);
                                                         Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr=ShowLine(TRUE,TRUE,FALSE);
                                                         DataSetFieldName=ShowLine_TRUE_TRUE_FALSE_ }
            { 1100057;TextBox   ;9900 ;2961 ;150  ;423  ;Name=ShowLine(TRUE,FALSE,TRUE);
                                                         Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr=ShowLine(TRUE,FALSE,TRUE);
                                                         DataSetFieldName=ShowLine_TRUE_FALSE_TRUE_ }
            { 1100058;TextBox   ;10200;2961 ;150  ;423  ;Name=ShowLine(TRUE,TRUE,TRUE);
                                                         Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr=ShowLine(TRUE,TRUE,TRUE);
                                                         DataSetFieldName=ShowLine_TRUE_TRUE_TRUE_ }
            { 1100059;TextBox   ;10500;2961 ;150  ;423  ;Name=ShowLine(FALSE,FALSE,FALSE);
                                                         Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr=ShowLine(FALSE,FALSE,FALSE);
                                                         DataSetFieldName=ShowLine_FALSE_FALSE_FALSE_ }
            { 1100060;TextBox   ;10800;2961 ;150  ;423  ;Name=ShowLine(FALSE,TRUE,FALSE);
                                                         Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr=ShowLine(FALSE,TRUE,FALSE);
                                                         DataSetFieldName=ShowLine_FALSE_TRUE_FALSE_ }
            { 1100061;TextBox   ;11100;2961 ;150  ;423  ;Name=ShowLine(FALSE,FALSE,TRUE);
                                                         Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr=ShowLine(FALSE,FALSE,TRUE);
                                                         DataSetFieldName=ShowLine_FALSE_FALSE_TRUE_ }
            { 1100062;TextBox   ;11400;2961 ;150  ;423  ;Name=ShowLine(FALSE,TRUE,TRUE);
                                                         Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr=ShowLine(FALSE,TRUE,TRUE);
                                                         DataSetFieldName=ShowLine_FALSE_TRUE_TRUE_ }
            { 1100065;TextBox   ;0    ;0    ;150  ;423  ;Name=AccSchLine."Line No.";
                                                         Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr="Acc. Schedule Line"."Line No.";
                                                         DataSetFieldName=AccSchLine__Line_No__ }
            { 1100066;TextBox   ;300  ;0    ;150  ;423  ;Name=GeneralIdData;
                                                         Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr=GeneralIdData;
                                                         DataSetFieldName=GeneralIdData }
            { 1100068;TextBox   ;12000;2961 ;150  ;423  ;Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr=PageNONO;
                                                         DataSetFieldName=PageNONO }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18300;
            SectionHeight=423;
            KeepWithNext=No;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ShowLine(TRUE,FALSE,FALSE));
                         END;

          }
          CONTROLS
          {
            { 1100030;TextBox   ;15750;0    ;2550 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         BlankZero=Yes;
                                                         SourceExpr=ColumnValuesAsText[2];
                                                         AutoCalcField=No;
                                                         DataSetFieldName=ColumnValuesAsText_2_ }
            { 1100031;TextBox   ;11700;0    ;2550 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         BlankZero=Yes;
                                                         SourceExpr=ColumnValuesAsText[1];
                                                         AutoCalcField=No;
                                                         DataSetFieldName=ColumnValuesAsText_1_ }
            { 1100032;TextBox   ;0    ;0    ;10800;423  ;FontSize=9;
                                                         SourceExpr=Description;
                                                         DataSetFieldName=Acc__Schedule_Line_Description }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18300;
            SectionHeight=423;
            KeepWithNext=No;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ShowLine(TRUE,TRUE,FALSE));
                         END;

          }
          CONTROLS
          {
            { 1100033;TextBox   ;0    ;0    ;10800;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=Description;
                                                         DataSetFieldName=Acc__Schedule_Line_Description_Control1100033 }
            { 1100034;TextBox   ;11700;0    ;2550 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=ColumnValuesAsText[1];
                                                         AutoCalcField=No;
                                                         DataSetFieldName=ColumnValuesAsText_1__Control1100034 }
            { 1100035;TextBox   ;15750;0    ;2550 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=ColumnValuesAsText[2];
                                                         AutoCalcField=No;
                                                         DataSetFieldName=ColumnValuesAsText_2__Control1100035 }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18300;
            SectionHeight=423;
            KeepWithNext=No;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ShowLine(TRUE,FALSE,TRUE));
                         END;

          }
          CONTROLS
          {
            { 1100036;TextBox   ;0    ;0    ;10800;423  ;FontSize=9;
                                                         FontItalic=Yes;
                                                         SourceExpr=Description;
                                                         DataSetFieldName=Acc__Schedule_Line_Description_Control1100036 }
            { 1100037;TextBox   ;11700;0    ;2550 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontItalic=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=ColumnValuesAsText[1];
                                                         AutoCalcField=No;
                                                         DataSetFieldName=ColumnValuesAsText_1__Control1100037 }
            { 1100038;TextBox   ;15750;0    ;2550 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontItalic=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=ColumnValuesAsText[2];
                                                         AutoCalcField=No;
                                                         DataSetFieldName=ColumnValuesAsText_2__Control1100038 }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18300;
            SectionHeight=423;
            KeepWithNext=No;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ShowLine(TRUE,TRUE,TRUE));
                         END;

          }
          CONTROLS
          {
            { 1100039;TextBox   ;0    ;0    ;10800;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         FontItalic=Yes;
                                                         SourceExpr=Description;
                                                         DataSetFieldName=Acc__Schedule_Line_Description_Control1100039 }
            { 1100040;TextBox   ;11700;0    ;2550 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         FontItalic=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=ColumnValuesAsText[1];
                                                         AutoCalcField=No;
                                                         DataSetFieldName=ColumnValuesAsText_1__Control1100040 }
            { 1100041;TextBox   ;15750;0    ;2550 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         FontItalic=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=ColumnValuesAsText[2];
                                                         AutoCalcField=No;
                                                         DataSetFieldName=ColumnValuesAsText_2__Control1100041 }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18300;
            SectionHeight=423;
            KeepWithNext=No;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ShowLine(FALSE,FALSE,FALSE));
                         END;

          }
          CONTROLS
          {
            { 1100042;TextBox   ;15750;0    ;2550 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         BlankZero=Yes;
                                                         SourceExpr=ColumnValuesAsText[2];
                                                         AutoCalcField=No;
                                                         DataSetFieldName=ColumnValuesAsText_2__Control1100042 }
            { 1100043;TextBox   ;11700;0    ;2550 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         BlankZero=Yes;
                                                         SourceExpr=ColumnValuesAsText[1];
                                                         AutoCalcField=No;
                                                         DataSetFieldName=ColumnValuesAsText_1__Control1100043 }
            { 1100044;TextBox   ;0    ;0    ;10800;423  ;FontSize=9;
                                                         SourceExpr=Description;
                                                         DataSetFieldName=Acc__Schedule_Line_Description_Control1100044 }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18300;
            SectionHeight=423;
            KeepWithNext=No;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ShowLine(FALSE,TRUE,FALSE));
                         END;

          }
          CONTROLS
          {
            { 1100045;TextBox   ;0    ;0    ;10800;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=Description;
                                                         DataSetFieldName=Acc__Schedule_Line_Description_Control1100045 }
            { 1100046;TextBox   ;11700;0    ;2550 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=ColumnValuesAsText[1];
                                                         AutoCalcField=No;
                                                         DataSetFieldName=ColumnValuesAsText_1__Control1100046 }
            { 1100047;TextBox   ;15750;0    ;2550 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=ColumnValuesAsText[2];
                                                         AutoCalcField=No;
                                                         DataSetFieldName=ColumnValuesAsText_2__Control1100047 }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18300;
            SectionHeight=423;
            KeepWithNext=No;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ShowLine(FALSE,FALSE,TRUE));
                         END;

          }
          CONTROLS
          {
            { 1100048;TextBox   ;0    ;0    ;10800;423  ;FontSize=9;
                                                         FontItalic=Yes;
                                                         SourceExpr=Description;
                                                         DataSetFieldName=Acc__Schedule_Line_Description_Control1100048 }
            { 1100049;TextBox   ;11700;0    ;2550 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontItalic=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=ColumnValuesAsText[1];
                                                         AutoCalcField=No;
                                                         DataSetFieldName=ColumnValuesAsText_1__Control1100049 }
            { 1100050;TextBox   ;15750;0    ;2550 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontItalic=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=ColumnValuesAsText[2];
                                                         AutoCalcField=No;
                                                         DataSetFieldName=ColumnValuesAsText_2__Control1100050 }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18300;
            SectionHeight=423;
            KeepWithNext=No;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ShowLine(FALSE,TRUE,TRUE));
                         END;

          }
          CONTROLS
          {
            { 1100051;TextBox   ;0    ;0    ;10800;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         FontItalic=Yes;
                                                         SourceExpr=Description;
                                                         DataSetFieldName=Acc__Schedule_Line_Description_Control1100051 }
            { 1100052;TextBox   ;11700;0    ;2550 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         FontItalic=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=ColumnValuesAsText[1];
                                                         AutoCalcField=No;
                                                         DataSetFieldName=ColumnValuesAsText_1__Control1100052 }
            { 1100053;TextBox   ;15750;0    ;2550 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         FontItalic=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=ColumnValuesAsText[2];
                                                         AutoCalcField=No;
                                                         DataSetFieldName=ColumnValuesAsText_2__Control1100053 }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18300;
            SectionHeight=105;
            KeepWithNext=No;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Acc. Schedule Line".Underline);
                         END;

          }
          CONTROLS
          {
            { 1100054;Shape     ;0    ;0    ;18300;105  ;Border=Yes;
                                                         BorderWidth=Hairline;
                                                         ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18300;
            SectionHeight=0;
            KeepWithNext=No;
            OnPreSection=VAR
                           AccScheduleLine@1100000 : Record 85;
                         BEGIN
                           IF "Acc. Schedule Line"."New Page" THEN BEGIN
                             AccScheduleLine := "Acc. Schedule Line";
                             IF AccScheduleLine.NEXT <> 0 THEN
                               DisplayText[5] := UPPERCASE(FORMAT(AccScheduleLine.Type));
                             CurrReport.NEWPAGE;
                           END;
                         END;

          }
          CONTROLS
          {
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=5060;
      Height=8030;
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1100000;CheckBox  ;3410 ;990  ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=[ENU=Print General;
                                                              ESP=Imprimir general];
                                                   SourceExpr=GeneralIdData }
      { 1100001;Label     ;0    ;550  ;3300 ;880  ;ParentControl=1100000;
                                                   VertAlign=Bottom;
                                                   MultiLine=Yes }
      { 1100002;TextBox   ;3410 ;1980 ;1650 ;440  ;CaptionML=[ENU=Permanent Wage-earning Employees in Fiscal Year;
                                                              ESP=Emp. asalariados fijos en ejercicio];
                                                   BlankZero=Yes;
                                                   SourceExpr=Personnel[1] }
      { 1100003;Label     ;0    ;1540 ;3300 ;880  ;ParentControl=1100002;
                                                   VertAlign=Bottom;
                                                   MultiLine=Yes }
      { 1100004;TextBox   ;3410 ;2970 ;1650 ;440  ;CaptionML=[ENU=Wage-earning Employees in Previous year;
                                                              ESP=Emp. asalariados en a¤o anterior];
                                                   BlankZero=Yes;
                                                   SourceExpr=Personnel[2] }
      { 1100005;Label     ;0    ;2530 ;3300 ;880  ;ParentControl=1100004;
                                                   VertAlign=Bottom;
                                                   MultiLine=Yes }
      { 1100006;TextBox   ;3410 ;3960 ;1650 ;440  ;CaptionML=[ENU=Temporary Wage-earner Employees in Fiscal Year;
                                                              ESP=Emp. asalariados temporales en ejercicio];
                                                   BlankZero=Yes;
                                                   SourceExpr=Personnel[3] }
      { 1100007;Label     ;0    ;3520 ;3300 ;880  ;ParentControl=1100006;
                                                   VertAlign=Bottom;
                                                   MultiLine=Yes }
      { 1100008;TextBox   ;3410 ;4950 ;1650 ;440  ;CaptionML=[ENU=Temporary Wage-earner Employees in Previous Year;
                                                              ESP=Emp. asalariados temporales en a¤o anterior];
                                                   BlankZero=Yes;
                                                   SourceExpr=Personnel[4] }
      { 1100009;Label     ;0    ;4510 ;3300 ;880  ;ParentControl=1100008;
                                                   VertAlign=Bottom;
                                                   MultiLine=Yes }
      { 1100010;TextBox   ;3410 ;5940 ;1650 ;440  ;CaptionML=[ENU=Total No. of pages presented in the Mercantile Registry;
                                                              ESP=N£m. p g. tot. presentado en el Registro Mercantil];
                                                   BlankZero=Yes;
                                                   SourceExpr=NoOfPages }
      { 1100011;Label     ;0    ;5500 ;3300 ;880  ;ParentControl=1100010;
                                                   VertAlign=Bottom;
                                                   MultiLine=Yes }
      { 1100012;TextBox   ;3410 ;6930 ;1650 ;440  ;CaptionML=[ENU=Closing date to which the annual accounts refer to;
                                                              ESP=Fecha de cierre a que van referidas las cuentas anuales];
                                                   NotBlank=Yes;
                                                   BlankZero=Yes;
                                                   SourceExpr=CloseDate }
      { 1100013;Label     ;0    ;6490 ;3300 ;880  ;ParentControl=1100012;
                                                   VertAlign=Bottom;
                                                   MultiLine=Yes }
      { 1100014;CheckBox  ;3410 ;0    ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=[ENU=Use Preprinted Form;
                                                              ESP=Utiliza preimpreso];
                                                   SourceExpr=UsePreprintedForm }
      { 1100015;Label     ;0    ;0    ;3300 ;440  ;ParentControl=1100014 }
      { 1100016;CheckBox  ;3410 ;7590 ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=[ENU=Show Amounts in Add. Currency;
                                                              ESP=Muestra importes en divisa adicional];
                                                   SourceExpr=PrintAmountsInAddCurrency }
      { 1100017;Label     ;0    ;7590 ;3300 ;440  ;ParentControl=1100016 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[ENU=Options;
                             ESP=Opciones] }

      { 1100014;2;Field     ;
                  CaptionML=[ENU=Use Preprinted Form;
                             ESP=Utiliza preimpreso];
                  SourceExpr=UsePreprintedForm }

      { 1100000;2;Field     ;
                  CaptionML=[ENU=Print General;
                             ESP=Imprimir general];
                  SourceExpr=GeneralIdData;
                  MultiLine=Yes }

      { 1100002;2;Field     ;
                  CaptionML=[ENU=Permanent Wage-earning Employees in Fiscal Year;
                             ESP=Emp. asalariados fijos en ejercicio];
                  BlankZero=Yes;
                  SourceExpr=Personnel[1];
                  MultiLine=Yes }

      { 1100004;2;Field     ;
                  CaptionML=[ENU=Wage-earning Employees in Previous year;
                             ESP=Emp. asalariados en a¤o anterior];
                  BlankZero=Yes;
                  SourceExpr=Personnel[2];
                  MultiLine=Yes }

      { 1100006;2;Field     ;
                  CaptionML=[ENU=Temporary Wage-earner Employees in Fiscal Year;
                             ESP=Emp. asalariados temporales en ejercicio];
                  BlankZero=Yes;
                  SourceExpr=Personnel[3];
                  MultiLine=Yes }

      { 1100008;2;Field     ;
                  CaptionML=[ENU=Temporary Wage-earner Employees in Previous Year;
                             ESP=Emp. asalariados temporales en a¤o anterior];
                  BlankZero=Yes;
                  SourceExpr=Personnel[4];
                  MultiLine=Yes }

      { 1100010;2;Field     ;
                  CaptionML=[ENU=Total No. of pages presented in the Mercantile Registry;
                             ESP=N£m. p g. tot. presentado en el Registro Mercantil];
                  BlankZero=Yes;
                  SourceExpr=NoOfPages;
                  MultiLine=Yes }

      { 1100012;2;Field     ;
                  CaptionML=[ENU=Closing date to which the annual accounts refer to;
                             ESP=Fecha de cierre a que van referidas las cuentas anuales];
                  NotBlank=Yes;
                  BlankZero=Yes;
                  SourceExpr=CloseDate;
                  MultiLine=Yes }

      { 1100016;2;Field     ;
                  CaptionML=[ENU=Show Amounts in Add. Currency;
                             ESP=Muestra importes en divisa adicional];
                  SourceExpr=PrintAmountsInAddCurrency }

    }
  }
  CODE
  {
    VAR
      CompanyInfo@1100001 : Record 79;
      ColLayoutTmp@1100002 : TEMPORARY Record 334;
      GLSetup@1100003 : Record 98;
      AccSchedManagement@1100004 : Codeunit 8;
      UsePreprintedForm@1100005 : Boolean;
      AccSchedLineFilter@1100006 : Text[250];
      FiscalYearTxt1@1100007 : Text[30];
      FiscalYearTxt2@1100008 : Text[30];
      CompName@1100009 : ARRAY [2] OF Text[32];
      HeaderText@1100011 : Text[30];
      CloseDate@1100012 : Date;
      Personnel@1100013 : ARRAY [4] OF Integer;
      NoOfPages@1100014 : Integer;
      GeneralIdData@1100015 : Boolean;
      TokenPointer@1100016 : Integer;
      ColumnValuesDisplayed@1100017 : ARRAY [5] OF Decimal;
      ColumnValuesAsText@1100018 : ARRAY [5] OF Text[30];
      MaxColumnsDisplayed@1100019 : Integer;
      i@1100020 : Integer;
      StartDate@1100021 : Date;
      EndDate@1100022 : Date;
      FiscalStartDate@1100023 : Date;
      ColumnLayoutName@1100024 : Code[10];
      AccSchedName@1103355000 : Code[10];
      ShowDivideError@1100025 : Boolean;
      PrintAmountsInAddCurrency@1100026 : Boolean;
      DisplayText@1100033 : ARRAY [6] OF Text[505];
      Text1100000@1100031 : TextConst 'ENU=Closing dates must be specified in G/L Accounts.;ESP=Especifique la Fecha de cierre a que van referidas las cuentas.';
      Text1100001@1100030 : TextConst 'ENU=* ERROR *;ESP=* ERROR *';
      Text1100002@1100029 : TextConst 'ENU=1Y-1D;ESP=1A-1D';
      Text1100003@1100027 : TextConst 'ENU="All amounts are in ";ESP="Importes en "';
      Text1100004@1100028 : TextConst 'ENU=Select a unique Account Schedule;ESP=Seleccione un solo esquema de cuentas';
      Text1100005@1100032 : TextConst 'ENU=-1D;ESP=-1D';
      Text1100006@1100034 : TextConst 'ENU=Personal Tax Number;ESP=N£mero fiscal personal';
      Text1100007@1100035 : TextConst 'ENU=UNIQUE COMPANY NAME;ESP=NOMBRE EMPRESA éNICO';
      Text1100008@1100036 : TextConst 'ENU=FISCAL YEAR;ESP=EJERCICIO';
      PageGroupNo@1100045 : Integer;
      NextPageGroupNo@1100000 : Integer;
      PageNONO@1100037 : Integer;

    PROCEDURE SplitCompanyName@6(VAR CompanyInfo2@1100000 : Record 79;VAR Line@1100001 : ARRAY [2] OF Text[132]);
    VAR
      FullName@1100002 : Text[101];
      NewToken@1100003 : Text[50];
      FullLine@1100004 : Boolean;
      NoMoreTokens@1100005 : Boolean;
    BEGIN
      FullName := CompanyInfo2.Name + ' ' + CompanyInfo2."Name 2";
      FullLine := FALSE;
      NoMoreTokens := FALSE;
      Token(FullName,Line[1]);
      REPEAT
        Token(FullName,NewToken);
        IF NewToken = '' THEN
          NoMoreTokens := TRUE
        ELSE
          IF STRLEN(Line[1] + NewToken) + 1 > MAXSTRLEN(CompName[1])
          THEN BEGIN
            FullLine := TRUE;
            Line[2] := NewToken;
          END ELSE
            Line[1] := Line[1] + ' ' + NewToken;
      UNTIL NoMoreTokens OR FullLine;

      IF FullLine THEN BEGIN
        FullLine := FALSE;
        REPEAT
          Token(FullName,NewToken);
          IF NewToken = '' THEN
            NoMoreTokens := TRUE
          ELSE
            IF STRLEN(Line[2] + NewToken) + 1 > MAXSTRLEN(CompName[2]) THEN
              FullLine := TRUE
            ELSE
              Line[2] := Line[2] + ' ' + NewToken;
        UNTIL NoMoreTokens OR FullLine;
      END;
    END;

    PROCEDURE Token@8(String@1100000 : Text[132];VAR Token@1100001 : Text[132]);
    VAR
      Character@1100002 : Text[30];
    BEGIN
      Token := '';
      REPEAT
        TokenPointer := TokenPointer + 1;
        Character := COPYSTR(String,TokenPointer,1);
      UNTIL Character <> ' ';
      WHILE (Character <> ' ') AND (Character <> '') DO BEGIN
        Token := Token + Character;
        TokenPointer := TokenPointer + 1;
        Character := COPYSTR(String,TokenPointer,1);
      END;
    END;

    PROCEDURE InitAccSched@10();
    BEGIN
      StartDate := "Acc. Schedule Line".GETRANGEMIN("Date Filter");
      EndDate := "Acc. Schedule Line".GETRANGEMAX("Date Filter");
      FiscalStartDate := AccSchedManagement.FindFiscalYear(EndDate);
      FiscalYearTxt1 := FORMAT(DATE2DMY(CALCDATE(Text1100002,FiscalStartDate),3));
      FiscalYearTxt2 := FORMAT(DATE2DMY(CALCDATE(Text1100005,FiscalStartDate),3));
      IF UsePreprintedForm THEN BEGIN
        FiscalYearTxt1 := COPYSTR(FiscalYearTxt1,4);
        FiscalYearTxt2 := COPYSTR(FiscalYearTxt2,4);
      END;

      MaxColumnsDisplayed := ARRAYLEN(ColumnValuesDisplayed);
      AccSchedLineFilter := "Acc. Schedule Line".GETFILTERS;
      AccSchedManagement.CopyColumnsToTemp(ColumnLayoutName,ColLayoutTmp);
    END;

    PROCEDURE CalcColumns@13() : Boolean;
    VAR
      NonZero@1100000 : Boolean;
    BEGIN
      NonZero := FALSE;
      WITH ColLayoutTmp DO BEGIN
        SETRANGE("Column Layout Name",ColumnLayoutName);
        i := 0;
        IF FIND('-') THEN
          REPEAT
            IF Show <> Show::Never THEN BEGIN
              i := i + 1;
              ColumnValuesDisplayed[i] := AccSchedManagement.CalcCell("Acc. Schedule Line",ColLayoutTmp,PrintAmountsInAddCurrency);
              IF AccSchedManagement.GetDivisionError THEN BEGIN
                IF ShowDivideError THEN
                  ColumnValuesAsText[i] := Text1100001
                ELSE
                  ColumnValuesAsText[i] := '';
              END ELSE BEGIN
                NonZero := NonZero OR (ColumnValuesDisplayed[i] <> 0);
                ColumnValuesAsText[i] :=
                  AccSchedManagement.FormatCellAsText(ColLayoutTmp,ColumnValuesDisplayed[i]);
              END;
            END;
          UNTIL (i >= MaxColumnsDisplayed) OR (NEXT = 0);
      END;
      EXIT(NonZero);
    END;

    LOCAL PROCEDURE GetCurrency@5() : Code[10];
    BEGIN
      IF PrintAmountsInAddCurrency THEN
        EXIT(GLSetup."Additional Reporting Currency")
      ELSE
        EXIT('');
    END;

    PROCEDURE ShowLine@3(Opc@1100000 : Boolean;Bold@1100001 : Boolean;Italic@1100002 : Boolean) : Boolean;
    VAR
      NonZero@1100003 : Boolean;
      PrintLine@1100004 : Boolean;
    BEGIN
      NonZero := FALSE;

      IF "Acc. Schedule Line".Show = "Acc. Schedule Line".Show::No THEN
        EXIT(FALSE);
      IF "Acc. Schedule Line".Bold <> Bold THEN
        EXIT(FALSE);
      IF "Acc. Schedule Line".Italic <> Italic THEN
        EXIT(FALSE);

      IF Opc = FALSE THEN BEGIN
        PrintLine := ("Acc. Schedule Line".Show IN ["Acc. Schedule Line".Show::"When Positive Balance"]);
        IF PrintLine THEN
          NonZero := CalcColumns;
        EXIT(PrintLine);
      END ELSE BEGIN
        PrintLine := NOT ("Acc. Schedule Line".Show IN ["Acc. Schedule Line".Show::No,
          "Acc. Schedule Line".Show::"When Positive Balance"]);
        IF PrintLine THEN BEGIN
          NonZero := CalcColumns;
          IF "Acc. Schedule Line".Show = "Acc. Schedule Line".Show::"If Any Column Not Zero" THEN
            PrintLine := NonZero;
          EXIT(PrintLine);
        END;
      END;

      EXIT(TRUE);
    END;

    PROCEDURE SetParameter@1103355000(pwAccSchedName@1103355000 : Code[10]);
    BEGIN

      AccSchedName := pwAccSchedName;
    END;

    BEGIN
    {
      $001 AJS 20.11.2007, Personalizacion GOC
         Al abrirse el report tiene que presentar como filtro de nombre esquema cuentas, el esquema de cuentas
         de la ventana, se ha tenido que crear una funcion SetParameter para pasar el nombre desde la ventana

      $002 AJS 01052013 Personalizacion de viaualizacion del label de CIF/NIF
    }
    END.
  }
  RDLDATA
  {
  }
}
