OBJECT Report 10704 Sales Invoice Book
{
  OBJECT-PROPERTIES
  {
    Date=15/06/13;
    Time=14:13:58;
    Modified=Yes;
    Version List=AIC2009,NAVES6.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Sales Invoice Book;
               ESP=Libro facturas emitidas];
    LeftMargin=1000;
    OnPreReport=BEGIN
                  AuxVatEntry := VATEntry.GETFILTERS;
                END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=<Integer3>;
        OnPreDataItem=BEGIN
                        GLSetup.GET;
                        IF PrintAmountsInAddCurrency THEN
                          HeaderText := STRSUBSTNO(Text1100002,GLSetup."Additional Reporting Currency")
                        ELSE BEGIN
                          GLSetup.TESTFIELD("LCY Code");
                          HeaderText := STRSUBSTNO(Text1100002,GLSetup."LCY Code");
                        END;

                        CompanyInfo.GET;
                        CompanyAddr[1] := CompanyInfo.Name;
                        CompanyAddr[2] := CompanyInfo."Name 2";
                        CompanyAddr[3] := CompanyInfo.Address;
                        CompanyAddr[4] := CompanyInfo."Address 2";
                        CompanyAddr[5] := CompanyInfo.City;
                        CompanyAddr[6] := CompanyInfo."Post Code" + ' ' + CompanyInfo.County;
                        IF CompanyInfo."VAT Registration No." <> '' THEN
                          CompanyAddr[7] := Text1100000 + CompanyInfo."VAT Registration No."
                        ELSE
                          ERROR(Text1100001);
                        COMPRESSARRAY(CompanyAddr);
                      END;

        OnAfterGetRecord=BEGIN

                           // $003 INCOMING
                           // Inicializar las matrices de IVA, Bases e Importes

                           CLEAR(TabIVA);
                           CLEAR(TabBase);
                           CLEAR(TabImporte);

                           wIndiceMaximo := 0;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18900;
            SectionHeight=3384;
          }
          CONTROLS
          {
            { 21  ;TextBox      ;15750;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4);
                                                         DataSetFieldName=FORMAT_TODAY_0_4_ }
            { 22  ;TextBox      ;17400;846  ;1500 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID;
                                                         DataSetFieldName=USERID }
            { 24  ;TextBox      ;18450;423  ;450  ;423  ;CaptionML=[ENU=Page;
                                                                    ESP=P g.];
                                                         SourceExpr=CurrReport.PAGENO;
                                                         DataSetFieldName=CurrReport_PAGENO }
            { 27  ;Label        ;17550;423  ;750  ;423  ;ParentControl=24;
                                                         FontSize=7;
                                                         DataSetFieldName=CurrReport_PAGENOCaption }
            { 64  ;TextBox      ;0    ;2961 ;6300 ;423  ;SourceExpr=CompanyAddr[7];
                                                         DataSetFieldName=CompanyAddr_7_ }
            { 65  ;TextBox      ;0    ;1692 ;6300 ;423  ;SourceExpr=CompanyAddr[4];
                                                         DataSetFieldName=CompanyAddr_4_ }
            { 66  ;TextBox      ;0    ;2115 ;6300 ;423  ;SourceExpr=CompanyAddr[5];
                                                         DataSetFieldName=CompanyAddr_5_ }
            { 67  ;TextBox      ;0    ;2538 ;6300 ;423  ;SourceExpr=CompanyAddr[6];
                                                         DataSetFieldName=CompanyAddr_6_ }
            { 139 ;TextBox      ;0    ;1269 ;6300 ;423  ;SourceExpr=CompanyAddr[3];
                                                         DataSetFieldName=CompanyAddr_3_ }
            { 140 ;TextBox      ;0    ;846  ;6300 ;423  ;SourceExpr=CompanyAddr[2];
                                                         DataSetFieldName=CompanyAddr_2_ }
            { 141 ;TextBox      ;0    ;423  ;6300 ;423  ;FontBold=Yes;
                                                         SourceExpr=CompanyAddr[1];
                                                         DataSetFieldName=CompanyAddr_1_ }
            { 142 ;Label        ;0    ;0    ;6300 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Sales Invoice Book;
                                                                    ESP=Libro facturas emitidas];
                                                         DataSetFieldName=Sales_Invoice_BookCaption }
            { 1100001;TextBox   ;18750;2961 ;150  ;423  ;Name=PrintAmountsInAddCurrency;
                                                         Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr=PrintAmountsInAddCurrency;
                                                         DataSetFieldName=PrintAmountsInAddCurrency }
            { 1100002;TextBox   ;18450;2961 ;150  ;423  ;Name=ShowAutoInvCred;
                                                         Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr=ShowAutoInvCred;
                                                         DataSetFieldName=ShowAutoInvCred }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18900;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((CurrReport.PAGENO = 1) AND (AuxVatEntry <> ''));
                         END;

          }
          CONTROLS
          {
            { 144 ;TextBox      ;0    ;0    ;18900;423  ;SourceExpr=AuxVatEntry;
                                                         DataSetFieldName=AuxVatEntry }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18900;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 143 ;TextBox      ;0    ;0    ;18900;423  ;SourceExpr=HeaderText;
                                                         DataSetFieldName=HeaderText }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18900;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 145 ;Label        ;450  ;0    ;1500 ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Document No.;
                                                                    ESP=N§ documento];
                                                         DataSetFieldName=Document_No_Caption }
            { 146 ;Label        ;2100 ;0    ;1200 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Posting Date;
                                                                    ESP=Fecha registro];
                                                         DataSetFieldName=Posting_DateCaption }
            { 147 ;Label        ;3450 ;0    ;1500 ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=External Document No.;
                                                                    ESP=N§ documento externo];
                                                         DataSetFieldName=External_Document_No_Caption }
            { 148 ;Label        ;5100 ;0    ;4200 ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Name;
                                                                    ESP=Nombre];
                                                         DataSetFieldName=NameCaption }
            { 154 ;Label        ;9450 ;0    ;1500 ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=VAT Registration;
                                                                    ESP=CIF/NIF];
                                                         DataSetFieldName=VAT_RegistrationCaption }
            { 155 ;Label        ;11100;0    ;1800 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Base;
                                                                    ESP=Base];
                                                         DataSetFieldName=BaseCaption }
            { 156 ;Label        ;13050;0    ;900  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=VAT%;
                                                                    ESP=%IVA];
                                                         DataSetFieldName=VAT_Caption }
            { 157 ;Label        ;14100;0    ;900  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=EC%;
                                                                    ESP=%RE];
                                                         DataSetFieldName=EC_Caption }
            { 158 ;Label        ;15150;0    ;1800 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Amount;
                                                                    ESP=Importe];
                                                         DataSetFieldName=AmountCaption }
            { 159 ;Label        ;17100;0    ;1800 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Total;
                                                                    ESP=Total];
                                                         DataSetFieldName=TotalCaption }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table254;
        DataItemTableView=SORTING(No. Series,Posting Date)
                          WHERE(Type=CONST(Sale));
        DataItemVarName=VATEntry;
        OnPreDataItem=BEGIN
                        IF GETFILTER("Posting Date") = '' THEN
                          PrevData := 0D
                        ELSE
                          PrevData := GETRANGEMIN("Posting Date");
                        i := 1;
                        IF SortPostDate THEN
                          VATEntry.SETCURRENTKEY(Type,"Posting Date","Document Type","Document No.","Bill-to/Pay-to No.")
                        ELSE
                          VATEntry.SETCURRENTKEY("No. Series","Posting Date","Document No.");
                      END;

        OnAfterGetRecord=BEGIN
                           VATBuffer.DELETEALL;

                           DocType := FORMAT("Document Type");
                           IF "Document Type" = "Document Type"::"Credit Memo" THEN
                             DocType := Text1100005;
                         END;

        ReqFilterFields=Posting Date,Document Type,Document No.,VAT %;
        TotalFields=Base,Amount,Additional-Currency Base,Additional-Currency Amount;
        GroupTotalFields=No. Series;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=18900;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(NOT PrintAmountsInAddCurrency AND NOT SortPostDate);
                         END;

          }
          CONTROLS
          {
            { 51  ;Label        ;3450 ;0    ;3000 ;423  ;LeaderDots=Yes;
                                                         CaptionML=[ENU=Continued;
                                                                    ESP=Suma];
                                                         DataSetFieldName=ContinuedCaption }
            { 52  ;TextBox      ;11100;0    ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=-Base;
                                                         DataSetFieldName=Base }
            { 53  ;TextBox      ;15150;0    ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=-Amount;
                                                         DataSetFieldName=Amount }
            { 58  ;TextBox      ;17100;0    ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=-(Base + Amount);
                                                         DataSetFieldName=Base_Amount_ }
          }
           }
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=18900;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(PrintAmountsInAddCurrency AND NOT SortPostDate);
                         END;

          }
          CONTROLS
          {
            { 28  ;Label        ;3450 ;0    ;3000 ;423  ;LeaderDots=Yes;
                                                         CaptionML=[ENU=Continued;
                                                                    ESP=Suma];
                                                         DataSetFieldName=ContinuedCaption_Control28 }
            { 29  ;TextBox      ;11100;0    ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=-"Additional-Currency Base";
                                                         DataSetFieldName=Additional_Currency_Base_ }
            { 30  ;TextBox      ;15150;0    ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=-"Additional-Currency Amount";
                                                         DataSetFieldName=Additional_Currency_Amount_ }
            { 31  ;TextBox      ;17100;0    ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=-("Additional-Currency Base" + "Additional-Currency Amount");
                                                         DataSetFieldName=Additional_Currency_Base___Additional_Currency_Amount__ }
          }
           }
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=18900;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(NOT PrintAmountsInAddCurrency AND SortPostDate);
                         END;

          }
          CONTROLS
          {
            { 128 ;Label        ;3450 ;0    ;3000 ;423  ;LeaderDots=Yes;
                                                         CaptionML=[ENU=Continued;
                                                                    ESP=Suma];
                                                         DataSetFieldName=ContinuedCaption_Control128 }
            { 127 ;TextBox      ;11100;0    ;1800 ;423  ;FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=-Base + Base2;
                                                         DataSetFieldName=Base_Base2 }
            { 133 ;TextBox      ;15150;0    ;1800 ;423  ;FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=-Amount + Amount2;
                                                         DataSetFieldName=Amount_Amount2 }
            { 134 ;TextBox      ;17100;0    ;1800 ;423  ;FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=(-Base + Base2) + (-Amount + Amount2);
                                                         DataSetFieldName=Base_Base2____Amount_Amount2_ }
          }
           }
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=18900;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(PrintAmountsInAddCurrency AND SortPostDate);
                         END;

          }
          CONTROLS
          {
            { 136 ;Label        ;3450 ;0    ;3000 ;423  ;LeaderDots=Yes;
                                                         CaptionML=[ENU=Continued;
                                                                    ESP=Suma];
                                                         DataSetFieldName=ContinuedCaption_Control136 }
            { 149 ;TextBox      ;17100;0    ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=(-"Additional-Currency Base" + Base2) + (-"Additional-Currency Amount" + Amount2);
                                                         DataSetFieldName=Additional_Currency_Base__Base2_____Additional_Currency_Amount__Amount2_ }
            { 150 ;TextBox      ;11100;0    ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=-"Additional-Currency Base" + Base2;
                                                         DataSetFieldName=Additional_Currency_Base__Base2 }
            { 151 ;TextBox      ;15150;0    ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=-"Additional-Currency Amount" + Amount2;
                                                         DataSetFieldName=Additional_Currency_Amount__Amount2 }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=18900;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 59  ;Label        ;0    ;0    ;1500 ;423  ;ParentControl=68;
                                                         VertAlign=Center;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         DataSetFieldName=VATEntry__No__Series_Caption }
            { 68  ;TextBox      ;1650 ;0    ;1500 ;423  ;SourceExpr="No. Series";
                                                         DataSetFieldName=VATEntry__No__Series_ }
            { 1100000;TextBox   ;17850;0    ;150  ;423  ;Name=SortPostDate;
                                                         Visible=No;
                                                         ForeColor=65535;
                                                         SourceExpr=SortPostDate;
                                                         DataSetFieldName=SortPostDate }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=18900;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(PrintAmountsInAddCurrency);
                         END;

          }
          CONTROLS
          {
            { 49  ;TextBox      ;7950 ;0    ;1500 ;423  ;SourceExpr="No. Series";
                                                         DataSetFieldName=VATEntry__No__Series__Control49 }
            { 71  ;Label        ;6300 ;0    ;1500 ;423  ;ParentControl=49;
                                                         VertAlign=Center;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         DataSetFieldName=VATEntry__No__Series__Control49Caption }
            { 72  ;Label        ;3450 ;0    ;2550 ;423  ;FontBold=No;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Total;
                                                                    ESP=Total];
                                                         DataSetFieldName=TotalCaption_Control72 }
            { 74  ;TextBox      ;11100;0    ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=-"Additional-Currency Base";
                                                         DataSetFieldName=Additional_Currency_Base__Control74 }
            { 80  ;TextBox      ;15150;0    ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=-"Additional-Currency Amount";
                                                         DataSetFieldName=Additional_Currency_Amount__Control80 }
            { 81  ;TextBox      ;17100;0    ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=-("Additional-Currency Base" + "Additional-Currency Amount");
                                                         DataSetFieldName=Additional_Currency_Base___Additional_Currency_Amount___Control81 }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=18900;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(NOT PrintAmountsInAddCurrency);
                         END;

          }
          CONTROLS
          {
            { 73  ;TextBox      ;11100;0    ;1800 ;423  ;FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=-Base;
                                                         DataSetFieldName=Base_Control73 }
            { 75  ;TextBox      ;15150;0    ;1800 ;423  ;FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=-Amount;
                                                         DataSetFieldName=Amount_Control75 }
            { 76  ;TextBox      ;17100;0    ;1800 ;423  ;FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=-(Base + Amount);
                                                         DataSetFieldName=Base_Amount__Control76 }
            { 77  ;Label        ;3450 ;0    ;2550 ;423  ;FontBold=No;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Total;
                                                                    ESP=Total];
                                                         DataSetFieldName=TotalCaption_Control77 }
            { 78  ;Label        ;6300 ;0    ;1500 ;423  ;ParentControl=79;
                                                         VertAlign=Center;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         DataSetFieldName=VATEntry__No__Series__Control79Caption }
            { 79  ;TextBox      ;7950 ;0    ;1500 ;423  ;SourceExpr="No. Series";
                                                         DataSetFieldName=VATEntry__No__Series__Control79 }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=18900;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(NOT PrintAmountsInAddCurrency AND SortPostDate);
                         END;

          }
          CONTROLS
          {
            { 105 ;Label        ;3450 ;423  ;3000 ;423  ;LeaderDots=Yes;
                                                         CaptionML=[ENU=Continued;
                                                                    ESP=Suma];
                                                         DataSetFieldName=ContinuedCaption_Control105 }
            { 50  ;TextBox      ;11100;423  ;1800 ;423  ;FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=-Base + Base2;
                                                         DataSetFieldName=Base_Base2_Control50 }
            { 54  ;TextBox      ;15150;423  ;1800 ;423  ;FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=-Amount + Amount2;
                                                         DataSetFieldName=Amount_Amount2_Control54 }
            { 104 ;TextBox      ;17100;423  ;1800 ;423  ;FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=(-Base + Base2) + (-Amount + Amount2);
                                                         DataSetFieldName=Base_Base2____Amount_Amount2__Control104 }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=18900;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(PrintAmountsInAddCurrency AND SortPostDate);
                         END;

          }
          CONTROLS
          {
            { 120 ;Label        ;3450 ;423  ;3000 ;423  ;LeaderDots=Yes;
                                                         CaptionML=[ENU=Continued;
                                                                    ESP=Suma];
                                                         DataSetFieldName=ContinuedCaption_Control120 }
            { 135 ;TextBox      ;17100;423  ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=(-"Additional-Currency Base" + Base2) + (-"Additional-Currency Amount" + Amount2);
                                                         DataSetFieldName=Additional_Currency_Base__Base2_____Additional_Currency_Amount__Amount2__Control135 }
            { 137 ;TextBox      ;11100;423  ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=-"Additional-Currency Base" + Base2;
                                                         DataSetFieldName=Additional_Currency_Base__Base2_Control137 }
            { 138 ;TextBox      ;15150;423  ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=-"Additional-Currency Amount" + Amount2;
                                                         DataSetFieldName=Additional_Currency_Amount__Amount2_Control138 }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=18900;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(NOT PrintAmountsInAddCurrency AND NOT SortPostDate);
                         END;

          }
          CONTROLS
          {
            { 60  ;Label        ;3450 ;423  ;3000 ;423  ;LeaderDots=Yes;
                                                         CaptionML=[ENU=Continued;
                                                                    ESP=Suma];
                                                         DataSetFieldName=ContinuedCaption_Control60 }
            { 61  ;TextBox      ;11100;423  ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=-Base;
                                                         DataSetFieldName=Base_Control61 }
            { 62  ;TextBox      ;15150;423  ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=-Amount;
                                                         DataSetFieldName=Amount_Control62 }
            { 63  ;TextBox      ;17100;423  ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=-(Base + Amount);
                                                         DataSetFieldName=Base_Amount__Control63 }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=18900;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(PrintAmountsInAddCurrency AND NOT SortPostDate);
                         END;

          }
          CONTROLS
          {
            { 32  ;Label        ;3450 ;423  ;3000 ;423  ;LeaderDots=Yes;
                                                         CaptionML=[ENU=Continued;
                                                                    ESP=Suma];
                                                         DataSetFieldName=ContinuedCaption_Control32 }
            { 33  ;TextBox      ;11100;423  ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=-"Additional-Currency Base";
                                                         DataSetFieldName=Additional_Currency_Base__Control33 }
            { 34  ;TextBox      ;15150;423  ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=-"Additional-Currency Amount";
                                                         DataSetFieldName=Additional_Currency_Amount__Control34 }
            { 35  ;TextBox      ;17100;423  ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=-("Additional-Currency Base" + "Additional-Currency Amount");
                                                         DataSetFieldName=Additional_Currency_Base___Additional_Currency_Amount___Control35 }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18900;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(NOT PrintAmountsInAddCurrency AND SortPostDate);
                         END;

          }
          CONTROLS
          {
            { 48  ;Label        ;3450 ;0    ;3000 ;423  ;FontBold=No;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Total;
                                                                    ESP=Total];
                                                         DataSetFieldName=TotalCaption_Control48 }
            { 55  ;TextBox      ;11100;0    ;1800 ;423  ;FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=-Base + Base2;
                                                         DataSetFieldName=Base_Base2_Control55 }
            { 56  ;TextBox      ;15150;0    ;1800 ;423  ;FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=-Amount + Amount2;
                                                         DataSetFieldName=Amount_Amount2_Control56 }
            { 57  ;TextBox      ;17100;0    ;1800 ;423  ;FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=(-Base + Base2) + (-Amount + Amount2);
                                                         DataSetFieldName=Base_Base2____Amount_Amount2__Control57 }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18900;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(PrintAmountsInAddCurrency AND SortPostDate);
                         END;

          }
          CONTROLS
          {
            { 70  ;Label        ;3450 ;0    ;3000 ;423  ;FontBold=No;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Total;
                                                                    ESP=Total];
                                                         DataSetFieldName=TotalCaption_Control70 }
            { 106 ;TextBox      ;11100;0    ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=-"Additional-Currency Base" + Base2;
                                                         DataSetFieldName=Additional_Currency_Base__Base2_Control106 }
            { 118 ;TextBox      ;15150;0    ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=-"Additional-Currency Amount" + Amount2;
                                                         DataSetFieldName=Additional_Currency_Amount__Amount2_Control118 }
            { 119 ;TextBox      ;17100;0    ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=(-"Additional-Currency Base" + Base2) + (-"Additional-Currency Amount" + Amount2);
                                                         DataSetFieldName=Additional_Currency_Base__Base2_____Additional_Currency_Amount__Amount2__Control119 }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table254;
        DataItemTableView=SORTING(Type,Posting Date,Document Type,Document No.,Bill-to/Pay-to No.)
                          WHERE(Type=CONST(Purchase));
        DataItemVarName=VATEntry6;
        OnPreDataItem=BEGIN
                        IF NOT SortPostDate OR NOT ShowAutoInvCred THEN
                          CurrReport.BREAK;
                        SETRANGE("Generated Autodocument",TRUE);
                        IF FIND('-') THEN;
                        IF i = 1 THEN BEGIN
                          REPEAT
                            VatEntryTemporary.INIT;
                            VatEntryTemporary.COPY(VATEntry6);
                            VatEntryTemporary.INSERT;
                            VatEntryTemporary.NEXT;
                          UNTIL VATEntry6.NEXT = 0;
                          IF FIND('-') THEN;
                          i := 0;
                        END;
                        SETFILTER("Posting Date",'%1..%2',PrevData,VATEntry."Posting Date");
                        SETFILTER("Document No.",VATEntry.GETFILTER("Document No."));
                        SETFILTER("Document Type",VATEntry.GETFILTER("Document Type"));
                        IF VatEntryTemporary.FIND('-') THEN;
                        VatEntryTemporary.SETRANGE("Generated Autodocument",TRUE);
                        VatEntryTemporary.SETFILTER("Posting Date",'%1..%2',PrevData,VATEntry."Posting Date");
                        IF VatEntryTemporary.FIND('-') THEN BEGIN
                          Show := TRUE;
                          VatEntryTemporary.DELETEALL;
                        END ELSE
                          Show := FALSE;
                      END;

        OnAfterGetRecord=BEGIN
                           IF NOT Show THEN
                             CurrReport.BREAK;
                           VATBuffer3.DELETEALL;
                           NoSeriesAuxPrev := NoSeriesAux;

                           IF "Document Type" = "Document Type"::"Credit Memo" THEN BEGIN
                             GLSetup.GET;
                             NoSeriesAux := GLSetup."Autocredit Memo Nos.";
                           END;
                           IF "Document Type" = "Document Type"::Invoice THEN BEGIN
                             GLSetup.GET;
                             NoSeriesAux := GLSetup."Autoinvoice Nos.";
                           END;

                           IF NoSeriesAux <> NoSeriesAuxPrev THEN BEGIN
                             NotBaseReverse := 0;
                             NotAmountReverse := 0;
                           END;
                         END;

        OnPostDataItem=BEGIN
                         PrevData := VATEntry."Posting Date" + 1;
                       END;

        TotalFields=Base,Amount,Additional-Currency Base,Additional-Currency Amount;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table254;
        DataItemTableView=SORTING(Type,Posting Date,Document Type,Document No.,Bill-to/Pay-to No.);
        DataItemVarName=VATEntry7;
        OnPreDataItem=BEGIN
                        CLEAR(PurchCrMemoHeader);
                        CLEAR(PurchInvHeader);
                        CLEAR(Vendor);
                        PurchInvHeader.RESET;
                        PurchCrMemoHeader.RESET;
                        Vendor.RESET;
                        VendLedgEntry.SETCURRENTKEY("Document No.","Document Type","Vendor No.");
                        CASE VATEntry6."Document Type" OF
                          "Document Type"::"Credit Memo":
                            IF PurchCrMemoHeader.GET(VATEntry6."Document No.") THEN BEGIN
                              Vendor.Name := PurchCrMemoHeader."Pay-to Name";
                              Vendor."VAT Registration No." := PurchCrMemoHeader."VAT Registration No.";
                              VendLedgEntry.SETRANGE("Document No.",VATEntry6."Document No.");
                              VendLedgEntry.SETRANGE("Document Type","Document Type"::"Credit Memo");
                              IF VendLedgEntry.FIND('-') THEN
                                AutoDocNo := VendLedgEntry."Autodocument No.";
                              EXIT;
                            END;
                          "Document Type"::Invoice:
                            IF PurchInvHeader.GET(VATEntry6."Document No.") THEN BEGIN
                              Vendor.Name := PurchInvHeader."Pay-to Name";
                              Vendor."VAT Registration No." := PurchInvHeader."VAT Registration No.";
                              VendLedgEntry.SETRANGE("Document Type","Document Type"::Invoice);
                              VendLedgEntry.SETRANGE("Document No.",VATEntry6."Document No.");
                              IF VendLedgEntry.FIND('-') THEN
                                AutoDocNo := VendLedgEntry."Autodocument No.";
                              EXIT;
                            END;
                        END;
                        IF NOT Vendor.GET(VATEntry6."Bill-to/Pay-to No.") THEN
                          Vendor.Name := Text1100003;
                        VendLedgEntry.SETCURRENTKEY("Document No.","Document Type","Vendor No.");
                        VendLedgEntry.SETRANGE("Document No.",VATEntry6."Document No.");
                        VendLedgEntry.SETFILTER("Document Type",Text1100004);
                        IF VendLedgEntry.FIND('-') THEN;
                      END;

        OnAfterGetRecord=BEGIN
                           VATBuffer3."VAT %" := "VAT %";
                           VATBuffer3."EC %" := "EC %";

                           IF "VAT Calculation Type" = "VAT Calculation Type"::"Reverse Charge VAT" THEN BEGIN
                             IF NOT PrintAmountsInAddCurrency THEN
                               IF VATBuffer3.FIND THEN BEGIN
                                 VATBuffer3.Base := VATBuffer3.Base + Base;
                                 VATBuffer3.Amount := VATBuffer3.Amount + Amount;
                                 VATBuffer3.MODIFY;
                               END ELSE BEGIN
                                 VATBuffer3.Base := Base;
                                 VATBuffer3.Amount := Amount;
                                 VATBuffer3.INSERT;
                               END
                             ELSE
                               IF VATBuffer3.FIND THEN BEGIN
                                 VATBuffer3.Base := VATBuffer3.Base + "Additional-Currency Base";
                                 VATBuffer3.Amount := VATBuffer3.Amount + "Additional-Currency Amount";
                                 VATBuffer3.MODIFY;
                               END ELSE BEGIN
                                 VATBuffer3.Base := "Additional-Currency Base";
                                 VATBuffer3.Amount := "Additional-Currency Amount";
                                 VATBuffer3.INSERT;
                               END
                           END;
                           IF "VAT Calculation Type" = "VAT Calculation Type"::"Reverse Charge VAT" THEN BEGIN
                             NotBaseReverse := NotBaseReverse + VATBuffer3.Base;
                             NotAmountReverse := NotAmountReverse + VATBuffer3.Amount;
                           END;

                           // $003 INCOMING
                           // Acumular en las tablas de Base e Importes

                           TotalizaPorPorcentaje ("VAT %", Base, Amount);
                         END;

        OnPostDataItem=BEGIN
                         VATEntry6 := VATEntry7;
                       END;

        TotalFields=Base,Amount,Additional-Currency Base,Additional-Currency Amount;
        DataItemLink=Type=FIELD(Type),
                     Posting Date=FIELD(Posting Date),
                     Document Type=FIELD(Document Type),
                     Document No.=FIELD(Document No.);
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=<Integer4>;
        OnPreDataItem=BEGIN
                        VATBuffer3.FIND('-');
                        CurrReport.CREATETOTALS(VATBuffer4.Base,VATBuffer4.Amount);
                        Fin := FALSE;
                        LineNo := 0;
                      END;

        OnAfterGetRecord=BEGIN
                           IF NOT SortPostDate THEN BEGIN
                             IF VATBuffer4.Amount = 0 THEN BEGIN
                               VATBuffer4."VAT %" := 0;
                               VATBuffer4."EC %" := 0;
                             END;
                             Base2 := Base2 + VATBuffer4.Base;
                             Amount2 := Amount2 + VATBuffer4.Amount;
                           END;

                           IF Fin THEN
                             CurrReport.BREAK;
                           VATBuffer4 := VATBuffer3;
                           Fin := VATBuffer3.NEXT = 0;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18900;
            SectionHeight=423;
            OnPreSection=BEGIN
                           IF SortPostDate THEN
                             CurrReport.SHOWOUTPUT(FALSE)
                           ELSE BEGIN
                             LineNo := LineNo + 1;
                             CurrReport.SHOWOUTPUT(LineNo = 1);
                           END;
                         END;

          }
          CONTROLS
          {
            { 2   ;TextBox      ;17100;0    ;1800 ;423  ;CaptionML=[ENU=Total;
                                                                    ESP=Total];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer4.Base + VATBuffer4.Amount;
                                                         DataSetFieldName=VATBuffer4_Base_VATBuffer4_Amount }
            { 4   ;TextBox      ;15150;0    ;1800 ;423  ;CaptionML=[ENU=Amount;
                                                                    ESP=Importe];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer4.Amount;
                                                         DataSetFieldName=VATBuffer4_Amount }
            { 8   ;TextBox      ;14100;0    ;900  ;423  ;CaptionML=[ENU=EC %;
                                                                    ESP=% RE];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer4."EC %";
                                                         DataSetFieldName=VATBuffer4__EC___ }
            { 10  ;TextBox      ;13050;0    ;900  ;423  ;CaptionML=[ENU=VAT %;
                                                                    ESP=% IVA];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer4."VAT %";
                                                         DataSetFieldName=VATBuffer4__VAT___ }
            { 20  ;TextBox      ;11100;0    ;1800 ;423  ;CaptionML=[ENU=Base;
                                                                    ESP=Base];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer4.Base;
                                                         DataSetFieldName=VATBuffer4_Base }
            { 37  ;TextBox      ;9450 ;0    ;1500 ;423  ;HorzAlign=Right;
                                                         CaptionML=[ENU=VAT Registration No.;
                                                                    ESP=CIF/NIF];
                                                         SourceExpr=CompanyInfo."VAT Registration No.";
                                                         DataSetFieldName=CompanyInfo__VAT_Registration_No__ }
            { 38  ;TextBox      ;5100 ;0    ;4200 ;423  ;MultiLine=Yes;
                                                         CaptionML=[ENU=Name;
                                                                    ESP=Nombre];
                                                         SourceExpr=CompanyInfo.Name;
                                                         DataSetFieldName=CompanyInfo_Name }
            { 39  ;TextBox      ;3450 ;0    ;1500 ;423  ;CaptionML=[ENU=Document No.;
                                                                    ESP=N§ documento];
                                                         SourceExpr=VATEntry6."Document No.";
                                                         DataSetFieldName=VATEntry6__Document_No__ }
            { 40  ;TextBox      ;2100 ;0    ;1200 ;423  ;CaptionML=[ENU=Posting Date;
                                                                    ESP=Fecha registro];
                                                         SourceExpr=FORMAT(VATEntry6."Posting Date");
                                                         DataSetFieldName=VATEntry6__Posting_Date_ }
            { 41  ;TextBox      ;450  ;0    ;1500 ;423  ;SourceExpr=AutoDocNo;
                                                         DataSetFieldName=AutoDocNo }
            { 42  ;TextBox      ;0    ;0    ;300  ;423  ;SourceExpr=DocType;
                                                         DataSetFieldName=DocType }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18900;
            SectionHeight=846;
            OnPreSection=BEGIN
                           IF SortPostDate THEN
                             CurrReport.SHOWOUTPUT(FALSE)
                           ELSE
                             CurrReport.SHOWOUTPUT(LineNo <> 1);
                         END;

          }
          CONTROLS
          {
            { 43  ;TextBox      ;17100;0    ;1800 ;423  ;CaptionML=[ENU=Total;
                                                                    ESP=Total];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer4.Base + VATBuffer4.Amount;
                                                         DataSetFieldName=VATBuffer4_Base_VATBuffer4_Amount_Control43 }
            { 44  ;TextBox      ;15150;0    ;1800 ;423  ;CaptionML=[ENU=Amount;
                                                                    ESP=Importe];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer4.Amount;
                                                         DataSetFieldName=VATBuffer4_Amount_Control44 }
            { 45  ;TextBox      ;14100;0    ;900  ;423  ;CaptionML=[ENU=EC %;
                                                                    ESP=% RE];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer4."EC %";
                                                         DataSetFieldName=VATBuffer4__EC____Control45 }
            { 46  ;TextBox      ;13050;0    ;900  ;423  ;CaptionML=[ENU=VAT %;
                                                                    ESP=% IVA];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer4."VAT %";
                                                         DataSetFieldName=VATBuffer4__VAT____Control46 }
            { 47  ;TextBox      ;11100;0    ;1800 ;423  ;CaptionML=[ENU=Base;
                                                                    ESP=Base];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer4.Base;
                                                         DataSetFieldName=VATBuffer4_Base_Control47 }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table254;
        DataItemTableView=SORTING(No. Series,Posting Date);
        DataItemVarName=VATEntry2;
        OnPreDataItem=BEGIN
                        IF SortPostDate THEN
                          SETCURRENTKEY(Type,"Posting Date","Document Type","Document No.","Bill-to/Pay-to No.")
                        ELSE
                          SETCURRENTKEY("No. Series","Posting Date");

                        CLEAR(SalesCrMemoHeader);
                        CLEAR(SalesInvHeader);
                        CLEAR(Customer);

                        IF NOT PrintAmountsInAddCurrency THEN
                          GLSetup.GET
                        ELSE BEGIN
                          GLSetup.GET;
                          Currency.GET(GLSetup."Additional Reporting Currency");
                        END;

                        CASE VATEntry."Document Type" OF
                          "Document Type"::"Credit Memo":
                            IF SalesCrMemoHeader.GET(VATEntry."Document No.") THEN BEGIN
                              Customer.Name := SalesCrMemoHeader."Bill-to Name";
                              Customer."VAT Registration No." := SalesCrMemoHeader."VAT Registration No.";
                              EXIT;
                            END;
                          "Document Type"::Invoice:
                            IF SalesInvHeader.GET(VATEntry."Document No.") THEN BEGIN
                              Customer.Name := SalesInvHeader."Bill-to Name";
                              Customer."VAT Registration No." := SalesInvHeader."VAT Registration No.";
                              EXIT;
                            END;
                        END;

                        IF NOT Customer.GET(VATEntry."Bill-to/Pay-to No.") THEN
                          Customer.Name := Text1100003;
                      END;

        OnAfterGetRecord=BEGIN
                           IF "VAT Calculation Type" = "VAT Calculation Type"::"Reverse Charge VAT" THEN BEGIN
                             VATBuffer."VAT %" := 0;
                             VATBuffer."EC %" := 0;
                           END ELSE BEGIN
                             VATBuffer."VAT %" := "VAT %";
                             VATBuffer."EC %" := "EC %";
                           END;
                           IF NOT PrintAmountsInAddCurrency THEN BEGIN
                             IF "VAT Calculation Type" = "VAT Calculation Type"::"Full VAT" THEN
                               Base := 0;
                             IF VATBuffer.FIND THEN BEGIN
                               VATBuffer.Base := VATBuffer.Base - Base;
                               VATBuffer.Amount := VATBuffer.Amount - Amount;
                               VATBuffer.MODIFY;
                             END ELSE BEGIN
                               VATBuffer.Base := -Base;
                               VATBuffer.Amount := -Amount;
                               VATBuffer.INSERT;
                             END;
                           END ELSE BEGIN
                             IF "VAT Calculation Type" = "VAT Calculation Type"::"Full VAT" THEN
                               "Additional-Currency Base" := 0;
                             IF VATBuffer.FIND THEN BEGIN
                               VATBuffer.Base := VATBuffer.Base - "Additional-Currency Base";
                               VATBuffer.Amount := VATBuffer.Amount - "Additional-Currency Amount";
                               VATBuffer.MODIFY;
                             END ELSE BEGIN
                               VATBuffer.Base := -"Additional-Currency Base";
                               VATBuffer.Amount := -"Additional-Currency Amount";
                               VATBuffer.INSERT;
                             END;
                           END;

                           // $003 INCOMING
                           // Acumular en las tablas de Base e Importes

                           TotalizaPorPorcentaje ("VAT %", Base, Amount);
                         END;

        OnPostDataItem=BEGIN
                         VATEntry := VATEntry2;
                       END;

        TotalFields=Base,Amount,Additional-Currency Base,Additional-Currency Amount;
        DataItemLink=Type=FIELD(Type),
                     Posting Date=FIELD(Posting Date),
                     Document Type=FIELD(Document Type),
                     Document No.=FIELD(Document No.);
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        OnPreDataItem=BEGIN
                        VATBuffer.FIND('-');
                        CurrReport.CREATETOTALS(VATBuffer2.Base,VATBuffer2.Amount);
                        Fin := FALSE;
                        LineNo := 0;
                      END;

        OnAfterGetRecord=BEGIN
                           IF Fin THEN
                             CurrReport.BREAK;
                           VATBuffer2 := VATBuffer;
                           Fin := VATBuffer.NEXT = 0;

                           IF VATBuffer2.Amount = 0 THEN BEGIN
                             VATBuffer2."VAT %" := 0;
                             VATBuffer2."EC %" := 0;
                           END;
                           LineNo := LineNo + 1;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18900;
            SectionHeight=423;
            OnPreSection=BEGIN
                           // IF VATBuffer2.Amount = 0 THEN BEGIN
                           //   VATBuffer2."VAT %" := 0;
                           //   VATBuffer2."EC %" := 0;
                           // END;
                           // LineNo := LineNo + 1;

                           CurrReport.SHOWOUTPUT(LineNo = 1);
                         END;

          }
          CONTROLS
          {
            { 1   ;TextBox      ;450  ;0    ;1650 ;423  ;CaptionML=[ENU=Document No.;
                                                                    ESP=N§ documento];
                                                         SourceExpr=VATEntry2."Document No.";
                                                         DataSetFieldName=VATEntry2__Document_No__ }
            { 3   ;TextBox      ;11100;0    ;1800 ;423  ;CaptionML=[ENU=Base;
                                                                    ESP=Base];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer2.Base;
                                                         DataSetFieldName=VATBuffer2_Base }
            { 5   ;TextBox      ;15150;0    ;1800 ;423  ;CaptionML=[ENU=Amount;
                                                                    ESP=Importe];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer2.Amount;
                                                         DataSetFieldName=VATBuffer2_Amount }
            { 6   ;TextBox      ;13050;0    ;900  ;423  ;CaptionML=[ENU=VAT %;
                                                                    ESP=% IVA];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer2."VAT %";
                                                         DataSetFieldName=VATBuffer2__VAT___ }
            { 7   ;TextBox      ;14100;0    ;900  ;423  ;CaptionML=[ENU=EC %;
                                                                    ESP=% RE];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer2."EC %";
                                                         DataSetFieldName=VATBuffer2__EC___ }
            { 9   ;TextBox      ;2250 ;0    ;1200 ;423  ;CaptionML=[ENU=Posting Date;
                                                                    ESP=Fecha registro];
                                                         SourceExpr=FORMAT(VATEntry2."Posting Date");
                                                         DataSetFieldName=VATEntry2__Posting_Date_ }
            { 11  ;TextBox      ;4800 ;0    ;4500 ;423  ;MultiLine=Yes;
                                                         CaptionML=[ENU=Name;
                                                                    ESP=Nombre];
                                                         SourceExpr=Customer.Name;
                                                         DataSetFieldName=Customer_Name }
            { 19  ;TextBox      ;9450 ;0    ;1500 ;423  ;HorzAlign=Right;
                                                         CaptionML=[ENU=VAT Registration No.;
                                                                    ESP=CIF/NIF];
                                                         SourceExpr=Customer."VAT Registration No.";
                                                         DataSetFieldName=Customer__VAT_Registration_No__ }
            { 25  ;TextBox      ;0    ;0    ;300  ;423  ;SourceExpr=DocType;
                                                         DataSetFieldName=DocType_Control25 }
            { 36  ;TextBox      ;17100;0    ;1800 ;423  ;CaptionML=[ENU=Total;
                                                                    ESP=Total];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer2.Base + VATBuffer2.Amount;
                                                         DataSetFieldName=VATBuffer2_Base_VATBuffer2_Amount }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18900;
            SectionHeight=423;
            OnPreSection=BEGIN
                           // IF VATBuffer2.Amount = 0 THEN BEGIN
                           //   VATBuffer2."VAT %" := 0;
                           //  VATBuffer2."EC %" := 0;
                           // END;
                           CurrReport.SHOWOUTPUT(LineNo <> 1);
                         END;

          }
          CONTROLS
          {
            { 13  ;TextBox      ;11100;0    ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=VATBuffer2.Base;
                                                         DataSetFieldName=VATBuffer2_Base_Control13 }
            { 15  ;TextBox      ;13050;0    ;900  ;423  ;BlankZero=Yes;
                                                         SourceExpr=VATBuffer2."VAT %";
                                                         DataSetFieldName=VATBuffer2__VAT____Control15 }
            { 16  ;TextBox      ;14100;0    ;900  ;423  ;BlankZero=Yes;
                                                         SourceExpr=VATBuffer2."EC %";
                                                         DataSetFieldName=VATBuffer2__EC____Control16 }
            { 14  ;TextBox      ;15150;0    ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=VATBuffer2.Amount;
                                                         DataSetFieldName=VATBuffer2_Amount_Control14 }
            { 12  ;TextBox      ;17100;0    ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=VATBuffer2.Base + VATBuffer2.Amount;
                                                         DataSetFieldName=VATBuffer2_Base_VATBuffer2_Amount_Control12 }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18900;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(LineNo <> 1);
                           LineNo := 0;
                         END;

          }
          CONTROLS
          {
            { 26  ;Label        ;3450 ;0    ;3000 ;423  ;FontBold=No;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Total;
                                                                    ESP=Total];
                                                         DataSetFieldName=TotalCaption_Control26 }
            { 17  ;TextBox      ;11100;0    ;1800 ;423  ;FontBold=No;
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer2.Base;
                                                         DataSetFieldName=VATBuffer2_Base_Control17 }
            { 18  ;TextBox      ;15150;0    ;1800 ;423  ;FontBold=No;
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer2.Amount;
                                                         DataSetFieldName=VATBuffer2_Amount_Control18 }
            { 23  ;TextBox      ;17100;0    ;1800 ;423  ;FontBold=No;
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer2.Base + VATBuffer2.Amount;
                                                         DataSetFieldName=VATBuffer2_Base_VATBuffer2_Amount_Control23 }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table254;
        DataItemTableView=SORTING(Document Type,No. Series,Posting Date)
                          WHERE(Type=CONST(Purchase));
        NewPagePerGroup=No;
        DataItemVarName=VATEntry4;
        OnPreDataItem=BEGIN
                        IF NOT ShowAutoInvCred THEN
                          CurrReport.BREAK;
                        SETRANGE("Generated Autodocument",TRUE);
                        IF FIND('-') THEN;
                        SETFILTER("Posting Date",VATEntry.GETFILTER("Posting Date"));
                        SETFILTER("Document No.",VATEntry.GETFILTER("Document No."));
                        SETFILTER("Document Type",VATEntry.GETFILTER("Document Type"));
                      END;

        OnAfterGetRecord=BEGIN
                           VATBuffer.DELETEALL;
                           NoSeriesAuxPrev := NoSeriesAux;

                           IF "Document Type" = "Document Type"::"Credit Memo" THEN BEGIN
                             GLSetup.GET;
                             NoSeriesAux := GLSetup."Autocredit Memo Nos.";
                           END;
                           IF "Document Type" = "Document Type"::Invoice THEN BEGIN
                             GLSetup.GET;
                             NoSeriesAux := GLSetup."Autoinvoice Nos.";
                           END;

                           IF NoSeriesAux <> NoSeriesAuxPrev THEN BEGIN
                             NotBaseReverse := 0;
                             NotAmountReverse := 0;
                             VarNotBaseReverse := 0;
                             VarNotAmountReverse := 0;
                           END;
                         END;

        TotalFields=Base,Amount,Additional-Currency Base,Additional-Currency Amount;
        GroupTotalFields=Document Type;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=18900;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 129 ;Label        ;3450 ;0    ;3000 ;423  ;LeaderDots=Yes;
                                                         CaptionML=[ENU=Continued;
                                                                    ESP=Suma];
                                                         DataSetFieldName=ContinuedCaption_Control129 }
            { 130 ;TextBox      ;11100;0    ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=VarNotBaseReverse;
                                                         DataSetFieldName=VarNotBaseReverse }
            { 131 ;TextBox      ;15150;0    ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=VarNotAmountReverse;
                                                         DataSetFieldName=VarNotAmountReverse }
            { 132 ;TextBox      ;17100;0    ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=VarNotBaseReverse + VarNotAmountReverse;
                                                         DataSetFieldName=VarNotBaseReverse_VarNotAmountReverse }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=18900;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 69  ;TextBox      ;1650 ;0    ;1500 ;423  ;SourceExpr=NoSeriesAux;
                                                         DataSetFieldName=No_SeriesAux_ }
            { 98  ;Label        ;0    ;0    ;1500 ;423  ;ParentControl=69;
                                                         VertAlign=Center;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=No.Serie;
                                                                    ESP=N§ serie];
                                                         DataSetFieldName=No_SerieCaption }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=18900;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 99  ;Label        ;3450 ;0    ;2100 ;423  ;FontBold=No;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Total;
                                                                    ESP=Total];
                                                         DataSetFieldName=TotalCaption_Control99 }
            { 100 ;Label        ;5850 ;0    ;1500 ;423  ;ParentControl=101;
                                                         VertAlign=Center;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=No.Serie;
                                                                    ESP=N§ serie];
                                                         DataSetFieldName=No_SerieCaption_Control100 }
            { 101 ;TextBox      ;7650 ;0    ;1500 ;423  ;SourceExpr=NoSeriesAux;
                                                         DataSetFieldName=No_SeriesAux__Control101 }
            { 102 ;TextBox      ;11100;0    ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=NotBaseReverse;
                                                         DataSetFieldName=NotBaseReverse }
            { 103 ;TextBox      ;15150;0    ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=NotAmountReverse;
                                                         DataSetFieldName=NotAmountReverse }
            { 107 ;TextBox      ;17100;0    ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=NotBaseReverse + NotAmountReverse;
                                                         DataSetFieldName=NotBaseReverse_NotAmountReverse }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=18900;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 117 ;Label        ;3450 ;0    ;3000 ;423  ;LeaderDots=Yes;
                                                         CaptionML=[ENU=Continued;
                                                                    ESP=Suma];
                                                         DataSetFieldName=ContinuedCaption_Control117 }
            { 108 ;TextBox      ;11100;0    ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=VarNotBaseReverse;
                                                         DataSetFieldName=VarNotBaseReverse_Control108 }
            { 110 ;TextBox      ;15150;0    ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=VarNotAmountReverse;
                                                         DataSetFieldName=VarNotAmountReverse_Control110 }
            { 112 ;TextBox      ;17100;0    ;1800 ;423  ;BlankZero=Yes;
                                                         SourceExpr=VarNotBaseReverse + VarNotAmountReverse;
                                                         DataSetFieldName=VarNotBaseReverse_VarNotAmountReverse_Control112 }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table254;
        DataItemTableView=SORTING(No. Series,Posting Date);
        DataItemVarName=VATEntry5;
        OnPreDataItem=BEGIN
                        CLEAR(PurchCrMemoHeader);
                        CLEAR(PurchInvHeader);
                        CLEAR(Vendor);
                        PurchInvHeader.RESET;
                        PurchCrMemoHeader.RESET;
                        Vendor.RESET;


                        VendLedgEntry.SETCURRENTKEY("Document No.","Document Type","Vendor No.");
                        CASE VATEntry4."Document Type" OF
                          "Document Type"::"Credit Memo":
                            IF PurchCrMemoHeader.GET(VATEntry4."Document No.") THEN BEGIN
                              Vendor.Name := PurchCrMemoHeader."Pay-to Name";
                              Vendor."VAT Registration No." := PurchCrMemoHeader."VAT Registration No.";
                              VendLedgEntry.SETRANGE("Document No.",VATEntry4."Document No.");
                              VendLedgEntry.SETRANGE("Document Type","Document Type"::"Credit Memo");
                              IF VendLedgEntry.FIND('-') THEN
                                AutoDocNo := VendLedgEntry."Autodocument No.";
                              EXIT;
                            END;
                          "Document Type"::Invoice:
                            IF PurchInvHeader.GET(VATEntry4."Document No.") THEN BEGIN
                              Vendor.Name := PurchInvHeader."Pay-to Name";
                              Vendor."VAT Registration No." := PurchInvHeader."VAT Registration No.";
                              VendLedgEntry.SETRANGE("Document No.",VATEntry4."Document No.");
                              VendLedgEntry.SETRANGE("Document Type","Document Type"::Invoice);
                              IF VendLedgEntry.FIND('-') THEN
                                AutoDocNo := VendLedgEntry."Autodocument No.";
                              EXIT;
                            END;
                        END;

                        IF NOT Vendor.GET(VATEntry4."Bill-to/Pay-to No.") THEN
                          Vendor.Name := Text1100003;
                        VendLedgEntry.SETCURRENTKEY("Document No.","Document Type","Vendor No.");
                        VendLedgEntry.SETRANGE("Document No.",VATEntry4."Document No.");
                        VendLedgEntry.SETFILTER("Document Type",Text1100004);
                        IF VendLedgEntry.FIND('-') THEN;
                      END;

        OnAfterGetRecord=BEGIN
                           VATBuffer."VAT %" := "VAT %";
                           VATBuffer."EC %" := "EC %";

                           IF "VAT Calculation Type" = "VAT Calculation Type"::"Reverse Charge VAT" THEN BEGIN
                             IF NOT PrintAmountsInAddCurrency THEN
                               IF VATBuffer.FIND THEN BEGIN
                                 VarBase2 := (VATBuffer.Base + Base) - VATBuffer.Base;
                                 VarAmount2 := (VATBuffer.Amount + Amount) - VATBuffer.Amount;
                                 VATBuffer.Base := VATBuffer.Base + Base;
                                 VATBuffer.Amount := VATBuffer.Amount + Amount;
                                 VATBuffer.MODIFY;
                               END ELSE BEGIN
                                 VarBase2 := Base;
                                 VarAmount2 := Amount;
                                 VATBuffer.Base := Base;
                                 VATBuffer.Amount := Amount;
                                 VATBuffer.INSERT;
                               END
                             ELSE
                               IF VATBuffer.FIND THEN BEGIN
                                 VATBuffer.Base := VATBuffer.Base + "Additional-Currency Base";
                                 VATBuffer.Amount := VATBuffer.Amount + "Additional-Currency Amount";
                                 VATBuffer.MODIFY;
                               END ELSE BEGIN
                                 VATBuffer.Base := "Additional-Currency Base";
                                 VATBuffer.Amount := "Additional-Currency Amount";
                                 VATBuffer.INSERT;
                               END
                           END;
                           IF "VAT Calculation Type" = "VAT Calculation Type"::"Reverse Charge VAT" THEN BEGIN
                             IF NOT PrintAmountsInAddCurrency THEN BEGIN
                               NotBaseReverse := NotBaseReverse + VarBase2;
                               NotAmountReverse := NotAmountReverse + VarAmount2;
                             END ELSE BEGIN
                               NotBaseReverse := NotBaseReverse + VATBuffer.Base;
                               NotAmountReverse := NotAmountReverse + VATBuffer.Amount;
                             END;
                           END;

                           // $003 INCOMING
                           // Acumular en las tablas de Base e Importes

                           TotalizaPorPorcentaje ("VAT %", Base, Amount);
                         END;

        OnPostDataItem=BEGIN
                         VATEntry4 := VATEntry5;
                       END;

        TotalFields=Base,Amount,Additional-Currency Base,Additional-Currency Amount;
        DataItemLink=Type=FIELD(Type),
                     Posting Date=FIELD(Posting Date),
                     Document Type=FIELD(Document Type),
                     Document No.=FIELD(Document No.);
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=<Integer2>;
        OnPreDataItem=BEGIN
                        VATBuffer.FIND('-');
                        CurrReport.CREATETOTALS(VATBuffer2.Base,VATBuffer2.Amount);
                        Fin := FALSE;
                        LineNo := 0;
                      END;

        OnAfterGetRecord=BEGIN
                           IF Fin THEN
                             CurrReport.BREAK;
                           VATBuffer2 := VATBuffer;
                           Fin := VATBuffer.NEXT = 0;
                           IF VATBuffer2.Amount = 0 THEN BEGIN
                             VATBuffer2."VAT %" := 0;
                             VATBuffer2."EC %" := 0;
                           END;

                           LineNo := LineNo + 1;
                           VarNotBaseReverse := VarNotBaseReverse + VATBuffer2.Base;
                           VarNotAmountReverse := VarNotAmountReverse + VATBuffer2.Amount;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18900;
            SectionHeight=423;
            OnPreSection=BEGIN
                           // IF VATBuffer2.Amount = 0 THEN BEGIN
                           //   VATBuffer2."VAT %" := 0;
                           //   VATBuffer2."EC %" := 0;
                           // END;
                           // LineNo := LineNo + 1;

                           CurrReport.SHOWOUTPUT(LineNo = 1);

                           // IF LineNo <> 1 THEN BEGIN
                           //   VarNotBaseReverse := VarNotBaseReverse + VATBuffer2.Base;
                           //   VarNotAmountReverse := VarNotAmountReverse + VATBuffer2.Amount;
                           // END;
                         END;

          }
          CONTROLS
          {
            { 82  ;TextBox      ;17100;0    ;1800 ;423  ;CaptionML=[ENU=Total;
                                                                    ESP=Total];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer2.Base + VATBuffer2.Amount;
                                                         DataSetFieldName=VATBuffer2_Base_VATBuffer2_Amount_Control82 }
            { 83  ;TextBox      ;15150;0    ;1800 ;423  ;CaptionML=[ENU=Amount;
                                                                    ESP=Importe];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer2.Amount;
                                                         DataSetFieldName=VATBuffer2_Amount_Control83 }
            { 84  ;TextBox      ;14100;0    ;900  ;423  ;CaptionML=[ENU=EC %;
                                                                    ESP=% RE];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer2."EC %";
                                                         DataSetFieldName=VATBuffer2__EC____Control84 }
            { 85  ;TextBox      ;13050;0    ;900  ;423  ;CaptionML=[ENU=VAT %;
                                                                    ESP=% IVA];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer2."VAT %";
                                                         DataSetFieldName=VATBuffer2__VAT____Control85 }
            { 86  ;TextBox      ;11100;0    ;1800 ;423  ;CaptionML=[ENU=Base;
                                                                    ESP=Base];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer2.Base;
                                                         DataSetFieldName=VATBuffer2_Base_Control86 }
            { 87  ;TextBox      ;9450 ;0    ;1500 ;423  ;HorzAlign=Right;
                                                         CaptionML=[ENU=VAT Registration No.;
                                                                    ESP=CIF/NIF];
                                                         SourceExpr=CompanyInfo."VAT Registration No.";
                                                         DataSetFieldName=CompanyInfo__VAT_Registration_No___Control87 }
            { 88  ;TextBox      ;5100 ;0    ;4200 ;423  ;MultiLine=Yes;
                                                         CaptionML=[ENU=Name;
                                                                    ESP=Nombre];
                                                         SourceExpr=CompanyInfo.Name;
                                                         DataSetFieldName=CompanyInfo_Name_Control88 }
            { 89  ;TextBox      ;2100 ;0    ;1200 ;423  ;CaptionML=[ENU=Posting Date;
                                                                    ESP=Fecha registro];
                                                         SourceExpr=FORMAT(VATEntry4."Posting Date");
                                                         DataSetFieldName=VATEntry4__Posting_Date_ }
            { 91  ;TextBox      ;450  ;0    ;1500 ;423  ;SourceExpr=AutoDocNo;
                                                         DataSetFieldName=AutoDocNo_Control91 }
            { 92  ;TextBox      ;0    ;0    ;300  ;423  ;SourceExpr=VATEntry4."Document Type";
                                                         DataSetFieldName=VATEntry4__Document_Type_ }
            { 90  ;TextBox      ;3450 ;0    ;1500 ;423  ;CaptionML=[ENU=Document No.;
                                                                    ESP=N§ documento];
                                                         SourceExpr=VATEntry4."Document No.";
                                                         DataSetFieldName=VATEntry4__Document_No__ }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18900;
            SectionHeight=846;
            OnPreSection=BEGIN
                           // IF VATBuffer2.Amount = 0 THEN BEGIN
                           //   VATBuffer2."VAT %" := 0;
                           //   VATBuffer2."EC %" := 0;
                           // END;
                           CurrReport.SHOWOUTPUT(LineNo <> 1);
                           // IF LineNo = 1 THEN BEGIN
                           //   VarNotBaseReverse := VarNotBaseReverse + VATBuffer2.Base;
                           //   VarNotAmountReverse := VarNotAmountReverse + VATBuffer2.Amount;
                           // END;
                         END;

          }
          CONTROLS
          {
            { 93  ;TextBox      ;11100;0    ;1800 ;423  ;CaptionML=[ENU=Base;
                                                                    ESP=Base];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer2.Base;
                                                         DataSetFieldName=VATBuffer2_Base_Control93 }
            { 94  ;TextBox      ;13050;0    ;900  ;423  ;CaptionML=[ENU=VAT %;
                                                                    ESP=% IVA];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer2."VAT %";
                                                         DataSetFieldName=VATBuffer2__VAT____Control94 }
            { 95  ;TextBox      ;14100;0    ;900  ;423  ;CaptionML=[ENU=EC %;
                                                                    ESP=% RE];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer2."EC %";
                                                         DataSetFieldName=VATBuffer2__EC____Control95 }
            { 96  ;TextBox      ;15150;0    ;1800 ;423  ;CaptionML=[ENU=Amount;
                                                                    ESP=Importe];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer2.Amount;
                                                         DataSetFieldName=VATBuffer2_Amount_Control96 }
            { 97  ;TextBox      ;17100;0    ;1800 ;423  ;CaptionML=[ENU=Total;
                                                                    ESP=Total];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer2.Base + VATBuffer2.Amount;
                                                         DataSetFieldName=VATBuffer2_Base_VATBuffer2_Amount_Control97 }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18900;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(LineNo <> 1);
                           LineNo := 0;
                         END;

          }
          CONTROLS
          {
            { 113 ;Label        ;3450 ;0    ;3000 ;423  ;FontBold=No;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Total;
                                                                    ESP=Total];
                                                         DataSetFieldName=TotalCaption_Control113 }
            { 114 ;TextBox      ;11100;0    ;1800 ;423  ;CaptionML=[ENU=Base;
                                                                    ESP=Base];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer2.Base;
                                                         DataSetFieldName=VATBuffer2_Base_Control114 }
            { 115 ;TextBox      ;15150;0    ;1800 ;423  ;CaptionML=[ENU=Amount;
                                                                    ESP=Importe];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer2.Amount;
                                                         DataSetFieldName=VATBuffer2_Amount_Control115 }
            { 116 ;TextBox      ;17100;0    ;1800 ;423  ;CaptionML=[ENU=Total;
                                                                    ESP=Total];
                                                         BlankZero=Yes;
                                                         SourceExpr=VATBuffer2.Base + VATBuffer2.Amount;
                                                         DataSetFieldName=VATBuffer2_Base_VATBuffer2_Amount_Control116 }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=TotalPorPorcentaje;
        OnPreDataItem=BEGIN
                        SETRANGE(Number, 1, wIndiceMaximo);

                        // Tomar la cuenta de ITBIS repercutido y calcular el saldo a la fecha

                        VATEntry.COPYFILTER("Posting Date", rCta."Date Filter");
                        rCta.CALCFIELDS(rCta."Balance at Date");
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=18900;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1103355000;Label  ;3300 ;423  ;3450 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Summary;
                                                                    ESP=Resumen] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18900;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1103355001;TextBox;4050 ;0    ;6750 ;423  ;LeaderDots=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=STRSUBSTNO(Text001, TabIVA[Number]) }
            { 1103355002;TextBox;11100;0    ;1950 ;423  ;BlankZero=Yes;
                                                         SourceExpr=TabBase[Number] }
            { 1103355003;TextBox;15000;0    ;1950 ;423  ;BlankZero=Yes;
                                                         SourceExpr=TabImporte[Number] }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18900;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(rCta."No." <> '');
                         END;

          }
          CONTROLS
          {
            { 1103355004;Label  ;3300 ;423  ;7200 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Summary;
                                                                    ESP=Saldo a la fecha de la cuenta ITBIS repercutido] }
            { 1103355005;TextBox;10650;423  ;2550 ;423  ;BlankZero=Yes;
                                                         SourceExpr=rCta."Balance at Date" }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=6270;
      Height=2970;
      OnOpenForm=BEGIN
                   ShowAutoInvCred := TRUE;
                 END;

    }
    CONTROLS
    {
      { 1   ;CheckBox     ;3410 ;0    ;440  ;440  ;InPage=-1;
                                                   ShowCaption=No;
                                                   CaptionML=[ENU=Show Amounts in Add. Currency;
                                                              ESP=Muestra importes en divisa adicional];
                                                   SourceExpr=PrintAmountsInAddCurrency }
      { 2   ;Label        ;0    ;0    ;3300 ;440  ;ParentControl=1 }
      { 3   ;Label        ;0    ;550  ;3300 ;440  ;ParentControl=4;
                                                   InPage=-1;
                                                   CaptionML=[ENU=Order by posting date;
                                                              ESP=Ordena por fecha regis.] }
      { 4   ;CheckBox     ;3410 ;550  ;440  ;440  ;ShowCaption=No;
                                                   SourceExpr=SortPostDate }
      { 5   ;Label        ;0    ;1100 ;3300 ;440  ;ParentControl=6;
                                                   InPage=-1;
                                                   CaptionML=[ENU=Show Autoinvoices/Autocr. memo;
                                                              ESP=Muestra autofacturas/autoabonos] }
      { 6   ;CheckBox     ;3410 ;1100 ;440  ;440  ;ShowCaption=No;
                                                   SourceExpr=ShowAutoInvCred }
      { 1103355000;Label  ;0    ;1760 ;3300 ;440  ;ParentControl=1103355001;
                                                   InPage=-1 }
      { 1103355001;TextBox;3410 ;1760 ;2310 ;440  ;CaptionML=ESP=Cta. ITBIS repecutido;
                                                   SourceExpr=rCta."No.";
                                                   TableRelation="G/L Account";
                                                   OnAfterValidate=BEGIN
                                                                     rCta.GET(rCta."No.");
                                                                   END;
                                                                    }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      OnOpenPage=BEGIN
                   ShowAutoInvCred := TRUE;
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[ENU=Options;
                             ESP=Opciones] }

      { 1   ;2   ;Field     ;
                  CaptionML=[ENU=Show Amounts in Add. Currency;
                             ESP=Muestra importes en divisa adicional];
                  SourceExpr=PrintAmountsInAddCurrency }

      { 4   ;2   ;Field     ;
                  CaptionML=[ENU=Order by posting date;
                             ESP=Ordena por fecha regis.];
                  SourceExpr=SortPostDate }

      { 6   ;2   ;Field     ;
                  CaptionML=[ENU=Show Autoinvoices/Autocr. memo;
                             ESP=Muestra autofacturas/autoabonos];
                  SourceExpr=ShowAutoInvCred }

    }
  }
  CODE
  {
    VAR
      Text1100000@1100033 : TextConst 'ENU="VAT Registration No.: ";ESP="CIF/NIF "';
      Text1100001@1100034 : TextConst 'ENU=Please, specify the VAT Registration N§ of your Company in the Company information Window;ESP=Especifique el CIF/NIF de su empresa en la ventana Informaci¢n empresa';
      Text1100002@1100035 : TextConst 'ENU=All Amounts are in %1;ESP=Importes en %1';
      Text1100003@1100036 : TextConst 'ENU=UNKNOWN;ESP=DESCONOCIDO';
      Text1100004@1100037 : TextConst 'ENU=Invoice|Credit Memo;ESP=Factura|Abono';
      SalesInvHeader@1100000 : Record 112;
      SalesCrMemoHeader@1100001 : Record 114;
      Customer@1100002 : Record 18;
      CompanyInfo@1100003 : Record 79;
      VATBuffer@1100004 : TEMPORARY Record 10704;
      VATBuffer2@1100005 : Record 10704;
      VATBuffer3@1100006 : TEMPORARY Record 10704;
      VATBuffer4@1100007 : TEMPORARY Record 10704;
      GLSetup@1100008 : Record 98;
      Currency@1100009 : Record 4;
      rCta@1103355005 : Record 15;
      PurchCrMemoHeader@1100016 : Record 124;
      PurchInvHeader@1100017 : Record 122;
      Vendor@1100018 : Record 23;
      VendLedgEntry@1100019 : Record 25;
      VatEntryTemporary@1100026 : TEMPORARY Record 254;
      HeaderText@1100010 : Text[250];
      CompanyAddr@1100011 : ARRAY [7] OF Text[50];
      LineNo@1100012 : Decimal;
      Fin@1100013 : Boolean;
      PrintAmountsInAddCurrency@1100014 : Boolean;
      NoSeriesAux@1100015 : Code[20];
      AutoDocNo@1100020 : Code[20];
      NotBaseReverse@1100021 : Decimal;
      NotAmountReverse@1100022 : Decimal;
      NoSeriesAuxPrev@1100023 : Code[20];
      AuxVatEntry@1100024 : Text[250];
      PrevData@1100025 : Date;
      SortPostDate@1100027 : Boolean;
      Show@1100028 : Boolean;
      i@1100029 : Integer;
      ShowAutoInvCred@1100030 : Boolean;
      Base2@1100031 : Decimal;
      Amount2@1100032 : Decimal;
      VarBase2@1003 : Decimal;
      VarAmount2@1002 : Decimal;
      VarNotBaseReverse@1001 : Decimal;
      VarNotAmountReverse@1000 : Decimal;
      DocType@1100050 : Text[30];
      Text1100005@1100051 : TextConst 'ENU=Corrective Invoice;ESP=Factura correctiva';
      TabIVA@1103355000 : ARRAY [20] OF Decimal;
      TabBase@1103355001 : ARRAY [20] OF Decimal;
      TabImporte@1103355002 : ARRAY [20] OF Decimal;
      wInd@1103355003 : Integer;
      wIndiceMaximo@1103355004 : Integer;
      Text001@1103355006 : TextConst 'ESP=IVA Repercutido al %1 %';

    PROCEDURE TotalizaPorPorcentaje@1103355001(pwPorcen@1103355000 : Decimal;pwBase@1103355001 : Decimal;pwImporte@1103355002 : Decimal);
    BEGIN
      // TotalizaPorPorcentaje

      wInd := 0;
      REPEAT
        wInd += 1;
        IF wInd > wIndiceMaximo THEN BEGIN
          TabIVA[wInd]  := pwPorcen;
          wIndiceMaximo := wInd;
        END;
      UNTIL TabIVA[wInd] = pwPorcen;

      TabBase[wInd] += pwBase;
      TabImporte[wInd] += pwImporte;
    END;

    PROCEDURE PasaParametros@1103355007(pwCuenta@1103355000 : Text[20]);
    BEGIN
      // PasaParametros
      //
      IF NOT rCta.GET(pwCuenta) THEN
        CLEAR(rCta);
    END;

    BEGIN
    {
      // INCOMING

      $001 Incluir el campo "VAT %" en el ReqFilterFields de "VATEntry"

      $002 Se ha creado una funcion TotalizaPorPorcentaje para acumular los campos Base e Importe por cada % de impuestos

      $003 Incluir una nueva section TotalporPorcentaje para mostrar el total de Base e Importe por cada % de impuestos

      $004 Se ha creado una funcion "PasaParametros" para pasar el numero de la cuenta de ITBIS repercutido desde la rutina
         que genera el informe de control

      $005 Se incluye en el Request form un campo para solicitar la cuenta de ITBIS repercutido

      $006 AJS 19.02.2007, Cambio el margen izquierdo a 1600 para poder hacer mas grandes las columnas Base, Importe y Total

      $007 AJS 14062013 Ampliar la visualizacion de las columnas Base, Importe y Total
    }
    END.
  }
  RDLDATA
  {
  }
}
