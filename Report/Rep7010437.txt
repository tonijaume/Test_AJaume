OBJECT Report 7010437 Contrato venta TRN
{
  OBJECT-PROPERTIES
  {
    Date=16/10/09;
    Time=12:34:43;
    Version List=TRANSFER;
  }
  PROPERTIES
  {
    CaptionML=ESP=Contrato venta TRN;
    LeftMargin=1000;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table7010403;
        DataItemTableView=SORTING(Garaje,N§ Contrato);
        NewPagePerRecord=Yes;
        OnPreDataItem=BEGIN
                        primer_contrato := TRUE;
                      END;

        ReqFilterFields=Garaje,N§ Contrato;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19200;
            SectionHeight=2961;
          }
          CONTROLS
          {
            { 1   ;Label        ;15900;0    ;3300 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=Contrato venta }
            { 3   ;TextBox      ;0    ;0    ;7500 ;423  ;FontBold=Yes;
                                                         SourceExpr=COMPANYNAME }
            { 7   ;Shape        ;0    ;423  ;19200;423  ;ShapeStyle=HorzLine }
            { 69  ;Shape        ;0    ;1269 ;19200;1692  }
            { 9   ;TextBox      ;2100 ;1692 ;2250 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         SourceExpr=Garaje }
            { 10  ;Label        ;150  ;1692 ;1800 ;423  ;ParentControl=9;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes }
            { 11  ;TextBox      ;2100 ;2115 ;2250 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         SourceExpr="N§ Contrato" }
            { 12  ;Label        ;150  ;2115 ;1800 ;423  ;ParentControl=11;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes }
            { 13  ;TextBox      ;7050 ;1692 ;1500 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         SourceExpr=Cliente }
            { 14  ;Label        ;4800 ;1692 ;2100 ;423  ;ParentControl=13;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes }
            { 15  ;TextBox      ;7050 ;2115 ;1500 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         SourceExpr=Touroperador }
            { 16  ;Label        ;4800 ;2115 ;2100 ;423  ;ParentControl=15;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes }
            { 17  ;TextBox      ;17550;1692 ;1500 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         CaptionML=ESP=Fecha inicio;
                                                         SourceExpr="Fecha inicio contrato" }
            { 18  ;Label        ;15600;1692 ;1800 ;423  ;ParentControl=17;
                                                         HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes }
            { 19  ;TextBox      ;17550;2115 ;1500 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         CaptionML=ESP=Fecha final;
                                                         SourceExpr="Fecha final contrato" }
            { 20  ;Label        ;15600;2115 ;1800 ;423  ;ParentControl=19;
                                                         HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes }
            { 21  ;TextBox      ;8700 ;1692 ;6750 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         SourceExpr=nom_cliente }
            { 22  ;TextBox      ;8700 ;2115 ;6750 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         SourceExpr=nom_touroperador }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=19200;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 2   ;TextBox      ;4800 ;423  ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 6   ;TextBox      ;8100 ;423  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
            { 5   ;Label        ;17850;423  ;900  ;423  ;ParentControl=4 }
            { 4   ;TextBox      ;18750;423  ;450  ;423  ;CaptionML=ESP=P gina;
                                                         SourceExpr=CurrReport.PAGENO }
            { 8   ;Shape        ;0    ;0    ;19200;423  ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(>=0));
        MaxIteration=4;
        DataItemVarName=Tipo;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          ORDER(Descending)
                          WHERE(Number=FILTER(0..1));
        MaxIteration=2;
        DataItemVarName=TipoFijo;
        OnAfterGetRecord=BEGIN
                           wTipo:=TipoFijo.Number;
                         END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table7010405;
        DataItemTableView=SORTING(Garaje,N§ Contrato,Tipo precio,Codigo servicio,Zona desde,Zona hasta,Fecha desde,Fecha hasta,Tipo Vehiculo,Rango desde,Rango hasta);
        DataItemVarName=Precios;
        OnPreDataItem=BEGIN
                        SETRANGE(Garaje        , "Contrato venta".Garaje);
                        SETRANGE("N§ Contrato" , "Contrato venta"."N§ Contrato");
                        SETRANGE("Tipo precio" , Tipo.Number);
                      END;

        OnAfterGetRecord=VAR
                           lrTipoSer@1100244000 : Record 7010319;
                           lrCodSer@1100244002 : Record 7010320;
                           wSalta@1100244001 : Boolean;
                           lrPrec@1100244003 : Record 7010405;
                         BEGIN

                           IF NOT lrCodSer.GET(Precios."Codigo servicio") THEN
                             CLEAR(lrCodSer);
                           IF NOT lrTipoSer.GET(lrCodSer."Tipo servicio") THEN
                             CLEAR(lrTipoSer);

                           IF lrTipoSer."Tipo fijo" <> TipoFijo.Number THEN
                             CurrReport.SKIP;

                           CLEAR(wPrecio);
                           IF ("Tipo precio" = "Tipo precio"::"Precio Base") AND ("Tipo aplicacion" = "Tipo aplicacion"::Pax) THEN BEGIN
                             IF w_importe_dl THEN BEGIN
                               wPrecio[1] := Precios."Precio Adulto (DL)";
                               wPrecio[2] := Precios."Precio Ni¤o (DL)";
                             END
                             ELSE BEGIN
                               wPrecio[1] := Precios."Precio Adulto";
                               wPrecio[2] := Precios."Precio Ni¤o";
                             END;
                           END
                           ELSE BEGIN
                             IF w_importe_dl THEN
                               wPrecio[1] := Precios."Precio Vehiculo (DL)"
                             ELSE
                               wPrecio[1] := Precios."Precio Vehiculo";
                           END;

                           CLEAR(wCods);
                           BuscaPrecioBase(lrPrec);
                           IF lrPrec."Calcular Maletas" THEN
                             wCods[1]:=Text50000;
                           IF lrPrec."Minimos Zona" <> 0 THEN
                             wCods[2]:= STRSUBSTNO('(%1)', lrPrec."Minimos Zona");
                           IF lrPrec."Concepto facturacion" <>''THEN
                             wCods[3]:=Text50001;
                         END;

        ReqFilterFields=Codigo servicio,Zona desde,Zona hasta;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19200;
            SectionHeight=1692;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Tipo precio"="Tipo precio"::"Precio Base");
                         END;

          }
          CONTROLS
          {
            { 1100244001;Label  ;14550;846  ;1500 ;846  ;ParentControl=1100244013;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Precio }
            { 1100244002;Label  ;12900;846  ;1500 ;846  ;ParentControl=1100244014;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1100244003;Label  ;11700;846  ;1050 ;846  ;ParentControl=1100244015;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1100244004;Label  ;10500;846  ;1050 ;846  ;ParentControl=1100244016;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1100244005;Label  ;8850 ;846  ;1500 ;846  ;ParentControl=1100244017;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1100244006;Label  ;7500 ;846  ;1200 ;846  ;ParentControl=1100244018;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1100244007;Label  ;6150 ;846  ;1200 ;846  ;ParentControl=1100244019;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1100244008;Label  ;3900 ;846  ;1800 ;846  ;ParentControl=1100244020;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1100244009;Label  ;1950 ;846  ;1800 ;846  ;ParentControl=1100244021;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1100244010;Label  ;0    ;846  ;1800 ;846  ;ParentControl=1100244022;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1100244011;Label  ;0    ;423  ;3750 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Precios Base }
            { 1100244059;TextBox;3900 ;423  ;1800 ;423  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=STRSUBSTNO('(%1)',wTipo) }
            { 1103350001;Label  ;16650;846  ;1500 ;846  ;ParentControl=1103350000;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=(Ni¤os) }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19200;
            SectionHeight=1692;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Tipo precio"="Tipo precio"::"Suplemento elemento");
                         END;

          }
          CONTROLS
          {
            { 1100244023;Label  ;1950 ;846  ;1950 ;846  ;ParentControl=1100244045;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1100244024;Label  ;16650;846  ;1650 ;846  ;ParentControl=1100244044;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Precio }
            { 1100244025;Label  ;15000;846  ;1500 ;846  ;ParentControl=1100244043;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1100244026;Label  ;13800;846  ;1050 ;846  ;ParentControl=1100244042;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1100244027;Label  ;12600;846  ;1050 ;846  ;ParentControl=1100244041;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1100244028;Label  ;10950;846  ;1500 ;846  ;ParentControl=1100244040;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1100244029;Label  ;9600 ;846  ;1200 ;846  ;ParentControl=1100244039;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1100244030;Label  ;8250 ;846  ;1200 ;846  ;ParentControl=1100244038;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1100244031;Label  ;6000 ;846  ;1800 ;846  ;ParentControl=1100244037;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1100244032;Label  ;4050 ;846  ;1800 ;846  ;ParentControl=1100244036;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1100244033;Label  ;0    ;846  ;1800 ;846  ;ParentControl=1100244035;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1100244034;Label  ;0    ;423  ;3900 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Suplementos x Elemento }
            { 1100244060;TextBox;4050 ;423  ;1800 ;423  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=STRSUBSTNO('(%1)',wTipo) }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19200;
            SectionHeight=1692;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Tipo precio"="Tipo precio"::"Suplemento zona");
                         END;

          }
          CONTROLS
          {
            { 106 ;Label        ;14400;846  ;1500 ;846  ;ParentControl=123;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 111 ;Label        ;12150;846  ;1800 ;846  ;ParentControl=121;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 107 ;Label        ;10350;846  ;1650 ;846  ;ParentControl=122;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 112 ;Label        ;8400 ;846  ;1800 ;846  ;ParentControl=120;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 108 ;Label        ;6750 ;846  ;1500 ;846  ;ParentControl=119;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 109 ;Label        ;5400 ;846  ;1200 ;846  ;ParentControl=118;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 110 ;Label        ;4050 ;846  ;1200 ;846  ;ParentControl=117;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 103 ;Label        ;1950 ;846  ;1950 ;846  ;ParentControl=116;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 114 ;Label        ;0    ;423  ;3900 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Suplementos x Zona }
            { 113 ;Label        ;0    ;846  ;1800 ;846  ;ParentControl=115;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1100244061;TextBox;4050 ;423  ;1800 ;423  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=STRSUBSTNO('(%1)',wTipo) }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19200;
            SectionHeight=1692;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Tipo precio"="Tipo precio"::"Suplemento vario");
                         END;

          }
          CONTROLS
          {
            { 135 ;Label        ;0    ;423  ;3900 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Suplementos Varios }
            { 150 ;Label        ;0    ;846  ;1800 ;846  ;ParentControl=136;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 151 ;Label        ;1950 ;846  ;1950 ;846  ;ParentControl=137;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 152 ;Label        ;4050 ;846  ;1200 ;846  ;ParentControl=138;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 153 ;Label        ;5400 ;846  ;1200 ;846  ;ParentControl=139;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 154 ;Label        ;6750 ;846  ;1500 ;846  ;ParentControl=140;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 155 ;Label        ;8400 ;846  ;1800 ;846  ;ParentControl=141;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 157 ;Label        ;10350;846  ;1800 ;846  ;ParentControl=142;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 159 ;Label        ;12600;846  ;1800 ;846  ;ParentControl=160;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 161 ;Label        ;15750;846  ;1050 ;846  ;ParentControl=164;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 162 ;Label        ;14550;846  ;1050 ;846  ;ParentControl=163;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 165 ;Label        ;16950;846  ;1350 ;846  ;ParentControl=166;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Precio }
            { 1100244062;TextBox;4050 ;423  ;1800 ;423  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=STRSUBSTNO('(%1)',wTipo) }
          }
           }
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=19200;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 64  ;Label        ;0    ;0    ;3450 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=ESP=Continuacion }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19200;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Tipo precio"="Tipo precio"::"Precio Base");
                         END;

          }
          CONTROLS
          {
            { 1100244013;TextBox;14550;0    ;1500 ;423  ;FontSize=8;
                                                         CaptionML=ESP=Precio;
                                                         DecimalPlaces=0:2;
                                                         SourceExpr=wPrecio[1] }
            { 1100244014;TextBox;12900;0    ;1500 ;423  ;FontSize=8;
                                                         SourceExpr="Tipo aplicacion" }
            { 1100244015;TextBox;11700;0    ;1050 ;423  ;FontSize=8;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr="Rango hasta" }
            { 1100244016;TextBox;10500;0    ;1050 ;423  ;FontSize=8;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr="Rango desde" }
            { 1100244017;TextBox;8850 ;0    ;1500 ;423  ;FontSize=8;
                                                         SourceExpr="Tipo Vehiculo" }
            { 1100244018;TextBox;7500 ;0    ;1200 ;423  ;FontSize=8;
                                                         SourceExpr="Fecha hasta" }
            { 1100244019;TextBox;6150 ;0    ;1200 ;423  ;FontSize=8;
                                                         SourceExpr="Fecha desde" }
            { 1100244020;TextBox;3900 ;0    ;1800 ;423  ;FontSize=8;
                                                         SourceExpr="Zona hasta" }
            { 1100244021;TextBox;1950 ;0    ;1800 ;423  ;FontSize=8;
                                                         SourceExpr="Zona desde" }
            { 1100244022;TextBox;0    ;0    ;1800 ;423  ;FontSize=8;
                                                         SourceExpr="Codigo servicio" }
            { 1100244046;TextBox;16050;0    ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=wCods[1] }
            { 1100244049;TextBox;5700 ;0    ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=wCods[2] }
            { 1100244053;TextBox;18750;0    ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=wCods[3] }
            { 1103350000;TextBox;16650;0    ;1500 ;423  ;FontSize=8;
                                                         CaptionML=ESP=Precio;
                                                         DecimalPlaces=0:2;
                                                         BlankZero=Yes;
                                                         SourceExpr=wPrecio[2] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19200;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Tipo precio"="Tipo precio"::"Suplemento elemento");
                         END;

          }
          CONTROLS
          {
            { 1100244035;TextBox;0    ;0    ;1800 ;423  ;FontSize=8;
                                                         SourceExpr="Codigo servicio" }
            { 1100244036;TextBox;4050 ;0    ;1800 ;423  ;FontSize=8;
                                                         SourceExpr="Zona desde" }
            { 1100244037;TextBox;6000 ;0    ;1800 ;423  ;FontSize=8;
                                                         SourceExpr="Zona hasta" }
            { 1100244038;TextBox;8250 ;0    ;1200 ;423  ;FontSize=8;
                                                         SourceExpr="Fecha desde" }
            { 1100244039;TextBox;9600 ;0    ;1200 ;423  ;FontSize=8;
                                                         SourceExpr="Fecha hasta" }
            { 1100244040;TextBox;10950;0    ;1500 ;423  ;FontSize=8;
                                                         SourceExpr="Tipo Vehiculo" }
            { 1100244041;TextBox;12600;0    ;1050 ;423  ;FontSize=8;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr="Rango desde" }
            { 1100244042;TextBox;13800;0    ;1050 ;423  ;FontSize=8;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr="Rango hasta" }
            { 1100244043;TextBox;15000;0    ;1500 ;423  ;FontSize=8;
                                                         SourceExpr="Tipo aplicacion" }
            { 1100244044;TextBox;16650;0    ;1650 ;423  ;FontSize=8;
                                                         CaptionML=ESP=Precio;
                                                         DecimalPlaces=0:2;
                                                         SourceExpr=wPrecio[1] }
            { 1100244045;TextBox;1950 ;0    ;1950 ;423  ;FontSize=8;
                                                         SourceExpr="Codigo suplemento" }
            { 1100244047;TextBox;18300;0    ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=wCods[1] }
            { 1100244050;TextBox;7800 ;0    ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=wCods[2] }
            { 1100244055;TextBox;18750;0    ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=wCods[3] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19200;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Tipo precio"="Tipo precio"::"Suplemento zona");
                         END;

          }
          CONTROLS
          {
            { 123 ;TextBox      ;14400;0    ;1500 ;423  ;FontSize=8;
                                                         SourceExpr="Minimos Zona hasta" }
            { 121 ;TextBox      ;12150;0    ;1800 ;423  ;FontSize=8;
                                                         SourceExpr="Zona hasta" }
            { 122 ;TextBox      ;10350;0    ;1650 ;423  ;FontSize=8;
                                                         SourceExpr="Minimos Zona desde" }
            { 120 ;TextBox      ;8400 ;0    ;1800 ;423  ;FontSize=8;
                                                         SourceExpr="Zona desde" }
            { 119 ;TextBox      ;6750 ;0    ;1500 ;423  ;FontSize=8;
                                                         SourceExpr="Tipo Vehiculo" }
            { 118 ;TextBox      ;5400 ;0    ;1200 ;423  ;FontSize=8;
                                                         SourceExpr="Fecha hasta" }
            { 117 ;TextBox      ;4050 ;0    ;1200 ;423  ;FontSize=8;
                                                         SourceExpr="Fecha desde" }
            { 116 ;TextBox      ;1950 ;0    ;1950 ;423  ;FontSize=8;
                                                         SourceExpr="Codigo servicio" }
            { 115 ;TextBox      ;0    ;0    ;1800 ;423  ;FontSize=8;
                                                         SourceExpr="Tipo Servicio" }
            { 1100244051;TextBox;13950;0    ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=wCods[2] }
            { 1100244054;TextBox;18750;0    ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=wCods[3] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19200;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Tipo precio"="Tipo precio"::"Suplemento vario");
                         END;

          }
          CONTROLS
          {
            { 136 ;TextBox      ;0    ;0    ;1800 ;423  ;FontSize=8;
                                                         SourceExpr="Tipo Servicio" }
            { 137 ;TextBox      ;1950 ;0    ;1950 ;423  ;FontSize=8;
                                                         SourceExpr="Codigo servicio" }
            { 138 ;TextBox      ;4050 ;0    ;1200 ;423  ;FontSize=8;
                                                         SourceExpr="Fecha desde" }
            { 139 ;TextBox      ;5400 ;0    ;1200 ;423  ;FontSize=8;
                                                         SourceExpr="Fecha hasta" }
            { 140 ;TextBox      ;6750 ;0    ;1500 ;423  ;FontSize=8;
                                                         SourceExpr="Tipo Vehiculo" }
            { 141 ;TextBox      ;8400 ;0    ;1800 ;423  ;FontSize=8;
                                                         SourceExpr="Zona desde" }
            { 142 ;TextBox      ;10350;0    ;1800 ;423  ;FontSize=8;
                                                         SourceExpr="Zona hasta" }
            { 160 ;TextBox      ;12600;0    ;1800 ;423  ;FontSize=8;
                                                         SourceExpr="Tercera Zona" }
            { 163 ;TextBox      ;14550;0    ;1050 ;423  ;FontSize=8;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr="Rango desde" }
            { 164 ;TextBox      ;15750;0    ;1050 ;423  ;FontSize=8;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr="Rango hasta" }
            { 166 ;TextBox      ;16950;0    ;1350 ;423  ;FontSize=8;
                                                         CaptionML=ESP=Precio;
                                                         DecimalPlaces=0:2;
                                                         SourceExpr=wPrecio[1] }
            { 168 ;TextBox      ;18300;0    ;300  ;423  ;FontSize=8;
                                                         SourceExpr=w_porcen }
            { 1100244048;TextBox;18600;0    ;300  ;423  ;HorzAlign=Center;
                                                         SourceExpr=wCods[1] }
            { 1100244052;TextBox;12150;0    ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=wCods[2] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table7010404;
        DataItemTableView=SORTING(Garaje,N§ Contrato,Tipo contrato,Tipo Servicio fijo,Zona Precio,Codigo Origen)
                          WHERE(Tipo contrato=CONST(Venta));
        DataItemLink=Garaje=FIELD(Garaje),
                     N§ Contrato=FIELD(N§ Contrato);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=19200;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 71  ;Label        ;4950 ;423  ;1800 ;846  ;ParentControl=70;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 73  ;Label        ;6900 ;423  ;6900 ;846  ;ParentControl=72;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 75  ;Label        ;13950;423  ;1350 ;846  ;ParentControl=74;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 76  ;Label        ;0    ;423  ;3750 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Zonas Precios }
            { 1103355003;Label  ;15450;423  ;2100 ;846  ;ParentControl=1103355002;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1103355004;Label  ;2250 ;423  ;2550 ;846  ;ParentControl=1103355000;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=19200;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 60  ;Label        ;4950 ;0    ;1800 ;846  ;ParentControl=70;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 61  ;Label        ;6900 ;0    ;6900 ;846  ;ParentControl=72;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 62  ;Label        ;0    ;0    ;3750 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Zonas Precios }
            { 63  ;Label        ;13950;0    ;1350 ;846  ;ParentControl=74;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1103355001;Label  ;2250 ;0    ;2550 ;846  ;ParentControl=1103355000;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1103355005;Label  ;15450;0    ;2100 ;846  ;ParentControl=1103355002;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19200;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 70  ;TextBox      ;4950 ;0    ;1800 ;423  ;FontSize=8;
                                                         SourceExpr="Zona Precio" }
            { 72  ;TextBox      ;6900 ;0    ;1800 ;423  ;FontSize=8;
                                                         SourceExpr="Codigo Origen" }
            { 74  ;TextBox      ;13950;0    ;1350 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=Orden }
            { 77  ;TextBox      ;8850 ;0    ;4950 ;423  ;FontSize=8;
                                                         SourceExpr=nom_codigoorigen }
            { 1103355000;TextBox;2250 ;0    ;2550 ;423  ;FontSize=8;
                                                         SourceExpr="Tipo Servicio fijo" }
            { 1103355002;TextBox;15450;0    ;2100 ;423  ;FontSize=8;
                                                         SourceExpr="Zona facturacion" }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table7010406;
        DataItemTableView=SORTING(Garaje,N§ Contrato,Tipo contrato,Orden)
                          WHERE(Tipo contrato=CONST(Venta));
        DataItemLink=Garaje=FIELD(Garaje),
                     N§ Contrato=FIELD(N§ Contrato);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=19200;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 78  ;Label        ;750  ;0    ;2250 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Comentarios }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19200;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 79  ;TextBox      ;1350 ;0    ;12300;423  ;SourceExpr=Texto }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table7010407;
        DataItemTableView=SORTING(N§ Contrato,Tipo Vehiculo,Tipo Contrato,Garaje)
                          WHERE(Tipo Contrato=CONST(Venta));
        DataItemLink=N§ Contrato=FIELD(N§ Contrato),
                     Garaje=FIELD(Garaje);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=19200;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 178 ;Label        ;4800 ;423  ;2250 ;846  ;ParentControl=177;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 180 ;Label        ;7350 ;423  ;1800 ;846  ;ParentControl=179;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 181 ;Label        ;750  ;423  ;3300 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=M¡nimo Vehiculo }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19200;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 177 ;TextBox      ;4800 ;0    ;2250 ;423  ;SourceExpr="Tipo Vehiculo" }
            { 179 ;TextBox      ;7350 ;0    ;1800 ;423  ;SourceExpr=Minimo }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
      { 1   ;Label        ;220  ;220  ;3300 ;440  ;CaptionML=ESP=Imprimir en Divisa Local }
      { 2   ;CheckBox     ;3630 ;220  ;440  ;440  ;ShowCaption=No;
                                                   SourceExpr=w_importe_dl }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text50000@1103355000 : TextConst 'ESP=M';
      Text50001@1103355001 : TextConst 'ESP=C';
      primer_contrato@1100244000 : Boolean;
      w_porcen@1100244001 : Char;
      w_importe_dl@1100244002 : Boolean;
      wPrecio@1100244003 : ARRAY [2] OF Decimal;
      wCods@1100244004 : ARRAY [3] OF Code[10];
      wTipo@1100244005 : 'Excursion,Traslado';

    PROCEDURE BuscaPrecioBase@1100244000(VAR prPrec@1100244000 : Record 7010405);
    BEGIN
      // BuscaPrecioBase

      // En caso de que haya precio por tipo de pax remitira al precio base

      CLEAR(prPrec);

      prPrec.RESET;
      prPrec.SETCURRENTKEY(Garaje,
                         "N§ Contrato",
                         "Tipo precio",
                         "Codigo servicio",
                         "Zona desde",
                         "Zona hasta",
                         "Fecha desde",
                         "Fecha hasta",
                         "Tipo Vehiculo",
                         "Rango desde",
                         "Rango hasta");
      prPrec.SETRANGE (Garaje           , Precios.Garaje);
      prPrec.SETRANGE ("N§ Contrato"    , Precios."N§ Contrato");
      prPrec.SETRANGE ("Tipo precio"    , Precios."Tipo precio");
      prPrec.SETRANGE ("Codigo servicio", Precios."Codigo servicio");
      prPrec.SETRANGE ("Zona desde"     , Precios."Zona desde");
      prPrec.SETRANGE ("Zona hasta"     , Precios."Zona hasta");
      prPrec.SETRANGE ("Fecha desde"    , Precios."Fecha desde");
      prPrec.SETRANGE ("Fecha hasta"    , Precios."Fecha hasta");
      prPrec.SETRANGE ("Tipo Vehiculo"  , Precios."Tipo Vehiculo");
      prPrec.SETRANGE ("Rango desde"    , Precios."Rango desde");
      prPrec.SETRANGE ("Rango hasta"    , Precios."Rango hasta");
      prPrec.SETFILTER("Tipo elemento"  , '%1', '');

      IF NOT prPrec.FINDFIRST THEN
        prPrec:=Precios;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}
