OBJECT Report 7009747 Documento ventas - Test REWE
{
  OBJECT-PROPERTIES
  {
    Date=02/10/12;
    Time=12:00:00;
    Modified=Yes;
    Version List=AIC2009,GOC;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Sales document - Test LTU;
               ESP=Documento ventas - Test LTU];
    OnInitReport=BEGIN
                   ConfCG.GET;
                 END;

    OnPreReport=BEGIN
                  FiltroCabVentas := "Sales Header".GETFILTERS;
                END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table36;
        DataItemTableView=WHERE(Document Type=FILTER(<>Quote));
        NewPagePerRecord=Yes;
        ReqFilterHeadingML=[ENU=Sale document;
                            ESP=Documento venta];
        OnPreDataItem=BEGIN
                        CabVenta.COPY("Sales Header");
                        CabVenta.FILTERGROUP := 2;
                        CabVenta.SETRANGE("Document Type",CabVenta."Document Type"::Order);
                        IF CabVenta.FIND('-') THEN BEGIN
                          CASE TRUE OF
                            EnviaEnSigRegistro AND FactEnSigRegitro:
                              TextoEnvFac := Text000;
                            EnviaEnSigRegistro:
                              TextoEnvFac := Text001;
                            FactEnSigRegitro:
                              TextoEnvFac := Text002;
                          END;
                          TextoEnvFac := STRSUBSTNO(Text003,TextoEnvFac);
                        END;
                      END;

        OnAfterGetRecord=BEGIN
                           FormatDire.SalesHeaderSellTo(VentaADir,"Sales Header");
                           FormatDire.SalesHeaderBillTo(FactADir,"Sales Header");
                           FormatDire.SalesHeaderShipTo(EnvADir,"Sales Header");
                           IF "Currency Code" = '' THEN BEGIN
                             ConfCG.TESTFIELD("LCY Code");
                             TotalTexto := STRSUBSTNO(Text004,ConfCG."LCY Code");
                             TextoTotIVAIncl := STRSUBSTNO(Text005,ConfCG."LCY Code");
                           END ELSE BEGIN
                             TotalTexto := STRSUBSTNO(Text004,"Currency Code");
                             TextoTotIVAIncl := STRSUBSTNO(Text005,"Currency Code");
                           END;

                           Invoice := FactEnSigRegitro;
                           Ship := EnviaEnSigRegistro;

                           IF "Sell-to Customer No." = '' THEN
                             SumError(STRSUBSTNO(Text006,FIELDCAPTION("Sell-to Customer No.")))
                           ELSE BEGIN
                             IF Clie.GET("Sell-to Customer No.") THEN BEGIN
                               IF Clie.Blocked = Clie.Blocked::Invoice THEN
                                 SumError(
                                   STRSUBSTNO(
                                     Text007,
                                     Clie.FIELDCAPTION(Blocked),FALSE,Clie.TABLECAPTION,"Sell-to Customer No."));
                             END ELSE
                               SumError(
                                 STRSUBSTNO(
                                   Text008,
                                   Clie.TABLECAPTION,"Sell-to Customer No."));
                           END;

                           IF "Bill-to Customer No." = '' THEN
                             SumError(STRSUBSTNO(Text006,FIELDCAPTION("Bill-to Customer No.")))
                           ELSE BEGIN
                             IF Clie.GET("Bill-to Customer No.") THEN BEGIN
                               IF Clie.Blocked = Clie.Blocked::Invoice THEN
                                 SumError(
                                   STRSUBSTNO(
                                     Text007,
                                     Clie.FIELDCAPTION(Blocked),FALSE,Clie.TABLECAPTION,"Bill-to Customer No."));
                             END ELSE
                               SumError(
                                 STRSUBSTNO(
                                   Text008,
                                   Clie.TABLECAPTION,"Bill-to Customer No."));
                           END;

                           ConfCG.GET;
                           ConfVtas.GET;

                           IF "Posting Date" = 0D THEN
                             SumError(STRSUBSTNO(Text006,FIELDCAPTION("Posting Date")))
                           ELSE
                             IF "Posting Date" <> NORMALDATE("Posting Date") THEN
                               SumError(STRSUBSTNO(Text009,FIELDCAPTION("Posting Date")))
                             ELSE BEGIN
                               IF (RegistDesdeFecha = 0D) AND (RegiHastaFecha = 0D) THEN BEGIN
                                 IF USERID <> '' THEN
                                   IF ConfUsuar.GET(USERID) THEN BEGIN
                                     RegistDesdeFecha := ConfUsuar."Allow Posting From";
                                     RegiHastaFecha := ConfUsuar."Allow Posting To";
                                   END;
                                 IF (RegistDesdeFecha = 0D) AND (RegiHastaFecha = 0D) THEN BEGIN
                                   RegistDesdeFecha := ConfCG."Allow Posting From";
                                   RegiHastaFecha := ConfCG."Allow Posting To";
                                 END;
                                 IF RegiHastaFecha = 0D THEN
                                   RegiHastaFecha := 31129999D;
                               END;
                               IF ("Posting Date" < RegistDesdeFecha) OR ("Posting Date" > RegiHastaFecha) THEN
                                 SumError(
                                   STRSUBSTNO(
                                     Text010,FIELDCAPTION("Posting Date")));
                             END;

                           IF ("Document Date" <> 0D) THEN
                             IF ("Document Date" <> NORMALDATE("Document Date")) THEN
                               SumError(STRSUBSTNO(Text009,FIELDCAPTION("Document Date")));

                           IF "Document Type" IN ["Document Type"::Invoice,"Document Type"::"Credit Memo"] THEN BEGIN
                             Ship := TRUE;
                             Invoice := TRUE;
                           END;

                           IF NOT (Ship OR Invoice) THEN
                             SumError(
                               STRSUBSTNO(
                                 Text011,
                                 FIELDCAPTION(Ship),FIELDCAPTION(Invoice)));

                           IF (Ship OR Invoice) AND ("Document Type" <> "Document Type"::"Credit Memo") THEN BEGIN
                             IF "Payment Method Code" = '' THEN
                               SumError(
                                 STRSUBSTNO(
                                   Text012,FIELDCAPTION("Payment Method Code")));
                             IF "Payment Terms Code" = '' THEN
                               SumError(
                                 STRSUBSTNO(
                                   Text012,FIELDCAPTION("Payment Terms Code")));
                           END;

                           IF Invoice THEN BEGIN
                             LinVtas.RESET;
                             LinVtas.SETRANGE("Document Type","Document Type");
                             LinVtas.SETRANGE("Document No.","No.");
                             LinVtas.SETFILTER(Quantity,'<>0');
                             IF "Document Type" = "Document Type"::Order THEN
                               LinVtas.SETFILTER("Qty. to Invoice",'<>0');
                             Invoice := LinVtas.FIND('-');
                             IF Invoice AND (NOT Ship) THEN BEGIN
                               Invoice := FALSE;
                               REPEAT
                                 Invoice := (LinVtas."Quantity Shipped" - LinVtas."Quantity Invoiced") <> 0;
                               UNTIL Invoice OR (LinVtas.NEXT = 0);
                             END;
                           END;

                           IF Ship THEN BEGIN
                             LinVtas.RESET;
                             LinVtas.SETRANGE("Document Type","Document Type");
                             LinVtas.SETRANGE("Document No.","No.");
                             LinVtas.SETFILTER(Quantity,'<>0');
                             IF "Document Type" = "Document Type"::Order THEN
                               LinVtas.SETFILTER("Qty. to Ship",'<>0');
                             LinVtas.SETRANGE("Shipment No.",'');
                             Ship := LinVtas.FIND('-');
                           END;

                           IF NOT (Ship OR Invoice) THEN
                             SumError(Text013);

                           IF Invoice THEN
                             IF "Document Type" <> "Document Type"::"Credit Memo" THEN
                               IF "Due Date" = 0D THEN
                                 SumError(STRSUBSTNO(Text006,FIELDCAPTION("Due Date")));

                           IF Ship AND ("Shipping No." = '') THEN // Pedido,Factura
                             IF ("Document Type" = "Document Type"::Order) OR
                                (("Document Type" = "Document Type"::Invoice) AND ConfVtas."Shipment on Invoice")
                             THEN
                               IF "Shipping No. Series" = '' THEN
                                 SumError(
                                   STRSUBSTNO(
                                     Text006,
                                     FIELDCAPTION("Shipping No. Series")));

                           IF Invoice AND ("Posting No." = '') THEN
                             IF "Document Type" = "Document Type"::Order THEN
                               IF "Posting No. Series" = '' THEN
                                 SumError(
                                   STRSUBSTNO(
                                     Text006,
                                     FIELDCAPTION("Posting No. Series")));

                           LinVtas.RESET;
                           LinVtas.SETRANGE("Document Type","Document Type");
                           LinVtas.SETRANGE("Document No.","No.");
                           LinVtas.SETFILTER("Purch. Order Line No.",'<>0');
                           IF LinVtas.FIND('-') THEN BEGIN
                             PedidoEnvDirecto := TRUE;
                             IF Ship THEN
                               REPEAT
                                 IF CabPedCompra."No." <> LinVtas."Purchase Order No." THEN BEGIN
                                   CabPedCompra.GET(CabPedCompra."Document Type"::Order,LinVtas."Purchase Order No.");
                                   IF CabPedCompra."Pay-to Vendor No." = '' THEN
                                     SumError(
                                       STRSUBSTNO(
                                         Text014,
                                         CabPedCompra.FIELDCAPTION("Pay-to Vendor No.")));
                                   IF CabPedCompra."Receiving No." = '' THEN
                                     IF CabPedCompra."Receiving No. Series" = '' THEN
                                       SumError(
                                         STRSUBSTNO(
                                           Text014,
                                           CabPedCompra.FIELDCAPTION("Receiving No. Series")));
                                 END;
                               UNTIL LinVtas.NEXT = 0;
                           END;

                           IF "Document Type" = "Document Type"::Order THEN
                             IF ConfVtas."Ext. Doc. No. Mandatory" AND ("External Document No." = '') THEN
                               SumError(STRSUBSTNO(Text006,FIELDCAPTION("External Document No.")));
                         END;

        ReqFilterFields=Document Type,No.;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=NumeraPags;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18150;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 1   ;Label        ;0    ;0    ;7500 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Sale documents - Test;
                                                                    ESP=Documento ventas - Test] }
            { 2   ;TextBox      ;15000;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 3   ;TextBox      ;0    ;423  ;7500 ;423  ;SourceExpr=COMPANYNAME }
            { 4   ;Label        ;16950;423  ;750  ;423  ;ParentControl=5 }
            { 5   ;TextBox      ;17700;423  ;450  ;423  ;CaptionML=[ENU=Page;
                                                                    ESP=P g.];
                                                         SourceExpr=CurrReport.PAGENO }
            { 6   ;TextBox      ;15900;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18150;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((CurrReport.PAGENO = 1) AND (FiltroCabVentas <> ''));
                         END;

          }
          CONTROLS
          {
            { 7   ;TextBox      ;0    ;0    ;18150;423  ;SourceExpr=Text015 + FiltroCabVentas }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=18150;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := (CurrReport.PAGENO = 1) AND (TextoEnvFac <> '');
                         END;

          }
          CONTROLS
          {
            { 9   ;TextBox      ;0    ;0    ;4500 ;423  ;SourceExpr=TextoEnvFac }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=5922;
            KeepWithNext=No;
          }
          CONTROLS
          {
            { 12  ;Label        ;0    ;846  ;3000 ;423  ;ParentControl=13 }
            { 13  ;TextBox      ;3150 ;846  ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Sales Header"."Sell-to Customer No." }
            { 114 ;TextBox      ;8850 ;5076 ;4500 ;423  ;SourceExpr=EnvADir[8] }
            { 115 ;TextBox      ;8850 ;4653 ;4500 ;423  ;SourceExpr=EnvADir[7] }
            { 116 ;TextBox      ;8850 ;4230 ;4500 ;423  ;SourceExpr=EnvADir[6] }
            { 117 ;TextBox      ;8850 ;3807 ;4500 ;423  ;SourceExpr=EnvADir[5] }
            { 118 ;TextBox      ;8850 ;3384 ;4500 ;423  ;SourceExpr=EnvADir[4] }
            { 119 ;TextBox      ;8850 ;2961 ;4500 ;423  ;SourceExpr=EnvADir[3] }
            { 120 ;TextBox      ;8850 ;2538 ;4500 ;423  ;SourceExpr=EnvADir[2] }
            { 121 ;TextBox      ;8850 ;2115 ;4500 ;423  ;SourceExpr=EnvADir[1] }
            { 17  ;Label        ;8850 ;1692 ;4500 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Send-to;
                                                                    ESP=Env¡o-a] }
            { 20  ;TextBox      ;0    ;5076 ;4500 ;423  ;SourceExpr=VentaADir[8] }
            { 21  ;TextBox      ;0    ;4653 ;4500 ;423  ;SourceExpr=VentaADir[7] }
            { 24  ;TextBox      ;0    ;4230 ;4500 ;423  ;SourceExpr=VentaADir[6] }
            { 25  ;TextBox      ;0    ;3807 ;4500 ;423  ;SourceExpr=VentaADir[5] }
            { 28  ;TextBox      ;0    ;3384 ;4500 ;423  ;SourceExpr=VentaADir[4] }
            { 29  ;TextBox      ;0    ;2961 ;4500 ;423  ;SourceExpr=VentaADir[3] }
            { 32  ;TextBox      ;0    ;2538 ;4500 ;423  ;SourceExpr=VentaADir[2] }
            { 33  ;TextBox      ;0    ;2115 ;4500 ;423  ;SourceExpr=VentaADir[1] }
            { 36  ;Label        ;0    ;1692 ;4500 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Sale-to;
                                                                    ESP=Venta-a] }
            { 14  ;TextBox      ;12000;846  ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Sales Header"."Ship-to Code" }
            { 15  ;Label        ;8850 ;846  ;3000 ;423  ;ParentControl=14 }
            { 8   ;TextBox      ;0    ;423  ;4500 ;423  ;FontBold=Yes;
                                                         SourceExpr=FORMAT("Sales Header"."Document Type") + ' ' + "Sales Header"."No." }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=5076;
            KeepWithNext=No;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             "Sales Header"."Bill-to Customer No." <> "Sales Header"."Sell-to Customer No.";
                         END;

          }
          CONTROLS
          {
            { 122 ;TextBox      ;0    ;4230 ;4500 ;423  ;SourceExpr=FactADir[8] }
            { 123 ;TextBox      ;0    ;3807 ;4500 ;423  ;SourceExpr=FactADir[7] }
            { 124 ;TextBox      ;0    ;3384 ;4500 ;423  ;SourceExpr=FactADir[6] }
            { 125 ;TextBox      ;0    ;2961 ;4500 ;423  ;SourceExpr=FactADir[5] }
            { 126 ;TextBox      ;0    ;2538 ;4500 ;423  ;SourceExpr=FactADir[4] }
            { 127 ;TextBox      ;0    ;2115 ;4500 ;423  ;SourceExpr=FactADir[3] }
            { 128 ;TextBox      ;0    ;1692 ;4500 ;423  ;SourceExpr=FactADir[2] }
            { 129 ;TextBox      ;0    ;1269 ;4500 ;423  ;SourceExpr=FactADir[1] }
            { 16  ;Label        ;0    ;846  ;4500 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Inv.-to;
                                                                    ESP=Fact.-a] }
            { 11  ;TextBox      ;3150 ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Sales Header"."Bill-to Customer No." }
            { 10  ;Label        ;0    ;0    ;3000 ;423  ;ParentControl=11 }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=846;
            KeepWithNext=No;
          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=1692;
            KeepWithNext=No;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             "Sales Header"."Document Type" = "Sales Header"."Document Type"::Quote;
                         END;

          }
          CONTROLS
          {
            { 49  ;TextBox      ;3150 ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Sales Header"."Customer Posting Group" }
            { 48  ;Label        ;0    ;0    ;3000 ;423  ;ParentControl=49 }
            { 47  ;TextBox      ;11850;423  ;1200 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Sales Header"."Posting Date" }
            { 46  ;Label        ;8700 ;423  ;3000 ;423  ;ParentControl=47 }
            { 110 ;TextBox      ;11850;0    ;1200 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Sales Header"."Document Date" }
            { 111 ;Label        ;8700 ;0    ;3000 ;423  ;ParentControl=110 }
            { 18  ;TextBox      ;3150 ;423  ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Sales Header"."Gen. Bus. Posting Group" }
            { 19  ;Label        ;0    ;423  ;3000 ;423  ;ParentControl=18 }
            { 54  ;TextBox      ;11850;846  ;5700 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Sales Header"."Posting Description" }
            { 55  ;Label        ;8700 ;846  ;3000 ;423  ;ParentControl=54 }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=2538;
            KeepWithNext=No;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             "Sales Header"."Document Type" = "Sales Header"."Document Type"::Order;
                         END;

          }
          CONTROLS
          {
            { 103 ;Label        ;0    ;0    ;3000 ;423  ;ParentControl=104 }
            { 104 ;TextBox      ;3150 ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Sales Header"."Customer Posting Group" }
            { 105 ;TextBox      ;11850;1269 ;1200 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Sales Header"."Posting Date" }
            { 106 ;TextBox      ;11850;846  ;1200 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Sales Header"."Document Date" }
            { 107 ;Label        ;8700 ;1269 ;3000 ;423  ;ParentControl=105 }
            { 108 ;Label        ;8700 ;846  ;3000 ;423  ;ParentControl=106 }
            { 43  ;TextBox      ;11850;0    ;1200 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Sales Header"."Order Date" }
            { 42  ;Label        ;8700 ;0    ;3000 ;423  ;ParentControl=43 }
            { 45  ;TextBox      ;11850;423  ;1200 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Sales Header"."Shipment Date" }
            { 44  ;Label        ;8700 ;423  ;3000 ;423  ;ParentControl=45 }
            { 26  ;TextBox      ;3150 ;423  ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Sales Header"."Gen. Bus. Posting Group" }
            { 27  ;Label        ;0    ;423  ;3000 ;423  ;ParentControl=26 }
            { 52  ;TextBox      ;11850;1692 ;5700 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Sales Header"."Posting Description" }
            { 53  ;Label        ;8700 ;1692 ;3000 ;423  ;ParentControl=52 }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=1692;
            KeepWithNext=No;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             "Sales Header"."Document Type" = "Sales Header"."Document Type"::Invoice;
                         END;

          }
          CONTROLS
          {
            { 109 ;Label        ;0    ;0    ;3000 ;423  ;ParentControl=130 }
            { 130 ;TextBox      ;3150 ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Sales Header"."Customer Posting Group" }
            { 131 ;TextBox      ;11850;423  ;1200 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Sales Header"."Posting Date" }
            { 132 ;TextBox      ;11850;0    ;1200 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Sales Header"."Document Date" }
            { 133 ;Label        ;8700 ;423  ;3000 ;423  ;ParentControl=131 }
            { 134 ;Label        ;8700 ;0    ;3000 ;423  ;ParentControl=132 }
            { 30  ;TextBox      ;3150 ;423  ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Sales Header"."Gen. Bus. Posting Group" }
            { 31  ;Label        ;0    ;423  ;3000 ;423  ;ParentControl=30 }
            { 50  ;TextBox      ;11850;846  ;5700 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Sales Header"."Posting Description" }
            { 51  ;Label        ;8700 ;846  ;3000 ;423  ;ParentControl=50 }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=2115;
            KeepWithNext=No;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             "Sales Header"."Document Type" = "Sales Header"."Document Type"::"Credit Memo";
                         END;

          }
          CONTROLS
          {
            { 64  ;Label        ;0    ;846  ;3000 ;423  ;ParentControl=65 }
            { 65  ;TextBox      ;3150 ;846  ;1500 ;423  ;SourceExpr="Sales Header"."Applies-to Doc. Type" }
            { 66  ;Label        ;0    ;1269 ;3000 ;423  ;ParentControl=67 }
            { 67  ;TextBox      ;3150 ;1269 ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Sales Header"."Applies-to Doc. No." }
            { 135 ;Label        ;0    ;0    ;3000 ;423  ;ParentControl=136 }
            { 136 ;TextBox      ;3150 ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Sales Header"."Customer Posting Group" }
            { 137 ;TextBox      ;11850;423  ;1200 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Sales Header"."Posting Date" }
            { 138 ;TextBox      ;11850;0    ;1200 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Sales Header"."Document Date" }
            { 139 ;Label        ;8700 ;423  ;3000 ;423  ;ParentControl=137 }
            { 140 ;Label        ;8700 ;0    ;3000 ;423  ;ParentControl=138 }
            { 34  ;TextBox      ;3150 ;423  ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Sales Header"."Gen. Bus. Posting Group" }
            { 35  ;Label        ;0    ;423  ;3000 ;423  ;ParentControl=34 }
            { 37  ;TextBox      ;11850;846  ;5700 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Sales Header"."Posting Description" }
            { 38  ;Label        ;8700 ;846  ;3000 ;423  ;ParentControl=37 }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=ContadorErrorCab;
        OnPreDataItem=BEGIN
                        SETRANGE(Number,1,ErrorContador);
                      END;

        OnPostDataItem=BEGIN
                         ErrorContador := 0;
                       END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 68  ;Label        ;0    ;0    ;1500 ;423  ;ParentControl=69;
                                                         FontBold=Yes }
            { 69  ;TextBox      ;1650 ;0    ;16500;423  ;CaptionML=[ENU=Warning!;
                                                                    ESP=­Aviso!];
                                                         SourceExpr=ErrorTexto[Number] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table37;
        DataItemTableView=SORTING(Document Type,Document No.,Line No.);
        OnPreDataItem=BEGIN
                        LinImporIVA.DELETEALL;
                        NoErrorIVA := FALSE;
                        ApplNoError := FALSE;
                        CurrReport.CREATETOTALS(Amount,"Amount Including VAT","Inv. Discount Amount","Pmt. Disc. Given Amount");
                      END;

        OnAfterGetRecord=BEGIN
                           IF ConfRegistroIVA.GET("Sales Line"."VAT Bus. Posting Group","Sales Line"."VAT Prod. Posting Group") THEN
                             IF ConfRegistroIVA."VAT+EC %" <> 0 THEN BEGIN
                               LinImporIVA.INIT;
                               LinImporIVA."VAT %" := ConfRegistroIVA."VAT %";
                               LinImporIVA."EC %" := ConfRegistroIVA."EC %";
                               LinImporIVA."VAT+EC Base" := "Sales Line".Amount;
                               LinImporIVA."Amount Including VAT+EC" := "Sales Line"."Amount Including VAT";
                               LinImporIVA.InsertLine;
                             END;

                           IF "Document Type" <> "Document Type"::Order THEN BEGIN
                             IF "Qty. to Ship" <> Quantity THEN
                               SumError(STRSUBSTNO(Text016,FIELDCAPTION("Qty. to Ship"),Quantity));
                             IF "Qty. to Invoice" <> Quantity THEN
                               SumError(STRSUBSTNO(Text016,FIELDCAPTION("Qty. to Invoice"),Quantity));
                           END;

                           IF NOT "Sales Header".Ship THEN
                             "Qty. to Ship" := 0;

                           IF ("Document Type" = "Document Type"::Invoice) AND ("Shipment No." <> '') THEN BEGIN
                             "Quantity Shipped" := Quantity;
                             "Qty. to Ship" := 0;
                           END;

                           IF "Sales Header".Invoice THEN BEGIN
                             MaxCdadAFacturar := "Qty. to Ship" + "Quantity Shipped" - "Quantity Invoiced";
                             IF ABS("Qty. to Invoice") > ABS(MaxCdadAFacturar) THEN
                               "Qty. to Invoice" := MaxCdadAFacturar;
                           END ELSE
                             "Qty. to Invoice" := 0;

                           IF "Gen. Prod. Posting Group" <> '' THEN BEGIN
                             IF ("Sales Header"."Document Type" = "Sales Header"."Document Type"::"Credit Memo") AND
                                ("Sales Header"."Applies-to Doc. Type" = "Sales Header"."Applies-to Doc. Type"::Invoice) AND
                                ("Sales Header"."Applies-to Doc. No." <> '')
                             THEN BEGIN
                               MovClie.SETCURRENTKEY("Document Type","Document No.","Customer No.");
                               MovClie.SETRANGE("Customer No.","Sales Header"."Bill-to Customer No.");
                               MovClie.SETRANGE("Document Type",MovClie."Document Type"::Invoice);
                               MovClie.SETRANGE("Document No.","Sales Header"."Applies-to Doc. No.");
                               IF (NOT MovClie.FIND('+')) AND (NOT ApplNoError) THEN BEGIN
                                 ApplNoError := TRUE;
                                 SumError(
                                   STRSUBSTNO(
                                     Text017,
                                     "Sales Header".FIELDCAPTION("Applies-to Doc. No."),"Sales Header"."Applies-to Doc. No."));
                               END;
                               FechaIVA := MovClie."Posting Date";
                             END ELSE
                               FechaIVA := "Sales Header"."Posting Date";

                             IF NOT ConfRegistroIVA.GET("VAT Bus. Posting Group","VAT Prod. Posting Group") THEN
                               SumError(
                                 STRSUBSTNO(
                                   Text018,
                                   ConfRegistroIVA.TABLECAPTION,"VAT Bus. Posting Group","VAT Prod. Posting Group"));
                             IF ConfRegistroIVA."VAT Calculation Type" = ConfRegistroIVA."VAT Calculation Type"::"Reverse Charge VAT" THEN
                               IF ("Sales Header"."VAT Registration No." = '') AND (NOT NoErrorIVA) THEN BEGIN
                                 NoErrorIVA := TRUE;
                                 SumError(
                                   STRSUBSTNO(
                                     Text019,"Sales Header".FIELDCAPTION("VAT Registration No.")));
                               END;
                             ActlzrImpor;
                           END;

                           IF Quantity <> 0 THEN BEGIN
                             IF "No." = '' THEN
                               SumError(STRSUBSTNO(Text020,Type,FIELDCAPTION("No.")));
                             IF Type = 0 THEN
                               SumError(STRSUBSTNO(Text006,FIELDCAPTION(Type)));
                           END ELSE
                             IF Amount <> 0 THEN
                                 SumError(STRSUBSTNO(Text021,FIELDCAPTION(Amount),FIELDCAPTION(Quantity)));

                           IF "Drop Shipment" THEN BEGIN
                             IF Type <> Type::Item THEN
                               SumError(Text022);
                             IF ("Qty. to Ship" <> 0) AND ("Purch. Order Line No." = 0) THEN BEGIN
                               SumError(STRSUBSTNO(Text023,"Line No."));
                               SumError(Text024);
                             END;
                           END;

                           LinVtas := "Sales Line";
                           IF "Document Type" <> "Document Type"::"Credit Memo" THEN BEGIN
                             LinVtas."Qty. to Ship" := -LinVtas."Qty. to Ship";
                             LinVtas."Qty. to Invoice" := -LinVtas."Qty. to Invoice";
                           END;

                           CdadPndteAFacturar := LinVtas."Qty. to Invoice";

                           IF ABS(CdadPndteAFacturar) > ABS("Qty. to Ship") THEN BEGIN
                             LinAlbaranVenta.RESET;
                             CASE "Document Type" OF
                               "Document Type"::Order:
                                 BEGIN
                                   LinAlbaranVenta.SETCURRENTKEY("Order No.","Order Line No.");
                                   LinAlbaranVenta.SETRANGE("Order No.","Document No.");
                                   LinAlbaranVenta.SETRANGE("Order Line No.","Line No.");
                                 END;
                               "Document Type"::Invoice:
                                 BEGIN
                                   LinAlbaranVenta.SETRANGE("Document No.","Shipment No.");
                                   LinAlbaranVenta.SETRANGE("Line No.","Shipment Line No.");
                                 END;
                             END;
                             IF LinAlbaranVenta.FIND('-') THEN
                               REPEAT
                                 IF LinAlbaranVenta."Quantity Invoiced" <> LinAlbaranVenta.Quantity THEN BEGIN
                                   IF LinAlbaranVenta."Sell-to Customer No." <> "Sell-to Customer No." THEN
                                     SumError(
                                       STRSUBSTNO(
                                         Text025,
                                         FIELDCAPTION("Sell-to Customer No.")));
                                   IF LinAlbaranVenta.Type <> Type THEN
                                     SumError(
                                       STRSUBSTNO(
                                         Text025,
                                         FIELDCAPTION(Type)));
                                   IF LinAlbaranVenta."No." <> "No." THEN
                                     SumError(
                                       STRSUBSTNO(
                                         Text025,
                                         FIELDCAPTION("No.")));
                                   IF LinAlbaranVenta."Gen. Bus. Posting Group" <> "Gen. Bus. Posting Group" THEN
                                     SumError(
                                       STRSUBSTNO(
                                         Text025,
                                         FIELDCAPTION("Gen. Bus. Posting Group")));
                                   IF LinAlbaranVenta."Gen. Prod. Posting Group" <> "Gen. Prod. Posting Group" THEN
                                     SumError(
                                       STRSUBSTNO(
                                         Text025,
                                         FIELDCAPTION("Gen. Prod. Posting Group")));
                                   IF LinAlbaranVenta."Location Code" <> "Location Code" THEN
                                     SumError(
                                       STRSUBSTNO(
                                         Text025,
                                         FIELDCAPTION("Location Code")));
                                   IF LinAlbaranVenta."Shortcut Dimension 1 Code" <> "Shortcut Dimension 1 Code" THEN
                                     SumError(
                                       STRSUBSTNO(
                                         Text025,
                                         FIELDCAPTION("Shortcut Dimension 1 Code")));
                                   IF LinAlbaranVenta."Shortcut Dimension 2 Code" <> "Shortcut Dimension 2 Code" THEN
                                     SumError(
                                       STRSUBSTNO(
                                         Text025,
                                         "Shortcut Dimension 2 Code"));
                                   IF LinAlbaranVenta."Job No." <> "Job No." THEN
                                     SumError(
                                       STRSUBSTNO(
                                         Text025,
                                         FIELDCAPTION("Job No.")));

                                   IF (-LinVtas."Qty. to Invoice") * LinAlbaranVenta.Quantity < 0 THEN
                                     SumError(
                                       STRSUBSTNO(
                                         Text026,FIELDCAPTION("Qty. to Invoice")));

                                   CdadAFacturar := CdadPndteAFacturar - LinVtas."Qty. to Ship";
                                   IF ABS(CdadAFacturar) > ABS(LinAlbaranVenta.Quantity - LinAlbaranVenta."Quantity Invoiced") THEN
                                     CdadAFacturar := -(LinAlbaranVenta.Quantity - LinAlbaranVenta."Quantity Invoiced");
                                   CdadPndteAFacturar := CdadPndteAFacturar - CdadAFacturar;
                                   LinAlbaranVenta."Quantity Invoiced" := LinAlbaranVenta."Quantity Invoiced" + (-CdadAFacturar);
                                 END;
                               UNTIL (LinAlbaranVenta.NEXT = 0) OR (ABS(CdadPndteAFacturar) <= ABS("Qty. to Ship"));
                           END;

                           IF ABS(CdadPndteAFacturar) > ABS("Qty. to Ship") THEN
                             IF "Document Type" = "Document Type"::Invoice THEN
                               SumError(STRSUBSTNO(Text027,"Shipment No."))
                             ELSE
                               SumError(Text028);

                           IF (Type >= Type::"G/L Account") AND ("Qty. to Invoice" <> 0) THEN BEGIN
                             IF NOT ConfGrupContabl.GET("Gen. Bus. Posting Group","Gen. Prod. Posting Group") THEN
                               SumError(
                                 STRSUBSTNO(
                                   Text018,
                                   ConfGrupContabl.TABLECAPTION,"Gen. Bus. Posting Group","Gen. Prod. Posting Group"));
                             IF NOT ConfRegistroIVA.GET("VAT Bus. Posting Group","VAT Prod. Posting Group") THEN
                               SumError(
                                 STRSUBSTNO(
                                   Text018,
                                   ConfRegistroIVA.TABLECAPTION,"VAT Bus. Posting Group","VAT Prod. Posting Group"));
                           END;

                           CASE Type OF
                             Type::"G/L Account":
                               BEGIN
                                 IF ("No." = '') AND (Amount = 0) THEN
                                   EXIT;

                                 IF "No." <> '' THEN
                                   IF CGCta.GET("No.") THEN BEGIN
                                     IF CGCta.Blocked THEN
                                       SumError(
                                         STRSUBSTNO(
                                           Text007,
                                           CGCta.FIELDCAPTION(Blocked),FALSE,CGCta.TABLECAPTION,"No."));
                                     IF NOT CGCta."Direct Posting" THEN
                                       SumError(
                                         STRSUBSTNO(
                                           Text007,
                                           CGCta.FIELDCAPTION("Direct Posting"),TRUE,CGCta.TABLECAPTION,"No."));
                                   END ELSE
                                     SumError(
                                       STRSUBSTNO(
                                         Text008,
                                         CGCta.TABLECAPTION,"No."));
                               END;
                             Type::Item:
                               BEGIN
                                 IF ("No." = '') AND (Quantity = 0) THEN
                                   EXIT;

                                 IF "No." <> '' THEN
                                   IF Producto.GET("No.") THEN BEGIN
                                     IF Producto.Blocked THEN
                                       SumError(
                                         STRSUBSTNO(
                                           Text007,
                                           Producto.FIELDCAPTION(Blocked),FALSE,Producto.TABLECAPTION,"No."));
                                     IF Producto.Reserve = Producto.Reserve::Always THEN
                                       IF (SignedXX(Quantity) < 0) AND (ABS("Reserved Quantity") < ABS("Qty. to Ship")) THEN
                                         SumError(
                                           STRSUBSTNO(
                                             Text016,
                                             FIELDCAPTION("Reserved Quantity"),SignedXX("Qty. to Ship")));
                                   END ELSE
                                     SumError(
                                       STRSUBSTNO(
                                         Text008,
                                         Producto.TABLECAPTION,"No."));

                               END;
                             Type::Resource:
                               BEGIN
                                 IF ("No." = '') AND (Quantity = 0) THEN
                                   EXIT;

                                 IF "No." <> '' THEN
                                   IF Recu.GET("No.") THEN BEGIN
                                     IF Recu.Blocked THEN
                                       SumError(
                                         STRSUBSTNO(
                                           Text007,
                                           Recu.FIELDCAPTION(Blocked),FALSE,Recu.TABLECAPTION,"No."));
                                   END ELSE
                                     SumError(
                                       STRSUBSTNO(
                                         Text008,
                                         Recu.TABLECAPTION,"No."));
                               END;
                           END;
                         END;

        DataItemLinkReference=Sales Header;
        DataItemLink=Document Type=FIELD(Document Type),
                     Document No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18150;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 70  ;Label        ;0    ;423  ;1500 ;846  ;ParentControl=80;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 71  ;Label        ;1650 ;423  ;1500 ;846  ;ParentControl=81;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 72  ;Label        ;3300 ;423  ;7500 ;846  ;ParentControl=82;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 73  ;Label        ;12150;423  ;900  ;846  ;ParentControl=83;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 76  ;Label        ;13200;423  ;1500 ;846  ;ParentControl=86;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 78  ;Label        ;15750;423  ;1800 ;846  ;ParentControl=88;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 57  ;Label        ;14850;423  ;750  ;846  ;ParentControl=56;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 59  ;Label        ;10950;423  ;1050 ;846  ;ParentControl=58;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 80  ;TextBox      ;0    ;0    ;1500 ;423  ;SourceExpr=Type }
            { 81  ;TextBox      ;1650 ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="No." }
            { 82  ;TextBox      ;3300 ;0    ;7500 ;423  ;SourceExpr=Description }
            { 83  ;TextBox      ;12150;0    ;900  ;423  ;BlankZero=Yes;
                                                         SourceExpr=Quantity }
            { 86  ;TextBox      ;13200;0    ;1500 ;423  ;BlankZero=Yes;
                                                         SourceExpr="Unit Price";
                                                         AutoFormatType=2;
                                                         AutoFormatExpr="Currency Code" }
            { 88  ;TextBox      ;15750;0    ;1800 ;423  ;CaptionML=[ENU=Amount;
                                                                    ESP=Importe];
                                                         BlankZero=Yes;
                                                         SourceExpr=Amount+"Inv. Discount Amount"+"Pmt. Disc. Given Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Currency Code" }
            { 56  ;TextBox      ;14850;0    ;750  ;423  ;BlankZero=Yes;
                                                         SourceExpr="VAT %" }
            { 58  ;TextBox      ;10950;0    ;1050 ;423  ;SourceExpr="Shortcut Dimension 1 Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18150;
            SectionHeight=423;
          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18150;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Inv. Discount Amount" <> 0);
                         END;

          }
          CONTROLS
          {
            { 90  ;Label        ;12600;0    ;3000 ;423  ;ParentControl=91 }
            { 91  ;TextBox      ;15750;0    ;1800 ;423  ;SourceExpr="Inv. Discount Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Currency Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18150;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Pmt. Disc. Given Amount" <> 0);
                         END;

          }
          CONTROLS
          {
            { 164 ;TextBox      ;15750;0    ;1800 ;423  ;SourceExpr="Pmt. Disc. Given Amount" }
            { 165 ;Label        ;12600;0    ;3000 ;423  ;ParentControl=164 }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18150;
            SectionHeight=2115;
          }
          CONTROLS
          {
            { 79  ;TextBox      ;15750;0    ;1800 ;423  ;FontBold=Yes;
                                                         SourceExpr=Amount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Currency Code" }
            { 89  ;TextBox      ;15750;423  ;1800 ;423  ;SourceExpr="Amount Including VAT" - Amount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Currency Code" }
            { 95  ;TextBox      ;12600;0    ;3000 ;423  ;FontBold=Yes;
                                                         SourceExpr=TotalTexto }
            { 92  ;TextBox      ;15750;846  ;1800 ;423  ;FontBold=Yes;
                                                         SourceExpr="Amount Including VAT";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Currency Code" }
            { 141 ;TextBox      ;12600;846  ;3000 ;423  ;FontBold=Yes;
                                                         SourceExpr=TextoTotIVAIncl }
            { 142 ;Label        ;12600;423  ;3000 ;423  ;FontSize=7;
                                                         CaptionML=[ENU=Ampunt VAT+ER;
                                                                    ESP=Importe IVA+RE] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=ContadorErrorLin;
        OnPreDataItem=BEGIN
                        SETRANGE(Number,1,ErrorContador);
                      END;

        OnPostDataItem=BEGIN
                         ErrorContador := 0;
                       END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 96  ;Label        ;0    ;0    ;1500 ;423  ;ParentControl=97;
                                                         FontBold=Yes }
            { 97  ;TextBox      ;1650 ;0    ;16500;423  ;CaptionML=[ENU=Warning!;
                                                                    ESP=­Aviso!];
                                                         SourceExpr=ErrorTexto[Number] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=ContadorIVA;
        OnPreDataItem=BEGIN
                        IF LinImporIVA.COUNT < 1 THEN
                          CurrReport.BREAK;
                        SETRANGE(Number,1,LinImporIVA.COUNT);
                        CurrReport.CREATETOTALS(LinImporIVA."VAT+EC Base",LinImporIVA."VAT Amount",LinImporIVA."EC Amount");
                      END;

        OnAfterGetRecord=BEGIN
                           LinImporIVA.GetLine(Number);
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18150;
            SectionHeight=2115;
          }
          CONTROLS
          {
            { 144 ;Label        ;5250 ;846  ;1800 ;846  ;ParentControl=150;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 145 ;Label        ;3300 ;846  ;1800 ;846  ;ParentControl=151;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 146 ;Label        ;0    ;846  ;1500 ;846  ;ParentControl=152;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 143 ;Label        ;0    ;0    ;4500 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Especify tax amount;
                                                                    ESP=Especificar importe IVA] }
            { 93  ;Label        ;1650 ;846  ;1500 ;846  ;ParentControl=159;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 94  ;Label        ;7200 ;846  ;1800 ;846  ;ParentControl=160;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=18150;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 147 ;TextBox      ;5250 ;0    ;1800 ;423  ;SourceExpr=LinImporIVA."VAT Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 148 ;TextBox      ;3300 ;0    ;1800 ;423  ;CaptionML=[ENU=Sum;
                                                                    ESP=Suma];
                                                         SourceExpr=LinImporIVA."VAT+EC Base";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 149 ;Label        ;0    ;0    ;1500 ;423  ;ParentControl=148;
                                                         LeaderDots=Yes }
            { 163 ;TextBox      ;7200 ;0    ;1800 ;423  ;SourceExpr=LinImporIVA."EC Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 150 ;TextBox      ;5250 ;0    ;1800 ;423  ;CaptionML=[ENU=VAT Amount;
                                                                    ESP=Importe IVA];
                                                         SourceExpr=LinImporIVA."VAT Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 151 ;TextBox      ;3300 ;0    ;1800 ;423  ;CaptionML=[ENU=Base VAT+ER;
                                                                    ESP=Base IVA+RE];
                                                         SourceExpr=LinImporIVA."VAT+EC Base";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 152 ;TextBox      ;0    ;0    ;1500 ;423  ;CaptionML=[ENU=% VAT;
                                                                    ESP=% IVA];
                                                         SourceExpr=LinImporIVA."VAT %" }
            { 159 ;TextBox      ;1650 ;0    ;1500 ;423  ;CaptionML=[ENU=% ER;
                                                                    ESP=% RE];
                                                         SourceExpr=LinImporIVA."EC %" }
            { 160 ;TextBox      ;7200 ;0    ;1800 ;423  ;CaptionML=[ENU=Amount ER;
                                                                    ESP=Importe RE];
                                                         SourceExpr=LinImporIVA."EC Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=18150;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 153 ;TextBox      ;5250 ;423  ;1800 ;423  ;SourceExpr=LinImporIVA."VAT Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 154 ;TextBox      ;3300 ;423  ;1800 ;423  ;CaptionML=[ENU=Sum;
                                                                    ESP=Suma];
                                                         SourceExpr=LinImporIVA."VAT+EC Base";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 155 ;Label        ;0    ;423  ;1500 ;423  ;ParentControl=154;
                                                         LeaderDots=Yes }
            { 161 ;TextBox      ;7200 ;423  ;1800 ;423  ;SourceExpr=LinImporIVA."EC Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18150;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 156 ;TextBox      ;5250 ;423  ;1800 ;423  ;FontBold=Yes;
                                                         SourceExpr=LinImporIVA."VAT Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 157 ;TextBox      ;3300 ;423  ;1800 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Total;
                                                                    ESP=Total];
                                                         SourceExpr=LinImporIVA."VAT+EC Base";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
            { 158 ;Label        ;0    ;423  ;1500 ;423  ;ParentControl=157;
                                                         FontBold=Yes }
            { 162 ;TextBox      ;7200 ;423  ;1800 ;423  ;FontBold=Yes;
                                                         SourceExpr=LinImporIVA."EC Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Line"."Currency Code" }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=3850;
      Height=1540;
      CaptionML=[ENU=Sales document - Test LTU;
                 ESP=Documento ventas - Test LTU];
      SaveValues=Yes;
      OnOpenForm=BEGIN
                   IF NOT EnviaEnSigRegistro AND NOT FactEnSigRegitro THEN BEGIN
                     EnviaEnSigRegistro := TRUE;
                     FactEnSigRegitro := TRUE;
                   END;
                 END;

    }
    CONTROLS
    {
      { 1   ;Label        ;0    ;0    ;3300 ;440  ;ParentControl=2;
                                                   LeaderDots=No;
                                                   CaptionML=[ENU=Order register;
                                                              ESP=Registro pedido] }
      { 2   ;CheckBox     ;3410 ;550  ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=[ENU=Send;
                                                              ESP=Env¡o];
                                                   SourceExpr=EnviaEnSigRegistro;
                                                   OnValidate=BEGIN
                                                                IF NOT EnviaEnSigRegistro THEN
                                                                  FactEnSigRegitro := TRUE;
                                                              END;
                                                               }
      { 3   ;Label        ;220  ;550  ;3080 ;440  ;ParentControl=2 }
      { 4   ;CheckBox     ;3410 ;1100 ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=[ENU=Invoice;
                                                              ESP=Factura];
                                                   SourceExpr=FactEnSigRegitro;
                                                   OnValidate=BEGIN
                                                                IF NOT FactEnSigRegitro THEN
                                                                  EnviaEnSigRegistro := TRUE;
                                                              END;
                                                               }
      { 5   ;Label        ;220  ;1100 ;3080 ;440  ;ParentControl=4 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text000@1103355036 : TextConst 'ENU=Send and invoice;ESP=Enviar y facturar';
      Text001@1103355037 : TextConst 'ENU=Send;ESP=Env¡o';
      Text002@1103355038 : TextConst 'ENU=Invoice;ESP=Factura';
      Text003@1103355039 : TextConst 'ENU=Order registration: %1;ESP=Registro pedido: %1';
      Text004@1103355040 : TextConst 'ENU=Total %1;ESP=Total %1';
      Text005@1103355041 : TextConst 'ENU=Total %1 incl. VAT;ESP=Total %1 incl. IVA';
      Text006@1103355042 : TextConst 'ENU=Must indicate %1;ESP=Se debe indicar %1.';
      Text007@1103355043 : TextConst 'ENU=%1 must be %2 for %3 %4;ESP=%1 debe ser %2 para %3 %4.';
      Text008@1103355044 : TextConst 'ENU=%1 %2 do not exist;ESP=No existe %1 %2.';
      Text009@1103355045 : TextConst 'ENU=%1 cannot be a last date;ESP=%1 no puede ser una fecha £ltima.';
      Text010@1103355046 : TextConst 'ENU=%1 is not included in the range of dates of allowed registrations;ESP=%1 no est  incluida en el intervalo de fechas de registro permitidas.';
      Text011@1103355047 : TextConst 'ENU=Enter "Yes" in %1 and/or %2;ESP=Introduzca "S¡" en %1 y/o %2.';
      Text012@1103355048 : TextConst 'ENU=Indicate %1.;ESP=Indique %1.';
      Text013@1103355049 : TextConst 'ENU=There is nothing to register;ESP=No hay nada que registrar.';
      Text014@1103355050 : TextConst 'ENU=In purchase header must indicate %1.;ESP=En la cabecera de compra se debe indicar %1.';
      Text015@1103355051 : TextConst 'ENU=Sale document:;ESP=Documento venta:';
      Text016@1103355052 : TextConst 'ENU=%1 must be %2;ESP=%1 debe ser %2.';
      Text017@1103355053 : TextConst 'ENU=%1 %2 do not exist in client movements;ESP=%1 %2 no existe en los movs. cliente.';
      Text018@1103355054 : TextConst 'ENU=%1 %2 %3 do not exist;ESP=No existe %1 %2 %3.';
      Text019@1103355055 : TextConst 'ENU=Must indicate %1 for the client;ESP=Se debe indicar %1 para el cliente.';
      Text020@1103355056 : TextConst 'ENU=Must indicate %1 %2;ESP=Se debe indicar %1 %2.';
      Text021@1103355057 : TextConst 'ENU=%1 must be 0 when %2 is 0;ESP=%1 debe ser 0 cuando %2 es 0.';
      Text022@1103355058 : TextConst 'ENU=Directo sent only is possible for items;ESP=Env¡o directo s¢lo es posible para productos.';
      Text023@1103355059 : TextConst 'ENU=Line %1 of sale order cannot be sent because is marked;ESP=No se puede enviar la l¡nea %1 del pedido de venta porque est  marcada';
      Text024@1103355060 : TextConst 'ENU=as direct sent and it is not associated with a purchase order;ESP=como un env¡o directo y no est  asociada todav¡a a un pedido de compra.';
      Text025@1103355061 : TextConst 'ENU=Sent %1 is not the same than %1 in the sale header.;ESP=En el env¡o %1 no es el mismo que %1 en la cabecera de ventas.';
      Text026@1103355062 : TextConst 'ENU=%1 must have the same sign than the sent;ESP=%1 debe tener el mismo signo que el env¡o.';
      Text027@1103355063 : TextConst 'ENU=Delivery note %1 has been invoiced while it was opening;ESP=Albar n %1 ha sido facturado mientras se abr¡a.';
      Text028@1103355064 : TextConst 'ENU=Sale delivery note lines have been deleted;ESP=Se han borrado las l¡neas del albar n de venta.';
      Text029@1103355065 : TextConst 'ENU=%1 must be completed when %2 is %3;ESP=%1 se debe completar cuando %2 es %3.';
      Text030@1103355066 : TextConst 'ENU=If you specify %2 then %1 must be 1 or -1;ESP=Si se especifica %2 entonces %1 debe ser 1 o -1.';
      Text031@1103355067 : TextConst 'ENU=Must indicate %1;ESP=Se debe indicar %1';
      ConfVtas@1103355000 : Record 311;
      ConfCG@1103355001 : Record 98;
      ConfUsuar@1103355002 : Record 91;
      Clie@1103355003 : Record 18;
      CabVenta@1103355004 : Record 36;
      LinVtas@1103355005 : Record 37;
      CGCta@1103355006 : Record 15;
      Producto@1103355007 : Record 27;
      Recu@1103355008 : Record 156;
      LinAlbaranVenta@1103355009 : Record 111;
      CabPedCompra@1103355010 : Record 38;
      ConfGrupContabl@1103355011 : Record 252;
      ConfRegistroIVA@1103355012 : Record 325;
      MovClie@1103355013 : Record 21;
      LinImporIVA@1103355014 : TEMPORARY Record 290;
      FormatDire@1103355015 : Codeunit 365;
      FiltroCabVentas@1103355016 : Text[250];
      VentaADir@1103355017 : ARRAY [8] OF Text[50];
      FactADir@1103355018 : ARRAY [8] OF Text[50];
      EnvADir@1103355019 : ARRAY [8] OF Text[50];
      TotalTexto@1103355020 : Text[50];
      TextoTotIVAIncl@1103355021 : Text[50];
      FactEnSigRegitro@1103355022 : Boolean;
      EnviaEnSigRegistro@1103355023 : Boolean;
      TextoEnvFac@1103355024 : Text[50];
      RegistDesdeFecha@1103355025 : Date;
      RegiHastaFecha@1103355026 : Date;
      MaxCdadAFacturar@1103355027 : Decimal;
      CdadPndteAFacturar@1103355028 : Decimal;
      CdadAFacturar@1103355029 : Decimal;
      PedidoEnvDirecto@1103355030 : Boolean;
      ErrorContador@1103355031 : Integer;
      ErrorTexto@1103355032 : ARRAY [99] OF Text[250];
      FechaIVA@1103355033 : Date;
      NoErrorIVA@1103355034 : Boolean;
      ApplNoError@1103355035 : Boolean;

    LOCAL PROCEDURE SumError@1(Texto@1103355000 : Text[250]);
    BEGIN
      ErrorContador := ErrorContador + 1;
      ErrorTexto[ErrorContador] := Texto;
    END;

    LOCAL PROCEDURE ActlzrImpor@2();
    BEGIN
      WITH "Sales Line" DO BEGIN
        IF Type = 0 THEN
          SumError(STRSUBSTNO(Text031,FIELDCAPTION(Type)));
      END;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}
