OBJECT Report 7009707 Contrato Venta Hotel For.Cial.
{
  OBJECT-PROPERTIES
  {
    Date=02/10/12;
    Time=12:00:00;
    Modified=Yes;
    Version List=AIC2009;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Contract sale Hotel For. Merch.;
               ESP=Contrato Venta Hotel For.Cial.];
    OnInitReport=BEGIN
                   IF NOT rEmpresa.FIND('-') THEN
                     ERROR(Text000);
                   IF NOT rDelegacion.FIND('-') THEN
                     ERROR(Text001);

                   rConf.GET;
                   InfoEmpresa.FIND('-');
                   InfoEmpresa.CALCFIELDS(Picture);
                 END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table7009727;
        DataItemTableView=SORTING(Delegacion,N§ Contrato venta);
        NewPagePerGroup=Yes;
        OnPreDataItem=BEGIN
                        CLEAR(tLiteral);
                      END;

        OnAfterGetRecord=BEGIN
                           IF rHotel.GET(Hotel) THEN
                         END;

        GroupTotalFields=Delegacion,N§ Contrato venta;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=16350;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1   ;Shape        ;0    ;423  ;16350;423  ;ShapeStyle=HorzLine }
            { 3   ;TextBox      ;0    ;0    ;5400 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=rEmpresa.Name }
            { 2   ;TextBox      ;10950;0    ;5400 ;423  ;HorzAlign=Right;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         SourceExpr=Text002 + FORMAT(TODAY,0,4) }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=16350;
            SectionHeight=3807;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(CurrReport.PAGENO = 1);
                         END;

          }
          CONTROLS
          {
            { 19  ;TextBox      ;9150 ;0    ;5100 ;423  ;FontBold=Yes;
                                                         SourceExpr=rEmpresa.Name }
            { 141 ;TextBox      ;9150 ;423  ;5100 ;423  ;FontBold=Yes;
                                                         SourceExpr=rEmpresa.Address }
            { 143 ;TextBox      ;9150 ;2538 ;900  ;423  ;FontBold=Yes;
                                                         SourceExpr=rEmpresa."Post Code" }
            { 144 ;TextBox      ;10200;2538 ;4050 ;423  ;FontBold=Yes;
                                                         SourceExpr=rEmpresa.City }
            { 145 ;TextBox      ;9150 ;2961 ;5100 ;423  ;FontBold=Yes;
                                                         SourceExpr=rEmpresa.County }
            { 1103355019;PictureBox;150;0   ;7200 ;2538 ;BackColor=255;
                                                         SourceExpr=InfoEmpresa.Picture }
            { 1103355020;Shape  ;0    ;3384 ;16350;423  ;ShapeStyle=HorzLine }
            { 1103355022;Label  ;9150 ;846  ;1050 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Tel. Int.;
                                                                    ESP=Tel. Int.] }
            { 1103355023;Label  ;9150 ;1269 ;1050 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Fax. Int.;
                                                                    ESP=Fax. Int.] }
            { 1103355024;Label  ;9150 ;1692 ;1050 ;423  ;ForeColor=16711680;
                                                         BorderColor=16711680;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=E-mail:;
                                                                    ESP=E-mail:] }
            { 1103355027;TextBox;10350;846  ;4800 ;423  ;FontBold=Yes;
                                                         SourceExpr=rEmpresa."Phone No." }
            { 1103355028;TextBox;10350;1269 ;4800 ;423  ;FontBold=Yes;
                                                         SourceExpr=rEmpresa."Fax No." }
            { 1103355029;TextBox;10350;1692 ;4800 ;423  ;FontBold=Yes;
                                                         SourceExpr=rEmpresa."E-Mail" }
            { 1103355030;TextBox;1050 ;2538 ;5700 ;423  ;HorzAlign=Center;
                                                         ForeColor=16711680;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         SourceExpr=rEmpresa."Home Page" }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=16350;
            SectionHeight=2961;
          }
          CONTROLS
          {
            { 110 ;TextBox      ;3300 ;423  ;4650 ;423  ;SourceExpr=Delegacion + ' - ' + fNoms.nom_delegacion(Delegacion) }
            { 77  ;Label        ;450  ;423  ;2700 ;423  ;ParentControl=110;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Delegation;
                                                                    ESP=Delegaci¢n] }
            { 111 ;TextBox      ;3300 ;846  ;4650 ;423  ;SourceExpr=Cliente + ' - ' + fNoms.nom_cliente(Cliente) }
            { 78  ;Label        ;450  ;846  ;2700 ;423  ;ParentControl=111;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Client;
                                                                    ESP=Cliente] }
            { 109 ;TextBox      ;3300 ;1269 ;1650 ;423  ;SourceExpr="N§ Contrato venta" }
            { 108 ;Label        ;450  ;1269 ;2700 ;423  ;ParentControl=109;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Contract No.;
                                                                    ESP=N§ Contrato] }
            { 112 ;TextBox      ;3300 ;1692 ;4650 ;423  ;SourceExpr=Hotel + ' - ' + fNoms.nom_hotel(Hotel) }
            { 113 ;Label        ;450  ;1692 ;2700 ;423  ;ParentControl=112;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Hotel;
                                                                    ESP=Hotel] }
            { 118 ;Label        ;8850 ;1269 ;2700 ;423  ;FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Location;
                                                                    ESP=Zona] }
            { 120 ;TextBox      ;11700;423  ;3450 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Fecha inicio contrato" }
            { 116 ;Label        ;8850 ;423  ;2700 ;423  ;ParentControl=120;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Starting Date;
                                                                    ESP=Fecha inicio] }
            { 121 ;TextBox      ;11700;846  ;3450 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Fecha final contrato" }
            { 117 ;Label        ;8850 ;846  ;2700 ;423  ;ParentControl=121;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Ending Date;
                                                                    ESP=Fecha Final] }
            { 122 ;TextBox      ;11700;1269 ;3450 ;423  ;SourceExpr=rHotel."Zona Fisica" + ' - ' + fNoms.nom_zonafisica(rHotel."Zona Fisica") }
            { 123 ;TextBox      ;11700;1692 ;3450 ;423  ;SourceExpr="Impuestos incluidos" }
            { 119 ;Label        ;8850 ;1692 ;2700 ;423  ;ParentControl=123;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Included Taxes;
                                                                    ESP=Impuestos incluidos] }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=16350;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 4   ;TextBox      ;4800 ;423  ;7050 ;423  ;HorzAlign=Center;
                                                         SourceExpr=Text003 + "N§ Contrato venta" }
            { 5   ;Shape        ;0    ;0    ;16350;423  ;ShapeStyle=HorzLine }
            { 6   ;TextBox      ;13200;423  ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=Text004 + FORMAT(CurrReport.PAGENO) }
            { 7   ;TextBox      ;0    ;423  ;4350 ;423  ;SourceExpr=Text005 + fNoms.nom_cliente(Cliente) }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table7009732;
        DataItemTableView=SORTING(Delegacion,N§ Contrato,Codigo Precio,Orden Precio)
                          WHERE(Activo=CONST(Yes),
                                Codigo Precio=FILTER(Habitacion|Regimen));
        NewPagePerGroup=Yes;
        DataItemVarName=Precios;
        OnPreDataItem=BEGIN

                        // AJF 10/02/09
                        // Tratamos los precios por habitaci¢n con un orden distinto.

                        FiltrarPreciosHabitacion;
                      END;

        OnAfterGetRecord=BEGIN

                           CLEAR(cPro);

                           IF Precios."Codigo Precio" = Precios."Codigo Precio"::Habitacion THEN BEGIN

                             // AJF 10/02/09
                             // Tratamos los precios por habitaci¢n con un orden distinto.

                             NextPrecioHabitacion;
                             IF rPreHab.Porcentaje THEN
                               cPro := Text007;

                           END
                           ELSE
                             IF Porcentaje THEN
                               cPro := Text007;
                         END;

        GroupTotalFields=Codigo Precio;
        DataItemLink=Delegacion=FIELD(Delegacion),
                     N§ Contrato=FIELD(N§ Contrato venta);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=16350;
            SectionHeight=1269;
            OnPreSection=BEGIN
                           // AJF 09/02/09
                           // Al imprimir primero los precios ya no nos hace falta este salto de p gina
                           //IF tLiteral = Text006 THEN
                           //  CurrReport.NEWPAGE;

                           CASE "Codigo Precio" OF
                             0: tLiteral := Text008; //Text009;
                             1: tLiteral := Text010;
                             2: tLiteral := Text011;
                             3: tLiteral := Text012;     //Text013;
                             4: tLiteral := Text014;    //Text015;
                             5: tLiteral := Text016;
                           END;
                         END;

          }
          CONTROLS
          {
            { 22  ;TextBox      ;0    ;423  ;6750 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=tLiteral }
            { 1103355026;Shape  ;0    ;846  ;16350;423  ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=16350;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Codigo Precio" = 1);
                         END;

          }
          CONTROLS
          {
            { 47  ;Label        ;0    ;0    ;1650 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Code;
                                                                    ESP=Codigo] }
            { 48  ;Label        ;5400 ;0    ;2700 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Dates;
                                                                    ESP=Fechas] }
            { 49  ;Label        ;8250 ;0    ;1800 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Amount;
                                                                    ESP=Importe] }
            { 1103355011;Label  ;10200;0    ;1350 ;423  ;ParentControl=1103355010;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Currency;
                                                                    ESP=Divisa] }
            { 1103355001;Label  ;1800 ;0    ;3450 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Description;
                                                                    ESP=Descripci¢n] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=16350;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Codigo Precio" = 0);
                         END;

          }
          CONTROLS
          {
            { 43  ;Label        ;0    ;0    ;1650 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Code;
                                                                    ESP=Codigo] }
            { 44  ;Label        ;5400 ;0    ;2700 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Dates;
                                                                    ESP=Fechas] }
            { 45  ;Label        ;8250 ;0    ;1800 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Amount;
                                                                    ESP=Importe] }
            { 92  ;Label        ;11700;0    ;1800 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Price type;
                                                                    ESP=Tipo Precio] }
            { 1103355012;Label  ;10200;0    ;1350 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Currency;
                                                                    ESP=Divisa] }
            { 1103355002;Label  ;1800 ;0    ;3450 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Description;
                                                                    ESP=Descripci¢n] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=16350;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Codigo Precio" = 2);
                         END;

          }
          CONTROLS
          {
            { 39  ;Label        ;0    ;0    ;1200 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Code;
                                                                    ESP=Codigo] }
            { 40  ;Label        ;3450 ;0    ;2100 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Dates;
                                                                    ESP=Fechas] }
            { 41  ;Label        ;8400 ;0    ;1800 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Amount;
                                                                    ESP=Importe] }
            { 42  ;Label        ;11850;0    ;1650 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Accum Factor;
                                                                    ESP=Factor Acum.] }
            { 50  ;Label        ;15000;0    ;1350 ;846  ;ParentControl=46;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Person No.;
                                                                    ESP=N§ Persona] }
            { 66  ;Label        ;13650;0    ;1200 ;846  ;ParentControl=62;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Companion type;
                                                                    ESP=Tipo Acompa¤ante] }
            { 1103355013;Label  ;10350;0    ;1350 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Currency;
                                                                    ESP=Divisa] }
            { 1103355003;Label  ;1350 ;0    ;1950 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Description;
                                                                    ESP=Descripci¢n] }
            { 1103355031;Label  ;5700 ;0    ;1200 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Room Code;
                                                                    ESP=Cod. Hab.] }
            { 1103355032;Label  ;7050 ;0    ;1200 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Ages;
                                                                    ESP=Edades] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=16350;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Codigo Precio" = 3);
                         END;

          }
          CONTROLS
          {
            { 35  ;Label        ;0    ;0    ;1650 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Code;
                                                                    ESP=Codigo] }
            { 36  ;Label        ;8100 ;0    ;2100 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Dates;
                                                                    ESP=Fechas] }
            { 37  ;Label        ;10350;0    ;1800 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Amount;
                                                                    ESP=Importe] }
            { 1103355014;Label  ;12300;0    ;1350 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Currency;
                                                                    ESP=Divisa] }
            { 1103355004;Label  ;1800 ;0    ;3450 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Description;
                                                                    ESP=Descripci¢n] }
            { 1103355036;Label  ;5400 ;0    ;1200 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Room Code;
                                                                    ESP=Cod. Hab.] }
            { 1103355037;Label  ;6750 ;0    ;1200 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Ages;
                                                                    ESP=Edades] }
            { 1103355038;Label  ;15150;0    ;1200 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Person No.;
                                                                    ESP=N§ Persona] }
            { 1103355039;Label  ;13800;0    ;1200 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Person type;
                                                                    ESP=Tipo Persona] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=16350;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Codigo Precio" >= 4);
                         END;

          }
          CONTROLS
          {
            { 21  ;Label        ;5400 ;0    ;2700 ;423  ;ParentControl=20;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Dates;
                                                                    ESP=Fechas] }
            { 27  ;Label        ;0    ;0    ;1650 ;423  ;ParentControl=23;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Code;
                                                                    ESP=Codigo] }
            { 1103355005;Label  ;1800 ;0    ;3450 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Description;
                                                                    ESP=Descripci¢n] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=16350;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Codigo Precio" = 1);
                         END;

          }
          CONTROLS
          {
            { 63  ;TextBox      ;0    ;0    ;1650 ;423  ;SourceExpr=Codigo }
            { 64  ;TextBox      ;5400 ;0    ;2700 ;423  ;SourceExpr=FORMAT("Fecha desde") + '..' + FORMAT("Fecha hasta") }
            { 65  ;TextBox      ;8250 ;0    ;1800 ;423  ;HorzAlign=Right;
                                                         SourceExpr=Importe }
            { 1103355000;TextBox;1800 ;0    ;3450 ;423  ;SourceExpr=GetDescripcion(Precios) }
            { 1103355010;TextBox;10200;0    ;1350 ;423  ;CaptionML=[ENU=Currency;
                                                                    ESP=Divisa];
                                                         SourceExpr=GetDivisa("C¢d. divisa") }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=16350;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Codigo Precio" = 0);
                         END;

          }
          CONTROLS
          {
            { 1103355042;TextBox;5400 ;0    ;2700 ;423  ;SourceExpr=FORMAT(rPreHab."Fecha desde") + '..' + FORMAT(rPreHab."Fecha hasta") }
            { 1103355043;TextBox;8250 ;0    ;1800 ;423  ;HorzAlign=Right;
                                                         SourceExpr=rPreHab.Importe }
            { 1103355044;TextBox;11700;0    ;1800 ;423  ;SourceExpr=FORMAT(rPreHab."Tipo Precio") }
            { 1103355045;TextBox;1800 ;0    ;3450 ;423  ;SourceExpr=GetDescripcion(rPreHab) }
            { 1103355046;TextBox;10200;0    ;1350 ;423  ;CaptionML=[ENU=Currency;
                                                                    ESP=Divisa];
                                                         SourceExpr=GetDivisa(rPreHab."C¢d. divisa") }
            { 1103355047;TextBox;0    ;0    ;1650 ;423  ;SourceExpr=rPreHab.Codigo }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=16350;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Codigo Precio" = 2);
                         END;

          }
          CONTROLS
          {
            { 55  ;TextBox      ;0    ;0    ;1200 ;423  ;SourceExpr=Codigo }
            { 56  ;TextBox      ;3450 ;0    ;2100 ;423  ;SourceExpr=FORMAT("Fecha desde") + '..' + FORMAT("Fecha hasta") }
            { 57  ;TextBox      ;8400 ;0    ;1800 ;423  ;HorzAlign=Right;
                                                         SourceExpr=Importe }
            { 58  ;TextBox      ;11850;0    ;1650 ;423  ;SourceExpr=cPro }
            { 46  ;TextBox      ;15000;0    ;1350 ;423  ;SourceExpr="N§ Persona" }
            { 62  ;TextBox      ;13650;0    ;1200 ;423  ;SourceExpr="Tipo Persona acompa¤ante" }
            { 1103355007;TextBox;1350 ;0    ;1950 ;423  ;SourceExpr=GetDescripcion(Precios) }
            { 1103355016;TextBox;10350;0    ;1350 ;423  ;CaptionML=[ENU=Currency;
                                                                    ESP=Divisa];
                                                         SourceExpr=GetDivisa("C¢d. divisa") }
            { 1103355025;TextBox;5700 ;0    ;1200 ;423  ;SourceExpr="Tipo Habitacion" }
            { 1103355033;TextBox;7050 ;0    ;1200 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT("Edad desde") + '..' + FORMAT("Edad hasta") }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=16350;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Codigo Precio" = 3);
                         END;

          }
          CONTROLS
          {
            { 51  ;TextBox      ;0    ;0    ;1650 ;423  ;SourceExpr=Codigo }
            { 52  ;TextBox      ;8100 ;0    ;2100 ;423  ;SourceExpr=FORMAT("Fecha desde") + '..' + FORMAT("Fecha hasta") }
            { 53  ;TextBox      ;10350;0    ;1800 ;423  ;HorzAlign=Right;
                                                         SourceExpr=Importe }
            { 1103355008;TextBox;1800 ;0    ;3450 ;423  ;SourceExpr=GetDescripcion(Precios) }
            { 1103355017;TextBox;12300;0    ;1350 ;423  ;CaptionML=[ENU=Currency;
                                                                    ESP=Divisa];
                                                         SourceExpr=GetDivisa("C¢d. divisa") }
            { 1103355034;TextBox;5400 ;0    ;1200 ;423  ;SourceExpr="Tipo Habitacion" }
            { 1103355035;TextBox;6750 ;0    ;1200 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT("Edad desde") + '..' + FORMAT("Edad hasta") }
            { 1103355040;TextBox;13800;0    ;1200 ;423  ;SourceExpr="Tipo Persona" }
            { 1103355041;TextBox;15150;0    ;1200 ;423  ;SourceExpr="N§ Persona" }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=16350;
            SectionHeight=1269;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Codigo Precio" >= 4);
                         END;

          }
          CONTROLS
          {
            { 20  ;TextBox      ;5400 ;0    ;2700 ;423  ;SourceExpr=FORMAT("Fecha desde") + '..' + FORMAT("Fecha hasta") }
            { 23  ;TextBox      ;0    ;0    ;1650 ;423  ;SourceExpr=Codigo }
            { 24  ;TextBox      ;5400 ;846  ;1350 ;423  ;SourceExpr=Importe }
            { 25  ;Label        ;4050 ;846  ;1200 ;423  ;ParentControl=24;
                                                         HorzAlign=Right;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Amount:;
                                                                    ESP=Importe:] }
            { 26  ;TextBox      ;6150 ;423  ;900  ;423  ;SourceExpr="Tipo Precio" }
            { 28  ;Label        ;4650 ;423  ;1350 ;423  ;ParentControl=26;
                                                         HorzAlign=Right;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=T. Price:;
                                                                    ESP=T. Precio:] }
            { 71  ;TextBox      ;3300 ;423  ;1200 ;423  ;SourceExpr="Tipo Habitacion" }
            { 72  ;Label        ;1800 ;423  ;1350 ;423  ;ParentControl=71;
                                                         HorzAlign=Right;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=T. Room:;
                                                                    ESP=T. Habit.:] }
            { 90  ;TextBox      ;14700;0    ;1200 ;423  ;SourceExpr="Tipo Regimen" }
            { 93  ;Label        ;12900;0    ;1650 ;423  ;ParentControl=90;
                                                         HorzAlign=Right;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=T. Board:;
                                                                    ESP=T. Regimen:] }
            { 94  ;TextBox      ;10200;0    ;2550 ;423  ;SourceExpr="Tipo Fechas" }
            { 95  ;Label        ;8250 ;0    ;1800 ;423  ;ParentControl=94;
                                                         HorzAlign=Right;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Dates type:;
                                                                    ESP=Tipo Fechas:] }
            { 96  ;TextBox      ;9000 ;846  ;600  ;423  ;SourceExpr=Porcentaje }
            { 97  ;Label        ;8400 ;846  ;450  ;423  ;ParentControl=96;
                                                         HorzAlign=Right;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=%:;
                                                                    ESP=%:] }
            { 98  ;TextBox      ;11250;846  ;600  ;423  ;SourceExpr="Acumular al total" }
            { 99  ;Label        ;9750 ;846  ;1350 ;423  ;ParentControl=98;
                                                         HorzAlign=Right;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Accumulate:;
                                                                    ESP=Acumular:] }
            { 100 ;TextBox      ;8850 ;423  ;750  ;423  ;SourceExpr="N§ Personas" }
            { 101 ;Label        ;7200 ;423  ;1500 ;423  ;ParentControl=100;
                                                         HorzAlign=Right;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Occupants:;
                                                                    ESP=Ocupantes:] }
            { 102 ;TextBox      ;3450 ;846  ;450  ;423  ;SourceExpr="A partir de estancias" }
            { 103 ;Label        ;1800 ;846  ;1500 ;423  ;ParentControl=102;
                                                         HorzAlign=Right;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=From:;
                                                                    ESP=A partir de:] }
            { 104 ;TextBox      ;11250;423  ;600  ;423  ;SourceExpr="N§ estancias" }
            { 105 ;Label        ;9750 ;423  ;1350 ;423  ;ParentControl=104;
                                                         HorzAlign=Right;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Stays:;
                                                                    ESP=Estancias:] }
            { 106 ;TextBox      ;15000;846  ;750  ;423  ;SourceExpr="N§ estancias a facturar" }
            { 107 ;Label        ;12000;846  ;2850 ;423  ;ParentControl=106;
                                                         HorzAlign=Right;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=N§ stays to invoice:;
                                                                    ESP=N§ estancias a facturar:] }
            { 1103355009;TextBox;1800 ;0    ;3450 ;423  ;SourceExpr=GetDescripcion(Precios) }
            { 1103355018;TextBox;6900 ;846  ;1350 ;423  ;CaptionML=[ENU=Currency;
                                                                    ESP=Divisa];
                                                         SourceExpr=GetDivisa("C¢d. divisa") }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table7009730;
        DataItemTableView=SORTING(Delegacion,N§ Contrato venta,Habitacion cupo,Fecha desde,Fecha hasta)
                          WHERE(Activo=CONST(Yes));
        NewPagePerGroup=Yes;
        GroupTotalFields=N§ Contrato venta;
        DataItemLink=Delegacion=FIELD(Delegacion),
                     N§ Contrato venta=FIELD(N§ Contrato venta);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=16350;
            SectionHeight=1692;
            OnPreSection=BEGIN
                           IF (tLiteral <> '') AND (tLiteral <> Text006) THEN
                             CurrReport.NEWPAGE;

                           tLiteral := Text006;
                         END;

          }
          CONTROLS
          {
            { 74  ;Label        ;6000 ;1269 ;1500 ;423  ;ParentControl=73;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Allotment;
                                                                    ESP=Cupo] }
            { 76  ;Label        ;7650 ;1269 ;1500 ;423  ;ParentControl=75;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 79  ;Label        ;0    ;1269 ;2250 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Code;
                                                                    ESP=Codigo] }
            { 80  ;Label        ;2400 ;1269 ;3450 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Dates;
                                                                    ESP=Fechas] }
            { 8   ;TextBox      ;0    ;423  ;7050 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=tLiteral }
            { 1103355021;Shape  ;0    ;846  ;16350;423  ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=16350;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 67  ;TextBox      ;0    ;0    ;2250 ;423  ;SourceExpr="Habitacion cupo" }
            { 69  ;TextBox      ;2400 ;0    ;3450 ;423  ;SourceExpr=FORMAT("Fecha desde") + '..' + FORMAT("Fecha hasta") }
            { 73  ;TextBox      ;6000 ;0    ;1500 ;423  ;SourceExpr=Cupo }
            { 75  ;TextBox      ;7650 ;0    ;1500 ;423  ;SourceExpr=Release }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table7009732;
        DataItemTableView=SORTING(Delegacion,N§ Contrato,Codigo Precio,Orden Precio)
                          WHERE(Activo=CONST(Yes),
                                Codigo Precio=FILTER(Suplementos|Extras|Ofertas|AxB));
        DataItemVarName=Precios2;
        OnAfterGetRecord=BEGIN
                           CLEAR(cPro);

                           IF Porcentaje THEN
                             cPro := Text007;
                         END;

        GroupTotalFields=Codigo Precio;
        DataItemLink=Delegacion=FIELD(Delegacion),
                     N§ Contrato=FIELD(N§ Contrato venta);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=16350;
            SectionHeight=1269;
            OnPreSection=BEGIN
                           IF (tLiteral <> '') THEN
                             CurrReport.NEWPAGE;

                           CASE "Codigo Precio" OF
                             0: tLiteral := Text008; //Text009;
                             1: tLiteral := Text010;
                             2: tLiteral := Text011;
                             3: tLiteral := Text012;     //Text013;
                             4: tLiteral := Text014;    //Text015;
                             5: tLiteral := Text016;
                           END;
                         END;

          }
          CONTROLS
          {
            { 1103355106;TextBox;0    ;423  ;6750 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=tLiteral }
            { 1103355107;Shape  ;0    ;846  ;16350;423  ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=16350;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Codigo Precio" = 2);
                         END;

          }
          CONTROLS
          {
            { 1103355108;Label  ;0    ;0    ;1200 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Code;
                                                                    ESP=Codigo] }
            { 1103355109;Label  ;1350 ;0    ;1950 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Description;
                                                                    ESP=Descripci¢n] }
            { 1103355110;Label  ;3450 ;0    ;2100 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Dates;
                                                                    ESP=Fechas] }
            { 1103355111;Label  ;5700 ;0    ;1200 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Room Code;
                                                                    ESP=Cod. Hab.] }
            { 1103355112;Label  ;7050 ;0    ;1200 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Ages;
                                                                    ESP=Edades] }
            { 1103355113;Label  ;8400 ;0    ;1800 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Amount;
                                                                    ESP=Importe] }
            { 1103355114;Label  ;10350;0    ;1350 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Currency;
                                                                    ESP=Divisa] }
            { 1103355115;Label  ;11850;0    ;1650 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Accum Factor;
                                                                    ESP=Factor Acum.] }
            { 1103355116;Label  ;13650;0    ;1200 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Companion type;
                                                                    ESP=Tipo Acompa¤ante] }
            { 1103355117;Label  ;15000;0    ;1350 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Person No.;
                                                                    ESP=N§ Persona] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=16350;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Codigo Precio" = 3);
                         END;

          }
          CONTROLS
          {
            { 1103355118;Label  ;0    ;0    ;1650 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Code;
                                                                    ESP=Codigo] }
            { 1103355119;Label  ;1800 ;0    ;3450 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Description;
                                                                    ESP=Descripci¢n] }
            { 1103355120;Label  ;5400 ;0    ;1200 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Room Code;
                                                                    ESP=Cod. Hab.] }
            { 1103355121;Label  ;6750 ;0    ;1200 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Ages;
                                                                    ESP=Edades] }
            { 1103355122;Label  ;8100 ;0    ;2100 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Dates;
                                                                    ESP=Fechas] }
            { 1103355123;Label  ;10350;0    ;1800 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Amount;
                                                                    ESP=Importe] }
            { 1103355124;Label  ;12300;0    ;1350 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Currency;
                                                                    ESP=Divisa] }
            { 1103355125;Label  ;13800;0    ;1200 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Person type;
                                                                    ESP=Tipo Persona] }
            { 1103355126;Label  ;15150;0    ;1200 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Person No.;
                                                                    ESP=N§ Persona] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=16350;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Codigo Precio" >= 4);
                         END;

          }
          CONTROLS
          {
            { 1103355127;Label  ;0    ;0    ;1650 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Code;
                                                                    ESP=Codigo] }
            { 1103355128;Label  ;1800 ;0    ;3450 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Description;
                                                                    ESP=Descripci¢n] }
            { 1103355129;Label  ;5400 ;0    ;2700 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Dates;
                                                                    ESP=Fechas] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=16350;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Codigo Precio" = 2);
                         END;

          }
          CONTROLS
          {
            { 1103355130;TextBox;15000;0    ;1350 ;423  ;SourceExpr="N§ Persona" }
            { 1103355131;TextBox;13650;0    ;1200 ;423  ;SourceExpr="Tipo Persona acompa¤ante" }
            { 1103355132;TextBox;11850;0    ;1650 ;423  ;SourceExpr=cPro }
            { 1103355133;TextBox;10350;0    ;1350 ;423  ;CaptionML=[ENU=Currency;
                                                                    ESP=Divisa];
                                                         SourceExpr=GetDivisa("C¢d. divisa") }
            { 1103355134;TextBox;8400 ;0    ;1800 ;423  ;HorzAlign=Right;
                                                         SourceExpr=Importe }
            { 1103355135;TextBox;7050 ;0    ;1200 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT("Edad desde") + '..' + FORMAT("Edad hasta") }
            { 1103355136;TextBox;5700 ;0    ;1200 ;423  ;SourceExpr="Tipo Habitacion" }
            { 1103355137;TextBox;3450 ;0    ;2100 ;423  ;SourceExpr=FORMAT("Fecha desde") + '..' + FORMAT("Fecha hasta") }
            { 1103355138;TextBox;1350 ;0    ;1950 ;423  ;SourceExpr=GetDescripcion(Precios2) }
            { 1103355139;TextBox;0    ;0    ;1200 ;423  ;SourceExpr=Codigo }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=16350;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Codigo Precio" = 3);
                         END;

          }
          CONTROLS
          {
            { 1103355140;TextBox;15150;0    ;1200 ;423  ;SourceExpr="N§ Persona" }
            { 1103355141;TextBox;13800;0    ;1200 ;423  ;SourceExpr="Tipo Persona" }
            { 1103355142;TextBox;12300;0    ;1350 ;423  ;CaptionML=[ENU=Currency;
                                                                    ESP=Divisa];
                                                         SourceExpr=GetDivisa("C¢d. divisa") }
            { 1103355143;TextBox;10350;0    ;1800 ;423  ;HorzAlign=Right;
                                                         SourceExpr=Importe }
            { 1103355144;TextBox;8100 ;0    ;2100 ;423  ;SourceExpr=FORMAT("Fecha desde") + '..' + FORMAT("Fecha hasta") }
            { 1103355145;TextBox;6750 ;0    ;1200 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT("Edad desde") + '..' + FORMAT("Edad hasta") }
            { 1103355146;TextBox;5400 ;0    ;1200 ;423  ;SourceExpr="Tipo Habitacion" }
            { 1103355147;TextBox;1800 ;0    ;3450 ;423  ;SourceExpr=GetDescripcion(Precios2) }
            { 1103355148;TextBox;0    ;0    ;1650 ;423  ;SourceExpr=Codigo }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=16350;
            SectionHeight=1269;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Codigo Precio" >= 4);
                         END;

          }
          CONTROLS
          {
            { 1103355149;TextBox;15000;846  ;750  ;423  ;SourceExpr="N§ estancias a facturar" }
            { 1103355150;Label  ;12000;846  ;2850 ;423  ;ParentControl=1103355149;
                                                         HorzAlign=Right;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=N§ stays to invoice:;
                                                                    ESP=N§ estancias a facturar:] }
            { 1103355151;TextBox;11250;846  ;600  ;423  ;SourceExpr="Acumular al total" }
            { 1103355152;Label  ;9750 ;846  ;1350 ;423  ;ParentControl=1103355151;
                                                         HorzAlign=Right;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Accumulate:;
                                                                    ESP=Acumular:] }
            { 1103355153;TextBox;9000 ;846  ;600  ;423  ;SourceExpr=Porcentaje }
            { 1103355154;TextBox;8850 ;423  ;750  ;423  ;SourceExpr="N§ Personas" }
            { 1103355155;TextBox;11250;423  ;600  ;423  ;SourceExpr="N§ estancias" }
            { 1103355156;Label  ;9750 ;423  ;1350 ;423  ;ParentControl=1103355155;
                                                         HorzAlign=Right;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Stays:;
                                                                    ESP=Estancias:] }
            { 1103355157;Label  ;8400 ;846  ;450  ;423  ;ParentControl=1103355153;
                                                         HorzAlign=Right;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=%:;
                                                                    ESP=%:] }
            { 1103355158;Label  ;7200 ;423  ;1500 ;423  ;ParentControl=1103355154;
                                                         HorzAlign=Right;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Occupants:;
                                                                    ESP=Ocupantes:] }
            { 1103355159;TextBox;6900 ;846  ;1350 ;423  ;CaptionML=[ENU=Currency;
                                                                    ESP=Divisa];
                                                         SourceExpr=GetDivisa("C¢d. divisa") }
            { 1103355160;TextBox;6150 ;423  ;900  ;423  ;SourceExpr="Tipo Precio" }
            { 1103355161;TextBox;5400 ;846  ;1350 ;423  ;SourceExpr=Importe }
            { 1103355162;TextBox;5400 ;0    ;2700 ;423  ;SourceExpr=FORMAT("Fecha desde") + '..' + FORMAT("Fecha hasta") }
            { 1103355163;Label  ;4650 ;423  ;1350 ;423  ;ParentControl=1103355160;
                                                         HorzAlign=Right;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=T. Price:;
                                                                    ESP=T. Precio:] }
            { 1103355164;TextBox;14700;0    ;1200 ;423  ;SourceExpr="Tipo Regimen" }
            { 1103355165;Label  ;12900;0    ;1650 ;423  ;ParentControl=1103355164;
                                                         HorzAlign=Right;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=T. Board:;
                                                                    ESP=T. Regimen:] }
            { 1103355166;TextBox;10200;0    ;2550 ;423  ;SourceExpr="Tipo Fechas" }
            { 1103355167;Label  ;8250 ;0    ;1800 ;423  ;ParentControl=1103355166;
                                                         HorzAlign=Right;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Dates type:;
                                                                    ESP=Tipo Fechas:] }
            { 1103355168;Label  ;4050 ;846  ;1200 ;423  ;ParentControl=1103355161;
                                                         HorzAlign=Right;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Amount:;
                                                                    ESP=Importe:] }
            { 1103355169;TextBox;1800 ;0    ;3450 ;423  ;SourceExpr=GetDescripcion(Precios2) }
            { 1103355170;TextBox;3300 ;423  ;1200 ;423  ;SourceExpr="Tipo Habitacion" }
            { 1103355171;TextBox;3450 ;846  ;450  ;423  ;SourceExpr="A partir de estancias" }
            { 1103355172;Label  ;1800 ;846  ;1500 ;423  ;ParentControl=1103355171;
                                                         HorzAlign=Right;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=From:;
                                                                    ESP=A partir de:] }
            { 1103355173;Label  ;1800 ;423  ;1350 ;423  ;ParentControl=1103355170;
                                                         HorzAlign=Right;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=T. Room:;
                                                                    ESP=T. Habit.:] }
            { 1103355174;TextBox;0    ;0    ;1650 ;423  ;SourceExpr=Codigo }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=Disclaimer;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Footer;
            PlaceInBottom=Yes;
            SectionWidth=16350;
            SectionHeight=21996;
            KeepWithNext=No;
          }
          CONTROLS
          {
            { 1103355006;Label  ;450  ;2115 ;1950 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Comments;
                                                                    ESP=Observaciones] }
            { 1103355015;Shape  ;600  ;2961 ;15450;423  ;ShapeStyle=HorzLine }
            { 1103355050;Shape  ;600  ;3807 ;15450;423  ;ShapeStyle=HorzLine }
            { 1103355051;Shape  ;600  ;4653 ;15450;423  ;ShapeStyle=HorzLine }
            { 1103355052;Shape  ;600  ;5499 ;15450;423  ;ShapeStyle=HorzLine }
            { 1103355053;Shape  ;600  ;6345 ;15450;423  ;ShapeStyle=HorzLine }
            { 1103355054;Label  ;150  ;8037 ;1950 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Meal Board;
                                                                    ESP=Regimen Alimenticio] }
            { 1103355055;Label  ;900  ;8883 ;1500 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Breakfast:;
                                                                    ESP=Desayuno:] }
            { 1103355056;Shape  ;2400 ;8883 ;13350;423  ;ShapeStyle=HorzLine }
            { 1103355057;Label  ;600  ;8883 ;300  ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=O;
                                                                    ESP=O] }
            { 1103355058;Label  ;1500 ;9306 ;300  ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=O;
                                                                    ESP=O] }
            { 1103355059;Label  ;1800 ;9306 ;1500 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Continental;
                                                                    ESP=Continental] }
            { 1103355060;Label  ;4050 ;9306 ;300  ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=O;
                                                                    ESP=O] }
            { 1103355061;Label  ;4350 ;9306 ;3000 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Special Breakfast;
                                                                    ESP=Desayuno especial] }
            { 1103355062;Label  ;8400 ;9306 ;300  ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=O;
                                                                    ESP=O] }
            { 1103355063;Label  ;8700 ;9306 ;2700 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Breakfast Buffet;
                                                                    ESP=Buffet de desayuno] }
            { 1103355064;Label  ;600  ;10152;300  ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=O;
                                                                    ESP=O] }
            { 1103355065;Label  ;900  ;10152;1350 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Lunch;
                                                                    ESP=Almuerzo] }
            { 1103355066;Shape  ;2400 ;10152;13350;423  ;ShapeStyle=HorzLine }
            { 1103355067;Label  ;1500 ;10575;300  ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=O;
                                                                    ESP=O] }
            { 1103355068;Label  ;1800 ;10575;2250 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Service to Table;
                                                                    ESP=Servicio a la mesa] }
            { 1103355069;Label  ;4350 ;10575;300  ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=O;
                                                                    ESP=O] }
            { 1103355070;Label  ;4650 ;10575;3750 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Full Buffet Hot and Cold;
                                                                    ESP=Buffet completo caliente y fr¡o] }
            { 1103355071;Label  ;8550 ;10575;300  ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=O;
                                                                    ESP=O] }
            { 1103355072;Label  ;8850 ;10575;6900 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=A la Carte;
                                                                    ESP=Elecci¢n de men£ con buffet de entremeses y de postre] }
            { 1103355073;Label  ;600  ;11421;300  ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=O;
                                                                    ESP=O] }
            { 1103355074;Label  ;900  ;11421;900  ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Dinner;
                                                                    ESP=Cena] }
            { 1103355075;Shape  ;1950 ;11421;13800;423  ;ShapeStyle=HorzLine }
            { 1103355076;Label  ;1500 ;11844;300  ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=O;
                                                                    ESP=O] }
            { 1103355077;Label  ;1800 ;11844;2250 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Service to Table;
                                                                    ESP=Servicio a la mesa] }
            { 1103355078;Label  ;4350 ;11844;300  ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=O;
                                                                    ESP=O] }
            { 1103355079;Label  ;4650 ;11844;3750 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Full Buffet Hot and Cold;
                                                                    ESP=Buffet completo caliente y fr¡o] }
            { 1103355080;Label  ;8550 ;11844;300  ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=O;
                                                                    ESP=O] }
            { 1103355081;Label  ;8850 ;11844;6900 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=A la Carte;
                                                                    ESP=Elecci¢n de men£ con buffet de entremeses y de postre] }
            { 1103355082;Label  ;900  ;12690;3750 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Half board included:;
                                                                    ESP=Media pensi¢n compuesto de:] }
            { 1103355083;Shape  ;4800 ;12690;10950;423  ;ShapeStyle=HorzLine }
            { 1103355084;Label  ;600  ;12690;300  ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=O;
                                                                    ESP=O] }
            { 1103355085;Label  ;1500 ;13113;300  ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=O;
                                                                    ESP=O] }
            { 1103355086;Label  ;1800 ;13113;1500 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Breakfast;
                                                                    ESP=Desayuno] }
            { 1103355087;Label  ;4200 ;13113;300  ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=O;
                                                                    ESP=O] }
            { 1103355088;Label  ;4500 ;13113;1500 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Lunch;
                                                                    ESP=Almuerzo] }
            { 1103355089;Label  ;7050 ;13113;300  ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=O;
                                                                    ESP=O] }
            { 1103355090;Label  ;7350 ;13113;750  ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Dinner;
                                                                    ESP=Cena] }
            { 1103355091;Label  ;900  ;13959;900  ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Others:;
                                                                    ESP=Otros:] }
            { 1103355092;Shape  ;1950 ;13959;13800;423  ;ShapeStyle=HorzLine }
            { 1103355093;Label  ;600  ;13959;300  ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=O;
                                                                    ESP=O] }
            { 1103355094;Label  ;1800 ;14382;2700 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Welcome Drink;
                                                                    ESP=Bebida de bienvenida] }
            { 1103355095;Label  ;5400 ;14382;300  ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=O;
                                                                    ESP=O] }
            { 1103355096;Label  ;5700 ;14382;3750 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=House Wine Included;
                                                                    ESP=Vino de mesa incluido] }
            { 1103355097;Label  ;1500 ;14382;300  ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=O;
                                                                    ESP=O] }
            { 1103355098;Label  ;900  ;16497;1650 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Signed In;
                                                                    ESP=Firmado en] }
            { 1103355099;Shape  ;9600 ;17343;3000 ;423  ;ShapeStyle=HorzLine }
            { 1103355100;Shape  ;12750;17343;3000 ;423  ;ShapeStyle=HorzLine }
            { 1103355101;Shape  ;6450 ;17343;3000 ;423  ;ShapeStyle=HorzLine }
            { 1103355102;Label  ;5700 ;17343;600  ;423  ;HorzAlign=General;
                                                         VertAlign=Top;
                                                         CaptionML=[ENU=, the;
                                                                    ESP=, el] }
            { 1103355103;Shape  ;750  ;17343;4800 ;423  ;ShapeStyle=HorzLine }
            { 1103355104;Label  ;12750;17766;3000 ;423  ;HorzAlign=Center;
                                                         CaptionML=[ENU=Go Caribic, S.A.;
                                                                    ESP=Go Caribic, S.A.] }
            { 1103355105;Label  ;9600 ;17766;3000 ;423  ;HorzAlign=Center;
                                                         CaptionML=[ENU=Travel Co.;
                                                                    ESP=Parte Contratante] }
            { 1103355175;Label  ;0    ;19458;16350;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Helvetica;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Legal Reserve;
                                                                    ESP=Reserva Legal] }
            { 1103355176;Shape  ;0    ;19881;16350;2115  }
            { 1103355048;Label  ;150  ;19881;15750;1692 ;HorzAlign=Center;
                                                         VertAlign=Center;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=These rates are intended exclusively for its addressee. It contains information that is CONFIDENTIAL and protected by a professional privilege or whose disclosure is prohibited by law. If this information has been received in error, you should know that it is forbidden to copy or use it. Please immediately notify us via e-mail and delete it.;
                                                                    ESP=Estas tarifas se dirigen exclusivamente a su destinatario. Contiene informaci¢n CONFIDENCIAL sometida a secreto profesional y su divulgaci¢n esta prohibida por ley. Si ha conseguido estas tarifas por error, su copia y uso est n prohibidos, rog ndole que nos lo comunique inmediatamente por esta misma v¡a y proceda a su destrucci¢n.] }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
      CaptionML=[ENU=Contract sale Hotel For. Merch.;
                 ESP=Contrato Venta Hotel For.Cial.];
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text000@1103355006 : TextConst 'ENU=There is any company;ESP=No hay ninguna empresa';
      Text001@1103355007 : TextConst 'ENU=Agency parameters do not exist;ESP=No existen par metros de agencia';
      Text002@1103355008 : TextConst 'ENU=Date:;ESP=Fecha:';
      Text003@1103355009 : TextConst 'ENU=Contract:;ESP=Contrato:';
      Text004@1103355010 : TextConst 'ENU=page;ESP=P gina';
      Text005@1103355011 : TextConst 'ENU=Client:;ESP=Cliente:';
      Text006@1103355012 : TextConst 'ENU=Allotment and Release;ESP=Cupos y Release';
      Text007@1103355013 : TextConst 'ENU=% Accumulate;ESP=% Acumula';
      Text008@1103355014 : TextConst 'ENU=Accomodation Rates and day;ESP=Precios en alojamiento y d¡a';
      Text009@1103355015 : TextConst 'ENU=Rates per Room;ESP=Precios por habitaci¢n';
      Text010@1103355016 : TextConst 'ENU=Rates per Board;ESP=Precios por rgimen';
      Text011@1103355017 : TextConst 'ENU=Surcharges per person and day;ESP=Suplementos por persona y d¡a';
      Text012@1103355018 : TextConst 'ENU=Extras per person and day;ESP=Extras por persona y d¡a';
      Text013@1103355019 : TextConst 'ENU=Extras Purchase;ESP=Extras compra';
      Text014@1103355020 : TextConst 'ENU=Offers per person and day;ESP=Ofertas por persona y d¡a';
      Text015@1103355021 : TextConst 'ENU=Purchase Offers;ESP=Ofertas compra';
      Text016@1103355022 : TextConst 'ENU=Offers AxB;ESP=Ofertas AxB';
      rEmpresa@1103355000 : Record 79;
      rDelegacion@1103355001 : Record 7009700;
      rHotel@1103355002 : Record 7009724;
      rConf@1103355023 : Record 98;
      InfoEmpresa@1103355024 : Record 79;
      fNoms@1103355003 : Codeunit 7009702;
      cPro@1103355004 : Code[10];
      tLiteral@1103355005 : Text[30];
      rPreHab@1103355025 : Record 7009732;
      wIniPreHab@1103355026 : Boolean;

    PROCEDURE GetDescripcion@1103355002(prPre@1103355000 : Record 7009732) : Text[60];
    VAR
      lwText@1103355001 : Text[60];
      lrReg@1103355002 : Record 7009712;
      lrConHab@1103355003 : Record 7009731;
      lrTipoEle@1103355004 : Record 7009715;
      lrCodExt@1103355005 : Record 7009760;
      lrOfert@1103355006 : Record 7009996;
    BEGIN
      // GetDescripcion

      CLEAR(lwText);
      CASE prPre."Codigo Precio" OF
        prPre."Codigo Precio"::Regimen: BEGIN
          CLEAR(lrReg);
          IF lrReg.GET(prPre.Codigo) THEN
            lwText := lrReg.Descripcion;
        END;
        prPre."Codigo Precio"::Habitacion: BEGIN
          CLEAR(lrConHab);
          lrConHab.SETRANGE(Delegacion       , prPre.Delegacion);
          lrConHab.SETRANGE("N§ Contrato"    , prPre."N§ Contrato");
          lrConHab.SETRANGE("Tipo contrato"  , lrConHab."Tipo contrato"::Venta);
          lrConHab.SETRANGE("Habitacion cupo", prPre.Codigo);
          IF lrConHab.FIND('-') THEN
            lwText := lrConHab.Descripcion;
        END;
        prPre."Codigo Precio"::Suplementos: BEGIN
          CLEAR(lrTipoEle);
          lrTipoEle.SETRANGE(Humano, TRUE);
          lrTipoEle.SETRANGE("Tipo elemento", prPre.Codigo);
          IF lrTipoEle.FIND('-') THEN
            lwText := lrTipoEle.Descripcion;
        END;
        prPre."Codigo Precio"::Extras: BEGIN
          CLEAR(lrCodExt);
          IF lrCodExt.GET(prPre.Codigo) THEN
            lwText := lrCodExt.Descripcion;
        END;
        prPre."Codigo Precio"::Ofertas: BEGIN
          CLEAR(lrOfert);
          IF lrOfert.GET(prPre.Codigo) THEN
            lwText := lrOfert.Descripcion;
        END;
      END;

      EXIT(lwText);
    END;

    PROCEDURE GetDivisa@1103355000(pwCod@1103355000 : Code[10]) : Code[10];
    BEGIN
      // GetDivisa

      IF pwCod='' THEN
        pwCod := rConf."LCY Code";

      EXIT(pwCod);
    END;

    LOCAL PROCEDURE FiltrarPreciosHabitacion@1103355001();
    BEGIN
      // FiltrarPreciosHabitacion
      // Ordenamos y filtramos los precios de habitaci¢n con una clave distinta al resto del informe.

      rPreHab.RESET;
      rPreHab.SETCURRENTKEY(Delegacion, "N§ Contrato", "Codigo Precio", Codigo,
                            "Fecha desde", "Fecha hasta", "Edad desde", "Edad hasta");

      rPreHab.COPYFILTERS(Precios);
      rPreHab.SETRANGE("Codigo Precio", rPreHab."Codigo Precio"::Habitacion);

      wIniPreHab := FALSE;
    END;

    PROCEDURE NextPrecioHabitacion@1103355009();
    BEGIN
      // NextPrecioHabitacion

      IF NOT wIniPreHab THEN BEGIN
        // **OJO** No deberia dar error ya que el n£mero de registros es el mismo que en el bucle de precios.
        rPreHab.FINDSET;
        wIniPreHab := TRUE;
      END
      ELSE BEGIN
        rPreHab.NEXT;
      END;
    END;

    BEGIN
    {
      ## AJS 05.02.2010

        .- Amplio el retorno de la funcion GetDescripcion a 60 caracteres
    }
    END.
  }
  RDLDATA
  {
  }
}
