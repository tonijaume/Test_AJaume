OBJECT Report 7009753 Com. Reserva Hotel Venta2
{
  OBJECT-PROPERTIES
  {
    Date=02/10/12;
    Time=12:00:00;
    Modified=Yes;
    Version List=AIC2009;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Communication 2Sale Hotel Res.;
               ESP=Comunicaci¢n Res. Hotel Venta2];
    OnInitReport=BEGIN
                   IF NOT rInfEmp.FIND('-') THEN
                     ERROR(Text000);
                   IF NOT rPar.FIND('-') THEN
                     ERROR(Text001);

                   FormatDire.Company(DirEmpresa,rInfEmp);

                   {
                   cmpEnvio:=rPar."Ultimo n§ envio hotel";

                   CLEAR(vCadTour);
                   CLEAR(vCadFec);
                   }
                   CLEAR(vNumPag);
                 END;

    OnPreReport=BEGIN
                  Preli := CurrReport.PREVIEW;
                  ImpresoAlgo := FALSE;
                END;

    OnPostReport=BEGIN
                   ImpresoAlgo := TRUE;
                   {
                   IF ("Reserva Hotel"."N§ envio hotel" = 0) AND (vNumPag > 0) THEN BEGIN
                     rEnvios.INIT;
                     rEnvios."Num. Envio"    := cmpEnvio;
                     rEnvios.Fecha           := TODAY;
                     rEnvios.Hora            := TIME;
                     rEnvios.Usuario         := USERID;
                     rEnvios.Hotel           := "Reserva Hotel"."Hotel booking";
                     rEnvios.Paginas         := vNumPag;
                     rEnvios."Fecha entrada" := vCadFec;
                     rEnvios."Nombre Hotel"  := cNombre.nom_hotel("Reserva Hotel"."Hotel booking");
                     rEnvios.TourOperador    := vCadTour;
                     rEnvios.INSERT;
                     IF rPar.FIND('-') THEN BEGIN
                       rPar."Ultimo n§ envio hotel" := rPar."Ultimo n§ envio hotel" + 1;
                       rPar.MODIFY;
                     END;
                   END;
                   }
                 END;

    Orientation=Landscape;
    PaperSize=Letter 8 1/2 x 11 in;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        MaxIteration=1;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=24150;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 2   ;TextBox      ;0    ;0    ;8250 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=rInfEmp.Name }
            { 3   ;Label        ;19200;0    ;4950 ;423  ;HorzAlign=Right;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Bookings communication;
                                                                    ESP=Comunicaci¢n Reservas] }
            { 43  ;TextBox      ;0    ;846  ;14700;423  ;FontSize=9;
                                                         SourceExpr=DirEmpresa[2]+' '+DirEmpresa[3]+' '+DirEmpresa[4] }
            { 27  ;TextBox      ;21840;846  ;2310 ;423  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         CaptionML=[ENU=No. Fax 1;
                                                                    ESP=N§ Fax 1];
                                                         SourceExpr=rInfEmp."Fax No." }
            { 24  ;Label        ;18450;846  ;3300 ;423  ;ParentControl=27;
                                                         HorzAlign=Left;
                                                         FontSize=9;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=No. Fax BOOKINGS;
                                                                    ESP=N§ Fax RESERVAS] }
            { 1   ;Shape        ;0    ;1269 ;24150;423  ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=24150;
            SectionHeight=1692;
            OnPostSection=BEGIN
                            vNumPag     := CurrReport.PAGENO;
                          END;

          }
          CONTROLS
          {
            { 21  ;Label        ;0    ;0    ;24150;846  ;HorzAlign=Center;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Please confirm these bookings by the same way;
                                                                    ESP=Favor confirmar estas reservas por esta misma v¡a] }
            { 10  ;TextBox      ;23550;1269 ;600  ;423  ;HorzAlign=Right;
                                                         FontSize=10;
                                                         SourceExpr=CurrReport.PAGENO }
            { 13  ;Label        ;22200;1269 ;1350 ;423  ;ParentControl=10;
                                                         VertAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=page;
                                                                    ESP=P gina] }
            { 16  ;TextBox      ;10050;1269 ;5550 ;423  ;FontSize=10;
                                                         SourceExpr=FORMAT(TODAY,0,4)+' '+FORMAT(TIME,5)+' ('+USERID+')' }
            { 7   ;TextBox      ;0    ;1269 ;6450 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=cNombre.nom_delegacion(rPar.Delegacion) }
            { 6   ;Shape        ;0    ;846  ;24150;423  ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table7009743;
        DataItemTableView=SORTING(N§ envio hotel,Hotel booking,Hotel TO,TourOperador Venta,Fecha entrada,Fecha salida)
                          WHERE(Responsable=CONST(Yes));
        OnPreDataItem=BEGIN
                        NuevoHotel := FALSE;
                        wPrimerGrupo := TRUE;
                      END;

        OnAfterGetRecord=BEGIN
                           IF NuevoHotel THEN BEGIN
                             IF rEnvios.GET(cmpEnvio, Hotel) THEN BEGIN
                               rEnvios.Fecha   := TODAY;
                               rEnvios.Hora    := TIME;
                               rEnvios.Usuario := USERID;
                               rEnvios.Paginas := CurrReport.PAGENO;
                               rEnvios.MODIFY;
                             END;
                             NuevoHotel := FALSE;
                             CLEAR(TabHabitacion);
                             CLEAR(TabRegimen);
                           END;

                           cmpEnvio := "N§ envio hotel";
                           Hotel := "Hotel booking";
                           IF rPar."Codigos comunicar hotel" = rPar."Codigos comunicar hotel"::Propios THEN BEGIN
                             w_habitacion := Habitacion;

                             rHab.RESET;
                             rHab.SETRANGE(Delegacion       , Delegacion);
                             rHab.SETRANGE("N§ Contrato"    , "Contrato compra");
                             rHab.SETRANGE("Tipo contrato"  , rHab."Tipo contrato"::Compra);
                             rHab.SETRANGE("Habitacion cupo", w_habitacion);
                             IF rHab.FIND('-') THEN
                               wTextHabitacion := rHab.Descripcion
                             ELSE
                               wTextHabitacion := '';

                             w_regimen := Regimen;
                           END
                           ELSE BEGIN
                             IF "Habitacion TO" <> '' THEN BEGIN
                               w_habitacion := "Habitacion TO";

                               rHab.RESET;
                               rHab.SETRANGE(Delegacion     , Delegacion);
                               rHab.SETRANGE("N§ Contrato"  , "Contrato compra");
                               rHab.SETRANGE("Tipo contrato", rHab."Tipo contrato"::Compra);
                               rHab.SETRANGE("Habitacion TO", w_habitacion);
                               IF rHab.FIND('-') THEN
                                 wTextHabitacion := rHab.Descripcion
                               ELSE
                                 wTextHabitacion := '';
                             END
                             ELSE BEGIN
                               w_habitacion := Habitacion;

                               rHab.RESET;
                               rHab.SETRANGE(Delegacion       , Delegacion);
                               rHab.SETRANGE("N§ Contrato"    , "Contrato compra");
                               rHab.SETRANGE("Tipo contrato"  , rHab."Tipo contrato"::Compra);
                               rHab.SETRANGE("Habitacion cupo", w_habitacion);
                               IF rHab.FIND('-') THEN
                                 wTextHabitacion := rHab.Descripcion
                               ELSE
                                 wTextHabitacion := '';
                             END;

                             IF "Regimen TO" <> '' THEN
                               w_regimen := "Regimen TO"
                             ELSE
                               w_regimen := Regimen;
                           END;

                           // AJS 05.12.2033
                           // Buscar el hotel Touroperador para mostrar el nombre

                           rHotelTO.RESET;
                           rHotelTO.SETRANGE(TourOperador        , TourOperador);
                           rHotelTO.SETRANGE("Touroperador venta", "TourOperador Venta");
                           rHotelTO.SETRANGE("Hotel TO"          , "Hotel TO");
                           IF rHotelTO.FINDFIRST THEN
                             wNomHotelTO := rHotelTO."Nombre hotel TO"
                           ELSE BEGIN
                             rHotelTO.SETRANGE("Touroperador venta", '');
                             IF rHotelTO.FINDFIRST THEN
                               wNomHotelTO := rHotelTO."Nombre hotel TO"
                             ELSE
                               wNomHotelTO := '';
                           END;

                           // Rellenar las matrices de habitaciones y regimenes

                           BuscaHabitacion;
                           BuscaRegimen;
                         END;

        OnPostDataItem=BEGIN
                         IF NuevoHotel THEN BEGIN
                           IF rEnvios.GET(cmpEnvio, Hotel) THEN BEGIN
                             rEnvios.Fecha   := TODAY;
                             rEnvios.Hora    := TIME;
                             rEnvios.Usuario := USERID;
                             rEnvios.Paginas := vNumPag;
                             rEnvios.MODIFY;
                           END;
                           NuevoHotel := FALSE;
                         END;
                       END;

        GroupTotalFields=Hotel booking,Hotel TO,TourOperador Venta,Fecha entrada;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=24150;
            SectionHeight=2115;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(wPrimerGrupo);
                           //CurrReport.SHOWOUTPUT(CurrReport.TOTALSCAUSEDBY = FIELDNO("Reserva Hotel"."Fecha entrada"));
                         END;

            OnPostSection=BEGIN
                            wPrimerGrupo := FALSE;
                          END;

          }
          CONTROLS
          {
            { 77  ;Label        ;9750 ;0    ;2850 ;423  ;ParentControl=76;
                                                         HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes }
            { 78  ;TextBox      ;3000 ;423  ;6150 ;423  ;FontSize=10;
                                                         SourceExpr=cNombre.nom_touroperador("Reserva Hotel"."TourOperador Venta") }
            { 79  ;Label        ;0    ;423  ;2850 ;423  ;VertAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=TourOperator;
                                                                    ESP=TourOperador] }
            { 80  ;Label        ;0    ;1269 ;2100 ;846  ;VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Voucher;
                                                                    ESP=Bono] }
            { 82  ;Label        ;2250 ;1269 ;2250 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Rooms;
                                                                    ESP=Habitaciones] }
            { 83  ;Label        ;4650 ;1269 ;900  ;846  ;VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Reg.;
                                                                    ESP=Reg.] }
            { 85  ;Label        ;5700 ;1269 ;900  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Days;
                                                                    ESP=Dias] }
            { 86  ;Label        ;17100;1269 ;1650 ;846  ;VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Sale date;
                                                                    ESP=Fecha venta] }
            { 87  ;Label        ;8550 ;1269 ;5700 ;846  ;VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Name;
                                                                    ESP=Nombre] }
            { 88  ;Label        ;14400;1269 ;900  ;846  ;VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Age;
                                                                    ESP=Edad] }
            { 91  ;Label        ;6750 ;1269 ;1650 ;846  ;VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Check-out Date;
                                                                    ESP=Fecha salida] }
            { 93  ;TextBox      ;3000 ;0    ;6150 ;423  ;FontSize=10;
                                                         SourceExpr=cNombre.nom_hotel("Reserva Hotel"."Hotel booking") }
            { 94  ;Label        ;0    ;0    ;2850 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Hotel;
                                                                    ESP=Hotel] }
            { 95  ;Label        ;20700;0    ;1800 ;423  ;ParentControl=96;
                                                         VertAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Delivery;
                                                                    ESP=Envio] }
            { 96  ;TextBox      ;22650;0    ;1500 ;423  ;FontSize=10;
                                                         SourceExpr=cmpEnvio }
            { 97  ;Label        ;15450;1269 ;1500 ;846  ;VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Person type;
                                                                    ESP=Tipo Persona] }
            { 76  ;TextBox      ;12750;0    ;1650 ;423  ;FontSize=10;
                                                         SourceExpr="Fecha entrada" }
            { 12  ;Label        ;18900;1269 ;3150 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Hotel No confirmation;
                                                                    ESP=Num confirmacion hotel] }
            { 29  ;TextBox      ;3000 ;846  ;6150 ;423  ;FontSize=10;
                                                         SourceExpr=wNomHotelTO }
            { 34  ;Label        ;0    ;846  ;2850 ;423  ;VertAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Hotel TTOO;
                                                                    ESP=Hotel TTOO] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=24150;
            SectionHeight=0;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(FALSE);

                           IF CurrReport.TOTALSCAUSEDBY = "Reserva Hotel".FIELDNO("Hotel booking") THEN
                             CurrReport.PAGENO := 1;
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=24150;
            SectionHeight=2115;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT( ((CurrReport.TOTALSCAUSEDBY = FIELDNO("Reserva Hotel"."Fecha entrada")) OR
                                                   (CurrReport.TOTALSCAUSEDBY = FIELDNO("Reserva Hotel"."TourOperador Venta")) OR
                                                   (CurrReport.TOTALSCAUSEDBY = FIELDNO("Reserva Hotel"."Hotel TO"))) AND wPrimerGrupo);
                         END;

            OnPostSection=BEGIN
                            IF (CurrReport.TOTALSCAUSEDBY = FIELDNO("Reserva Hotel"."Fecha entrada")) OR
                               (CurrReport.TOTALSCAUSEDBY = FIELDNO("Reserva Hotel"."Hotel TO")) OR
                               (CurrReport.TOTALSCAUSEDBY = FIELDNO("Reserva Hotel"."TourOperador Venta")) THEN
                              wPrimerGrupo := FALSE;
                          END;

          }
          CONTROLS
          {
            { 31  ;Label        ;2250 ;1269 ;2250 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Rooms;
                                                                    ESP=Habitaciones] }
            { 44  ;Label        ;4650 ;1269 ;900  ;846  ;VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Reg.;
                                                                    ESP=Reg.] }
            { 45  ;Label        ;5700 ;1269 ;900  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Days;
                                                                    ESP=Dias] }
            { 46  ;Label        ;17250;1269 ;1650 ;846  ;VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Sale date;
                                                                    ESP=Fecha venta] }
            { 50  ;Label        ;6750 ;1269 ;1650 ;846  ;VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Check-out Date;
                                                                    ESP=Fecha salida] }
            { 9   ;Label        ;0    ;1269 ;2100 ;846  ;ParentControl=8;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 5   ;Label        ;8550 ;1269 ;5850 ;846  ;ParentControl=4;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 33  ;Label        ;14550;1269 ;900  ;846  ;ParentControl=32;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 53  ;Label        ;0    ;423  ;2850 ;423  ;VertAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Tour Operator;
                                                                    ESP=Tour Operador] }
            { 56  ;TextBox      ;3000 ;423  ;6150 ;423  ;FontSize=10;
                                                         SourceExpr=cNombre.nom_touroperador("Reserva Hotel"."TourOperador Venta") }
            { 58  ;TextBox      ;3000 ;0    ;6150 ;423  ;FontSize=10;
                                                         SourceExpr=cNombre.nom_hotel("Reserva Hotel"."Hotel booking") }
            { 57  ;Label        ;0    ;0    ;2850 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Hotel;
                                                                    ESP=Hotel] }
            { 67  ;Label        ;20700;0    ;1800 ;423  ;ParentControl=68;
                                                         VertAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Delivery;
                                                                    ESP=Envio] }
            { 68  ;TextBox      ;22650;0    ;1500 ;423  ;FontSize=10;
                                                         SourceExpr=cmpEnvio }
            { 73  ;Label        ;15600;1269 ;1500 ;846  ;ParentControl=72;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Person type;
                                                                    ESP=Tipo Persona] }
            { 14  ;Label        ;19050;1269 ;3150 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Hotel No confirmation;
                                                                    ESP=Num confirmacion hotel] }
            { 18  ;TextBox      ;12750;0    ;1650 ;423  ;FontSize=10;
                                                         SourceExpr="Fecha entrada" }
            { 20  ;Label        ;9750 ;0    ;2850 ;423  ;ParentControl=18;
                                                         HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes }
            { 36  ;TextBox      ;3000 ;846  ;6150 ;423  ;FontSize=10;
                                                         SourceExpr=wNomHotelTO }
            { 37  ;Label        ;0    ;846  ;2850 ;423  ;VertAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Hotel TTOO;
                                                                    ESP=Hotel TTOO] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=24150;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 8   ;TextBox      ;0    ;0    ;2100 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         SourceExpr=Bono }
            { 11  ;TextBox      ;2250 ;0    ;2250 ;423  ;HorzAlign=Right;
                                                         FontSize=10;
                                                         SourceExpr=STRSUBSTNO(Text002, "N§ Habitaciones", w_habitacion) }
            { 17  ;TextBox      ;4650 ;0    ;900  ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         SourceExpr=w_regimen }
            { 23  ;TextBox      ;5700 ;0    ;900  ;423  ;HorzAlign=Right;
                                                         FontSize=10;
                                                         SourceExpr=Estancia }
            { 26  ;TextBox      ;17250;0    ;1650 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         SourceExpr="Fecha venta" }
            { 32  ;TextBox      ;14550;0    ;900  ;423  ;HorzAlign=Right;
                                                         FontSize=10;
                                                         SourceExpr=Edad }
            { 41  ;TextBox      ;6750 ;0    ;1650 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         SourceExpr="Fecha salida" }
            { 4   ;TextBox      ;8550 ;0    ;5850 ;423  ;FontSize=10;
                                                         SourceExpr=Nombre }
            { 72  ;TextBox      ;15600;0    ;1500 ;423  ;FontSize=10;
                                                         SourceExpr="Tipo Persona" }
            { 15  ;TextBox      ;19050;0    ;3150 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         SourceExpr="Num confirmacion hotel" }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=24150;
            SectionHeight=3384;
            OnPreSection=BEGIN
                           IF CurrReport.TOTALSCAUSEDBY = "Reserva Hotel".FIELDNO("Hotel booking") THEN
                             NuevoHotel := TRUE;

                           IF CurrReport.TOTALSCAUSEDBY = "Reserva Hotel".FIELDNO("Fecha entrada") THEN BEGIN
                             rRsv2.RESET;
                             rRsv2.COPY("Reserva Hotel");
                             IF rRsv2.NEXT > 0 THEN
                               CurrReport.SHOWOUTPUT( ("TourOperador Venta" <> rRsv2."TourOperador Venta")  OR
                                                      ("Hotel booking" <> "Hotel booking") )
                             ELSE
                               CurrReport.SHOWOUTPUT( TRUE );
                           END
                           ELSE
                               CurrReport.SHOWOUTPUT( FALSE );
                         END;

            OnPostSection=BEGIN
                            IF (CurrReport.TOTALSCAUSEDBY = "Reserva Hotel".FIELDNO("Hotel TO")) THEN BEGIN

                              IF "Reserva Hotel".NEXT > 0 THEN BEGIN
                                CurrReport.NEWPAGE;
                                "Reserva Hotel".NEXT(-1);
                              END;

                            END;

                            wPrimerGrupo := TRUE;
                          END;

          }
          CONTROLS
          {
            { 35  ;TextBox      ;4500 ;1269 ;2100 ;423  ;FontSize=10;
                                                         SourceExpr=TabHabitacion[1][1] }
            { 38  ;TextBox      ;6750 ;1269 ;9150 ;423  ;FontSize=10;
                                                         SourceExpr=TabHabitacion[1][2] }
            { 39  ;Label        ;0    ;423  ;4350 ;423  ;VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Codes summary;
                                                                    ESP=Resumen de codigos] }
            { 40  ;Label        ;4500 ;423  ;11400;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         FontUnderline=No;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Rooms;
                                                                    ESP=Habitaciones] }
            { 42  ;TextBox      ;6750 ;1692 ;9150 ;423  ;FontSize=10;
                                                         SourceExpr=TabHabitacion[2][2] }
            { 47  ;TextBox      ;4500 ;1692 ;2100 ;423  ;FontSize=10;
                                                         SourceExpr=TabHabitacion[2][1] }
            { 48  ;TextBox      ;6750 ;2115 ;9150 ;423  ;FontSize=10;
                                                         SourceExpr=TabHabitacion[3][2] }
            { 49  ;TextBox      ;4500 ;2115 ;2100 ;423  ;FontSize=10;
                                                         SourceExpr=TabHabitacion[3][1] }
            { 51  ;TextBox      ;6750 ;2538 ;9150 ;423  ;FontSize=10;
                                                         SourceExpr=TabHabitacion[4][2] }
            { 52  ;TextBox      ;4500 ;2538 ;2100 ;423  ;FontSize=10;
                                                         SourceExpr=TabHabitacion[4][1] }
            { 54  ;TextBox      ;6750 ;2961 ;9150 ;423  ;FontSize=10;
                                                         SourceExpr=TabHabitacion[5][2] }
            { 55  ;TextBox      ;4500 ;2961 ;2100 ;423  ;FontSize=10;
                                                         SourceExpr=TabHabitacion[5][1] }
            { 59  ;TextBox      ;18450;2961 ;5400 ;423  ;FontSize=10;
                                                         SourceExpr=cNombre.nom_regimen(TabRegimen[5]) }
            { 60  ;TextBox      ;18450;2538 ;5400 ;423  ;FontSize=10;
                                                         SourceExpr=cNombre.nom_regimen(TabRegimen[4]) }
            { 61  ;TextBox      ;16200;2538 ;2100 ;423  ;FontSize=10;
                                                         SourceExpr=TabRegimen[4] }
            { 62  ;TextBox      ;16200;2961 ;2100 ;423  ;FontSize=10;
                                                         SourceExpr=TabRegimen[5] }
            { 63  ;TextBox      ;18450;2115 ;5400 ;423  ;FontSize=10;
                                                         SourceExpr=cNombre.nom_regimen(TabRegimen[3]) }
            { 64  ;TextBox      ;16200;2115 ;2100 ;423  ;FontSize=10;
                                                         SourceExpr=TabRegimen[3] }
            { 65  ;TextBox      ;18450;1692 ;5400 ;423  ;FontSize=10;
                                                         SourceExpr=cNombre.nom_regimen(TabRegimen[2]) }
            { 66  ;TextBox      ;16200;1692 ;2100 ;423  ;FontSize=10;
                                                         SourceExpr=TabRegimen[2] }
            { 69  ;TextBox      ;16200;1269 ;2100 ;423  ;FontSize=10;
                                                         SourceExpr=TabRegimen[1] }
            { 70  ;TextBox      ;18450;1269 ;5400 ;423  ;FontSize=10;
                                                         SourceExpr=cNombre.nom_regimen(TabRegimen[1]) }
            { 71  ;Label        ;16200;423  ;7650 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         FontUnderline=No;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Boards;
                                                                    ESP=Regimenes] }
            { 74  ;Shape        ;4500 ;846  ;11400;423  ;ShapeStyle=HorzLine }
            { 81  ;Shape        ;16200;846  ;7650 ;423  ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table7009762;
        DataItemTableView=SORTING(Delegacion,N§ Interno,N§ Periodo,N§ Reserva,Tipo Reserva);
        OnPreDataItem=BEGIN
                        Comentarios.SETFILTER("Tipo Reserva", '%1|%2', Comentarios."Tipo Reserva"::Cabecera,
                                                                       Comentarios."Tipo Reserva"::Hotel);
                      END;

        DataItemLink=Delegacion=FIELD(Delegacion),
                     N§ Interno=FIELD(N§ Interno);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=24150;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 19  ;Label        ;0    ;0    ;450  ;423  ;FontSize=10;
                                                         CaptionML=[ENU=***;
                                                                    ESP=***] }
            { 22  ;TextBox      ;600  ;0    ;8850 ;423  ;FontSize=10;
                                                         SourceExpr=Texto }
            { 28  ;Label        ;9600 ;0    ;450  ;423  ;FontSize=10;
                                                         CaptionML=[ENU=***;
                                                                    ESP=***] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table7009743;
        DataItemTableView=SORTING(Delegacion,N§ Responsable,N§ Habitacion)
                          WHERE(Responsable=CONST(No));
        DataItemVarName=Acompa¤antes;
        DataItemLink=Delegacion=FIELD(Delegacion),
                     N§ Responsable=FIELD(N§ Reserva);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=24150;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 25  ;TextBox      ;8550 ;0    ;5850 ;423  ;FontSize=10;
                                                         SourceExpr=Nombre }
            { 30  ;TextBox      ;14550;0    ;900  ;423  ;FontSize=10;
                                                         SourceExpr=Edad }
            { 75  ;TextBox      ;15600;0    ;1500 ;423  ;FontSize=10;
                                                         SourceExpr="Tipo Persona" }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
      CaptionML=[ENU=Communication 2Sale Hotel Res.;
                 ESP=Comunicaci¢n Res. Hotel Venta2];
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text000@1103355028 : TextConst 'ENU=Company information chart does not exist;ESP=No existe la tabla informacion empresa';
      Text001@1103355029 : TextConst 'ENU=D.B. parameters chart do not exist;ESP=No existe la tabla parametros B.D.';
      Text002@1103355030 : TextConst 'ENU=%1 x %2;ESP=%1 x %2';
      rRsv2@1103355000 : Record 7009743;
      rInfEmp@1103355001 : Record 79;
      rPar@1103355002 : Record 7009700;
      rEnvios@1103355003 : Record 7009761;
      rHotelTO@1103355004 : Record 7009725;
      rHab@1103355005 : Record 7009731;
      wNomHotelTO@1103355006 : Text[30];
      cNombre@1103355007 : Codeunit 7009702;
      FormatDire@1103355008 : Codeunit 365;
      cmpTourOperador@1103355009 : Text[30];
      cmpEnvio@1103355010 : Integer;
      vCadTour@1103355011 : Text[50];
      vCadFec@1103355012 : Text[50];
      vNumPag@1103355013 : Integer;
      NuevoHotel@1103355014 : Boolean;
      Hotel@1103355015 : Code[20];
      Preli@1103355016 : Boolean;
      ImpresoAlgo@1103355017 : Boolean;
      EsReimpresion@1103355018 : Boolean;
      wPrimerGrupo@1103355019 : Boolean;
      aux@1103355020 : Integer;
      wIndice@1103355021 : Integer;
      w_habitacion@1103355022 : Text[60];
      w_regimen@1103355023 : Text[30];
      DirEmpresa@1103355024 : ARRAY [8] OF Text[50];
      wTextHabitacion@1103355025 : Text[60];
      TabHabitacion@1103355026 : ARRAY [20,2] OF Code[10];
      TabRegimen@1103355027 : ARRAY [20] OF Code[10];

    PROCEDURE Definitivo@1() : Boolean;
    BEGIN
      EXIT((NOT Preli) AND ImpresoAlgo);
    END;

    PROCEDURE Reimpresion@2(par_reimpresion@1103355000 : Boolean);
    BEGIN
      EsReimpresion := par_reimpresion;
    END;

    PROCEDURE BuscaHabitacion@4();
    BEGIN
      // BuscaHabitacion
      //
      wIndice := 0;
      REPEAT
        wIndice += 1;
        IF TabHabitacion[wIndice][1] = '' THEN BEGIN
          TabHabitacion[wIndice][1] := w_habitacion;
          TabHabitacion[wIndice][2] := wTextHabitacion;
        END;
      UNTIL TabHabitacion[wIndice][1] = w_habitacion;
    END;

    PROCEDURE BuscaRegimen@5();
    BEGIN
      // BuscaRegimen
      //
      wIndice := 0;
      REPEAT
        wIndice += 1;
        IF TabRegimen[wIndice] = '' THEN
          TabRegimen[wIndice] := w_regimen;
      UNTIL TabRegimen[wIndice] = w_regimen;
    END;

    BEGIN
    {
      ## AJF 29/06/09

        .- (09/00319) cambio c¢digos de hotel de code10 a code20.

      ## AJS 05.02.2010

        .- El campo Descripcion de los tipos de habitacion es ahora de 60 caracteres
    }
    END.
  }
  RDLDATA
  {
  }
}
