OBJECT Report 7010011 Minibalance proveedor ext.
{
  OBJECT-PROPERTIES
  {
    Date=02/10/12;
    Time=12:00:00;
    Modified=Yes;
    Version List=AIC2009;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Ext. supplier minibalance;
               ESP=Minibalance proveedor ext.];
    LeftMargin=1500;
    OnPreReport=BEGIN
                  tFiltro := Vendor.GETFILTERS;
                  tFiltro2 := "Vendor Ledger Entry".GETFILTERS;

                  IF Vendor.GETFILTER("Date Filter") <> '' THEN BEGIN
                    IF Imp_anys_ant THEN
                      textoacumulado := STRSUBSTNO(Text000, Vendor.GETRANGEMAX("Date Filter"))
                    ELSE
                      textoacumulado := STRSUBSTNO(Text001,
                        DMY2DATE(1, 1, DATE2DMY(Vendor.GETRANGEMIN("Date Filter"), 3)), Vendor.GETRANGEMAX("Date Filter"));
                  END;


                  rMovPro.RESET;
                  rMovPro.COPYFILTERS("Vendor Ledger Entry");
                  rMovPro.SETCURRENTKEY("Vendor No.", "Global Dimension 1 Code", "Global Dimension 2 Code", "Posting Date", "Currency Code");
                  IF Vendor.GETFILTER("Global Dimension 1 Filter") <> '' THEN
                    rMovPro.SETFILTER("Global Dimension 1 Code", Vendor.GETFILTER("Global Dimension 1 Filter"));
                  IF Vendor.GETFILTER("Global Dimension 2 Filter") <> '' THEN
                    rMovPro.SETFILTER("Global Dimension 2 Code", Vendor.GETFILTER("Global Dimension 2 Filter"));
                  IF Vendor.GETFILTER("Date Filter") <> '' THEN
                    rMovPro.SETFILTER("Posting Date", Vendor.GETFILTER("Date Filter"));

                  rMovPro2.COPY(rMovPro);
                  IF Vendor.GETFILTER("Date Filter") <> '' THEN
                    IF Imp_anys_ant THEN
                      rMovPro2.SETRANGE("Posting Date", 0D, CALCDATE(Text002, Vendor.GETRANGEMIN("Date Filter")))
                    ELSE
                      rMovPro2.SETFILTER("Posting Date", '%1..%2',
                           DMY2DATE(1, 1, DATE2DMY(Vendor.GETRANGEMIN("Date Filter"), 3)), CALCDATE(Text002,Vendor.GETRANGEMIN("Date Filter"
                  )));
                END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table23;
        DataItemTableView=SORTING(Vendor Posting Group);
        OnPreDataItem=BEGIN
                        LastFieldNo := FIELDNO("Vendor Posting Group");
                        MostrarFiltro := TRUE;

                        CurrReport.CREATETOTALS(ImpDebePer, ImpHaberPer, ImpDebeAcu, ImpHaberAcu);
                      END;

        OnAfterGetRecord=BEGIN

                           ImpDebePer := 0;
                           ImpHaberPer := 0;
                           rMovPro.SETRANGE("Vendor No.", "No.");
                           IF rMovPro.FIND('-') THEN BEGIN
                             REPEAT
                               rMovPro.CALCFIELDS("Debit Amount (LCY)", "Credit Amount (LCY)");
                               ImpDebePer := ImpDebePer + rMovPro."Debit Amount (LCY)";
                               ImpHaberPer := ImpHaberPer + rMovPro."Credit Amount (LCY)";
                             UNTIL rMovPro.NEXT = 0;
                           END;

                           ImpDebeAcu := ImpDebePer;
                           ImpHaberAcu := ImpHaberPer;
                           rMovPro2.SETRANGE("Vendor No.", "No.");
                           IF rMovPro2.FIND('-') THEN BEGIN
                             REPEAT
                               rMovPro2.CALCFIELDS("Debit Amount (LCY)", "Credit Amount (LCY)");
                               ImpDebeAcu := ImpDebeAcu + rMovPro2."Debit Amount (LCY)";
                               ImpHaberAcu := ImpHaberAcu + rMovPro2."Credit Amount (LCY)";
                             UNTIL rMovPro2.NEXT = 0;
                           END;

                           IF (ImpDebePer - ImpHaberPer = 0) AND
                              (ImpDebeAcu - ImpHaberAcu = 0) AND
                              SoloImpCtasConSaldo THEN
                              CurrReport.SKIP;

                           IF (ImpDebePer = 0) AND (ImpHaberPer = 0) AND
                              (ImpDebeAcu = 0) AND (ImpHaberAcu = 0) AND
                              SoloImpCtasConAcum THEN
                              CurrReport.SKIP;
                         END;

        ReqFilterFields=Vendor Posting Group,Date Filter,Global Dimension 1 Filter,Global Dimension 2 Filter;
        TotalFields=Net Change (LCY),Debit Amount (LCY),Credit Amount (LCY);
        GroupTotalFields=Vendor Posting Group;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18750;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 1   ;Label        ;0    ;0    ;7500 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Extended supplier balance;
                                                                    ESP=Balance Proveedor Extendido] }
            { 2   ;TextBox      ;15600;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 3   ;TextBox      ;0    ;423  ;7500 ;423  ;SourceExpr=COMPANYNAME }
            { 4   ;TextBox      ;18000;423  ;750  ;423  ;CaptionML=[ENU=page;
                                                                    ESP=P gina];
                                                         SourceExpr=CurrReport.PAGENO }
            { 5   ;Label        ;17250;423  ;750  ;423  ;ParentControl=4 }
            { 6   ;TextBox      ;16500;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18750;
            SectionHeight=1269;
            OnPreSection=BEGIN
                           IF MostrarFiltro THEN BEGIN
                             CurrReport.SHOWOUTPUT(TRUE);
                             MostrarFiltro := FALSE;
                           END;
                         END;

          }
          CONTROLS
          {
            { 7   ;TextBox      ;0    ;0    ;18750;423  ;SourceExpr=tFiltro }
            { 46  ;TextBox      ;0    ;423  ;18750;423  ;SourceExpr=tFiltro2 }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18750;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 12  ;Label        ;750  ;423  ;1500 ;846  ;ParentControl=11;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 15  ;Label        ;2400 ;423  ;4200 ;846  ;ParentControl=14;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 18  ;Label        ;16800;423  ;1950 ;846  ;ParentControl=17;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 13  ;Label        ;10650;423  ;1950 ;846  ;ParentControl=10;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 24  ;Label        ;8700 ;423  ;1800 ;846  ;ParentControl=21;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 20  ;Label        ;6750 ;423  ;1800 ;846  ;ParentControl=19;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 28  ;Label        ;14850;423  ;1800 ;846  ;ParentControl=27;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 26  ;Label        ;12900;423  ;1800 ;846  ;ParentControl=25;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 30  ;TextBox      ;12900;0    ;5850 ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         SourceExpr=textoacumulado }
            { 44  ;TextBox      ;12900;423  ;5850 ;423  ;FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         SourceExpr=Blanc }
            { 29  ;TextBox      ;6750 ;0    ;5850 ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         SourceExpr=STRSUBSTNO(Text003, GETRANGEMIN("Date Filter"), GETRANGEMAX("Date Filter")) }
            { 35  ;TextBox      ;6750 ;423  ;5850 ;423  ;FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         SourceExpr=Blanc }
          }
           }
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=18750;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(NOT Imp_Solo_Tot);
                         END;

          }
          CONTROLS
          {
            { 43  ;TextBox      ;3150 ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         FontBold=Yes;
                                                         SourceExpr="Vendor Posting Group" }
            { 45  ;Label        ;0    ;0    ;3000 ;423  ;ParentControl=43;
                                                         FontBold=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=18750;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             (CurrReport.TOTALSCAUSEDBY = Vendor.FIELDNO("Vendor Posting Group"))
                             AND NOT Imp_Solo_Tot;
                         END;

          }
          CONTROLS
          {
            { 8   ;TextBox      ;3150 ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         FontBold=Yes;
                                                         SourceExpr="Vendor Posting Group" }
            { 9   ;Label        ;0    ;0    ;3000 ;423  ;ParentControl=8;
                                                         FontBold=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=18750;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             (CurrReport.TOTALSCAUSEDBY = LastFieldNo) AND NOT Imp_Solo_Tot;
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18750;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(NOT Imp_Solo_Tot);
                         END;

          }
          CONTROLS
          {
            { 11  ;TextBox      ;750  ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="No." }
            { 14  ;TextBox      ;2400 ;0    ;4200 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Name }
            { 17  ;TextBox      ;16800;0    ;1950 ;423  ;FontBold=No;
                                                         CaptionML=[ENU=Balance;
                                                                    ESP=Saldo];
                                                         BlankZero=Yes;
                                                         SourceExpr=ImpDebeAcu - ImpHaberAcu }
            { 10  ;TextBox      ;10650;0    ;1950 ;423  ;FontBold=No;
                                                         CaptionML=[ENU=Balance;
                                                                    ESP=Saldo];
                                                         BlankZero=Yes;
                                                         SourceExpr=ImpDebePer - ImpHaberPer }
            { 21  ;TextBox      ;8700 ;0    ;1800 ;423  ;FontBold=No;
                                                         CaptionML=[ENU=Credit;
                                                                    ESP=Haber];
                                                         BlankZero=Yes;
                                                         SourceExpr=ImpHaberPer }
            { 19  ;TextBox      ;6750 ;0    ;1800 ;423  ;FontBold=No;
                                                         CaptionML=[ENU=Debit;
                                                                    ESP=Debe];
                                                         BlankZero=Yes;
                                                         SourceExpr=ImpDebePer }
            { 25  ;TextBox      ;12900;0    ;1800 ;423  ;FontBold=No;
                                                         CaptionML=[ENU=Debit;
                                                                    ESP=Debe];
                                                         BlankZero=Yes;
                                                         SourceExpr=ImpDebeAcu }
            { 27  ;TextBox      ;14850;0    ;1800 ;423  ;FontBold=No;
                                                         CaptionML=[ENU=Credit;
                                                                    ESP=Haber];
                                                         BlankZero=Yes;
                                                         SourceExpr=ImpHaberAcu }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=18750;
            SectionHeight=423;
            OnPreSection=BEGIN
                           {
                           IF NOT FooterPrinted THEN
                             LastFieldNo := CurrReport.TOTALSCAUSEDBY;
                           CurrReport.SHOWOUTPUT := NOT FooterPrinted;
                           FooterPrinted := TRUE;
                           }
                           CurrReport.SHOWOUTPUT :=
                             (CurrReport.TOTALSCAUSEDBY = Vendor.FIELDNO("Vendor Posting Group")) AND
                             NOT Imp_Solo_Tot;
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=18750;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = Vendor.FIELDNO("Vendor Posting Group");
                         END;

          }
          CONTROLS
          {
            { 22  ;TextBox      ;750  ;0    ;5850 ;423  ;FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         SourceExpr=Text004+FIELDCAPTION("Vendor Posting Group") + ' ' + "Vendor Posting Group" }
            { 16  ;TextBox      ;6750 ;0    ;1800 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Debit;
                                                                    ESP=Debe];
                                                         BlankZero=Yes;
                                                         SourceExpr=ImpDebePer }
            { 23  ;TextBox      ;8700 ;0    ;1800 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Credit;
                                                                    ESP=Haber];
                                                         BlankZero=Yes;
                                                         SourceExpr=ImpHaberPer }
            { 31  ;TextBox      ;10650;0    ;1950 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Balance;
                                                                    ESP=Saldo];
                                                         BlankZero=Yes;
                                                         SourceExpr=ImpDebePer - ImpHaberPer }
            { 32  ;TextBox      ;12900;0    ;1800 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Debit;
                                                                    ESP=Debe];
                                                         BlankZero=Yes;
                                                         SourceExpr=ImpDebeAcu }
            { 33  ;TextBox      ;14850;0    ;1800 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Credit;
                                                                    ESP=Haber];
                                                         BlankZero=Yes;
                                                         SourceExpr=ImpHaberAcu }
            { 34  ;TextBox      ;16800;0    ;1950 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Balance;
                                                                    ESP=Saldo];
                                                         BlankZero=Yes;
                                                         SourceExpr=ImpDebeAcu - ImpHaberAcu }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=18750;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             (CurrReport.TOTALSCAUSEDBY = Vendor.FIELDNO("Vendor Posting Group")) AND
                             NOT Imp_Solo_Tot;
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18750;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             Imp_Solo_Tot;
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18750;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 42  ;Label        ;750  ;0    ;5850 ;423  ;FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Total;
                                                                    ESP=Total] }
            { 36  ;TextBox      ;6750 ;0    ;1800 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Debit;
                                                                    ESP=Debe];
                                                         BlankZero=Yes;
                                                         SourceExpr=ImpDebePer }
            { 37  ;TextBox      ;8700 ;0    ;1800 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Credit;
                                                                    ESP=Haber];
                                                         BlankZero=Yes;
                                                         SourceExpr=ImpHaberPer }
            { 38  ;TextBox      ;10650;0    ;1950 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Balance;
                                                                    ESP=Saldo];
                                                         BlankZero=Yes;
                                                         SourceExpr=ImpDebePer - ImpHaberPer }
            { 39  ;TextBox      ;12900;0    ;1800 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Debit;
                                                                    ESP=Debe];
                                                         BlankZero=Yes;
                                                         SourceExpr=ImpDebeAcu }
            { 40  ;TextBox      ;14850;0    ;1800 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Credit;
                                                                    ESP=Haber];
                                                         BlankZero=Yes;
                                                         SourceExpr=ImpHaberAcu }
            { 41  ;TextBox      ;16800;0    ;1950 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Balance;
                                                                    ESP=Saldo];
                                                         BlankZero=Yes;
                                                         SourceExpr=ImpDebeAcu - ImpHaberAcu }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table25;
        DataItemTableView=SORTING(Vendor No.,Global Dimension 1 Code,Global Dimension 2 Code,Posting Date,Currency Code);
        OnPreDataItem=VAR
                        rMovPro3@1100217000 : Record 25;
                      BEGIN
                        IF NOT ImprimeMovs THEN
                          CurrReport.BREAK;

                        IF Vendor.GETFILTER("Global Dimension 1 Filter") <> '' THEN
                          SETFILTER("Global Dimension 1 Code", Vendor.GETFILTER("Global Dimension 1 Filter"));
                        IF Vendor.GETFILTER("Global Dimension 2 Filter") <> '' THEN
                          SETFILTER("Global Dimension 2 Code", Vendor.GETFILTER("Global Dimension 2 Filter"));
                        IF Vendor.GETFILTER("Date Filter") <> '' THEN
                          SETFILTER("Posting Date", Vendor.GETFILTER("Date Filter"));
                        IF Vendor.GETFILTER("Currency Filter") <> '' THEN
                          SETFILTER("Currency Code", Vendor.GETFILTER("Currency Filter"));

                        SaldoCliente := 0;

                        SaldoAnterior := 0;

                        rMovPro3.COPY("Vendor Ledger Entry");
                        rMovPro3.SETRANGE("Posting Date", 0D, CLOSINGDATE(CALCDATE(Text002, "Vendor Ledger Entry".GETRANGEMIN("Posting Date"))));
                        IF rMovPro3.FIND('-') THEN
                          REPEAT
                            rMovPro3.CALCFIELDS("Amount (LCY)");
                            SaldoAnterior := SaldoAnterior + rMovPro3."Amount (LCY)";
                          UNTIL rMovPro3.NEXT = 0;
                      END;

        OnAfterGetRecord=BEGIN
                           SaldoCliente := SaldoCliente + "Debit Amount (LCY)" - "Credit Amount (LCY)";
                         END;

        ReqFilterFields=Document Type;
        TotalFields=Debit Amount (LCY),Credit Amount (LCY);
        DataItemLink=Vendor No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=18750;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 58  ;Label        ;9150 ;0    ;1800 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Credit (LCY);
                                                                    ESP=Haber (DL)] }
            { 59  ;Label        ;7200 ;0    ;1800 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Debit (LCY);
                                                                    ESP=Debe (DL)] }
            { 60  ;Label        ;2550 ;0    ;4500 ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Description;
                                                                    ESP=Descripci¢n] }
            { 61  ;Label        ;14550;0    ;1500 ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Document No.;
                                                                    ESP=N§ documento] }
            { 62  ;Label        ;13200;0    ;1200 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Posting Date;
                                                                    ESP=Fecha registro] }
            { 63  ;Label        ;450  ;0    ;1950 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Ledger Entry No.;
                                                                    ESP=N§ Mov.] }
            { 68  ;Label        ;11100;0    ;1800 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Balance (LCY);
                                                                    ESP=Saldo (DL)] }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=18750;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(SaldoAnterior = 0);
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=18750;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(SaldoAnterior <> 0);
                         END;

          }
          CONTROLS
          {
            { 70  ;TextBox      ;11100;0    ;1800 ;423  ;SourceExpr=SaldoAnterior }
            { 71  ;Label        ;4200 ;0    ;2850 ;423  ;FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Previous sum;
                                                                    ESP=Suma anterior] }
          }
           }
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=18750;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 47  ;Label        ;9150 ;0    ;1800 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Credit (LCY);
                                                                    ESP=Haber (DL)] }
            { 48  ;Label        ;7200 ;0    ;1800 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Debit (LCY);
                                                                    ESP=Debe (DL)] }
            { 49  ;Label        ;2550 ;0    ;4500 ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Description;
                                                                    ESP=Descripci¢n] }
            { 50  ;Label        ;14550;0    ;1500 ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Document No.;
                                                                    ESP=N§ documento] }
            { 51  ;Label        ;13200;0    ;1200 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Posting Date;
                                                                    ESP=Fecha registro] }
            { 52  ;Label        ;450  ;0    ;1950 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Ledger Entry No.;
                                                                    ESP=N§ Mov.] }
            { 57  ;Label        ;11100;0    ;1800 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Balance (LCY);
                                                                    ESP=Saldo (DL)] }
          }
           }
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=18750;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Debit Amount (LCY)" - "Credit Amount (LCY)" + SaldoAnterior = 0);
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=18750;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Debit Amount (LCY)" - "Credit Amount (LCY)" + SaldoAnterior <> 0);
                         END;

          }
          CONTROLS
          {
            { 54  ;TextBox      ;11100;0    ;1800 ;423  ;SourceExpr="Debit Amount (LCY)" - "Credit Amount (LCY)" + SaldoAnterior }
            { 53  ;Label        ;4200 ;0    ;2850 ;423  ;FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Previous sum;
                                                                    ESP=Suma anterior] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18750;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 55  ;TextBox      ;450  ;0    ;1950 ;423  ;SourceExpr="Entry No." }
            { 56  ;TextBox      ;13200;0    ;1200 ;423  ;SourceExpr="Posting Date" }
            { 64  ;TextBox      ;14550;0    ;1500 ;423  ;SourceExpr="Document No." }
            { 65  ;TextBox      ;2550 ;0    ;4500 ;423  ;SourceExpr=Description }
            { 66  ;TextBox      ;7200 ;0    ;1800 ;423  ;SourceExpr="Debit Amount (LCY)" }
            { 67  ;TextBox      ;9150 ;0    ;1800 ;423  ;SourceExpr="Credit Amount (LCY)" }
            { 69  ;TextBox      ;11100;0    ;1800 ;423  ;CaptionML=[ENU=Balance;
                                                                    ESP=Saldo];
                                                         SourceExpr=SaldoCliente + SaldoAnterior }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18750;
            SectionHeight=423;
          }
          CONTROLS
          {
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=5610;
      Height=2640;
      CaptionML=[ENU=Ext. supplier minibalance;
                 ESP=Minibalance proveedor ext.];
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1   ;CheckBox     ;5170 ;0    ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=[ENU=Print balances previous years;
                                                              ESP=Imprimir saldos de a¤os anteriores];
                                                   SourceExpr=Imp_anys_ant }
      { 4   ;Label        ;0    ;0    ;5060 ;440  ;ParentControl=1;
                                                   MultiLine=Yes }
      { 5   ;CheckBox     ;5170 ;550  ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=[ENU=print only group totals;
                                                              ESP=Imprimir s¢lo totales de grupo];
                                                   SourceExpr=Imp_Solo_Tot }
      { 6   ;Label        ;0    ;550  ;5060 ;440  ;ParentControl=5;
                                                   MultiLine=Yes }
      { 7   ;CheckBox     ;5170 ;2200 ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=[ENU=Print supplier movements;
                                                              ESP=Imprimir movimientos proveedor];
                                                   SourceExpr=ImprimeMovs }
      { 8   ;Label        ;0    ;2200 ;5060 ;440  ;ParentControl=7;
                                                   MultiLine=Yes }
      { 2   ;Label        ;0    ;1100 ;5060 ;440  ;ParentControl=9;
                                                   MultiLine=Yes }
      { 3   ;Label        ;0    ;1650 ;5060 ;440  ;ParentControl=10;
                                                   MultiLine=Yes }
      { 9   ;CheckBox     ;5170 ;1100 ;440  ;440  ;Name=SoloSaldo;
                                                   ShowCaption=No;
                                                   CaptionML=[ENU=Print only accounts with balance;
                                                              ESP=Imprimir s¢lo cuentas con saldo];
                                                   SourceExpr=SoloImpCtasConSaldo;
                                                   OnPush=BEGIN
                                                            SoloImpCtasConAcum := SoloImpCtasConSaldo;

                                                            RequestOptionsForm.SoloAcum.EDITABLE := NOT SoloImpCtasConSaldo;
                                                          END;
                                                           }
      { 10  ;CheckBox     ;5170 ;1650 ;440  ;440  ;Name=SoloAcum;
                                                   ShowCaption=No;
                                                   CaptionML=[ENU=Print only accounts with accumulated;
                                                              ESP=Imprimir s¢lo cuentas con acumulados];
                                                   SourceExpr=SoloImpCtasConAcum }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text000@1100217000 : TextConst 'ENU=Accumulated since %1;ESP=Acumulado hasta %1';
      Text001@1100217001 : TextConst 'ENU=Accumulated from %1 to %2;ESP=Acumulado desde %1 hasta %2';
      Text002@1100217002 : TextConst 'ENU=-1D;ESP=-1D';
      Text003@1100217003 : TextConst 'ENU=Term from %1 to %2;ESP=Periodo desde %1 hasta %2';
      Text004@1100217004 : TextConst 'ENU=Total;ESP=Total';
      LastFieldNo@1100217005 : Integer;
      FooterPrinted@1100217006 : Boolean;
      tFiltro@1100217007 : Text[150];
      tFiltro2@1100217008 : Text[150];
      MostrarFiltro@1100217009 : Boolean;
      Imp_anys_ant@1100217010 : Boolean;
      Blanc@1100217011 : Text[1];
      Imp_Solo_Tot@1100217012 : Boolean;
      rMovPro@1100217013 : Record 25;
      rMovPro2@1100217014 : Record 25;
      ImpDebePer@1100217015 : Decimal;
      ImpHaberPer@1100217016 : Decimal;
      ImpDebeAcu@1100217017 : Decimal;
      ImpHaberAcu@1100217018 : Decimal;
      SoloImpCtasConSaldo@1100217019 : Boolean;
      SoloImpCtasConAcum@1100217020 : Boolean;
      textoacumulado@1100217021 : Text[80];
      ImprimeMovs@1100217022 : Boolean;
      SaldoProveedor@1100217023 : Decimal;
      SaldoAnterior@1100217024 : Decimal;
      SaldoCliente@1100217025 : Decimal;

    PROCEDURE PasaParametros@1103355000(pwImprimirSoloTotal@1103355000 : Boolean;pwSaldoAnyosAnteriores@1103355001 : Boolean;pwSoloCuentasConSaldo@1100253000 : Boolean);
    BEGIN
      // PasaParametros
      //

      Imp_Solo_Tot := pwImprimirSoloTotal;
      Imp_anys_ant := pwSaldoAnyosAnteriores;
      SoloImpCtasConSaldo := pwSoloCuentasConSaldo;
    END;

    BEGIN
    {
      // PLB 10/02/2004
      Se han solucionado problemas derivados de la migraci¢n (saldo inicial, acumulados)

      // AJS 30.10.2006
      Se ha incluido una nueva funcion para poder indicar desde fuera del report si hay que imprimir solo los totales y
      el saldo de los a¤os anteriores
    }
    END.
  }
  RDLDATA
  {
  }
}
