OBJECT Report 7009720 Comunicaci¢n Res. Hotel Compra
{
  OBJECT-PROPERTIES
  {
    Date=02/10/12;
    Time=12:00:00;
    Modified=Yes;
    Version List=AIC2009;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Purchase Hotel rest. Communication;
               ESP=Comunicaci¢n Res. Hotel Compra];
    OnInitReport=BEGIN
                   IF NOT rInfEmp.FIND('-') THEN
                     ERROR(Text000);
                   IF NOT rPar.FIND('-') THEN
                     ERROR(Text001);

                   {
                   cmpEnvio:=rPar."Ultimo n§ envio hotel";

                   CLEAR(vCadTour);
                   CLEAR(vCadFec);
                   }
                   CLEAR(vNumPag);
                 END;

    OnPreReport=BEGIN
                  Preli := CurrReport.PREVIEW;
                  ImpresoAlgo := FALSE;
                END;

    OnPostReport=BEGIN
                   ImpresoAlgo := TRUE;

                   {
                   IF ("Reserva Hotel"."N§ envio hotel" = 0) AND (vNumPag > 0) THEN BEGIN
                     rEnvios.INIT;
                     rEnvios."Num. Envio"    := cmpEnvio;
                     rEnvios.Fecha           := TODAY;
                     rEnvios.Hora            := TIME;
                     rEnvios.Usuario         := USERID;
                     rEnvios.Hotel           := "Reserva Hotel"."Hotel booking";
                     rEnvios.Paginas         := vNumPag;
                     rEnvios."Fecha entrada" := vCadFec;
                     rEnvios."Nombre Hotel"  := cNombre.nom_hotel("Reserva Hotel"."Hotel booking");
                     rEnvios.TourOperador    := vCadTour;
                     rEnvios.INSERT;
                     IF rPar.FIND('-') THEN BEGIN
                       rPar."Ultimo n§ envio hotel" := rPar."Ultimo n§ envio hotel" + 1;
                       rPar.MODIFY;
                     END;
                   END;
                   }
                 END;

    Orientation=Landscape;
    PaperSize=A4 210 x 297 mm;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table7009743;
        DataItemTableView=SORTING(Hotel booking,TourOperador,Fecha entrada)
                          WHERE(Responsable=CONST(Yes));
        OnPreDataItem=BEGIN
                        {IF GETFILTER("Reserva Hotel"."N§ envio hotel") <> '0' THEN
                          IF EVALUATE(cmpEnvio, GETFILTER("Reserva Hotel"."N§ envio hotel")) THEN;
                        }
                        NuevoHotel := FALSE;
                        IF EsReimpresion THEN
                          "Reserva Hotel".SETCURRENTKEY("N§ envio hotel");
                      END;

        OnAfterGetRecord=BEGIN
                           IF NuevoHotel THEN BEGIN
                             IF rEnvios.GET(cmpEnvio, Hotel) THEN BEGIN
                               rEnvios.Fecha   := TODAY;
                               rEnvios.Hora    := TIME;
                               rEnvios.Usuario := USERID;
                               rEnvios.Paginas := vNumPag;
                               rEnvios.MODIFY;
                             END;
                             NuevoHotel := FALSE;
                           END;

                           cmpEnvio := "N§ envio hotel";
                           Hotel := "Hotel booking";
                           IF rPar."Codigos comunicar hotel" = rPar."Codigos comunicar hotel"::Propios THEN BEGIN
                             w_habitacion := Habitacion;
                             w_regimen := Regimen;
                           END
                           ELSE BEGIN
                             IF "Habitacion TO" <> '' THEN
                               w_habitacion := "Habitacion TO"
                             ELSE
                               w_habitacion := Habitacion;

                             IF "Regimen TO" <> '' THEN
                               w_regimen := "Regimen TO"
                             ELSE
                               w_regimen := Regimen;
                           END;
                         END;

        OnPostDataItem=BEGIN
                         IF NuevoHotel THEN BEGIN
                           IF rEnvios.GET(cmpEnvio, Hotel) THEN BEGIN
                             rEnvios.Fecha   := TODAY;
                             rEnvios.Hora    := TIME;
                             rEnvios.Usuario := USERID;
                             rEnvios.Paginas := vNumPag;
                             rEnvios.MODIFY;
                           END;
                           NuevoHotel := FALSE;
                         END;
                       END;

        GroupTotalFields=Hotel booking,TourOperador Venta,Fecha entrada;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=25500;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1   ;Shape        ;0    ;423  ;25500;423  ;ShapeStyle=HorzLine }
            { 2   ;TextBox      ;0    ;0    ;4350 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=rInfEmp.Name }
            { 3   ;Label        ;21900;0    ;3600 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Bookings communication;
                                                                    ESP=Comunicaci¢n Reservas] }
          }
           }
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=25500;
            SectionHeight=1692;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(NOT rPar."Mostrar ambos TO en comunic");
                         END;

          }
          CONTROLS
          {
            { 76  ;TextBox      ;10500;423  ;1650 ;423  ;FontSize=8;
                                                         SourceExpr="Fecha entrada" }
            { 77  ;Label        ;8100 ;423  ;2250 ;423  ;ParentControl=76;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 78  ;TextBox      ;2400 ;423  ;5250 ;423  ;FontSize=8;
                                                         SourceExpr=cNombre.nom_touroperador("Reserva Hotel".TourOperador) }
            { 79  ;Label        ;0    ;423  ;2250 ;423  ;VertAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Tour Operator;
                                                                    ESP=Tour Operador] }
            { 80  ;Label        ;0    ;1269 ;1350 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Voucher;
                                                                    ESP=Bono] }
            { 81  ;Label        ;1500 ;1269 ;900  ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Quant.;
                                                                    ESP=Cant.] }
            { 82  ;Label        ;2550 ;1269 ;1050 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Room;
                                                                    ESP=Hab.] }
            { 83  ;Label        ;3750 ;1269 ;900  ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Reg.;
                                                                    ESP=Reg.] }
            { 84  ;Label        ;4800 ;1269 ;1350 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Time Ll.;
                                                                    ESP=Hora Ll.] }
            { 85  ;Label        ;6300 ;1269 ;750  ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Days;
                                                                    ESP=Dias] }
            { 86  ;Label        ;7200 ;1269 ;1650 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Bkg date:;
                                                                    ESP=Fecha Rva.] }
            { 87  ;Label        ;9000 ;1269 ;4500 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Name;
                                                                    ESP=Nombre] }
            { 88  ;Label        ;13650;1269 ;750  ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Age;
                                                                    ESP=Edad] }
            { 89  ;Label        ;16200;1269 ;1800 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Dep. Purch.;
                                                                    ESP=Comp. Sal.] }
            { 90  ;Label        ;18150;1269 ;1800 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Dep. Flight;
                                                                    ESP=Vuelo Sal.] }
            { 91  ;Label        ;20100;1269 ;1650 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Dep. Date;
                                                                    ESP=Fecha Sal.] }
            { 92  ;Label        ;21900;846  ;1200 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Room No.;
                                                                    ESP=N§ Habitacion] }
            { 93  ;TextBox      ;1050 ;0    ;6150 ;423  ;FontSize=8;
                                                         SourceExpr=cNombre.nom_hotel("Reserva Hotel"."Hotel booking") }
            { 94  ;Label        ;0    ;0    ;900  ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Hotel;
                                                                    ESP=Hotel] }
            { 95  ;Label        ;22800;0    ;1050 ;423  ;ParentControl=96;
                                                         VertAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Delivery:;
                                                                    ESP=Envio:] }
            { 96  ;TextBox      ;24000;0    ;1500 ;423  ;SourceExpr=cmpEnvio }
            { 97  ;Label        ;14550;846  ;1500 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Person type;
                                                                    ESP=Tipo Persona] }
          }
           }
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=25500;
            SectionHeight=1692;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(rPar."Mostrar ambos TO en comunic");
                         END;

          }
          CONTROLS
          {
            { 52  ;TextBox      ;10500;423  ;1650 ;423  ;FontSize=8;
                                                         SourceExpr="Fecha entrada" }
            { 51  ;Label        ;8100 ;423  ;2250 ;423  ;ParentControl=52;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 62  ;TextBox      ;2400 ;423  ;5250 ;423  ;FontSize=8;
                                                         SourceExpr=cNombre.nom_touroperador("Reserva Hotel".TourOperador) }
            { 65  ;Label        ;0    ;423  ;2250 ;423  ;VertAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Tour Operator;
                                                                    ESP=Tour Operador] }
            { 66  ;Label        ;0    ;1269 ;1350 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Voucher;
                                                                    ESP=Bono] }
            { 64  ;Label        ;1500 ;1269 ;900  ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Quant.;
                                                                    ESP=Cant.] }
            { 63  ;Label        ;2550 ;1269 ;1050 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Room;
                                                                    ESP=Hab.] }
            { 61  ;Label        ;3750 ;1269 ;900  ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Reg.;
                                                                    ESP=Reg.] }
            { 60  ;Label        ;4800 ;1269 ;1350 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Time Ll.;
                                                                    ESP=Hora Ll.] }
            { 59  ;Label        ;6300 ;1269 ;750  ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Days;
                                                                    ESP=Dias] }
            { 47  ;Label        ;7200 ;1269 ;1650 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Bkg date:;
                                                                    ESP=Fecha Rva.] }
            { 42  ;Label        ;9000 ;1269 ;4500 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Name;
                                                                    ESP=Nombre] }
            { 39  ;Label        ;13650;1269 ;750  ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Age;
                                                                    ESP=Edad] }
            { 36  ;Label        ;16200;1269 ;1800 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Dep. Purch.;
                                                                    ESP=Comp. Sal.] }
            { 29  ;Label        ;18150;1269 ;1800 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Dep. Flight;
                                                                    ESP=Vuelo Sal.] }
            { 27  ;Label        ;20100;1269 ;1650 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Dep. Date;
                                                                    ESP=Fecha Sal.] }
            { 70  ;Label        ;21900;846  ;1200 ;846  ;ParentControl=69;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 21  ;TextBox      ;1050 ;0    ;6150 ;423  ;FontSize=8;
                                                         SourceExpr=cNombre.nom_hotel("Reserva Hotel"."Hotel booking") }
            { 24  ;Label        ;0    ;0    ;900  ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Hotel;
                                                                    ESP=Hotel] }
            { 15  ;Label        ;22800;0    ;1050 ;423  ;ParentControl=18;
                                                         VertAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Delivery:;
                                                                    ESP=Envio:] }
            { 18  ;TextBox      ;24000;0    ;1500 ;423  ;SourceExpr=cmpEnvio }
            { 74  ;Label        ;14550;846  ;1500 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Person type;
                                                                    ESP=Tipo Persona] }
            { 34  ;Label        ;23250;1269 ;2250 ;423  ;Name=cap_tour1;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=TourOperator;
                                                                    ESP=TourOperador] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=25500;
            SectionHeight=0;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(FALSE);

                           IF CurrReport.TOTALSCAUSEDBY = "Reserva Hotel".FIELDNO("Hotel booking") THEN
                             CurrReport.PAGENO := 1;
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=25500;
            SectionHeight=1692;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((CurrReport.TOTALSCAUSEDBY = "Reserva Hotel".FIELDNO("Fecha entrada")) AND
                                                 NOT (rPar."Mostrar ambos TO en comunic"));
                         END;

          }
          CONTROLS
          {
            { 31  ;Label        ;2550 ;1269 ;1050 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Room;
                                                                    ESP=Hab.] }
            { 43  ;Label        ;4800 ;1269 ;1350 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Time Ll.;
                                                                    ESP=Hora Ll.] }
            { 44  ;Label        ;3750 ;1269 ;900  ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Reg.;
                                                                    ESP=Reg.] }
            { 45  ;Label        ;6300 ;1269 ;750  ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Days;
                                                                    ESP=Dias] }
            { 46  ;Label        ;7200 ;1269 ;1650 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Bkg date:;
                                                                    ESP=Fecha Rva.] }
            { 48  ;Label        ;16200;1269 ;1800 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Dep. Purch.;
                                                                    ESP=Comp. Sal.] }
            { 49  ;Label        ;18150;1269 ;1800 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Dep. Flight;
                                                                    ESP=Vuelo Sal.] }
            { 50  ;Label        ;20100;1269 ;1650 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Dep. Date;
                                                                    ESP=Fecha Sal.] }
            { 12  ;Label        ;1500 ;1269 ;900  ;423  ;ParentControl=11;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Quant.;
                                                                    ESP=Cant.] }
            { 9   ;Label        ;0    ;1269 ;1350 ;423  ;ParentControl=8;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 5   ;Label        ;9000 ;1269 ;4500 ;423  ;ParentControl=4;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 33  ;Label        ;13650;1269 ;750  ;423  ;ParentControl=32;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 53  ;Label        ;0    ;423  ;2250 ;423  ;VertAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Tour Operator;
                                                                    ESP=Tour Operador] }
            { 54  ;TextBox      ;10500;423  ;1650 ;423  ;FontSize=8;
                                                         SourceExpr="Fecha entrada" }
            { 55  ;Label        ;8100 ;423  ;2250 ;423  ;ParentControl=54;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 56  ;TextBox      ;2400 ;423  ;5250 ;423  ;FontSize=8;
                                                         SourceExpr=cNombre.nom_touroperador("Reserva Hotel".TourOperador) }
            { 71  ;Label        ;21900;846  ;1200 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Room No.;
                                                                    ESP=N§ Habitacion] }
            { 58  ;TextBox      ;1050 ;0    ;6150 ;423  ;FontSize=8;
                                                         SourceExpr=cNombre.nom_hotel("Reserva Hotel"."Hotel booking") }
            { 57  ;Label        ;0    ;0    ;900  ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Hotel;
                                                                    ESP=Hotel] }
            { 67  ;Label        ;22800;0    ;1050 ;423  ;ParentControl=68;
                                                         VertAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Delivery:;
                                                                    ESP=Envio:] }
            { 68  ;TextBox      ;24000;0    ;1500 ;423  ;SourceExpr=cmpEnvio }
            { 73  ;Label        ;14550;846  ;1500 ;846  ;ParentControl=72;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Person type;
                                                                    ESP=Tipo Persona] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=25500;
            SectionHeight=1692;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((CurrReport.TOTALSCAUSEDBY = "Reserva Hotel".FIELDNO("Fecha entrada")) AND
                                                 rPar."Mostrar ambos TO en comunic");
                         END;

          }
          CONTROLS
          {
            { 99  ;Label        ;2550 ;1269 ;1050 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Room;
                                                                    ESP=Hab.] }
            { 100 ;Label        ;4800 ;1269 ;1350 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Time Ll.;
                                                                    ESP=Hora Ll.] }
            { 101 ;Label        ;3750 ;1269 ;900  ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Reg.;
                                                                    ESP=Reg.] }
            { 102 ;Label        ;6300 ;1269 ;750  ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Days;
                                                                    ESP=Dias] }
            { 103 ;Label        ;7200 ;1269 ;1650 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Bkg date:;
                                                                    ESP=Fecha Rva.] }
            { 104 ;Label        ;16200;1269 ;1800 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Dep. Purch.;
                                                                    ESP=Comp. Sal.] }
            { 105 ;Label        ;18150;1269 ;1800 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Dep. Flight;
                                                                    ESP=Vuelo Sal.] }
            { 106 ;Label        ;20100;1269 ;1650 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Dep. Date;
                                                                    ESP=Fecha Sal.] }
            { 107 ;Label        ;1500 ;1269 ;900  ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Quant.;
                                                                    ESP=Cant.] }
            { 108 ;Label        ;0    ;1269 ;1350 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 109 ;Label        ;9000 ;1269 ;4500 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Name;
                                                                    ESP=Nombre] }
            { 110 ;Label        ;13650;1269 ;750  ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 111 ;Label        ;0    ;423  ;2250 ;423  ;VertAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Tour Operator;
                                                                    ESP=Tour Operador] }
            { 112 ;TextBox      ;10500;423  ;1650 ;423  ;FontSize=8;
                                                         SourceExpr="Fecha entrada" }
            { 113 ;Label        ;8100 ;423  ;2250 ;423  ;ParentControl=112;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 114 ;TextBox      ;2400 ;423  ;5250 ;423  ;FontSize=8;
                                                         SourceExpr=cNombre.nom_touroperador("Reserva Hotel".TourOperador) }
            { 115 ;Label        ;21900;846  ;1200 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Room No.;
                                                                    ESP=N§ Habitacion] }
            { 116 ;TextBox      ;1050 ;0    ;6150 ;423  ;FontSize=8;
                                                         SourceExpr=cNombre.nom_hotel("Reserva Hotel"."Hotel booking") }
            { 117 ;Label        ;0    ;0    ;900  ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Hotel;
                                                                    ESP=Hotel] }
            { 118 ;Label        ;22800;0    ;1050 ;423  ;ParentControl=119;
                                                         VertAlign=Center;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Delivery:;
                                                                    ESP=Envio:] }
            { 119 ;TextBox      ;24000;0    ;1500 ;423  ;SourceExpr=cmpEnvio }
            { 120 ;Label        ;14550;846  ;1500 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Person type;
                                                                    ESP=Tipo Persona] }
            { 121 ;Label        ;23250;1269 ;2250 ;423  ;Name=cap_tour2;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=TourOperator;
                                                                    ESP=TourOperador] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=25500;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(NOT rPar."Mostrar ambos TO en comunic");
                         END;

          }
          CONTROLS
          {
            { 8   ;TextBox      ;0    ;0    ;1350 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Bono }
            { 11  ;TextBox      ;1500 ;0    ;900  ;423  ;HorzAlign=Right;
                                                         SourceExpr="N§ Habitaciones" }
            { 14  ;TextBox      ;2550 ;0    ;1050 ;423  ;HorzAlign=Left;
                                                         SourceExpr=w_habitacion }
            { 17  ;TextBox      ;3750 ;0    ;900  ;423  ;HorzAlign=Left;
                                                         SourceExpr=w_regimen }
            { 20  ;TextBox      ;4800 ;0    ;1350 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Hora entrada" }
            { 23  ;TextBox      ;6300 ;0    ;750  ;423  ;HorzAlign=Right;
                                                         SourceExpr=Estancia }
            { 26  ;TextBox      ;7200 ;0    ;1650 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Fecha venta" }
            { 32  ;TextBox      ;13650;0    ;750  ;423  ;HorzAlign=Right;
                                                         SourceExpr=Edad }
            { 35  ;TextBox      ;16200;0    ;1800 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Compa¤ia salida" }
            { 38  ;TextBox      ;18150;0    ;1800 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Vuelo salida" }
            { 41  ;TextBox      ;20100;0    ;1650 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Fecha salida" }
            { 4   ;TextBox      ;9000 ;0    ;4500 ;423  ;SourceExpr=Nombre }
            { 69  ;TextBox      ;21900;0    ;1200 ;423  ;SourceExpr="N§ Habitacion" }
            { 72  ;TextBox      ;14550;0    ;1500 ;423  ;SourceExpr="Tipo Persona" }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=25500;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(rPar."Mostrar ambos TO en comunic");
                         END;

          }
          CONTROLS
          {
            { 122 ;TextBox      ;0    ;0    ;1350 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Bono }
            { 123 ;TextBox      ;1500 ;0    ;900  ;423  ;HorzAlign=Right;
                                                         SourceExpr="N§ Habitaciones" }
            { 124 ;TextBox      ;2550 ;0    ;1050 ;423  ;HorzAlign=Left;
                                                         SourceExpr=w_habitacion }
            { 125 ;TextBox      ;3750 ;0    ;900  ;423  ;HorzAlign=Left;
                                                         SourceExpr=w_regimen }
            { 126 ;TextBox      ;4800 ;0    ;1350 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Hora entrada" }
            { 127 ;TextBox      ;6300 ;0    ;750  ;423  ;HorzAlign=Right;
                                                         SourceExpr=Estancia }
            { 128 ;TextBox      ;7200 ;0    ;1650 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Fecha venta" }
            { 129 ;TextBox      ;13650;0    ;750  ;423  ;HorzAlign=Right;
                                                         SourceExpr=Edad }
            { 130 ;TextBox      ;16200;0    ;1800 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Compa¤ia salida" }
            { 131 ;TextBox      ;18150;0    ;1800 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Vuelo salida" }
            { 132 ;TextBox      ;20100;0    ;1650 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Fecha salida" }
            { 133 ;TextBox      ;9000 ;0    ;4500 ;423  ;SourceExpr=Nombre }
            { 134 ;TextBox      ;21900;0    ;1200 ;423  ;SourceExpr="N§ Habitacion" }
            { 135 ;TextBox      ;14550;0    ;1500 ;423  ;SourceExpr="Tipo Persona" }
            { 136 ;TextBox      ;23250;0    ;2250 ;423  ;SourceExpr="TourOperador Venta" }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=25500;
            SectionHeight=0;
            OnPreSection=BEGIN
                           IF CurrReport.TOTALSCAUSEDBY = "Reserva Hotel".FIELDNO("Hotel booking") THEN
                             NuevoHotel := TRUE;
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=25500;
            SectionHeight=0;
            OnPreSection=BEGIN
                           IF CurrReport.TOTALSCAUSEDBY = "Reserva Hotel".FIELDNO("Fecha entrada") THEN
                             IF "Reserva Hotel".NEXT > 0 THEN BEGIN
                               CurrReport.NEWPAGE;
                               "Reserva Hotel".NEXT(-1);
                             END
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=25500;
            SectionHeight=846;
            OnPreSection=BEGIN
                           //vNumPag := vNumPag + 1;
                           vNumPag     := CurrReport.PAGENO;
                         END;

          }
          CONTROLS
          {
            { 6   ;Shape        ;0    ;0    ;25500;423  ;ShapeStyle=HorzLine }
            { 7   ;TextBox      ;0    ;423  ;4350 ;423  ;FontSize=7;
                                                         FontBold=Yes;
                                                         SourceExpr=cNombre.nom_delegacion(rPar.Delegacion) }
            { 10  ;TextBox      ;24900;423  ;600  ;423  ;HorzAlign=Right;
                                                         SourceExpr=CurrReport.PAGENO }
            { 13  ;Label        ;24000;423  ;900  ;423  ;ParentControl=10;
                                                         VertAlign=Center;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=page;
                                                                    ESP=P gina] }
            { 16  ;TextBox      ;10500;423  ;4500 ;423  ;SourceExpr=FORMAT(TODAY,0,4)+' '+FORMAT(TIME,5)+' ('+USERID+')' }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table7009762;
        DataItemTableView=SORTING(Delegacion,N§ Interno,N§ Periodo,N§ Reserva,Tipo Reserva);
        OnPreDataItem=BEGIN
                        Comentarios.SETFILTER("Tipo Reserva", '%1|%2', Comentarios."Tipo Reserva"::Cabecera,
                                                                       Comentarios."Tipo Reserva"::Hotel);
                      END;

        DataItemLink=Delegacion=FIELD(Delegacion),
                     N§ Interno=FIELD(N§ Interno);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=25500;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 19  ;Label        ;0    ;0    ;450  ;423  ;CaptionML=[ENU=***;
                                                                    ESP=***] }
            { 22  ;TextBox      ;600  ;0    ;7050 ;423  ;SourceExpr=Texto }
            { 28  ;Label        ;7800 ;0    ;450  ;423  ;CaptionML=[ENU=***;
                                                                    ESP=***] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table7009743;
        DataItemTableView=SORTING(Delegacion,N§ Responsable,N§ Habitacion)
                          WHERE(Responsable=CONST(No));
        DataItemVarName=Acompa¤antes;
        DataItemLink=Delegacion=FIELD(Delegacion),
                     N§ Responsable=FIELD(N§ Reserva);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=25500;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 25  ;TextBox      ;9000 ;0    ;4500 ;423  ;SourceExpr=Nombre }
            { 30  ;TextBox      ;13650;0    ;750  ;423  ;SourceExpr=Edad }
            { 75  ;TextBox      ;14550;0    ;1500 ;423  ;SourceExpr="Tipo Persona" }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
      CaptionML=[ENU=Purchase Hotel rest. Communication;
                 ESP=Comunicaci¢n Res. Hotel Compra];
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text000@1103355016 : TextConst 'ENU=Company information chart does not exist;ESP=No existe la tabla informacion empresa';
      Text001@1103355017 : TextConst 'ENU=D.B. parameters chart do not exist;ESP=No existe la tabla parametros B.D.';
      rInfEmp@1103355000 : Record 79;
      rPar@1103355001 : Record 7009700;
      rEnvios@1103355002 : Record 7009761;
      cNombre@1103355003 : Codeunit 7009702;
      cmpTourOperador@1103355004 : Text[30];
      cmpEnvio@1103355005 : Integer;
      vCadTour@1103355006 : Text[50];
      vCadFec@1103355007 : Text[50];
      vNumPag@1103355008 : Integer;
      NuevoHotel@1103355009 : Boolean;
      Hotel@1103355010 : Code[20];
      Preli@1103355011 : Boolean;
      ImpresoAlgo@1103355012 : Boolean;
      EsReimpresion@1103355013 : Boolean;
      w_habitacion@1103355014 : Text[30];
      w_regimen@1103355015 : Text[30];

    PROCEDURE Definitivo@1() : Boolean;
    BEGIN
      EXIT((NOT Preli) AND ImpresoAlgo);
    END;

    PROCEDURE Reimpresion@2(par_reimpresion@1103355000 : Boolean);
    BEGIN
      EsReimpresion := par_reimpresion;
    END;

    BEGIN
    {

      ## AJF 29/06/09

        .- (09/00319) cambio c¢digos de hotel de code10 a code20.
    }
    END.
  }
  RDLDATA
  {
  }
}
