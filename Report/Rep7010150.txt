OBJECT Report 7010150 CNT-Hoja Servicio Excursiones
{
  OBJECT-PROPERTIES
  {
    Date=12/12/14;
    Time=11:50:56;
    Modified=Yes;
    Version List=AIC2009,CNT;
  }
  PROPERTIES
  {
    CaptionML=[ENU=CNT-Excursions service work-order;
               ESP=CNT-Hoja Servicio Excursiones];
    LeftMargin=1000;
    OnPreReport=BEGIN
                  rEmpresa.FINDFIRST;

                  FormatDire.Company(DirEmpresa,rEmpresa);

                  rDelegacion.FINDFIRST;
                END;

    Orientation=Landscape;
    PaperSize=Letter 8 1/2 x 11 in;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table7010163;
        DataItemTableView=SORTING(Estado,Fecha,Zona Excursion,Excursion)
                          WHERE(Estado=FILTER(Generada|Confirmada));
        DataItemVarName=diServicio;
        OnPreDataItem=VAR
                        lrPrest@1000000000 : Record 7010170;
                      BEGIN
                        IF wTodosProv THEN
                        BEGIN
                          lrPrest.RESET;
                          lrPrest.SETRANGE(Delegacion    , GETFILTER(Delegacion));
                          lrPrest.SETFILTER("N§ Servicio", GETFILTER("N§ Servicio"));
                          lrPrest.FINDFIRST;

                          IF lrPrest.COUNT > 1 THEN
                            wTodosProv := FALSE
                          ELSE
                            SETRANGE("N§ Servicio");
                        END;

                        IF wTodosProv THEN
                        BEGIN
                          CLEAR(wCodProveedor);
                          wCodProveedor := lrPrest.Proveedor;
                          wFecha := GETRANGEMIN(Fecha);
                        END;
                      END;

        OnAfterGetRecord=VAR
                           lrPrest@1000000001 : Record 7010170;
                           lrPrest2@1000000000 : Record 7010170;
                         BEGIN
                           //-$006Buscar_Zonas;
                           Buscar_Transportista;

                           lrPrest2.RESET;
                           lrPrest2.SETRANGE(Delegacion   , Delegacion);
                           lrPrest2.SETRANGE("N§ Servicio", "N§ Servicio");
                           IF wTodosProv THEN
                             lrPrest2.SETRANGE(Proveedor, wCodProveedor);

                           IF NOT lrPrest2.FINDFIRST THEN
                             CurrReport.SKIP;

                           IF wTodosProv THEN
                           BEGIN
                             lrPrest2.SETRANGE(Proveedor, wCodProveedor);

                             IF Fecha <> wFecha THEN
                               CurrReport.SKIP;
                           END;

                           rProducto.GET(Excursion);

                           //+$007 <
                           IF NOT CurrReport.PREVIEW THEN
                           BEGIN
                             "Peticion servicio impresa" := TRUE;
                             MODIFY;
                           END;
                           //+$007 >
                         END;

        ReqFilterFields=N§ Servicio,Fecha;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=26250;
            SectionHeight=5076;
          }
          CONTROLS
          {
            { 1000000000;TextBox;0    ;0    ;13950;423  ;FontSize=11;
                                                         FontBold=Yes;
                                                         SourceExpr=rEmpresa.Name }
            { 1000000001;Shape  ;0    ;846  ;26250;423  ;ShapeStyle=HorzLine }
            { 1000000002;Label  ;19950;0    ;6300 ;423  ;HorzAlign=Right;
                                                         FontSize=11;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Work order;
                                                                    ESP=Hoja de Servicio] }
            { 1000000003;TextBox;0    ;423  ;13950;423  ;FontSize=9;
                                                         SourceExpr=DirEmpresa[2]+' '+DirEmpresa[3]+' '+DirEmpresa[4] }
            { 1000000004;Label  ;11850;4230 ;4200 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Hotel;
                                                                    ESP=Hotel] }
            { 1000000005;Label  ;16200;4230 ;1200 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Room No.;
                                                                    ESP=N§ Habitacion] }
            { 1000000006;Label  ;17550;4230 ;750  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=AD.;
                                                                    ESP=AD.] }
            { 1000000007;Label  ;19350;4230 ;600  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=CH.;
                                                                    ESP=NI.] }
            { 1000000008;Label  ;0    ;4230 ;1950 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Ticket No.;
                                                                    ESP=N§ Ticket] }
            { 1000000009;Label  ;8550 ;4230 ;3150 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Vendor confirmation;
                                                                    ESP=Confirmacion proveedor] }
            { 1000000010;Label  ;21000;4230 ;900  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Picking time;
                                                                    ESP=Hora recogida] }
            { 1000000011;TextBox;3750 ;1692 ;2400 ;423  ;FontSize=10;
                                                         SourceExpr=Fecha }
            { 1000000012;Label  ;300  ;1692 ;3300 ;423  ;ParentControl=1000000011;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes }
            { 1000000013;TextBox;3750 ;2115 ;6900 ;423  ;FontSize=10;
                                                         CaptionML=[ENU=Supplier;
                                                                    ESP=Proveedor];
                                                         SourceExpr=rProveedor.Name }
            { 1000000014;Label  ;300  ;2115 ;3300 ;423  ;ParentControl=1000000013;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes }
            { 1000000016;TextBox;3750 ;2538 ;6900 ;423  ;FontSize=10;
                                                         SourceExpr=rProducto.Descripcion }
            { 1000000017;TextBox;3750 ;2961 ;8400 ;423  ;FontSize=10;
                                                         SourceExpr=Observaciones }
            { 1000000018;Label  ;300  ;2961 ;3300 ;423  ;ParentControl=1000000017;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Comments;
                                                                    ESP=Observaciones] }
            { 1000000021;Label  ;300  ;2538 ;3300 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Excursion;
                                                                    ESP=Excursion] }
            { 1000000023;Label  ;22050;4230 ;4200 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Name;
                                                                    ESP=Nombre] }
            { 1000000024;TextBox;3750 ;3384 ;8400 ;423  ;HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=10;
                                                         CaptionML=[ENU=Vehicle;
                                                                    ESP=Vehiculo];
                                                         SourceExpr="Tipo Vehiculo" + ' - ' + FORMAT("Capacidad vehiculo") }
            { 1000000025;Label  ;300  ;3384 ;3300 ;423  ;ParentControl=1000000024;
                                                         HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes }
            { 1000000026;Label  ;21750;1692 ;2100 ;423  ;ParentControl=1000000027;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes }
            { 1000000027;TextBox;24000;1692 ;2250 ;423  ;FontSize=12;
                                                         CaptionML=[ENU=Service;
                                                                    ESP=Servicio];
                                                         SourceExpr=diServicio."N§ Servicio" }
            { 1000000028;Label  ;6900 ;4230 ;1500 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Language;
                                                                    ESP=Idioma] }
            { 1000000029;Label  ;4650 ;4230 ;2100 ;846  ;ParentControl=1100217011;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000030;Label  ;2100 ;4230 ;2400 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Representant;
                                                                    ESP=Representante] }
            { 1000000031;TextBox;14400;2538 ;1050 ;423  ;FontSize=10;
                                                         SourceExpr=diServicio."Turno excursion" }
            { 1000000032;Label  ;10950;2538 ;3300 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Schedule;
                                                                    ESP=Turno] }
            { 1000000015;Label  ;18450;4230 ;750  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=AD Free;
                                                                    ESP=Free AD] }
            { 1000000019;Label  ;20100;4230 ;750  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=CH Free;
                                                                    ESP=Free NI] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table7010162;
        DataItemTableView=SORTING(Fecha Excursion,N§ Servicio,Orden zona,Orden hotel,Hotel Cliente);
        DataItemVarName=ResvExc;
        OnPreDataItem=BEGIN
                        SETCURRENTKEY("Fecha Excursion",
                                      "N§ Servicio",
                                      "Hora Recogida",
                                      "Orden hotel");
                      END;

        TotalFields=Adultos,Ni¤os,Adultos Reembolsados,Ni¤os Reembolsados;
        GroupTotalFields=N§ Servicio;
        DataItemLink=N§ Servicio=FIELD(N§ Servicio);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=26250;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 22  ;Label        ;11850;0    ;4200 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Hotel;
                                                                    ESP=Hotel] }
            { 25  ;Label        ;16200;0    ;1200 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Room No.;
                                                                    ESP=N§ Habitacion] }
            { 28  ;Label        ;17550;0    ;750  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=AD.;
                                                                    ESP=AD.] }
            { 31  ;Label        ;19350;0    ;600  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=CH.;
                                                                    ESP=NI.] }
            { 34  ;Label        ;0    ;0    ;1950 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Ticket No.;
                                                                    ESP=N§ Ticket] }
            { 38  ;Label        ;21000;0    ;900  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Picking time;
                                                                    ESP=Hora recogida] }
            { 43  ;TextBox      ;17550;846  ;750  ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=Adultos-"Adultos Reembolsados" }
            { 44  ;TextBox      ;19350;846  ;600  ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=Ni¤os-"Ni¤os Reembolsados" }
            { 45  ;Label        ;12450;846  ;4950 ;423  ;FontSize=10;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Previous sum;
                                                                    ESP=Suma anterior] }
            { 33  ;Label        ;22050;0    ;4200 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Name;
                                                                    ESP=Nombre] }
            { 1100217010;Label  ;6900 ;0    ;1500 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Language;
                                                                    ESP=Idioma] }
            { 1100217013;Label  ;4650 ;0    ;2100 ;846  ;ParentControl=1100217011;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1100217016;Label  ;2100 ;0    ;2400 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Representant;
                                                                    ESP=Representante] }
            { 1100217017;Label  ;8550 ;0    ;3150 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Vendor confirmation;
                                                                    ESP=Confirmacion proveedor] }
            { 1000000020;Label  ;18450;0    ;750  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=AD Free;
                                                                    ESP=Free AD] }
            { 1000000022;Label  ;20100;0    ;750  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=CH Free;
                                                                    ESP=Free NI] }
            { 1000000037;TextBox;18450;846  ;750  ;423  ;SourceExpr="Venta - Invitados Adultos" }
            { 1000000038;TextBox;20100;846  ;750  ;423  ;SourceExpr="Venta - Invitados ni¤os" }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=26250;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 11  ;TextBox      ;11850;0    ;4200 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr=fNoms.nom_hotel("Hotel Cliente") }
            { 14  ;TextBox      ;16200;0    ;1200 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="N§ Habitacion" }
            { 17  ;TextBox      ;17550;0    ;750  ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=Adultos-"Adultos Reembolsados" }
            { 20  ;TextBox      ;19350;0    ;600  ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=Ni¤os-"Ni¤os Reembolsados" }
            { 23  ;TextBox      ;0    ;0    ;1950 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="N§ Ticket" }
            { 29  ;TextBox      ;21000;0    ;900  ;423  ;FontSize=8;
                                                         SourceExpr="Hora Recogida";
                                                         Format=<Hours24,2>:<Minutes,2> }
            { 35  ;TextBox      ;22050;0    ;4200 ;423  ;FontSize=8;
                                                         SourceExpr="Nombre Cliente" }
            { 1100217008;TextBox;6900 ;0    ;1500 ;423  ;FontSize=8;
                                                         SourceExpr=fNoms.nom_idioma(Idioma) }
            { 1100217011;TextBox;4650 ;0    ;2100 ;423  ;FontSize=8;
                                                         SourceExpr=TourOperador }
            { 1100217015;TextBox;2100 ;0    ;2400 ;423  ;FontSize=8;
                                                         SourceExpr=fNoms.nom_Representante("Guia Venta") }
            { 1100217018;TextBox;8550 ;0    ;3150 ;423  ;FontSize=8;
                                                         SourceExpr="Confirmacion proveedor" }
            { 1000000033;TextBox;18450;0    ;750  ;423  ;SourceExpr="Venta - Invitados Adultos" }
            { 1000000035;TextBox;20100;0    ;750  ;423  ;SourceExpr="Venta - Invitados ni¤os" }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=26250;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT( (Observaciones <> '') OR ("Punto Recogida" <> '') )
                         END;

          }
          CONTROLS
          {
            { 8   ;TextBox      ;19500;0    ;6750 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr=Observaciones }
            { 26  ;TextBox      ;13650;0    ;4200 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Punto Recogida" }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=26250;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 10  ;TextBox      ;17550;0    ;750  ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=Adultos-"Adultos Reembolsados" }
            { 13  ;TextBox      ;20100;0    ;750  ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=Ni¤os-"Ni¤os Reembolsados" }
            { 46  ;Label        ;12450;0    ;4950 ;423  ;FontSize=10;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Total;
                                                                    ESP=Total] }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=26250;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 16  ;TextBox      ;17550;0    ;750  ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=Adultos-"Adultos Reembolsados" }
            { 19  ;TextBox      ;20100;0    ;750  ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=Ni¤os-"Ni¤os Reembolsados" }
            { 42  ;Label        ;12450;0    ;4950 ;423  ;FontSize=10;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Sum and continue;
                                                                    ESP=Suma y sigue] }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=26250;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 66  ;TextBox      ;0    ;0    ;26250;1269 ;VertAlign=Top;
                                                         FontSize=12;
                                                         MultiLine=Yes;
                                                         SourceExpr=Observaciones }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=26250;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 4   ;TextBox      ;7650 ;423  ;10800;423  ;HorzAlign=Center;
                                                         FontSize=10;
                                                         SourceExpr=FORMAT(TODAY,0,4) + ' / ' + FORMAT(TIME,0,0) + ' / ' + USERID }
            { 5   ;Shape        ;0    ;0    ;26250;423  ;ShapeStyle=HorzLine }
            { 6   ;TextBox      ;0    ;423  ;5400 ;423  ;FontSize=10;
                                                         SourceExpr=fNoms.nom_delegacion(rDelegacion.Delegacion) }
            { 7   ;TextBox      ;23100;423  ;3150 ;423  ;HorzAlign=Right;
                                                         FontSize=10;
                                                         SourceExpr=Text004 + ' ' + FORMAT(CurrReport.PAGENO) }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table7010206;
        DataItemTableView=SORTING(Delegacion,N§ Servicio,ID Soporte);
        NewPagePerRecord=Yes;
        DataItemVarName=Soporte;
        OnPreDataItem=BEGIN

                        SETRANGE(Delegacion   , ResvExc.Delegacion);
                        SETRANGE("N§ Servicio", ResvExc."N§ Servicio");
                      END;

        OnAfterGetRecord=BEGIN
                           IF NOT rProveedor.GET("Proveedor Transporte") THEN
                             CLEAR(rProveedor);

                           CLEAR(wToAdultosSop);
                           CLEAR(wToNi¤osSop);
                         END;

        DataItemLink=N§ Servicio=FIELD(N§ Servicio);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=26250;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 1100253000;TextBox;0    ;0    ;7350 ;423  ;FontSize=11;
                                                         FontBold=Yes;
                                                         SourceExpr=rEmpresa.Name }
            { 1100253001;Shape  ;0    ;846  ;26250;423  ;ShapeStyle=HorzLine }
            { 1100253002;Label  ;19200;0    ;6300 ;423  ;HorzAlign=Right;
                                                         FontSize=11;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=Hoja de Servicio }
            { 1100253003;TextBox;0    ;423  ;14550;423  ;FontSize=9;
                                                         SourceExpr=DirEmpresa[2]+' '+DirEmpresa[3]+' '+DirEmpresa[4] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=26250;
            SectionHeight=5076;
          }
          CONTROLS
          {
            { 1100253016;TextBox;3750 ;846  ;2400 ;423  ;FontSize=10;
                                                         CaptionML=[ENU=Service date;
                                                                    ESP=Fecha excursion];
                                                         SourceExpr=ResvExc."Fecha Excursion" }
            { 1100253017;Label  ;300  ;846  ;3300 ;423  ;ParentControl=1100253016;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes }
            { 1100253018;TextBox;3750 ;1269 ;6900 ;423  ;FontSize=10;
                                                         CaptionML=[ENU=Supplier;
                                                                    ESP=Proveedor];
                                                         SourceExpr=rProveedor.Name }
            { 1100253019;Label  ;300  ;1269 ;3300 ;423  ;ParentControl=1100253018;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes }
            { 1100253023;TextBox;3750 ;1692 ;6900 ;423  ;FontSize=10;
                                                         SourceExpr=rProducto.Descripcion }
            { 1100253024;TextBox;3750 ;2115 ;8400 ;423  ;FontSize=10;
                                                         SourceExpr=rHoja.Observaciones }
            { 1100253025;Label  ;300  ;2115 ;3300 ;423  ;ParentControl=1100253024;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Remarks;
                                                                    ESP=Observaciones] }
            { 1100253030;Label  ;300  ;1692 ;3300 ;423  ;FontSize=10;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=[ENU=Excursion;
                                                                    ESP=Excursion] }
            { 1100253043;Label  ;0    ;0    ;5100 ;846  ;HorzAlign=Left;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=SUPPORT Service;
                                                                    ESP=Servicio SOPORTE] }
            { 1100253044;TextBox;3750 ;2538 ;8400 ;423  ;HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=10;
                                                         CaptionML=[ENU=Vehicle;
                                                                    ESP=Vehiculo];
                                                         SourceExpr="Tipo Vehiculo" + ' - ' + FORMAT("Capacidad vehiculo") }
            { 1100253045;Label  ;300  ;2538 ;3300 ;423  ;ParentControl=1100253044;
                                                         HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes }
            { 1100253046;TextBox;15150;2538 ;3600 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         SourceExpr="Numero Bus" }
            { 1100253047;Label  ;12600;2538 ;2400 ;423  ;ParentControl=1100253046;
                                                         HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes }
            { 1100253048;TextBox;3750 ;2961 ;8400 ;423  ;HorzAlign=Left;
                                                         FontSize=10;
                                                         SourceExpr="Punto de Encuentro" }
            { 1100253059;Label  ;300  ;2961 ;3300 ;423  ;ParentControl=1100253048;
                                                         HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes }
            { 1100253060;TextBox;5100 ;0    ;7050 ;846  ;FontSize=14;
                                                         FontBold=Yes;
                                                         SourceExpr=Direccion }
            { 1100217004;TextBox;24000;0    ;2250 ;423  ;FontSize=12;
                                                         CaptionML=[ENU=Service;
                                                                    ESP=Servicio];
                                                         SourceExpr="N§ Servicio" }
            { 1100217005;Label  ;21750;0    ;2250 ;423  ;ParentControl=1100217004;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         LeaderDots=Yes }
            { 1100217019;Label  ;0    ;3807 ;1950 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Ticket No.;
                                                                    ESP=N§ Ticket] }
            { 1100217020;Label  ;10350;3807 ;3150 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Vendor confirmation;
                                                                    ESP=Confirmacion proveedor] }
            { 1100217021;Label  ;8700 ;3807 ;1500 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Language;
                                                                    ESP=Idioma] }
            { 1100217022;Label  ;6450 ;3807 ;2100 ;846  ;ParentControl=1100217038;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1100217023;Label  ;2100 ;3807 ;4200 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Representant;
                                                                    ESP=Representante] }
            { 1100217024;Label  ;13650;3807 ;4200 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Hotel;
                                                                    ESP=Hotel] }
            { 1100217025;Label  ;18000;3807 ;1200 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Room No.;
                                                                    ESP=N§ Habitacion] }
            { 1100217026;Label  ;19350;3807 ;750  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=AD.;
                                                                    ESP=AD.] }
            { 1100217027;Label  ;20250;3807 ;600  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=CH.;
                                                                    ESP=NI.] }
            { 1100217028;Label  ;21000;3807 ;900  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Picking time;
                                                                    ESP=Hora recogida] }
            { 1100217029;Label  ;22050;3807 ;4200 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=Name;
                                                                    ESP=Nombre] }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=26250;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1100253053;TextBox;7650 ;423  ;10800;423  ;HorzAlign=Center;
                                                         FontSize=10;
                                                         SourceExpr=FORMAT(TODAY,0,4) + ' / ' + FORMAT(TIME,0,0) + ' / ' + USERID }
            { 1100253054;Shape  ;0    ;0    ;26250;423  ;ShapeStyle=HorzLine }
            { 1100253055;TextBox;0    ;423  ;5400 ;423  ;FontSize=10;
                                                         SourceExpr=fNoms.nom_delegacion(rDelegacion.Delegacion) }
            { 1100253056;TextBox;23100;423  ;3150 ;423  ;HorzAlign=Right;
                                                         FontSize=10;
                                                         SourceExpr=Text004 + ' ' + FORMAT(CurrReport.PAGENO) }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table7010214;
        DataItemTableView=SORTING(Delegacion,N§ Servicio,Id Soporte,Id Detalle);
        DataItemVarName=PersonaSoporte;
        GroupTotalFields=Id Soporte;
        DataItemLink=Delegacion=FIELD(Delegacion),
                     N§ Servicio=FIELD(N§ Servicio),
                     Id Soporte=FIELD(ID Soporte);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=26250;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1100253042;TextBox;20250;0    ;600  ;423  ;HorzAlign=Right;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=wToNi¤osSop }
            { 1100253029;TextBox;19350;0    ;750  ;423  ;HorzAlign=Right;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=wToAdultosSop }
            { 1100253028;Label  ;14250;0    ;4950 ;423  ;FontSize=10;
                                                         LeaderDots=Yes;
                                                         CaptionML=ESP=Total }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PlaceInBottom=Yes;
            SectionWidth=26250;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 1100253050;TextBox;0    ;0    ;26250;1269 ;VertAlign=Top;
                                                         FontSize=12;
                                                         MultiLine=Yes;
                                                         SourceExpr=diServicio.Observaciones }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table7010162;
        DataItemTableView=SORTING(Delegacion,N§ Reserva);
        DataItemVarName=ResvExcSop;
        OnAfterGetRecord=BEGIN
                           wToAdultosSop += Adultos;
                           wToNi¤osSop   += Ni¤os;
                         END;

        DataItemLink=Delegacion=FIELD(Delegacion),
                     N§ Reserva=FIELD(N§ Reserva);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=26250;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1100217030;TextBox;13650;0    ;4200 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr=fNoms.nom_hotel("Hotel Cliente") }
            { 1100217031;TextBox;18000;0    ;1200 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="N§ Habitacion" }
            { 1100217032;TextBox;19350;0    ;750  ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=Adultos-"Adultos Reembolsados" }
            { 1100217033;TextBox;20250;0    ;600  ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=Ni¤os-"Ni¤os Reembolsados" }
            { 1100217034;TextBox;0    ;0    ;1950 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="N§ Ticket" }
            { 1100217035;TextBox;21000;0    ;900  ;423  ;FontSize=8;
                                                         SourceExpr="Hora Recogida";
                                                         Format=<Hours24,2>:<Minutes,2> }
            { 1100217036;TextBox;22050;0    ;4200 ;423  ;FontSize=8;
                                                         SourceExpr="Nombre Cliente" }
            { 1100217037;TextBox;8700 ;0    ;1500 ;423  ;FontSize=8;
                                                         SourceExpr=fNoms.nom_idioma(Idioma) }
            { 1100217038;TextBox;6450 ;0    ;2100 ;423  ;FontSize=8;
                                                         SourceExpr=TourOperador }
            { 1100217039;TextBox;2100 ;0    ;4200 ;423  ;FontSize=8;
                                                         SourceExpr=fNoms.nom_Representante("Guia Venta") }
            { 1100217040;TextBox;10350;0    ;3150 ;423  ;FontSize=8;
                                                         SourceExpr="Confirmacion proveedor" }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=26250;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT( (Observaciones <> '') OR ("Punto Recogida" <> '') )
                         END;

          }
          CONTROLS
          {
            { 1100217041;TextBox;19500;0    ;6750 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr=Observaciones }
            { 1100217042;TextBox;13650;0    ;4200 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Punto Recogida" }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=7480;
      Height=1540;
      CaptionML=[ENU=Excursions service work-order;
                 ESP=Hoja de Servicio Excursiones];
    }
    CONTROLS
    {
      { 1000000000;Label  ;110  ;110  ;5390 ;440  ;ParentControl=1000000001;
                                                   InPage=-1 }
      { 1000000001;CheckBox;5610;110  ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=[ENU=Print all the services for the vendor;
                                                              ESP=Imprimir todos los servicios del proveedor];
                                                   SourceExpr=wTodosProv }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text003@1103355021 : TextConst 'ENU=Service sheet %1 does not exist;ESP=No existe la hoja de servicio %1';
      Text004@1103355022 : TextConst 'ENU=page;ESP=P gina';
      Text005@1103355023 : TextConst 'ENU=Contract %1 does not exist;ESP=No existe el contrato %1';
      Text006@1103355024 : TextConst 'ENU=Supplier %1 does not exist;ESP=No existe el proveedor %1';
      rEmpresa@1103355000 : Record 79;
      rDelegacion@1103355001 : Record 7009700;
      fNoms@1103355003 : Codeunit 7009702;
      FormatDire@1103355004 : Codeunit 365;
      rPrestacion@1103355005 : Record 7010170;
      rProveedor@1103355006 : Record 23;
      rProducto@1103355008 : Record 7009710;
      rHoja@1103355009 : Record 7010168;
      TourOperador@1103355013 : ARRAY [15] OF Code[10];
      rContrato@1103355014 : Record 7010142;
      DirEmpresa@1103355017 : ARRAY [8] OF Text[50];
      wToAdultosSop@1100253000 : Decimal;
      wToNi¤osSop@1100253001 : Decimal;
      wTodosProv@1000000000 : Boolean;
      wCodProveedor@1000000001 : Code[20];
      wFecha@1000000002 : Date;

    PROCEDURE Buscar_Transportista@10();
    BEGIN
      rPrestacion.RESET;
      rPrestacion.SETRANGE (Delegacion     , diServicio.Delegacion);
      rPrestacion.SETRANGE ("N§ Servicio"  , diServicio."N§ Servicio");
      rPrestacion.SETRANGE ("Tipo Contrato", rPrestacion."Tipo Contrato"::Transportista);
      IF rPrestacion.FINDFIRST THEN
      BEGIN
        IF NOT rContrato.GET(rPrestacion.Delegacion, rPrestacion."N§ Contrato", rContrato."Tipo Contrato"::Transportista) THEN
          ERROR(Text005, rPrestacion."N§ Contrato");
        IF NOT rProveedor.GET(rContrato.Proveedor) THEN
          ERROR(Text006, rContrato.Proveedor);
      END
      //. Si no hay Transportista buscaremos el proveedor de servicio
      ELSE
      BEGIN
        rPrestacion.SETRANGE ("Tipo Contrato", rPrestacion."Tipo Contrato"::Excursion);
        IF rPrestacion.FINDFIRST THEN
        BEGIN
          IF NOT rContrato.GET(rPrestacion.Delegacion, rPrestacion."N§ Contrato", rContrato."Tipo Contrato"::Excursion) THEN
          BEGIN
            CLEAR(rProveedor);
            EXIT;
          END;
          IF NOT rProveedor.GET(rContrato.Proveedor) THEN
            ERROR(Text006, rContrato.Proveedor);
        END
      END;
    END;

    BEGIN
    {
      $001 AJS 04022014 Aumento el array Touroperador a 15

      $002 AJS 04502014 Cambios de formato para crear un nuevo formato para CNT

      $003 ARM 28072014 Reembolsos CNT-OC-14047

      $004 AJS 23092014 Poder imprimir todos los servicios del mismo proveedor de una vez

      $005 AJS 29092014 Ajustes de traduccion

      $006 AJS 11102014 Elimino la funcion Buscar_Zonas porque no aporta informacion

      $007 AJS 11102014 La marca de diServicio."Peticion servicio impresa" se pone automatica al lanzar por
                        impresora

      $008 AJS 08122014 Mostrar las observaciones del servicio en lugar de las observaciones de la hoja

      $009 AJS 12122014 Poder imprimir los servicios confirmados
    }
    END.
  }
  RDLDATA
  {
  }
}
