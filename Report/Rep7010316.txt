OBJECT Report 7010316 Estadillo de incidencias
{
  OBJECT-PROPERTIES
  {
    Date=16/10/09;
    Time=12:34:25;
    Version List=TRANSFER;
  }
  PROPERTIES
  {
    CaptionML=ESP=Estadillo de incidencias;
    Orientation=Landscape;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table7010327;
        DataItemTableView=SORTING(Conductor);
        OnPreDataItem=VAR
                        cCond@1100244000 : Codeunit 7010313;
                      BEGIN
                        //Construimos el orden adecuado.
                        CASE cCond.ObtenerOrden() OF
                          Text000:
                              SETCURRENTKEY(Garaje,"Nombre Abreviado");
                          Text001:
                              SETCURRENTKEY(Garaje,"Tipo Acuerdo","Nombre Abreviado");
                          Text002 :
                              SETCURRENTKEY(Garaje,"Tipo Acuerdo","Orden Contrato","Fecha Antiguedad","Nombre Abreviado");
                          Text003 :
                              SETCURRENTKEY(Garaje,"Grupo Vehiculo","Tipo Acuerdo","Orden Contrato","Fecha Antiguedad","Nombre Abreviado");
                        END;

                        //Calculamos la fecha final

                        vFI := DMY2DATE(1,vMes+1,vA¤o);
                        //vFF := vFI+31;
                        //WHILE DATE2DMY(vFF+1,1)<>1 DO
                        //  vFF := vFF-1;

                        vFF := CALCDATE(Text50000, vFI);

                        // Calculamos los conceptos a considerar: Vacaciones, dia libre,...

                        CalcularConceptos;
                      END;

        OnAfterGetRecord=VAR
                           rHI@1100244000 : Record 7010333;
                           rRA@1100244001 : Record 7010332;
                           rConf@1100244006 : Record 7035345;
                           vContador@1100244002 : Integer;
                           aAmbito@1100244003 : ARRAY [62,2] OF Date;
                           aValor@1100244004 : ARRAY [62] OF Text[3];
                           vFecha@1100244005 : Date;
                         BEGIN
                           // Inicializaciones

                           wTieneIncidencia := FALSE;
                           vContador := 0;
                           CLEAR(aIncid);
                           CLEAR(aAmbito);
                           CLEAR(aValor);
                           CLEAR(rConf);
                           //.......
                           FOR vFecha := vFI TO vFF DO BEGIN
                             //Accedemos a la tabla de incidencias.
                             //.......
                             vContador:=DATE2DMY(vFecha,1);

                             rHI.RESET;
                             rHI.SETCURRENTKEY(Conductor,Prioridad,"Fecha Desde","Fecha Hasta");
                             rHI.SETRANGE(Conductor     , Conductor);
                             rHI.SETFILTER("Fecha Desde", '<=%1',vFecha);
                             rHI.SETFILTER("Fecha Hasta", '>=%1 | %2',vFecha,0D);
                             //BRM 17/06/04
                             rHI.SETFILTER(Motivo,vFltIncidencias);
                             //rHI.SETFILTER("Cod Motivo", vFltIncidencias);
                             IF rHI.FINDSET THEN BEGIN
                               //BRM 17/06/04
                               //IF rConf.GET(rHI.Motivo) THEN
                               IF rConf.GET(rHI."Cod Motivo") THEN BEGIN
                                 aIncid[vContador] := rConf.Codigo;
                                 wTieneIncidencia  := TRUE;
                               END;
                             END;

                             //......
                             //Y si procede, a las nocturnidades.
                             //......
                             // Solo si no se ha insetado ninguna incidencia
                             IF vNocturnidad AND (aIncid[vContador]='') THEN BEGIN
                               rRA.RESET;
                               rRA.SETCURRENTKEY(Conductor,Fecha);
                               rRA.SETRANGE(Conductor  , Conductor);
                               rRA.SETRANGE(Fecha      , vFecha);
                               rRA.SETRANGE(Nocturnidad, TRUE);
                               IF rRA.FINDSET THEN BEGIN
                                 aIncid[vContador] := Text009;
                                 wTieneIncidencia  := TRUE;
                               END;
                             END;
                           END;

                           IF vSoloconIncidencias AND NOT wTieneIncidencia THEN
                             CurrReport.SKIP;
                         END;

        ReqFilterFields=Garaje,Tipo Acuerdo;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=25650;
            SectionHeight=2325;
          }
          CONTROLS
          {
            { 1   ;Label        ;0    ;0    ;7500 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=Estadillo de incidencias }
            { 2   ;TextBox      ;22200;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 3   ;TextBox      ;0    ;423  ;7500 ;423  ;SourceExpr=COMPANYNAME }
            { 4   ;TextBox      ;24900;423  ;450  ;423  ;CaptionML=ESP=P gina;
                                                         SourceExpr=CurrReport.PAGENO }
            { 5   ;Label        ;24150;423  ;750  ;423  ;ParentControl=4 }
            { 6   ;TextBox      ;23550;846  ;1800 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
            { 42  ;Label        ;0    ;846  ;1200 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Mes }
            { 76  ;TextBox      ;6450 ;846  ;16950;423  ;SourceExpr=GETFILTERS }
            { 77  ;Label        ;5100 ;846  ;1200 ;423  ;ParentControl=76;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Filtros }
            { 78  ;Shape        ;0    ;1692 ;25350;423  ;ShapeStyle=HorzLine }
            { 79  ;TextBox      ;1350 ;846  ;3300 ;423  ;SourceExpr=FORMAT(vMes)+Text010+FORMAT(vA¤o) }
            { 83  ;Shape        ;4050 ;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 86  ;Shape        ;3450 ;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 85  ;Shape        ;4650 ;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 90  ;Shape        ;5250 ;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 91  ;Shape        ;5850 ;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 92  ;Shape        ;6450 ;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 89  ;Shape        ;10050;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 93  ;Shape        ;9450 ;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 94  ;Shape        ;8850 ;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 95  ;Shape        ;8250 ;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 96  ;Shape        ;7650 ;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 97  ;Shape        ;7050 ;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 98  ;Shape        ;14850;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 99  ;Shape        ;14250;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 100 ;Shape        ;13650;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 101 ;Shape        ;13050;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 102 ;Shape        ;12450;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 103 ;Shape        ;11850;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 104 ;Shape        ;11250;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 105 ;Shape        ;10650;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 106 ;Shape        ;19050;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 107 ;Shape        ;18450;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 108 ;Shape        ;17850;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 109 ;Shape        ;17250;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 110 ;Shape        ;16650;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 111 ;Shape        ;16050;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 112 ;Shape        ;15450;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 113 ;Shape        ;22050;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 114 ;Shape        ;21450;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 115 ;Shape        ;20850;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 116 ;Shape        ;20250;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 117 ;Shape        ;19650;1910 ;150  ;415  ;ShapeStyle=VertLine }
            { 176 ;Label        ;0    ;1269 ;3600 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Conceptos a considerar }
            { 177 ;TextBox      ;3750 ;1269 ;21600;423  ;VertAlign=Bottom;
                                                         SourceExpr=vStrConceptos }
            { 178 ;Label        ;4800 ;846  ;150  ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=/ }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=25650;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 7   ;Label        ;0    ;0    ;3450 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Conductor }
            { 10  ;Label        ;3600 ;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=1 }
            { 11  ;Label        ;4200 ;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=2 }
            { 12  ;Label        ;4800 ;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=3 }
            { 13  ;Label        ;5400 ;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=4 }
            { 14  ;Label        ;6000 ;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=5 }
            { 15  ;Label        ;6600 ;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=6 }
            { 16  ;Label        ;7200 ;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=7 }
            { 17  ;Label        ;7800 ;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=8 }
            { 18  ;Label        ;8400 ;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=9 }
            { 19  ;Label        ;9000 ;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=10 }
            { 20  ;Label        ;9600 ;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=11 }
            { 21  ;Label        ;10200;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=12 }
            { 22  ;Label        ;10800;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=13 }
            { 23  ;Label        ;11400;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=14 }
            { 24  ;Label        ;12000;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=15 }
            { 25  ;Label        ;12600;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=16 }
            { 26  ;Label        ;13200;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=17 }
            { 27  ;Label        ;13800;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=18 }
            { 28  ;Label        ;14400;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=19 }
            { 29  ;Label        ;15000;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=20 }
            { 30  ;Label        ;15600;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=21 }
            { 31  ;Label        ;16200;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=22 }
            { 32  ;Label        ;16800;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=23 }
            { 33  ;Label        ;17400;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=24 }
            { 34  ;Label        ;18000;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=25 }
            { 35  ;Label        ;18600;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=26 }
            { 36  ;Label        ;19200;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=27 }
            { 37  ;Label        ;19800;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=28 }
            { 38  ;Label        ;20400;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=29 }
            { 39  ;Label        ;21000;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=30 }
            { 40  ;Label        ;21600;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontBold=Yes;
                                                         CaptionML=ESP=31 }
            { 41  ;Label        ;22200;0    ;3150 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ESP=Conductor }
            { 9   ;Shape        ;0    ;423  ;25350;423  ;ShapeStyle=HorzLine }
            { 81  ;Shape        ;4050 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 82  ;Shape        ;3450 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 87  ;Shape        ;4650 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 118 ;Shape        ;5850 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 119 ;Shape        ;5250 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 120 ;Shape        ;12450;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 121 ;Shape        ;11850;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 122 ;Shape        ;11250;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 123 ;Shape        ;10650;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 124 ;Shape        ;10050;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 125 ;Shape        ;9450 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 126 ;Shape        ;8850 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 127 ;Shape        ;8250 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 128 ;Shape        ;7650 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 129 ;Shape        ;7050 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 130 ;Shape        ;6450 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 131 ;Shape        ;17850;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 132 ;Shape        ;17250;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 133 ;Shape        ;16650;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 134 ;Shape        ;16050;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 135 ;Shape        ;15450;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 136 ;Shape        ;14850;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 137 ;Shape        ;14250;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 138 ;Shape        ;13650;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 139 ;Shape        ;13050;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 140 ;Shape        ;20850;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 141 ;Shape        ;20250;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 142 ;Shape        ;19650;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 143 ;Shape        ;19050;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 144 ;Shape        ;18450;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 145 ;Shape        ;21450;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 147 ;Shape        ;22050;0    ;150  ;846  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=25650;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 8   ;TextBox      ;0    ;0    ;3450 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Nombre Abreviado" }
            { 43  ;TextBox      ;3600 ;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[1] }
            { 44  ;TextBox      ;4200 ;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[2] }
            { 45  ;TextBox      ;6000 ;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[5] }
            { 46  ;TextBox      ;6600 ;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[6] }
            { 47  ;TextBox      ;4800 ;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[3] }
            { 48  ;TextBox      ;5400 ;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[4] }
            { 49  ;TextBox      ;7200 ;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[7] }
            { 50  ;TextBox      ;7800 ;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[8] }
            { 51  ;TextBox      ;8400 ;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[9] }
            { 52  ;TextBox      ;9000 ;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[10] }
            { 53  ;TextBox      ;9600 ;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[11] }
            { 54  ;TextBox      ;10200;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[12] }
            { 55  ;TextBox      ;10800;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[13] }
            { 56  ;TextBox      ;11400;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[14] }
            { 57  ;TextBox      ;12000;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[15] }
            { 58  ;TextBox      ;12600;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[16] }
            { 59  ;TextBox      ;13200;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[17] }
            { 60  ;TextBox      ;13800;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[18] }
            { 61  ;TextBox      ;14400;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[19] }
            { 62  ;TextBox      ;15000;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[20] }
            { 63  ;TextBox      ;15600;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[21] }
            { 64  ;TextBox      ;16200;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[22] }
            { 65  ;TextBox      ;16800;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[23] }
            { 66  ;TextBox      ;17400;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[24] }
            { 67  ;TextBox      ;18000;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[25] }
            { 68  ;TextBox      ;18600;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[26] }
            { 69  ;TextBox      ;19200;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[27] }
            { 70  ;TextBox      ;19800;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[28] }
            { 71  ;TextBox      ;20400;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[29] }
            { 72  ;TextBox      ;21000;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[30] }
            { 73  ;TextBox      ;21600;0    ;450  ;423  ;HorzAlign=Center;
                                                         FontSize=6;
                                                         SourceExpr=aIncid[31] }
            { 74  ;TextBox      ;22200;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr="Nombre Abreviado" }
            { 75  ;Shape        ;0    ;423  ;25350;423  ;VertGlue=Top;
                                                         ShapeStyle=HorzLine }
            { 80  ;Shape        ;4050 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 84  ;Shape        ;3450 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 88  ;Shape        ;4650 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 146 ;Shape        ;5850 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 148 ;Shape        ;5250 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 149 ;Shape        ;17250;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 150 ;Shape        ;16650;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 151 ;Shape        ;16050;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 152 ;Shape        ;15450;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 153 ;Shape        ;14850;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 154 ;Shape        ;14250;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 155 ;Shape        ;13650;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 156 ;Shape        ;13050;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 157 ;Shape        ;12450;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 158 ;Shape        ;11850;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 159 ;Shape        ;11250;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 160 ;Shape        ;10650;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 161 ;Shape        ;10050;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 162 ;Shape        ;9450 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 163 ;Shape        ;8850 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 164 ;Shape        ;8250 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 165 ;Shape        ;7650 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 166 ;Shape        ;7050 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 167 ;Shape        ;6450 ;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 168 ;Shape        ;22050;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 169 ;Shape        ;21450;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 170 ;Shape        ;20850;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 171 ;Shape        ;20250;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 172 ;Shape        ;19650;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 173 ;Shape        ;19050;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 174 ;Shape        ;18450;0    ;150  ;846  ;ShapeStyle=VertLine }
            { 175 ;Shape        ;17850;0    ;150  ;846  ;ShapeStyle=VertLine }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=8800;
      Height=10010;
      OnOpenForm=VAR
                   lwCont@1100253000 : Integer;
                 BEGIN
                   vMes := DATE2DMY(TODAY,2)-1;
                   vA¤o := DATE2DMY(TODAY,3);
                   vSoloconIncidencias := FALSE;
                   MarcaConceptos(TRUE);
                 END;

    }
    CONTROLS
    {
      { 1100253000;CheckBox;3520;2310 ;440  ;440  ;ParentControl=5;
                                                   InFrame=Yes;
                                                   ShowCaption=No;
                                                   SourceExpr=wMMotivos[1] }
      { 1100253001;TextBox;330  ;2310 ;3020 ;440  ;Editable=No;
                                                   Focusable=No;
                                                   ParentControl=1100253000;
                                                   Border=No;
                                                   LeaderDots=Yes;
                                                   SourceExpr=TituloMotivo(1) }
      { 1100253017;CheckBox;3520;2860 ;440  ;440  ;ParentControl=5;
                                                   InFrame=Yes;
                                                   ShowCaption=No;
                                                   SourceExpr=wMMotivos[2] }
      { 1100253018;TextBox;330  ;2860 ;3020 ;440  ;Editable=No;
                                                   Focusable=No;
                                                   ParentControl=1100253017;
                                                   Border=No;
                                                   LeaderDots=Yes;
                                                   SourceExpr=TituloMotivo(2) }
      { 1100253019;CheckBox;3520;3410 ;440  ;440  ;ParentControl=5;
                                                   InFrame=Yes;
                                                   ShowCaption=No;
                                                   SourceExpr=wMMotivos[3] }
      { 1100253020;TextBox;330  ;3410 ;3020 ;440  ;Editable=No;
                                                   Focusable=No;
                                                   ParentControl=1100253019;
                                                   Border=No;
                                                   LeaderDots=Yes;
                                                   SourceExpr=TituloMotivo(3) }
      { 1100253021;CheckBox;3520;3960 ;440  ;440  ;ParentControl=5;
                                                   InFrame=Yes;
                                                   ShowCaption=No;
                                                   SourceExpr=wMMotivos[4] }
      { 1100253022;TextBox;330  ;3960 ;3020 ;440  ;Editable=No;
                                                   Focusable=No;
                                                   ParentControl=1100253021;
                                                   Border=No;
                                                   LeaderDots=Yes;
                                                   SourceExpr=TituloMotivo(4) }
      { 1100253023;CheckBox;3520;4510 ;440  ;440  ;ParentControl=5;
                                                   InFrame=Yes;
                                                   ShowCaption=No;
                                                   SourceExpr=wMMotivos[5] }
      { 1100253024;TextBox;330  ;4510 ;3020 ;440  ;Editable=No;
                                                   Focusable=No;
                                                   ParentControl=1100253023;
                                                   Border=No;
                                                   LeaderDots=Yes;
                                                   SourceExpr=TituloMotivo(5) }
      { 1100253025;CheckBox;3520;5060 ;440  ;440  ;ParentControl=5;
                                                   InFrame=Yes;
                                                   ShowCaption=No;
                                                   SourceExpr=wMMotivos[6] }
      { 1100253026;TextBox;330  ;5060 ;3020 ;440  ;Editable=No;
                                                   Focusable=No;
                                                   ParentControl=1100253025;
                                                   Border=No;
                                                   LeaderDots=Yes;
                                                   SourceExpr=TituloMotivo(6) }
      { 1100253027;CheckBox;3520;5610 ;440  ;440  ;ParentControl=5;
                                                   InFrame=Yes;
                                                   ShowCaption=No;
                                                   SourceExpr=wMMotivos[7] }
      { 1100253028;TextBox;330  ;5610 ;3020 ;440  ;Editable=No;
                                                   Focusable=No;
                                                   ParentControl=1100253027;
                                                   Border=No;
                                                   LeaderDots=Yes;
                                                   SourceExpr=TituloMotivo(7) }
      { 1100253029;CheckBox;3520;6160 ;440  ;440  ;ParentControl=5;
                                                   InFrame=Yes;
                                                   ShowCaption=No;
                                                   SourceExpr=wMMotivos[8] }
      { 1100253030;TextBox;330  ;6160 ;3020 ;440  ;Editable=No;
                                                   Focusable=No;
                                                   ParentControl=1100253029;
                                                   Border=No;
                                                   LeaderDots=Yes;
                                                   SourceExpr=TituloMotivo(8) }
      { 1100253031;CheckBox;3520;6710 ;440  ;440  ;ParentControl=5;
                                                   InFrame=Yes;
                                                   ShowCaption=No;
                                                   SourceExpr=wMMotivos[9] }
      { 1100253032;TextBox;330  ;6710 ;3020 ;440  ;Editable=No;
                                                   Focusable=No;
                                                   ParentControl=1100253031;
                                                   Border=No;
                                                   LeaderDots=Yes;
                                                   SourceExpr=TituloMotivo(9) }
      { 1100253033;CheckBox;3520;7260 ;440  ;440  ;ParentControl=5;
                                                   InFrame=Yes;
                                                   ShowCaption=No;
                                                   SourceExpr=wMMotivos[10] }
      { 1100253034;TextBox;330  ;7260 ;3020 ;440  ;Editable=No;
                                                   Focusable=No;
                                                   ParentControl=1100253033;
                                                   Border=No;
                                                   LeaderDots=Yes;
                                                   SourceExpr=TituloMotivo(10) }
      { 1100253035;CheckBox;3520;7810 ;440  ;440  ;ParentControl=5;
                                                   InFrame=Yes;
                                                   ShowCaption=No;
                                                   SourceExpr=wMMotivos[11] }
      { 1100253036;TextBox;330  ;7810 ;3020 ;440  ;Editable=No;
                                                   Focusable=No;
                                                   ParentControl=1100253035;
                                                   Border=No;
                                                   LeaderDots=Yes;
                                                   SourceExpr=TituloMotivo(11) }
      { 1100253037;CheckBox;3520;8360 ;440  ;440  ;ParentControl=5;
                                                   InFrame=Yes;
                                                   ShowCaption=No;
                                                   SourceExpr=wMMotivos[12] }
      { 1100253038;TextBox;330  ;8360 ;3020 ;440  ;Editable=No;
                                                   Focusable=No;
                                                   ParentControl=1100253037;
                                                   Border=No;
                                                   LeaderDots=Yes;
                                                   SourceExpr=TituloMotivo(12) }
      { 1100253039;CheckBox;3520;8910 ;440  ;440  ;ParentControl=5;
                                                   InFrame=Yes;
                                                   ShowCaption=No;
                                                   SourceExpr=wMMotivos[13] }
      { 1100253040;TextBox;330  ;8910 ;3020 ;440  ;Editable=No;
                                                   Focusable=No;
                                                   ParentControl=1100253039;
                                                   Border=No;
                                                   LeaderDots=Yes;
                                                   SourceExpr=TituloMotivo(13) }
      { 1100253006;CheckBox;3520;1760 ;440  ;440  ;ParentControl=5;
                                                   InFrame=Yes;
                                                   ShowCaption=No;
                                                   CaptionML=ESP=Nocturnidad;
                                                   SourceExpr=vNocturnidad }
      { 1100253008;Label  ;330  ;1760 ;3080 ;440  ;ParentControl=1100253006 }
      { 1100253007;Label  ;0    ;0    ;0    ;0    ;InColumnHeading=Yes }
      { 1100253005;Label  ;0    ;0    ;0    ;0    ;InColumnHeading=Yes }
      { 1100253004;Label  ;660  ;5390 ;0    ;0    ;ParentControl=5;
                                                   InFrame=Yes }
      { 1100253003;Label  ;770  ;2090 ;0    ;0    ;ParentControl=5;
                                                   InFrame=Yes }
      { 1100253002;Label  ;4840 ;440  ;0    ;0    ;ParentControl=5;
                                                   InFrame=Yes }
      { 1   ;TextBox      ;5940 ;0    ;2310 ;440  ;NextControl=1;
                                                   SourceExpr=vA¤o }
      { 2   ;Label        ;5720 ;0    ;220  ;440  ;LeaderDots=No;
                                                   CaptionML=ESP=/ }
      { 3   ;TextBox      ;3410 ;0    ;2310 ;440  ;NextControl=7;
                                                   SourceExpr=vMes }
      { 4   ;Label        ;0    ;0    ;3300 ;440  ;CaptionML=ESP=Mes / A¤o }
      { 5   ;Frame        ;0    ;1210 ;4290 ;8580 ;CaptionML=ESP=Conceptos a considerar }
      { 18  ;CheckBox     ;3410 ;550  ;440  ;440  ;ShowCaption=No;
                                                   SourceExpr=vSoloconIncidencias }
      { 19  ;Label        ;0    ;550  ;3300 ;440  ;ParentControl=18;
                                                   CaptionML=ESP=S¢lo con incidencias }
      { 1100253009;CommandButton;4400;1210;1430;550;
                                                   CaptionML=ESP=Todos;
                                                   OnPush=BEGIN
                                                            MarcaConceptos(TRUE);
                                                          END;
                                                           }
      { 1100253010;CommandButton;5940;1210;1430;550;
                                                   CaptionML=ESP=Ninguno;
                                                   OnPush=BEGIN
                                                            MarcaConceptos(FALSE);
                                                          END;
                                                           }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text50000@1103355001 : TextConst 'ESP=<+1D-1M>';
      Text50001@1103355002 : TextConst 'ESP=<Text>';
      Text000@1100244014 : TextConst 'ESP=G+N';
      Text001@1100244015 : TextConst 'ESP=G+TA+N';
      Text002@1100244016 : TextConst 'ESP=G+TA+A+N';
      Text003@1100244017 : TextConst 'ESP=G+GR+TA+A+N';
      Text004@1100244018 : TextConst 'ESP=L';
      Text005@1100244019 : TextConst 'ESP=V';
      Text006@1100244020 : TextConst 'ESP=B';
      Text007@1100244021 : TextConst 'ESP=A';
      Text008@1100244022 : TextConst 'ESP=O';
      Text009@1100244023 : TextConst 'ESP=NCT';
      Text010@1100244024 : TextConst 'ESP=" de "';
      aIncid@1100244000 : ARRAY [31] OF Code[10];
      vFI@1100244001 : Date;
      vFF@1100244002 : Date;
      vA¤o@1100244003 : Integer;
      vMes@1100244004 : 'Enero,Febrero,Marzo,Abril,Mayo,Junio,Julio,Agosto,Septiembre,Octubre,Noviembre,Diciembre';
      vStrConceptos@1100244011 : Text[1024];
      vFltIncidencias@1100244012 : Text[250];
      vSoloconIncidencias@1100244013 : Boolean;
      wMMotivos@1100253000 : ARRAY [13] OF Boolean;
      Text015@1100253001 : TextConst 'ESP=Nocturnidad';
      vNocturnidad@1100253002 : Boolean;
      wTieneIncidencia@1103355000 : Boolean;

    PROCEDURE CalcularConceptos@1();
    VAR
      lwCont@1100253000 : Integer;
    BEGIN
      vStrConceptos   := '';
      vFltIncidencias := '';

      FOR lwCont:= 1 TO ARRAYLEN(wMMotivos) DO BEGIN
        IF wMMotivos[lwCont] THEN BEGIN
          IF vStrConceptos <> '' THEN BEGIN
            vFltIncidencias += '|';
            vStrConceptos   += ',';
          END;
          vStrConceptos   += TituloMotivo(lwCont);
          vFltIncidencias += FORMAT(lwCont);
        END;
      END;

      IF vNocturnidad THEN BEGIN
        IF vStrConceptos <> '' THEN
          vStrConceptos += ',';
        vStrConceptos  += Text015;
      END;
    END;

    PROCEDURE TituloMotivo@1100253000(pwNum@1100253001 : Integer) : Text[100];
    VAR
      lrConf@1100253000 : Record 7010333;
    BEGIN
      // TituloMotivo
      // Devuelve la descripci¢n del motivo

      lrConf.Motivo:= pwNum;
      EXIT(FORMAT(lrConf.Motivo,0,Text50001));
    END;

    PROCEDURE MarcaConceptos@1100253003(wBol@1100253000 : Boolean);
    VAR
      lwCont@1100253001 : Integer;
    BEGIN
      // MarcaConceptos


      vNocturnidad:= wBol;
      FOR lwCont:= 1 TO ARRAYLEN(wMMotivos) DO BEGIN
        wMMotivos[lwCont]:= wBol;
      END;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}
