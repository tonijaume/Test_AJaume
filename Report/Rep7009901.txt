OBJECT Report 7009901 Voucher proforma
{
  OBJECT-PROPERTIES
  {
    Date=28/10/14;
    Time=13:40:13;
    Modified=Yes;
    Version List=AIC2009,GOC;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Voucher proforma;
               ESP=Voucher proforma];
    TopMargin=0;
    BottomMargin=0;
    LeftMargin=500;
    OnPreReport=BEGIN

                  rInfEmp.RESET;
                  rInfEmp.FINDFIRST;
                END;

    PaperSize=Letter 8 1/2 x 11 in;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table7009866;
        DataItemTableView=SORTING(Num. Proforma);
        DataItemVarName=diCabProf;
        ReqFilterFields=Num. Proforma;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table7009867;
        DataItemTableView=SORTING(Tipo producto,Num. Reserva)
                          WHERE(Tipo producto=FILTER(Transfer|Hotel|Excursiones));
        NewPagePerGroup=No;
        DataItemVarName=diLinProf;
        OnPreDataItem=BEGIN
                        IF wFiltroLinea <> 0 THEN
                          SETRANGE("Num. Linea", wFiltroLinea);
                      END;

        DataItemLink=Num. Proforma=FIELD(Num. Proforma);
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=diRepeticion;
        OnPreDataItem=VAR
                        lrResTransfer@1103355000 : Record 7009744;
                      BEGIN

                        wDetProcesado := FALSE;
                        wIteraciones  := 1;

                        // Comprobamos si el transfer es solo entrada o salida o ambas.
                        IF diLinProf."Tipo producto" = diLinProf."Tipo producto"::Transfer THEN BEGIN
                          lrResTransfer.SETCURRENTKEY(Delegacion, "N§ Responsable");
                          lrResTransfer.SETRANGE("N§ Responsable", diLinProf."Num. Reserva");

                          IF NOT lrResTransfer.FINDSET THEN
                            ERROR(Text001, diLinProf."Tipo producto", diLinProf."Num. Reserva", diLinProf."Num. Linea");

                          wTipoTransfer := wTipoTransfer::Entrada;

                          IF lrResTransfer.Direccion = lrResTransfer.Direccion::Ambos THEN
                            wIteraciones := 2;

                          IF lrResTransfer.Direccion = lrResTransfer.Direccion::Salida THEN
                            wTipoTransfer := wTipoTransfer::Salida;

                        END;

                        diRepeticion.SETFILTER(Number, '1..%1', wIteraciones);
                      END;

        OnAfterGetRecord=BEGIN

                           IF (Number = 2) THEN BEGIN
                             wTipoTransfer := wTipoTransfer::Salida;
                           END;

                           ProcesarDatosReserva(diCabProf, diLinProf);
                         END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        NewPagePerRecord=Yes;
        DataItemVarName=diVoucher;
        OnAfterGetRecord=VAR
                           lrProv@1103355000 : Record 23;
                         BEGIN

                           // JPT 24/06/09
                           IF diLinProf."Tipo producto" = diLinProf."Tipo producto"::Hotel THEN
                             wText2 := Text012
                           ELSE
                             wText2 := Text011;

                           CLEAR(wDatPr);
                           IF (diCabProf."Agencia Receptiva"<>'') AND (lrProv.GET(diCabProf."Agencia Receptiva")) THEN BEGIN
                             wDatPr[1] := STRSUBSTNO(Text007, lrProv.Name);
                             wDatPr[2] := STRSUBSTNO(Text008, lrProv."Phone No.", lrProv."Fax No.");
                             wDatPr[3] := STRSUBSTNO(Text009, lrProv."E-Mail");
                             wDatPr[4] := STRSUBSTNO(Text010, lrProv."Home Page");
                           END
                           ELSE BEGIN
                             wDatPr[1] := STRSUBSTNO(Text007, rInfEmp.Name);
                             wDatPr[2] := STRSUBSTNO(Text008,rInfEmp."Phone No.", rInfEmp."Fax No.");
                             wDatPr[3] := STRSUBSTNO(Text009, rInfEmp."E-Mail");
                             wDatPr[4] := STRSUBSTNO(Text010, rInfEmp."Home Page");
                           END;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=20400;
            SectionHeight=12690;
          }
          CONTROLS
          {
            { 1103355000;Shape  ;450  ;423  ;19350;11844 }
            { 1103355034;Label  ;1200 ;846  ;18150;423  ;HorzAlign=General;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         CaptionML=ENU=Dear Client, }
            { 1103355035;Label  ;1200 ;1692 ;18150;423  ;HorzAlign=General;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         CaptionML=ENU="Thank you for allowing us to offer you our finest services. We are confident that you will be " }
            { 1103355036;Label  ;1200 ;2115 ;18150;423  ;HorzAlign=General;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         CaptionML=ENU="more than satisfied. " }
            { 1103355037;Label  ;1200 ;2961 ;18150;423  ;HorzAlign=General;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         CaptionML=ENU=Learn more about Go Caribic, S.A. products and services on our webpage: }
            { 1103355038;Label  ;1200 ;3384 ;18150;423  ;HorzAlign=General;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         CaptionML=ENU=www.gocaribic-rewe.com where we like to provide a customized solution for each client. }
            { 1103355039;Label  ;1200 ;4230 ;18150;423  ;HorzAlign=General;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         CaptionML=ENU=Please don't hesitate to contact us. We very much appreciate your business and trust. }
            { 1103355040;Label  ;1200 ;5076 ;18150;423  ;HorzAlign=General;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         CaptionML=ENU="Thank you for considering us for your holiday needs! We wish you a pleasant and relaxing " }
            { 1103355041;Label  ;1200 ;5499 ;18150;423  ;HorzAlign=General;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         CaptionML=ENU=stay! }
            { 1103355042;Label  ;1200 ;6345 ;18150;423  ;HorzAlign=General;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         CaptionML=ENU=Please find below your hotel voucher which is needed for your check-in at your hotel. }
            { 1103355043;Label  ;1200 ;9306 ;18150;423  ;HorzAlign=General;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         CaptionML=ENU="Sincerely, " }
            { 1103355044;Label  ;1200 ;10152;18150;423  ;HorzAlign=General;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         CaptionML=ENU=Your Go Caribic Team }
            { 1103355004;Label  ;1200 ;7191 ;18150;423  ;HorzAlign=General;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         CaptionML=ENU=We want to take this opportunity to wish you a pleasant staying in the destination }
            { 1103355005;Label  ;1200 ;8037 ;18150;423  ;HorzAlign=General;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         CaptionML=ENU=you have chosen. }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=No;
            PlaceInBottom=Yes;
            SectionWidth=20400;
            SectionHeight=3384;
            KeepWithNext=Yes;
          }
          CONTROLS
          {
            { 1103355045;Shape  ;11850;2961 ;7950 ;423  ;ShapeStyle=HorzLine }
            { 1103355046;TextBox;12600;2538 ;7200 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontName=Arial;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=wTTOOBono }
            { 1103355047;Label  ;12300;2115 ;3450 ;423  ;ParentControl=1103355048;
                                                         VertAlign=Bottom;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Booking Number: }
            { 1103355048;TextBox;15900;1692 ;3900 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontName=Arial;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         SourceExpr=wBono }
            { 1103355049;Image  ;15900;625  ;3900 ;1269 ;Bitmap=\\SRV-FILES\_TIS\Atennea Incoming\Logos\rewe.bmp }
            { 1103355050;Image  ;0    ;625  ;6450 ;1692 ;Bitmap=\\SRV-FILES\_TIS\Atennea Incoming\Logos\gocaribic.bmp }
            { 1103355064;Shape  ;0    ;0    ;20250;846  ;ShapeStyle=HorzLine }
            { 1103355065;TextBox;0    ;0    ;10050;423  ;FontName=Verdana;
                                                         SourceExpr=Text015 }
            { 1103355066;TextBox;10050;0    ;10200;423  ;HorzAlign=Right;
                                                         FontName=Verdana;
                                                         SourceExpr=Text015 }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PlaceInBottom=Yes;
            SectionWidth=20400;
            SectionHeight=7193;
            KeepWithNext=No;
            OnPreSection=BEGIN

                           CurrReport.SHOWOUTPUT(diLinProf."Tipo producto" = diLinProf."Tipo producto"::Hotel);
                         END;

          }
          CONTROLS
          {
            { 1103355069;Shape  ;0    ;3384 ;20250;3807 ;BorderWidth=2pt }
            { 1103355070;Shape  ;13050;3386 ;900  ;3807 ;BorderWidth=2pt;
                                                         ShapeStyle=VertLine }
            { 1103355071;TextBox;10050;6770 ;3450 ;423  ;HorzAlign=Center;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle2[9] }
            { 1103355072;TextBox;13650;6770 ;6600 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle3[9] }
            { 1103355073;TextBox;10050;6347 ;3450 ;423  ;HorzAlign=Center;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle2[8] }
            { 1103355074;TextBox;13650;6347 ;6600 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle3[8] }
            { 1103355075;TextBox;150  ;5924 ;9900 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle1[7] }
            { 1103355076;TextBox;10050;5924 ;3450 ;423  ;HorzAlign=Center;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle2[7] }
            { 1103355077;TextBox;13650;5924 ;6600 ;423  ;Border=Yes;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=wDetalle3[7] }
            { 1103355078;Shape  ;13500;5922 ;6750 ;423   }
            { 1103355079;TextBox;150  ;6347 ;9900 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle1[8] }
            { 1103355080;TextBox;150  ;6770 ;9900 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle1[9] }
            { 1103355085;TextBox;150  ;5501 ;9900 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle1[6] }
            { 1103355086;TextBox;10050;5501 ;3450 ;423  ;HorzAlign=Center;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle2[6] }
            { 1103355087;TextBox;13650;5501 ;6600 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle3[6] }
            { 1103355088;TextBox;150  ;5078 ;9900 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle1[5] }
            { 1103355089;TextBox;10050;5078 ;3450 ;423  ;HorzAlign=Center;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle2[5] }
            { 1103355090;TextBox;13650;5078 ;6600 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle3[5] }
            { 1103355091;TextBox;150  ;4655 ;9900 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle1[4] }
            { 1103355092;TextBox;10050;4655 ;3450 ;423  ;HorzAlign=Center;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle2[4] }
            { 1103355093;TextBox;13650;4655 ;6600 ;423  ;Border=Yes;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=wDetalle3[4] }
            { 1103355094;Shape  ;13500;4655 ;6750 ;423   }
            { 1103355095;TextBox;150  ;4232 ;9900 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle1[3] }
            { 1103355096;TextBox;10050;4232 ;3450 ;423  ;HorzAlign=Center;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle2[3] }
            { 1103355097;TextBox;13650;4232 ;6600 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle3[3] }
            { 1103355098;Shape  ;0    ;3384 ;20250;846  ;ShapeStyle=HorzLine }
            { 1103355099;TextBox;150  ;3809 ;9900 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle1[2] }
            { 1103355100;TextBox;10050;3809 ;3450 ;423  ;HorzAlign=Center;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle2[2] }
            { 1103355114;TextBox;13650;3809 ;6600 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle3[2] }
            { 1103355115;TextBox;150  ;3386 ;9900 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=wDetalle1[1] }
            { 1103355116;TextBox;10050;3386 ;3450 ;423  ;HorzAlign=Center;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=wDetalle2[1] }
            { 1103355117;TextBox;13650;3386 ;6600 ;423  ;Border=Yes;
                                                         BorderWidth=Hairline;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=wDetalle3[1] }
            { 1103355118;Shape  ;3750 ;2538 ;6900 ;844  ;ShapeStyle=HorzLine }
            { 1103355123;TextBox;15750;2538 ;3000 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         Border=Yes;
                                                         FontName=verdana;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=wEstancia }
            { 1103355124;Label  ;11550;2538 ;4050 ;423  ;ParentControl=1103355123;
                                                         VertAlign=Bottom;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Bednights }
            { 1103355125;Shape  ;15750;2540 ;3150 ;423   }
            { 1103355126;TextBox;3750 ;2538 ;6900 ;423  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         Border=No;
                                                         FontName=verdana;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=wCodHotel }
            { 1103355127;Label  ;150  ;2538 ;3450 ;423  ;ParentControl=1103355126;
                                                         VertAlign=Bottom;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Hotel Code }
            { 1103355128;TextBox;15750;2115 ;3000 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         Border=Yes;
                                                         FontName=verdana;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=wFechaSalida }
            { 1103355129;Label  ;11550;2115 ;4050 ;423  ;ParentControl=1103355128;
                                                         VertAlign=Bottom;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Departure Date }
            { 1103355130;Shape  ;15750;2117 ;3150 ;423   }
            { 1103355131;Shape  ;3750 ;1692 ;6900 ;844  ;ShapeStyle=HorzLine }
            { 1103355132;TextBox;15750;1692 ;3000 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         Border=Yes;
                                                         FontName=verdana;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=wFechaLlegada }
            { 1103355133;Label  ;11550;1692 ;4050 ;423  ;ParentControl=1103355132;
                                                         VertAlign=Bottom;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Arrival Date }
            { 1103355134;Shape  ;15750;1694 ;3150 ;423   }
            { 1103355135;TextBox;3750 ;1692 ;6900 ;423  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         Border=No;
                                                         FontName=verdana;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=wHotel }
            { 1103355136;Label  ;150  ;1692 ;3450 ;423  ;ParentControl=1103355135;
                                                         VertAlign=Bottom;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Hotel }
            { 1103355138;Shape  ;15750;846  ;3150 ;423   }
            { 1103355139;TextBox;15750;844  ;3000 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         Border=Yes;
                                                         FontName=verdana;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=wFechaVenta }
            { 1103355140;Label  ;11550;844  ;4050 ;423  ;ParentControl=1103355139;
                                                         VertAlign=Bottom;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Reservation Date }
            { 1103355143;Label  ;0    ;0    ;20400;846  ;HorzAlign=Center;
                                                         FontName=Verdana;
                                                         FontSize=16;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Hotel e-Voucher }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=No;
            PlaceInBottom=Yes;
            SectionWidth=20400;
            SectionHeight=6768;
            KeepWithNext=No;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(diLinProf."Tipo producto" = diLinProf."Tipo producto"::Excursiones);
                         END;

          }
          CONTROLS
          {
            { 1103355259;Shape  ;3750 ;5922 ;7050 ;846  ;ShapeStyle=HorzLine }
            { 1103355260;Label  ;11400;6345 ;4200 ;423  ;ParentControl=1103355261;
                                                         VertAlign=Bottom;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Children }
            { 1103355261;TextBox;15750;6345 ;3000 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         Border=Yes;
                                                         FontName=verdana;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=wNi }
            { 1103355262;Shape  ;15750;6345 ;3150 ;423   }
            { 1103355263;TextBox;3750 ;5922 ;7050 ;423  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         Border=No;
                                                         FontName=verdana;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=wClientName }
            { 1103355264;TextBox;15750;5922 ;3000 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         Border=Yes;
                                                         FontName=verdana;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=wAd }
            { 1103355265;Label  ;11400;5922 ;4200 ;423  ;ParentControl=1103355264;
                                                         VertAlign=Bottom;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Adults }
            { 1103355266;Shape  ;15750;5922 ;3150 ;423   }
            { 1103355267;Shape  ;3750 ;5076 ;7050 ;846  ;ShapeStyle=HorzLine }
            { 1103355268;TextBox;3750 ;5076 ;7050 ;423  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         Border=No;
                                                         FontName=verdana;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=wHotel }
            { 1103355269;TextBox;15750;4653 ;3000 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         Border=Yes;
                                                         FontName=verdana;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=wHoraServicio }
            { 1103355270;Label  ;11400;4653 ;4200 ;423  ;ParentControl=1103355269;
                                                         VertAlign=Bottom;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Service Time }
            { 1103355271;Shape  ;15750;4653 ;3150 ;423   }
            { 1103355272;TextBox;15750;4230 ;3000 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         Border=Yes;
                                                         FontName=verdana;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=wFechaServicio }
            { 1103355273;Label  ;11400;4230 ;4200 ;423  ;ParentControl=1103355272;
                                                         VertAlign=Bottom;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Service Date }
            { 1103355274;Shape  ;15750;4230 ;3150 ;423   }
            { 1103355275;Shape  ;3750 ;3807 ;7050 ;846  ;ShapeStyle=HorzLine }
            { 1103355276;Label  ;150  ;5076 ;3450 ;423  ;ParentControl=1103355268;
                                                         VertAlign=Bottom;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Hotel }
            { 1103355277;Label  ;150  ;5922 ;3450 ;423  ;ParentControl=1103355263;
                                                         VertAlign=Bottom;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Client Name }
            { 1103355278;TextBox;3750 ;3807 ;7050 ;423  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         Border=No;
                                                         FontName=verdana;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=wLugarRec }
            { 1103355279;Label  ;150  ;3807 ;3450 ;423  ;ParentControl=1103355278;
                                                         VertAlign=Bottom;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Meeting Point }
            { 1103355280;Shape  ;3750 ;2961 ;7050 ;846  ;ShapeStyle=HorzLine }
            { 1103355281;Shape  ;15750;2961 ;3150 ;423   }
            { 1103355282;TextBox;15750;2961 ;3000 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         Border=Yes;
                                                         FontName=verdana;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=wFechaVenta }
            { 1103355283;Label  ;11400;2961 ;4200 ;423  ;ParentControl=1103355282;
                                                         VertAlign=Bottom;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Reservation Date }
            { 1103355284;Label  ;150  ;2961 ;3450 ;423  ;ParentControl=1103355285;
                                                         VertAlign=Bottom;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Excursion }
            { 1103355285;TextBox;3750 ;2961 ;7050 ;423  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         Border=No;
                                                         FontName=verdana;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=wExcursion }
            { 1103355286;Shape  ;3750 ;1692 ;7050 ;846  ;ShapeStyle=HorzLine }
            { 1103355287;TextBox;3750 ;1692 ;7050 ;423  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         Border=No;
                                                         FontName=verdana;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=wTTOO }
            { 1103355288;Label  ;150  ;1692 ;3450 ;423  ;ParentControl=1103355287;
                                                         VertAlign=Bottom;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Travel Agency }
            { 1103355289;Label  ;11400;1692 ;4200 ;423  ;ParentControl=1103355290;
                                                         VertAlign=Bottom;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Ticket No. }
            { 1103355290;TextBox;15750;1692 ;3000 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         Border=Yes;
                                                         FontName=verdana;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=wNumTicket }
            { 1103355291;Shape  ;15750;1692 ;3150 ;423   }
            { 1103355292;Label  ;0    ;0    ;20400;846  ;HorzAlign=Center;
                                                         FontName=Verdana;
                                                         FontSize=16;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Excursion e-Voucher;
                                                                    ESP=Excursion e-Voucher] }
            { 1103355006;TextBox;0    ;846  ;20250;423  ;HorzAlign=Center;
                                                         FontName=Verdana;
                                                         FontSize=8;
                                                         SourceExpr=Text017 }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=No;
            PlaceInBottom=Yes;
            SectionWidth=20400;
            SectionHeight=7195;
            KeepWithNext=No;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(diLinProf."Tipo producto" = diLinProf."Tipo producto"::Transfer);
                         END;

          }
          CONTROLS
          {
            { 1103355302;Shape  ;0    ;3384 ;20252;3811 ;BorderWidth=2pt }
            { 1103355303;Shape  ;13050;3386 ;900  ;3807 ;BorderWidth=2pt;
                                                         ShapeStyle=VertLine }
            { 1103355304;TextBox;13650;6770 ;6600 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle3[9] }
            { 1103355305;TextBox;10050;6770 ;3450 ;423  ;HorzAlign=Center;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle2[9] }
            { 1103355306;TextBox;150  ;6770 ;9900 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle1[9] }
            { 1103355307;TextBox;13650;6347 ;6600 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle3[8] }
            { 1103355308;TextBox;10050;6347 ;3450 ;423  ;HorzAlign=Center;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle2[8] }
            { 1103355309;TextBox;150  ;6347 ;9900 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle1[8] }
            { 1103355310;TextBox;13650;5924 ;6600 ;423  ;Border=Yes;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=wDetalle3[7] }
            { 1103355311;TextBox;10050;5924 ;3450 ;423  ;HorzAlign=Center;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle2[7] }
            { 1103355312;TextBox;150  ;5924 ;9900 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle1[7] }
            { 1103355313;Shape  ;13500;5924 ;6750 ;423  ;ShapeStyle=Rectangle }
            { 1103355314;TextBox;10050;5501 ;3450 ;423  ;HorzAlign=Center;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle2[6] }
            { 1103355315;TextBox;13650;5499 ;6600 ;425  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle3[6] }
            { 1103355316;TextBox;150  ;5501 ;9900 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle1[6] }
            { 1103355317;TextBox;150  ;5078 ;9900 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle1[5] }
            { 1103355318;TextBox;10050;5078 ;3450 ;423  ;HorzAlign=Center;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle2[5] }
            { 1103355319;TextBox;13650;5078 ;6600 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle3[5] }
            { 1103355320;TextBox;150  ;4655 ;9900 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle1[4] }
            { 1103355321;TextBox;10050;4655 ;3450 ;423  ;HorzAlign=Center;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle2[4] }
            { 1103355322;TextBox;13650;4655 ;6600 ;423  ;Border=Yes;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=wDetalle3[4] }
            { 1103355323;Shape  ;13500;4655 ;6750 ;423  ;ShapeStyle=Rectangle }
            { 1103355324;TextBox;150  ;4232 ;9900 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle1[3] }
            { 1103355325;TextBox;10050;4232 ;3450 ;423  ;HorzAlign=Center;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle2[3] }
            { 1103355326;TextBox;13650;4232 ;6600 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle3[3] }
            { 1103355327;Shape  ;0    ;3384 ;20250;846  ;ShapeStyle=HorzLine }
            { 1103355328;TextBox;150  ;3809 ;9900 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle1[2] }
            { 1103355329;TextBox;10050;3809 ;3450 ;423  ;HorzAlign=Center;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle2[2] }
            { 1103355330;TextBox;13650;3809 ;6600 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDetalle3[2] }
            { 1103355331;TextBox;150  ;3386 ;9900 ;423  ;FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=wDetalle1[1] }
            { 1103355332;TextBox;10050;3384 ;3450 ;423  ;HorzAlign=Center;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=wDetalle2[1] }
            { 1103355333;TextBox;13650;3386 ;6600 ;423  ;Border=Yes;
                                                         BorderWidth=Hairline;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=wDetalle3[1] }
            { 1103355334;Shape  ;3750 ;2538 ;7050 ;846  ;ShapeStyle=HorzLine }
            { 1103355335;TextBox;15750;2538 ;3000 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         Border=Yes;
                                                         FontName=verdana;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=wNumVuelo }
            { 1103355336;Label  ;11400;2538 ;4200 ;423  ;ParentControl=1103355335;
                                                         VertAlign=Bottom;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Flight Number }
            { 1103355337;TextBox;3750 ;2538 ;7050 ;423  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         Border=No;
                                                         FontName=verdana;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=wDestino }
            { 1103355338;Shape  ;15750;2538 ;3150 ;423   }
            { 1103355339;Label  ;150  ;2538 ;3450 ;423  ;ParentControl=1103355337;
                                                         VertAlign=Bottom;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Destination }
            { 1103355340;Shape  ;3750 ;1692 ;7050 ;846  ;ShapeStyle=HorzLine }
            { 1103355341;TextBox;15750;2115 ;3000 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         Border=Yes;
                                                         FontName=verdana;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=wFechaServicio }
            { 1103355342;Label  ;11400;2115 ;4200 ;423  ;ParentControl=1103355341;
                                                         VertAlign=Bottom;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Service Date }
            { 1103355343;Shape  ;15750;2115 ;3150 ;423   }
            { 1103355344;TextBox;3750 ;1692 ;7050 ;423  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         Border=No;
                                                         FontName=verdana;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=wOrigen }
            { 1103355345;Label  ;150  ;1692 ;3450 ;423  ;ParentControl=1103355344;
                                                         VertAlign=Bottom;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Origin }
            { 1103355346;Shape  ;3750 ;846  ;7050 ;846  ;ShapeStyle=HorzLine }
            { 1103355347;Shape  ;15750;846  ;3150 ;423   }
            { 1103355348;TextBox;15750;846  ;3000 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         Border=Yes;
                                                         FontName=verdana;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=wFechaVenta }
            { 1103355349;Label  ;11400;846  ;4200 ;423  ;ParentControl=1103355348;
                                                         VertAlign=Bottom;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Reservation Date }
            { 1103355350;TextBox;3750 ;846  ;7050 ;423  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         Border=No;
                                                         FontName=verdana;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=wTTOO }
            { 1103355351;Label  ;150  ;846  ;3450 ;423  ;ParentControl=1103355350;
                                                         VertAlign=Bottom;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Travel Agency }
            { 1103355352;Label  ;0    ;0    ;20400;846  ;HorzAlign=Center;
                                                         FontName=Verdana;
                                                         FontSize=16;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Transfer e-Voucher }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=20400;
            SectionHeight=2538;
          }
          CONTROLS
          {
            { 1103355007;TextBox;0    ;423  ;10050;423  ;HorzAlign=Center;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDatPr[1] }
            { 1103355008;TextBox;0    ;846  ;10050;423  ;HorzAlign=Center;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDatPr[2] }
            { 1103355009;TextBox;0    ;1269 ;10050;423  ;HorzAlign=Center;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDatPr[3] }
            { 1103355010;TextBox;0    ;1692 ;10050;423  ;HorzAlign=Center;
                                                         FontName=Verdana;
                                                         FontSize=10;
                                                         SourceExpr=wDatPr[4] }
            { 1103355011;TextBox;0    ;2115 ;20250;423  ;HorzAlign=Center;
                                                         FontName=Verdana;
                                                         FontSize=8;
                                                         SourceExpr=wText2 }
            { 1103355012;Image  ;11100;846  ;1350 ;1269 ;Bitmap=\\SRV-FILES\_Tis\Atennea Incoming\logos\its.bmp }
            { 1103355013;Image  ;12600;846  ;2400 ;1269 ;Bitmap=\\SRV-FILES\_Tis\Atennea Incoming\Logos\jahnreisen.bmp }
            { 1103355014;Image  ;15150;846  ;2550 ;1269 ;Bitmap=\\SRV-FILES\_Tis\Atennea Incoming\Logos\tjaereborg.bmp }
            { 1103355015;Image  ;17850;846  ;2400 ;1269 ;Bitmap=\\SRV-FILES\_Tis\Atennea Incoming\Logos\meiers.bmp }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
      CaptionML=[ENU=Voucher proforma;
                 ESP=Voucher proforma];
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      cNoms@1103355002 : Codeunit 7009702;
      rInfEmp@1103355032 : Record 79;
      wTTOO@1103355003 : Text[30];
      wHotel@1103355004 : Text[30];
      wCodHotel@1103355033 : Code[20];
      wOrigen@1103355010 : Text[50];
      wDestino@1103355011 : Text[50];
      wNumVuelo@1103355012 : Text[30];
      wFechaVenta@1103355005 : Date;
      wFechaLlegada@1103355006 : Date;
      wFechaSalida@1103355007 : Date;
      wFechaServicio@1103355008 : Date;
      wEstancia@1103355009 : Integer;
      wDetalle1@1103355000 : ARRAY [9] OF Text[120];
      Text001@1103355001 : TextConst 'ENU=Booking of %1 %2 linked to line of proforma invoice %3 does not exist;ESP=La reserva de %1 %2 ligada a la l¡nea de proforma %3 no existe.';
      wDetalle2@1103355015 : ARRAY [9] OF Text[10];
      wDetalle3@1103355016 : ARRAY [9] OF Text[80];
      wDetProcesado@1103355013 : Boolean;
      wTipoTransfer@1103355014 : 'Entrada,Salida';
      Text002@1103355017 : TextConst 'ENU=Text002;ESP=Text002';
      Text003@1103355018 : TextConst 'ENU=Text003;ESP=Text003';
      Text004@1103355019 : TextConst 'ENU=Text004;ESP=Text004';
      Text005@1103355020 : TextConst 'ENU=Text005;ESP=Text005';
      Text006@1103355021 : TextConst 'ENU=Text006;ESP=Text006';
      Text007@1103355022 : TextConst 'ENU=%1 is a member of REWE Touristik Group;ESP=%1 is a member of REWE Touristik Group';
      Text008@1103355023 : TextConst 'ENU=Tel. %1   Fax. %2;ESP=Tel. %1   Fax. %2';
      Text009@1103355024 : TextConst 'ENU=E-mail : %1;ESP=E-mail : %1';
      Text010@1103355025 : TextConst 'ENU=%1;ESP=%1';
      Text011@1103355026 : TextConst 'ENU=Please make sure you have this voucher with you to present it to our Personnel;ESP=Please make sure you have this voucher with you to present it to our Personnel';
      Text012@1103355027 : TextConst 'ENU=Please make sure to enclose this voucher with your invoice;ESP=Please make sure to enclose this voucher with your invoice';
      Text013@1103355028 : TextConst 'ENU=Text013;ESP=Text013';
      Text014@1103355029 : TextConst 'ENU=Text014;ESP=Text014';
      wIteraciones@1103355031 : Integer;
      wFiltroLinea@1103355030 : Integer;
      wTTOOBono@1103355034 : Text[30];
      Text015@1103355035 : TextConst 'ENU=Cut voucher in this line;ESP=Recortar voucher por esta l¡nea.';
      wHoraServicio@1103355036 : Time;
      wExcursion@1103355037 : Text[30];
      wAd@1103355038 : Integer;
      wNi@1103355039 : Integer;
      wNumTicket@1103355040 : Code[10];
      wLugarRec@1103355041 : Text[30];
      wBono@1103355042 : Code[10];
      Text016@1103355043 : TextConst 'ENU=Adults: %1 Children: %2;ESP=Adultos: %1 Ni¤os: %2';
      wClientName@1103355044 : Text[50];
      Text017@1103355045 : TextConst 'ENU=Contact with the destination agency if time or picking up point is not indicated;ESP=Contacte con la agencia de destino si no se indica punto y/o hora de recogida.';
      wText2@1103355046 : Text[1024];
      wDatPr@1103355047 : ARRAY [4] OF Text[250];

    LOCAL PROCEDURE ProcesarDatosReserva@1103355000(VAR prCabProf@1103355001 : Record 7009866;VAR prLinProf@1103355000 : Record 7009867) : Boolean;
    BEGIN
      // ProcesarDatosReserva
      // Recuperamos las reservas a las que hace referencia la linea de proforma pasada por par metro.
      // si la reserva es de transfer la recuperamos en la global del informe rResTranfer.
      // si la reserva es de hotel la recuperamos en la global del informe rResHotel.
      // Para cualquier otro caso no hacemos nada.

      // Limpiamos las variables globales de impresi¢n
      LimpiaVarsCab;

      CASE prLinProf."Tipo producto" OF

        prLinProf."Tipo producto"::Transfer  : DatosTransfer(prLinProf);
        prLinProf."Tipo producto"::Hotel     : DatosHotel(prLinProf);
        prLinProf."Tipo producto"::Excursiones : DatosExcursion(prCabProf, prLinProf);
      END;

      EXIT(TRUE);
    END;

    LOCAL PROCEDURE DatosTransfer@1103355001(VAR prLinProf@1103355000 : Record 7009867);
    VAR
      lrResTransfer@1103355001 : Record 7009744;
      lwIndex@1103355002 : Integer;
      lwPersonas@1103355003 : Integer;
    BEGIN
      // DatosTransfer

      lrResTransfer.SETCURRENTKEY(Delegacion, "N§ Responsable");
      //lrResTransfer.SETRANGE(Delegacion      , ???); // la proforma no tiene c¢digo de delegaci¢n.
      lrResTransfer.SETRANGE("N§ Responsable", prLinProf."Num. Reserva");

      IF NOT lrResTransfer.FINDSET THEN
        ERROR(Text001, prLinProf."Tipo producto", prLinProf."Num. Reserva", prLinProf."Num. Linea");

      CabeceraTransfer(prLinProf, lrResTransfer);

      IF NOT wDetProcesado THEN BEGIN

        LimpiaVarsDet;

        // Titulos recuadro detalle.
        wDetalle1[1] := Text002;
        wDetalle2[1] := Text003;
        wDetalle3[1] := Text004;
        wDetalle3[4] := Text005;
        wDetalle3[7] := Text006;

        // Datos sueltos
        // AJF 29/04/09
        // Paso el n£mero de personas al detalle de transfer. si son demasiados para
        // el detalle solo pongo el responsable  y un total de paxes.
        lwPersonas := prLinProf.Adultos + prLinProf.Ni¤os;
        wDetalle3[2] := cNoms.nom_producto(lrResTransfer.Producto);
        wDetalle3[5] := FORMAT(lwPersonas);
        Comentarios(lrResTransfer.Delegacion, lrResTransfer."N§ Interno", diLinProf."Tipo producto");
        lwIndex := 1;

        IF lwPersonas > (ARRAYLEN(wDetalle1) - 1) THEN BEGIN
          ResumenTransfer(prLinProf, lrResTransfer);
        END
        ELSE BEGIN
          REPEAT
            lwIndex += 1;
            DetalleTransfer(prLinProf, lrResTransfer,lwIndex);
          UNTIL lrResTransfer.NEXT = 0;
        END;

        wDetProcesado := TRUE;

      END;
    END;

    LOCAL PROCEDURE CabeceraTransfer@1103355005(VAR prLinProf@1103355001 : Record 7009867;VAR prResTransfer@1103355000 : Record 7009744);
    BEGIN
      // CabeceraTransfer

      wTTOO          := cNoms.nom_touroperador(prResTransfer."TourOperador facturacion");
      wTTOOBono      := cNoms.nom_touroperador(BuscaTTOOBlank(prResTransfer.Delegacion, prResTransfer.Bono, prResTransfer.TourOperador))
      ;
      wBono          := prLinProf.Bono;

      CASE wTipoTransfer OF

        wTipoTransfer::Entrada : BEGIN
          // AJF 14/10/09
          wOrigen        := prResTransfer."IATA destino entrada" + ' ' +
                            cNoms.nom_aeropuerto(prResTransfer."IATA destino entrada");
          wDestino       := cNoms.nom_hotel(prResTransfer."Hotel entrada");
          wNumVuelo      := prResTransfer."Compa¤ia entrada" + ' ' + prResTransfer."Vuelo entrada";
          wFechaServicio := prResTransfer."Fecha entrada";
        END;

        wTipoTransfer::Salida  : BEGIN
          wOrigen        := cNoms.nom_hotel(prResTransfer."Hotel salida");
          // AJF 14/10/09
          wDestino       := prResTransfer."IATA origen salida"  + ' ' +
                            cNoms.nom_aeropuerto(prResTransfer."IATA destino salida");;
          wNumVuelo      := prResTransfer."Compa¤ia salida" + ' ' + prResTransfer."Vuelo salida";
          wFechaServicio := prResTransfer."Fecha salida";
        END;

      END;
    END;

    LOCAL PROCEDURE DetalleTransfer@1103355003(VAR prLinProf@1103355000 : Record 7009867;VAR prResTransfer@1103355001 : Record 7009744;pwIndex@1103355002 : Integer);
    VAR
      lwIndex@1103355003 : Integer;
    BEGIN
      // DetalleTransfer

      IF pwIndex <= ARRAYLEN(wDetalle1) THEN BEGIN

        wDetalle1[pwIndex] := COPYSTR(prResTransfer.Nombre, 1, MAXSTRLEN(wDetalle1[pwIndex]));

        IF prResTransfer.Edad <> 0 THEN
          wDetalle2[pwIndex] := COPYSTR(FORMAT(prResTransfer.Edad), 1, MAXSTRLEN(wDetalle2[pwIndex]));
      END
      ELSE BEGIN

        lwIndex := pwIndex MOD ARRAYLEN(wDetalle1);
        IF lwIndex = 0 THEN
          lwIndex := ARRAYLEN(wDetalle1)
        ELSE
          IF lwIndex < 2 THEN BEGIN
            pwIndex += 1;
            lwIndex := 2;
          END;

        wDetalle1[lwIndex] := COPYSTR(wDetalle1[lwIndex] + ' | '+ prResTransfer.Nombre, 1, MAXSTRLEN(wDetalle1[lwIndex]));

        IF prResTransfer.Edad <> 0 THEN
          wDetalle2[lwIndex] := COPYSTR(wDetalle2[lwIndex] + ' | ' + FORMAT(prResTransfer.Edad), 1, MAXSTRLEN(wDetalle2[lwIndex]));

      END;
    END;

    PROCEDURE ResumenTransfer@1103355015(VAR prLinProf@1103355002 : Record 7009867;VAR prResTransfer@1103355001 : Record 7009744);
    BEGIN
      // ResumenTransfer

      wDetalle1[2] := prResTransfer.Nombre;
      wDetalle2[2] := FORMAT(prResTransfer.Edad);
      wDetalle1[3] := STRSUBSTNO(Text016, prLinProf.Adultos, prLinProf.Ni¤os);
    END;

    LOCAL PROCEDURE DatosHotel@1103355002(VAR prLinProf@1103355000 : Record 7009867);
    VAR
      lrResHotel@1103355001 : Record 7009743;
      lwIndex@1103355002 : Integer;
    BEGIN
      // DatosHotel

      lrResHotel.SETCURRENTKEY(Delegacion, "N§ Responsable");
      //lrResHotel.SETRANGE(Delegacion      , ???); // la proforma no tiene c¢digo de delegaci¢n.
      lrResHotel.SETRANGE("N§ Responsable", prLinProf."Num. Reserva");

      IF NOT lrResHotel.FINDSET THEN
        ERROR(Text001, prLinProf."Tipo producto", prLinProf."Num. Reserva", prLinProf."Num. Linea");

      CabeceraHotel(prLinProf, lrResHotel);

      lwIndex := 1;

      LimpiaVarsDet;

      // Titulos recuadro detalle.
      wDetalle1[1] := Text002;
      wDetalle2[1] := Text003;
      wDetalle3[1] := Text013;
      wDetalle3[4] := Text014;
      wDetalle3[7] := Text006;

      // Datos sueltos
      wDetalle3[2] := DescHabitacion(lrResHotel) + ' x ' + FORMAT(lrResHotel."N§ Habitaciones");
      wDetalle3[5] := cNoms.nom_regimen(lrResHotel.Regimen);

      Comentarios(lrResHotel.Delegacion, lrResHotel."N§ Interno", diLinProf."Tipo producto");

      lwIndex := 1;

      REPEAT
        lwIndex += 1;
        DetalleHotel(prLinProf, lrResHotel, lwIndex);
      UNTIL lrResHotel.NEXT = 0;
    END;

    LOCAL PROCEDURE CabeceraHotel@1103355006(VAR prLinProf@1103355001 : Record 7009867;VAR prResHotel@1103355000 : Record 7009743);
    BEGIN
      // CabeceraHotel

      wTTOO         := cNoms.nom_touroperador(prResHotel."TourOperador Venta");
      wTTOOBono     := cNoms.nom_touroperador(BuscaTTOOBlank(prResHotel.Delegacion, prResHotel.Bono, prResHotel.TourOperador));
      wBono         := prLinProf.Bono;

      wHotel        := cNoms.nom_hotel       (prLinProf."Cod. Hotel");
      wCodHotel     := prLinProf."Cod. Hotel";
      wFechaVenta   := prResHotel."Fecha venta";
      wFechaLlegada := prResHotel."Fecha entrada";
      wFechaSalida  := prResHotel."Fecha salida";
      wEstancia     := prResHotel.Estancia;
    END;

    LOCAL PROCEDURE DetalleHotel@1103355004(VAR prLinProf@1103355002 : Record 7009867;VAR prResHotel@1103355001 : Record 7009743;VAR pwIndex@1103355000 : Integer);
    VAR
      lwIndex@1103355003 : Integer;
    BEGIN
      // DetalleHotel

      IF pwIndex <= ARRAYLEN(wDetalle1) THEN BEGIN

        wDetalle1[pwIndex] := COPYSTR(prResHotel.Nombre, 1, MAXSTRLEN(wDetalle1[pwIndex]));

        IF prResHotel.Edad <> 0 THEN
          wDetalle2[pwIndex] := COPYSTR(FORMAT(prResHotel.Edad), 1, MAXSTRLEN(wDetalle2[pwIndex]));
      END
      ELSE BEGIN

        lwIndex := pwIndex MOD ARRAYLEN(wDetalle1);
        IF lwIndex = 0 THEN
          lwIndex := ARRAYLEN(wDetalle1)
        ELSE
          IF lwIndex < 2 THEN BEGIN
            pwIndex += 1;
            lwIndex := 2;
          END;

        wDetalle1[lwIndex] := COPYSTR(wDetalle1[lwIndex] + ' | '+ prResHotel.Nombre, 1, MAXSTRLEN(wDetalle1[lwIndex]));

        IF prResHotel.Edad <> 0 THEN
          wDetalle2[lwIndex] := COPYSTR(wDetalle2[lwIndex] + ' | ' + FORMAT(prResHotel.Edad), 1, MAXSTRLEN(wDetalle2[lwIndex]));

      END;
    END;

    LOCAL PROCEDURE DatosExcursion@1103355010(VAR prCabProf@1103355002 : Record 7009866;VAR prLinProf@1103355000 : Record 7009867);
    VAR
      lrResExcursion@1103355001 : Record 7010162;
    BEGIN
      // DatosExcursion

      lrResExcursion.SETRANGE("N§ Reserva", prLinProf."Num. Reserva");

      IF NOT lrResExcursion.FINDSET THEN
        ERROR(Text001, prLinProf."Tipo producto", prLinProf."Num. Reserva", prLinProf."Num. Linea");

      CabeceraExcursion(prCabProf, prLinProf, lrResExcursion);
    END;

    LOCAL PROCEDURE CabeceraExcursion@1103355012(VAR prCabProf@1103355002 : Record 7009866;VAR prLinProf@1103355000 : Record 7009867;VAR prResExc@1103355001 : Record 7010162);
    BEGIN
      // CabeceraExcursion

      wTTOO          := cNoms.nom_touroperador(prResExc.TourOperador);

      // AJF 09/06/09
      // quito el n£mero de bono para los vouchers de excursiones.
      //IF prLinProf.Bono <> '' THEN
      //  wBono := prLinProf.Bono
      //ELSE
      //  wBono := prCabProf.Bono;

      //wTTOOBono      := cNoms.nom_touroperador(BuscaTTOOBlank(prResExc.Delegacion, wBono));
      wFechaServicio := prResExc."Fecha Excursion";
      wHoraServicio  := prResExc."Hora Recogida";
      wFechaVenta    := prResExc."Fecha Venta";
      wExcursion     := cNoms.nom_producto(prResExc.Producto);
      wAd            := prResExc.Adultos;
      wNi            := prResExc.Ni¤os;

      // AJF 09/06/09
      // Como n£mero de ticket sacamos el n§ de la reserva.
      wNumTicket     := FORMAT(prResExc."N§ Reserva"); //prResExc."N§ Ticket";

      wHotel         := cNoms.nom_hotel(prResExc."Hotel Cliente");
      wLugarRec      := prResExc."Punto Recogida";
      wClientName    := prResExc."Nombre Cliente";
    END;

    LOCAL PROCEDURE LimpiaVarsCab@1103355019();
    BEGIN
      // LimpiaVarsCab

      CLEAR(wBono);
      CLEAR(wTTOO);
      CLEAR(wTTOOBono);
      CLEAR(wHotel);
      CLEAR(wOrigen);
      CLEAR(wDestino);
      CLEAR(wNumVuelo);
      CLEAR(wFechaVenta);
      CLEAR(wFechaLlegada);
      CLEAR(wFechaSalida);
      CLEAR(wFechaServicio);
      CLEAR(wHoraServicio);
      CLEAR(wEstancia);
      CLEAR(wExcursion);
      CLEAR(wAd);
      CLEAR(wNi);
      CLEAR(wNumTicket);
      CLEAR(wLugarRec);
      CLEAR(wClientName);
    END;

    LOCAL PROCEDURE LimpiaVarsDet@1103355022();
    BEGIN
      // LimpiaVarsDet

      CLEAR(wDetalle1);
      CLEAR(wDetalle2);
      CLEAR(wDetalle3);
    END;

    LOCAL PROCEDURE DescHabitacion@1103355007(VAR prResHotel@1103355000 : Record 7009743) rvDesc : Text[60];
    VAR
      lrConvHab@1103355003 : Record 7009731;
    BEGIN
      // DescHabitacion

      lrConvHab.SETRANGE(Delegacion       , prResHotel.Delegacion);
      lrConvHab.SETRANGE("N§ Contrato"    , prResHotel."Contrato compra");
      lrConvHab.SETRANGE("Tipo contrato"  , lrConvHab."Tipo contrato"::Compra);

      IF  prResHotel."Habitacion TO" <> '' THEN
        lrConvHab.SETRANGE("Habitacion TO"  , prResHotel."Habitacion TO")
      ELSE
        lrConvHab.SETRANGE("Habitacion cupo", prResHotel.Habitacion);

      IF lrConvHab.FINDFIRST THEN
        EXIT(lrConvHab.Descripcion);

      EXIT('');
    END;

    LOCAL PROCEDURE Comentarios@1103355013(pwDeleg@1103355000 : Code[10];pwInterno@1103355001 : Integer;pwTipo@1103355002 : Integer);
    VAR
      lrComentarios@1103355003 : Record 7009762;
      lwIndex@1103355004 : Integer;
    BEGIN
      // Comentarios

      lrComentarios.SETRANGE(Delegacion  , pwDeleg);
      lrComentarios.SETRANGE("N§ Interno", pwInterno);

      CASE pwTipo OF

        diLinProf."Tipo producto"::Transfer :
          lrComentarios.SETRANGE("Tipo Reserva", lrComentarios."Tipo Reserva"::Transfer);
        diLinProf."Tipo producto"::Hotel :
          lrComentarios.SETRANGE("Tipo Reserva", lrComentarios."Tipo Reserva"::Hotel);
      END;

      lwIndex := 8;
      IF lrComentarios.FINDSET THEN BEGIN
        REPEAT
          wDetalle3[lwIndex] := lrComentarios.Texto;
          lwIndex += 1;
        UNTIL (lrComentarios.NEXT = 0) OR (lwIndex > 9);
      END;
    END;

    PROCEDURE SetParametros@1103355008(pwFiltroLinea@1103355000 : Integer);
    BEGIN
      // SetParametros
      wFiltroLinea := pwFiltroLinea;
    END;

    LOCAL PROCEDURE BuscaTTOOBlank@1103355009(VAR pwDeleg@1103355003 : Code[10];VAR pwBono@1103355001 : Code[10];VAR pwTTOOCompra@1103355000 : Code[10]) : Code[10];
    VAR
      lrParAgencia@1103355002 : Record 7009700;
      lrConvBlank@1103355004 : Record 7009820;
      lwTTOO@1103355005 : Code[10];
    BEGIN
      // BuscaTTOOBlank
      // JPT 03/09/09 A¤adido parametro pwTTOOCompra

      lrParAgencia.FINDFIRST;
      lwTTOO :=lrConvBlank.GetTTOOEmp(pwDeleg,pwBono,pwTTOOCompra,FALSE, lrParAgencia."Empres Hotel Payment");
      EXIT(lwTTOO);
    END;

    BEGIN
    {
      ## AJF 09/06/09

        .- El n£mero de bono no tiene que aparecer en el voucher para las excursiones.
        .- Como n§ de ticket se pone el n£mero de la reserva.

      ## AJF 29/06/09

        .- (09/00319) cambio c¢digos de hotel de code10 a code20.

      ## JPT 03/09/09

        .- Se ha a¤adido "Touroperador Compra" a la funci¢n BuscaTTOOBlank.

      ## AJF 14/10/09

        .- (0900523) A¤adido el nombre del aeropuerto al c¢digo en origen/destino del voucher de transfers.

      $001 AJS 28102014 Ampliar la variable wClientName a Text50
    }
    END.
  }
  RDLDATA
  {
  }
}
