OBJECT Form 36845 Liq. Analysis by Dim. Matrix
{
  OBJECT-PROPERTIES
  {
    Date=05/11/08;
    Time=12:00:00;
    Version List=LIQEM6.00;
  }
  PROPERTIES
  {
    Width=20790;
    Height=6710;
    Editable=No;
    CaptionML=ENU=Liq. Analysis by Dim. Matrix;
    LinksAllowed=No;
    SourceTable=Table367;
    DataCaptionExpr=AnalysisViewCode;
    OnOpenForm=BEGIN
                 MATRIX_NoOfMatrixColumns := ARRAYLEN(MATRIX_CellData);

                 ValidateAnalysisViewCode;

                 IF (LineDimCode = '') AND (ColumnDimCode = '') THEN BEGIN
                   LineDimCode := LiqAcc.TABLECAPTION;
                   ColumnDimCode := Text1140000;
                 END;

                 SetVisible;
                 CurrForm.UPDATECONTROLS;
                 IF LineDimOption = LineDimOption::Period THEN
                   Rec.Code := '';
               END;

    OnFindRecord=BEGIN
                   EXIT(FindRec(LineDimOption,Rec,Which));
                 END;

    OnNextRecord=BEGIN
                   EXIT(NextRec(LineDimOption,Rec,Steps));
                 END;

    OnAfterGetRecord=VAR
                       MATRIX_CurrentColumnOrdinal@1043 : Integer;
                       MATRIX_Steps@1044 : Integer;
                     BEGIN
                       Amount := CalcAmount(FALSE);
                         CASE RoundingFactor OF
                           RoundingFactor::"1":
                             Amount := ROUND(Amount,1);
                           RoundingFactor::"1000":
                             Amount := ROUND(Amount / 1000,0.1);
                           RoundingFactor::"1000000":
                             Amount := ROUND(Amount / 1000000,0.1);
                         END;

                       MATRIX_CurrentColumnOrdinal := 0;
                       MatrixRecord.SETPOSITION(MATRIX_PrimKeyFirstCol);
                       IF MATRIX_OnFindRecord('=><') THEN BEGIN

                         MATRIX_CurrentColumnOrdinal := 1;

                         REPEAT
                           MATRIX_ColumnOrdinal := MATRIX_CurrentColumnOrdinal;
                           MATRIX_OnAfterGetRecord;
                           MATRIX_Steps := MATRIX_OnNextRecord(1);
                           MATRIX_CurrentColumnOrdinal := MATRIX_CurrentColumnOrdinal+MATRIX_Steps;
                         UNTIL (MATRIX_CurrentColumnOrdinal-MATRIX_Steps = MATRIX_NoOfMatrixColumns) OR (MATRIX_Steps = 0);
                         IF MATRIX_CurrentColumnOrdinal <> 1 THEN
                           MATRIX_OnNextRecord(1-MATRIX_CurrentColumnOrdinal);
                       END;

                       SetVisible;
                     END;

  }
  CONTROLS
  {
    { 1   ;TableBox     ;220  ;220  ;20350;5500 ;HorzGlue=Both;
                                                 VertGlue=Both }
    { 1140031;TextBox   ;3493 ;3080 ;2420 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Code;
                                                 OnLookup=BEGIN
                                                            LookUpCode(LineDimOption,LineDimCode,Code);
                                                          END;
                                                           }
    { 1281;Label        ;0    ;0    ;0    ;0    ;ParentControl=1140031;
                                                 InColumnHeading=Yes }
    { 1140033;TextBox   ;3493 ;3080 ;2420 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Name }
    { 1282;Label        ;0    ;0    ;0    ;0    ;ParentControl=1140033;
                                                 InColumnHeading=Yes }
    { 1140035;TextBox   ;3493 ;3080 ;2420 ;440  ;Name=TotalAmount;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 CaptionML=ENU=Total Amount;
                                                 BlankZero=Yes;
                                                 SourceExpr=Amount;
                                                 OnDrillDown=BEGIN
                                                               DrillDown(FALSE);
                                                             END;
                                                              }
    { 1283;Label        ;0    ;0    ;0    ;0    ;ParentControl=1140035;
                                                 InColumnHeading=Yes }
    { 1011;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field1;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 DrillDown=Yes;
                                                 SourceExpr=MATRIX_CellData[1];
                                                 CaptionClass='3,' + ColumnCaptions[1];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(1);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1048;Label        ;0    ;0    ;0    ;0    ;ParentControl=1011;
                                                 InColumnHeading=Yes }
    { 1012;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field2;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[2];
                                                 CaptionClass='3,' + ColumnCaptions[2];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(2);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1049;Label        ;0    ;0    ;0    ;0    ;ParentControl=1012;
                                                 InColumnHeading=Yes }
    { 1013;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field3;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[3];
                                                 CaptionClass='3,' + ColumnCaptions[3];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(3);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1050;Label        ;0    ;0    ;0    ;0    ;ParentControl=1013;
                                                 InColumnHeading=Yes }
    { 1014;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field4;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[4];
                                                 CaptionClass='3,' + ColumnCaptions[4];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(4);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1051;Label        ;0    ;0    ;0    ;0    ;ParentControl=1014;
                                                 InColumnHeading=Yes }
    { 1015;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field5;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[5];
                                                 CaptionClass='3,' + ColumnCaptions[5];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(5);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1052;Label        ;0    ;0    ;0    ;0    ;ParentControl=1015;
                                                 InColumnHeading=Yes }
    { 1016;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field6;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[6];
                                                 CaptionClass='3,' + ColumnCaptions[6];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(6);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1053;Label        ;0    ;0    ;0    ;0    ;ParentControl=1016;
                                                 InColumnHeading=Yes }
    { 1017;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field7;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[7];
                                                 CaptionClass='3,' + ColumnCaptions[7];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(7);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1054;Label        ;0    ;0    ;0    ;0    ;ParentControl=1017;
                                                 InColumnHeading=Yes }
    { 1018;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field8;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[8];
                                                 CaptionClass='3,' + ColumnCaptions[8];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(8);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1055;Label        ;0    ;0    ;0    ;0    ;ParentControl=1018;
                                                 InColumnHeading=Yes }
    { 1019;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field9;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[9];
                                                 CaptionClass='3,' + ColumnCaptions[9];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(9);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1056;Label        ;0    ;0    ;0    ;0    ;ParentControl=1019;
                                                 InColumnHeading=Yes }
    { 1020;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field10;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[10];
                                                 CaptionClass='3,' + ColumnCaptions[10];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(10);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1057;Label        ;0    ;0    ;0    ;0    ;ParentControl=1020;
                                                 InColumnHeading=Yes }
    { 1021;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field11;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[11];
                                                 CaptionClass='3,' + ColumnCaptions[11];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(11);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1058;Label        ;0    ;0    ;0    ;0    ;ParentControl=1021;
                                                 InColumnHeading=Yes }
    { 1022;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field12;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[12];
                                                 CaptionClass='3,' + ColumnCaptions[12];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(12);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1059;Label        ;0    ;0    ;0    ;0    ;ParentControl=1022;
                                                 InColumnHeading=Yes }
    { 1023;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field13;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[13];
                                                 CaptionClass='3,' + ColumnCaptions[13];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(13);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1060;Label        ;0    ;0    ;0    ;0    ;ParentControl=1023;
                                                 InColumnHeading=Yes }
    { 1024;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field14;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[14];
                                                 CaptionClass='3,' + ColumnCaptions[14];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(14);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1061;Label        ;0    ;0    ;0    ;0    ;ParentControl=1024;
                                                 InColumnHeading=Yes }
    { 1025;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field15;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[15];
                                                 CaptionClass='3,' + ColumnCaptions[15];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(15);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1062;Label        ;0    ;0    ;0    ;0    ;ParentControl=1025;
                                                 InColumnHeading=Yes }
    { 1026;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field16;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[16];
                                                 CaptionClass='3,' + ColumnCaptions[16];
                                                 OnAssistEdit=BEGIN
                                                                MATRIX_UpdateMatrixRecord(16);
                                                                DrillDown(TRUE);
                                                              END;
                                                               }
    { 1063;Label        ;0    ;0    ;0    ;0    ;ParentControl=1026;
                                                 InColumnHeading=Yes }
    { 1027;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field17;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[17];
                                                 CaptionClass='3,' + ColumnCaptions[17];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(17);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1064;Label        ;0    ;0    ;0    ;0    ;ParentControl=1027;
                                                 InColumnHeading=Yes }
    { 1028;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field18;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[18];
                                                 CaptionClass='3,' + ColumnCaptions[18];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(18);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1065;Label        ;0    ;0    ;0    ;0    ;ParentControl=1028;
                                                 InColumnHeading=Yes }
    { 1029;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field19;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[19];
                                                 CaptionClass='3,' + ColumnCaptions[19];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(19);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1066;Label        ;0    ;0    ;0    ;0    ;ParentControl=1029;
                                                 InColumnHeading=Yes }
    { 1030;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field20;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[20];
                                                 CaptionClass='3,' + ColumnCaptions[20];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(20);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1067;Label        ;0    ;0    ;0    ;0    ;ParentControl=1030;
                                                 InColumnHeading=Yes }
    { 1031;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field21;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[21];
                                                 CaptionClass='3,' + ColumnCaptions[21];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(21);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1068;Label        ;0    ;0    ;0    ;0    ;ParentControl=1031;
                                                 InColumnHeading=Yes }
    { 1032;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field22;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[22];
                                                 CaptionClass='3,' + ColumnCaptions[22];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(22);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1069;Label        ;0    ;0    ;0    ;0    ;ParentControl=1032;
                                                 InColumnHeading=Yes }
    { 1033;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field23;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[23];
                                                 CaptionClass='3,' + ColumnCaptions[23];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(23);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1070;Label        ;0    ;0    ;0    ;0    ;ParentControl=1033;
                                                 InColumnHeading=Yes }
    { 1034;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field24;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[24];
                                                 CaptionClass='3,' + ColumnCaptions[24];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(24);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1071;Label        ;0    ;0    ;0    ;0    ;ParentControl=1034;
                                                 InColumnHeading=Yes }
    { 1035;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field25;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[25];
                                                 CaptionClass='3,' + ColumnCaptions[25];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(25);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1072;Label        ;0    ;0    ;0    ;0    ;ParentControl=1035;
                                                 InColumnHeading=Yes }
    { 1036;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field26;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[26];
                                                 CaptionClass='3,' + ColumnCaptions[26];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(26);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1073;Label        ;0    ;0    ;0    ;0    ;ParentControl=1036;
                                                 InColumnHeading=Yes }
    { 1037;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field27;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[27];
                                                 CaptionClass='3,' + ColumnCaptions[27];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(27);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1074;Label        ;0    ;0    ;0    ;0    ;ParentControl=1037;
                                                 InColumnHeading=Yes }
    { 1038;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field28;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[28];
                                                 CaptionClass='3,' + ColumnCaptions[28];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(28);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1075;Label        ;0    ;0    ;0    ;0    ;ParentControl=1038;
                                                 InColumnHeading=Yes }
    { 1039;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field29;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[29];
                                                 CaptionClass='3,' + ColumnCaptions[29];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(29);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1076;Label        ;0    ;0    ;0    ;0    ;ParentControl=1039;
                                                 InColumnHeading=Yes }
    { 1040;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field30;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[30];
                                                 CaptionClass='3,' + ColumnCaptions[30];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(30);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1077;Label        ;0    ;0    ;0    ;0    ;ParentControl=1040;
                                                 InColumnHeading=Yes }
    { 1041;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field31;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[31];
                                                 CaptionClass='3,' + ColumnCaptions[31];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(31);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1078;Label        ;0    ;0    ;0    ;0    ;ParentControl=1041;
                                                 InColumnHeading=Yes }
    { 1042;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field32;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Right;
                                                 SourceExpr=MATRIX_CellData[32];
                                                 CaptionClass='3,' + ColumnCaptions[32];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(32);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1079;Label        ;0    ;0    ;0    ;0    ;ParentControl=1042;
                                                 InColumnHeading=Yes }
    { 2   ;CommandButton;18370;6050 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 3   ;MenuButton   ;15950;6050 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=ENU=&Actions;
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=5;
                                                     CaptionML=ENU=Export to Excel;
                                                     OnPush=VAR
                                                              AnalysisViewEntry@1001 : Record 5055271;
                                                              LiqAnalysisViewToExcel@1000 : Codeunit 5055267;
                                                            BEGIN
                                                              SetCommonFilters(AnalysisViewEntry);
                                                              AnalysisViewEntry.FIND('-');
                                                              LiqAnalysisViewToExcel.ExportData(
                                                                AnalysisViewEntry,LineDimCode,ColumnDimCode,ShowOppositeSign,
                                                                PeriodType,ShowColumnName,DateFilter,LiqAccFilter,
                                                                Dim1Filter,Dim2Filter,Dim3Filter,Dim4Filter,AmountType,ShowActual,LiquidityFilter);
                                                            END;
                                                             }
                                                 }
                                                  }
  }
  CODE
  {
    VAR
      Text1140000@1000 : TextConst 'ENU=Period';
      Text1140001@1001 : TextConst 'ENU=<Sign><Integer Thousand><Decimals,3>';
      Text1140002@1002 : TextConst 'ENU=You have not yet defined an analysis view.';
      Text1140003@1003 : TextConst 'ENU=%1 is not a valid line definition.';
      Text1140004@1004 : TextConst 'ENU=%1 is not a valid column definition.';
      Text1140005@1005 : TextConst 'ENU=1,6,,Dimension 1 Filter';
      Text1140006@1006 : TextConst 'ENU=1,6,,Dimension 2 Filter';
      Text1140007@1007 : TextConst 'ENU=1,6,,Dimension 3 Filter';
      Text1140008@1008 : TextConst 'ENU=1,6,,Dimension 4 Filter';
      GLSetup@1009 : Record 98;
      LiqAcc@1010 : Record 5055251;
      AnalysisView@1011 : Record 5055269;
      AnalysisViewEntry@1012 : Record 5055271;
      AVBreakdownBuffer@1013 : TEMPORARY Record 375;
      MatrixRecord@1014 : Record 367;
      LineDimOption@1015 : 'Liquidity Account,Period,Liquidity,Dimension 1,Dimension 2,Dimension 3,Dimension 4';
      ColumnDimOption@1016 : 'Liquidity Account,Period,Liquidity,Dimension 1,Dimension 2,Dimension 3,Dimension 4';
      PeriodType@1017 : 'Day,Week,Month,Quarter,Year,Accounting Period';
      AmountType@1018 : 'Balance at Date,Net Change';
      RoundingFactor@1019 : 'None,1,1000,1000000';
      ShowActual@1020 : 'Amounts';
      LineDimCode@1021 : Text[30];
      ColumnDimCode@1022 : Text[30];
      DateFilter@1023 : Text[250];
      InternalDateFilter@1024 : Text[250];
      LiquidityFilter@1025 : Text[250];
      MatrixHeader@1026 : Text[50];
      MATRIX_CellData@1027 : ARRAY [32] OF Text[1024];
      ColumnCaptions@1028 : ARRAY [32] OF Text[250];
      MATRIX_PrimKeyFirstCol@1029 : Text[1024];
      AnalysisViewCode@1030 : Code[10];
      LiqAccFilter@1031 : Code[250];
      Dim1Filter@1032 : Code[250];
      Dim2Filter@1033 : Code[250];
      Dim3Filter@1034 : Code[250];
      Dim4Filter@1035 : Code[250];
      ColumnsFilters@1036 : ARRAY [32] OF Code[100];
      MatrixAmount@1037 : Decimal;
      MATRIX_ColumnOrdinal@1038 : Integer;
      MATRIX_NoOfMatrixColumns@1039 : Integer;
      Itterations@1040 : Integer;
      ShowOppositeSign@1041 : Boolean;
      ShowColumnName@1042 : Boolean;
      PeriodInitialized@1043 : Boolean;

    LOCAL PROCEDURE DimCodeToOption@1129(DimCode@1140000 : Text[30]) : Integer;
    VAR
      Liquidity@1130 : Record 5055250;
    BEGIN
      CASE DimCode OF
        '' :
          EXIT(-1);
        LiqAcc.TABLECAPTION :
          EXIT(0);
        Text1140000 :
          EXIT(1);
        Liquidity.TABLECAPTION :
          EXIT(2);
        AnalysisView."Dimension 1 Code" :
          EXIT(3);
        AnalysisView."Dimension 2 Code" :
          EXIT(4);
        AnalysisView."Dimension 3 Code" :
          EXIT(5);
        AnalysisView."Dimension 4 Code" :
          EXIT(6);
        ELSE
          EXIT(-1);
      END;
    END;

    LOCAL PROCEDURE FindRec@1131(DimOption@1140000 : 'Liquidity Account,Period,Liquidity,Dimension 1,Dimension 2,Dimension 3,Dimension 4';VAR DimCodeBuf@1140001 : Record 367;Which@1140002 : Text[250]) : Boolean;
    VAR
      LiqAcc@1359 : Record 5055251;
      Liquidity@1360 : Record 5055250;
      Period@1361 : Record 2000000007;
      DimVal@1362 : Record 349;
      PeriodFormMgt@1363 : Codeunit 359;
      Found@1364 : Boolean;
    BEGIN
      CASE DimOption OF
        DimOption::"Liquidity Account" :
          BEGIN
            LiqAcc."No." := DimCodeBuf.Code;
            IF LiqAccFilter <> '' THEN
              LiqAcc.SETFILTER("No.",LiqAccFilter);
            Found := LiqAcc.FIND(Which);
            IF Found THEN
              CopyLiqAccToBuf(LiqAcc,DimCodeBuf);
          END;
        DimOption::Period :
          BEGIN
            IF NOT PeriodInitialized THEN
              DateFilter := '';
            PeriodInitialized := TRUE;
            EVALUATE(Period."Period Start",DimCodeBuf.Code);
            IF DateFilter <> '' THEN
              Period.SETFILTER("Period Start",DateFilter)
            ELSE
              IF NOT PeriodInitialized AND (InternalDateFilter <> '') THEN
                Period.SETFILTER("Period Start",InternalDateFilter);
            Found := PeriodFormMgt.FindDate(Which,Period,PeriodType);
            IF Found THEN
              CopyPeriodToBuf(Period,DimCodeBuf);
          END;
        DimOption::Liquidity :
          BEGIN
            Liquidity."No." := DimCodeBuf.Code;
            IF LiquidityFilter <> '' THEN
              Liquidity.SETFILTER("No.",LiquidityFilter);
            Found := Liquidity.FIND(Which);
            IF Found THEN
              CopyLiquidityToBuf(Liquidity,DimCodeBuf);
          END;
        DimOption::"Dimension 1" :
          BEGIN
            IF Dim1Filter <> '' THEN
              DimVal.SETFILTER(Code,Dim1Filter);
            DimVal."Dimension Code" := AnalysisView."Dimension 1 Code";
            DimVal.SETRANGE("Dimension Code",DimVal."Dimension Code");
            DimVal.Code := DimCodeBuf.Code;
            Found := DimVal.FIND(Which);
            IF Found THEN
              CopyDimValueToBuf(DimVal,DimCodeBuf);
          END;
        DimOption::"Dimension 2" :
          BEGIN
            IF Dim2Filter <> '' THEN
              DimVal.SETFILTER(Code,Dim2Filter);
            DimVal."Dimension Code" := AnalysisView."Dimension 2 Code";
            DimVal.SETRANGE("Dimension Code",DimVal."Dimension Code");
            DimVal.Code := DimCodeBuf.Code;
            Found := DimVal.FIND(Which);
            IF Found THEN
              CopyDimValueToBuf(DimVal,DimCodeBuf);
          END;
        DimOption::"Dimension 3" :
          BEGIN
            IF Dim3Filter <> '' THEN
              DimVal.SETFILTER(Code,Dim3Filter);
            DimVal."Dimension Code" := AnalysisView."Dimension 3 Code";
            DimVal.SETRANGE("Dimension Code",DimVal."Dimension Code");
            DimVal.Code := DimCodeBuf.Code;
            Found := DimVal.FIND(Which);
            IF Found THEN
              CopyDimValueToBuf(DimVal,DimCodeBuf);
          END;
        DimOption::"Dimension 4" :
          BEGIN
            IF Dim4Filter <> '' THEN
              DimVal.SETFILTER(Code,Dim4Filter);
            DimVal."Dimension Code" := AnalysisView."Dimension 4 Code";
            DimVal.SETRANGE("Dimension Code",DimVal."Dimension Code");
            DimVal.Code := DimCodeBuf.Code;
            Found := DimVal.FIND(Which);
            IF Found THEN
              CopyDimValueToBuf(DimVal,DimCodeBuf);
          END;
      END;
      EXIT(Found);
    END;

    LOCAL PROCEDURE NextRec@1365(DimOption@1140000 : 'Liquidity Account,Period,Liquidity,Dimension 1,Dimension 2,Dimension 3,Dimension 4';VAR DimCodeBuf@1140001 : Record 367;Steps@1140002 : Integer) : Integer;
    VAR
      LiqAcc@1366 : Record 5055251;
      Liquidity@1367 : Record 5055250;
      Period@1368 : Record 2000000007;
      DimVal@1369 : Record 349;
      PeriodFormMgt@1370 : Codeunit 359;
      ResultSteps@1371 : Integer;
    BEGIN
      CASE DimOption OF
        DimOption::"Liquidity Account" :
          BEGIN
            LiqAcc."No." := DimCodeBuf.Code;
            IF LiqAccFilter <> '' THEN
              LiqAcc.SETFILTER("No.",LiqAccFilter);
            ResultSteps := LiqAcc.NEXT(Steps);
            IF ResultSteps <> 0 THEN
              CopyLiqAccToBuf(LiqAcc,DimCodeBuf);
          END;
        DimOption::Period :
          BEGIN
            IF DateFilter <> '' THEN
              Period.SETFILTER("Period Start",DateFilter);
            EVALUATE(Period."Period Start",DimCodeBuf.Code);
            ResultSteps := PeriodFormMgt.NextDate(Steps,Period,PeriodType);
            IF ResultSteps <> 0 THEN
              CopyPeriodToBuf(Period,DimCodeBuf);
          END;
        DimOption::Liquidity :
          BEGIN
            Liquidity."No." := DimCodeBuf.Code;
            IF LiquidityFilter <> '' THEN
              Liquidity.SETFILTER("No.",LiquidityFilter);
            ResultSteps := Liquidity.NEXT(Steps);
            IF ResultSteps <> 0 THEN
              CopyLiquidityToBuf(Liquidity,DimCodeBuf);
          END;
        DimOption::"Dimension 1" :
          BEGIN
            IF Dim1Filter <> '' THEN
              DimVal.SETFILTER(Code,Dim1Filter);
            DimVal."Dimension Code" := AnalysisView."Dimension 1 Code";
            DimVal.SETRANGE("Dimension Code",DimVal."Dimension Code");
            DimVal.Code := DimCodeBuf.Code;
            ResultSteps := DimVal.NEXT(Steps);
            IF ResultSteps <> 0 THEN
              CopyDimValueToBuf(DimVal,DimCodeBuf);
          END;
        DimOption::"Dimension 2" :
          BEGIN
            IF Dim2Filter <> '' THEN
              DimVal.SETFILTER(Code,Dim2Filter);
            DimVal."Dimension Code" := AnalysisView."Dimension 2 Code";
            DimVal.SETRANGE("Dimension Code",DimVal."Dimension Code");
            DimVal.Code := DimCodeBuf.Code;
            ResultSteps := DimVal.NEXT(Steps);
            IF ResultSteps <> 0 THEN
              CopyDimValueToBuf(DimVal,DimCodeBuf);
          END;
        DimOption::"Dimension 3" :
          BEGIN
            IF Dim3Filter <> '' THEN
              DimVal.SETFILTER(Code,Dim3Filter);
            DimVal."Dimension Code" := AnalysisView."Dimension 3 Code";
            DimVal.SETRANGE("Dimension Code",DimVal."Dimension Code");
            DimVal.Code := DimCodeBuf.Code;
            ResultSteps := DimVal.NEXT(Steps);
            IF ResultSteps <> 0 THEN
              CopyDimValueToBuf(DimVal,DimCodeBuf);
          END;
        DimOption::"Dimension 4" :
          BEGIN
            IF Dim4Filter <> '' THEN
              DimVal.SETFILTER(Code,Dim4Filter);
            DimVal."Dimension Code" := AnalysisView."Dimension 4 Code";
            DimVal.SETRANGE("Dimension Code",DimVal."Dimension Code");
            DimVal.Code := DimCodeBuf.Code;
            ResultSteps := DimVal.NEXT(Steps);
            IF ResultSteps <> 0 THEN
              CopyDimValueToBuf(DimVal,DimCodeBuf);
          END;
      END;
      EXIT(ResultSteps);
    END;

    LOCAL PROCEDURE CopyLiqAccToBuf@1372(VAR TheLiqAcc@1140000 : Record 5055251;VAR TheDimCodeBuf@1140001 : Record 367);
    BEGIN
      WITH TheDimCodeBuf DO BEGIN
        INIT;
        Code := TheLiqAcc."No.";
        Name := TheLiqAcc.Name;
        Totaling := TheLiqAcc.Totaling;
        Indentation := TheLiqAcc.Indentation;
        "Show in Bold" := TheLiqAcc."Account Type" <> TheLiqAcc."Account Type"::Posting;
      END;
    END;

    LOCAL PROCEDURE CopyPeriodToBuf@1373(VAR ThePeriod@1140000 : Record 2000000007;VAR TheDimCodeBuf@1140001 : Record 367);
    VAR
      Period2@1374 : Record 2000000007;
    BEGIN
      WITH TheDimCodeBuf DO BEGIN
        INIT;
        Code := FORMAT(ThePeriod."Period Start");
        "Period Start" := ThePeriod."Period Start";
        "Period End" := ThePeriod."Period End";
        IF DateFilter <> '' THEN BEGIN
          Period2.SETFILTER("Period End",DateFilter);
          IF Period2.GETRANGEMAX("Period End") < "Period End" THEN
            "Period End" := Period2.GETRANGEMAX("Period End");
        END;
        Name := ThePeriod."Period Name";
      END;
    END;

    LOCAL PROCEDURE CopyLiquidityToBuf@1375(VAR TheLiquidity@1140000 : Record 5055250;VAR TheDimCodeBuf@1140001 : Record 367);
    BEGIN
      WITH TheDimCodeBuf DO BEGIN
        INIT;
        Code := TheLiquidity."No.";
        Name := TheLiquidity.Description;
      END;
    END;

    LOCAL PROCEDURE CopyDimValueToBuf@1376(VAR TheDimVal@1140000 : Record 349;VAR TheDimCodeBuf@1140001 : Record 367);
    BEGIN
      WITH TheDimCodeBuf DO BEGIN
        INIT;
        Code := TheDimVal.Code;
        Name := TheDimVal.Name;
        Totaling := TheDimVal.Totaling;
        Indentation := TheDimVal.Indentation;
        "Show in Bold" :=
          TheDimVal."Dimension Value Type" <> TheDimVal."Dimension Value Type"::Standard;
      END;
    END;

    LOCAL PROCEDURE FindPeriod@1377(SearchText@1140000 : Code[10]);
    VAR
      Calendar@1378 : Record 2000000007;
      PeriodFormMgt@1379 : Codeunit 359;
    BEGIN
      IF DateFilter <> '' THEN BEGIN
        Calendar.SETFILTER("Period Start",DateFilter);
        IF NOT PeriodFormMgt.FindDate('+',Calendar,PeriodType) THEN
          PeriodFormMgt.FindDate('+',Calendar,PeriodType::Day);
        Calendar.SETRANGE("Period Start");
      END;
      IF PeriodFormMgt.FindDate(SearchText,Calendar,PeriodType) THEN;
      IF AmountType = AmountType::"Net Change" THEN BEGIN
        AnalysisViewEntry.SETRANGE("Liquidity Date",Calendar."Period Start",Calendar."Period End");
        IF AnalysisViewEntry.GETRANGEMIN("Liquidity Date") = AnalysisViewEntry.GETRANGEMAX("Liquidity Date") THEN
          AnalysisViewEntry.SETRANGE("Liquidity Date",AnalysisViewEntry.GETRANGEMIN("Liquidity Date"));
      END ELSE
        AnalysisViewEntry.SETRANGE("Liquidity Date",0D,Calendar."Period End");
      InternalDateFilter := AnalysisViewEntry.GETFILTER("Liquidity Date");
      IF (LineDimOption <> LineDimOption::Period) AND (ColumnDimOption <> ColumnDimOption::Period) THEN
        DateFilter := InternalDateFilter;
      AVBreakdownBuffer.DELETEALL;
    END;

    LOCAL PROCEDURE FormatAmount@1380(VAR Text@1140000 : Text[250]);
    VAR
      Amount@1381 : Decimal;
    BEGIN
      IF Text = '' THEN
        EXIT;
      EVALUATE(Amount,Text);
      IF RoundingFactor = RoundingFactor::None THEN
        EXIT;
      CASE RoundingFactor OF
        RoundingFactor::"1":
          Amount := ROUND(Amount,1);
        RoundingFactor::"1000":
          Amount := ROUND(Amount / 1000,0.1);
        RoundingFactor::"1000000":
          Amount := ROUND(Amount / 1000000,0.1);
      END;
      IF Amount = 0 THEN
        Text := ''
      ELSE
        CASE RoundingFactor OF
          RoundingFactor::"1":
            Text := FORMAT(Amount);
          RoundingFactor::"1000",RoundingFactor::"1000000":
            Text := FORMAT(Amount,0,Text1140001);
        END;
    END;

    LOCAL PROCEDURE GetDimSelection@1382(OldDimSelCode@1140000 : Text[30]) : Text[30];
    VAR
      DimSelection@1383 : Form 568;
    BEGIN
      DimSelection.InsertDimSelBuf(FALSE,LiqAcc.TABLECAPTION,LiqAcc.TABLECAPTION);
      DimSelection.InsertDimSelBuf(FALSE,Text1140000,Text1140000);
      IF AnalysisView."Dimension 1 Code" <> '' THEN
        DimSelection.InsertDimSelBuf(FALSE,AnalysisView."Dimension 1 Code",'');
      IF AnalysisView."Dimension 2 Code" <> '' THEN
        DimSelection.InsertDimSelBuf(FALSE,AnalysisView."Dimension 2 Code",'');
      IF AnalysisView."Dimension 3 Code" <> '' THEN
        DimSelection.InsertDimSelBuf(FALSE,AnalysisView."Dimension 3 Code",'');
      IF AnalysisView."Dimension 4 Code" <> '' THEN
        DimSelection.InsertDimSelBuf(FALSE,AnalysisView."Dimension 4 Code",'');
      DimSelection.LOOKUPMODE := TRUE;
      IF DimSelection.RUNMODAL = ACTION::LookupOK THEN
        EXIT(DimSelection.GetDimSelCode)
      ELSE
        EXIT(OldDimSelCode);
    END;

    LOCAL PROCEDURE LookUpCode@1384(DimOption@1140000 : 'Liquidity Account,Period,Liquidity,Dimension 1,Dimension 2,Dimension 3,Dimension 4';DimCode@1140001 : Text[30];Code@1140002 : Text[30]);
    VAR
      LiqAcc@1385 : Record 5055251;
      Liquidity@1386 : Record 5055250;
      DimVal@1387 : Record 349;
      DimValList@1388 : Form 560;
    BEGIN
      CASE DimOption OF
        DimOption::"Liquidity Account" :
          BEGIN
            LiqAcc.GET(Code);
            FORM.RUNMODAL(FORM::"Liquidity Account List",LiqAcc);
          END;
        DimOption::Period : ;
        DimOption::Liquidity :
          BEGIN
            Liquidity.GET(Code);
            FORM.RUNMODAL(FORM::"Liquidity List",Liquidity);
          END;
        DimOption::"Dimension 1",DimOption::"Dimension 2",
        DimOption::"Dimension 3",DimOption::"Dimension 4" :
          BEGIN
            DimVal.SETRANGE("Dimension Code",DimCode);
            DimVal.GET(DimCode,Code);
            DimValList.SETTABLEVIEW(DimVal);
            DimValList.SETRECORD(DimVal);
            DimValList.RUNMODAL;
          END;
      END;
    END;

    LOCAL PROCEDURE LookUpDimFilter@1389(Dim@1140000 : Code[20];VAR Text@1140001 : Text[250]) : Boolean;
    VAR
      DimVal@1390 : Record 349;
      DimValList@1391 : Form 560;
    BEGIN
      IF Dim = '' THEN
        EXIT(FALSE);
      DimValList.LOOKUPMODE(TRUE);
      DimVal.SETRANGE("Dimension Code",Dim);
      DimValList.SETTABLEVIEW(DimVal);
      IF DimValList.RUNMODAL = ACTION::LookupOK THEN BEGIN
        DimValList.GETRECORD(DimVal);
        Text := DimValList.GetSelectionFilter;
        EXIT(TRUE);
      END ELSE
        EXIT(FALSE)
    END;

    LOCAL PROCEDURE SetCommonFilters@1392(VAR TheAnalysisViewEntry@1140000 : Record 5055271);
    VAR
      DateFilter2@1393 : Text[1024];
    BEGIN
      WITH TheAnalysisViewEntry DO BEGIN
        RESET;

        SETRANGE("Analysis View Code",AnalysisView.Code);
        IF LiquidityFilter <> '' THEN
          SETFILTER("Liquidity No.",LiquidityFilter);
        IF LiqAccFilter <> '' THEN
          SETFILTER("Liquidity Account No.",LiqAccFilter);
        IF DateFilter <> '' THEN
          SETFILTER("Liquidity Date",DateFilter);
        IF Dim1Filter <> '' THEN
          SETFILTER("Dimension 1 Value Code",Dim1Filter);
        IF Dim2Filter <> '' THEN
          SETFILTER("Dimension 2 Value Code",Dim2Filter);
        IF Dim3Filter <> '' THEN
          SETFILTER("Dimension 3 Value Code",Dim3Filter);
        IF Dim4Filter <> '' THEN
          SETFILTER("Dimension 4 Value Code",Dim4Filter);
        SETPERMISSIONFILTER;
      END;
    END;

    LOCAL PROCEDURE SetDimFilters@1394(VAR TheAnalysisViewEntry@1140000 : Record 5055271;LineOrColumn@1140001 : 'Line,Column');
    VAR
      DimOption@1395 : 'Liquidity Account,Period,Liquidity,Dimension 1,Dimension 2,Dimension 3,Dimension 4';
      DimCodeBuf@1396 : Record 367;
    BEGIN
      IF LineOrColumn = LineOrColumn::Line THEN BEGIN
        DimCodeBuf := Rec;
        DimOption := LineDimOption;
      END ELSE BEGIN
        DimCodeBuf := MatrixRecord;
        DimOption := ColumnDimOption;
      END;
      CASE DimOption OF
        DimOption::"Liquidity Account" :
          IF DimCodeBuf.Totaling = '' THEN
            TheAnalysisViewEntry.SETRANGE("Liquidity Account No.",DimCodeBuf.Code)
          ELSE
            TheAnalysisViewEntry.SETFILTER("Liquidity Account No.",DimCodeBuf.Totaling);
        DimOption::Period :
          BEGIN
            IF AmountType = AmountType::"Net Change" THEN
              TheAnalysisViewEntry.SETRANGE(
                "Liquidity Date",DimCodeBuf."Period Start",DimCodeBuf."Period End")
            ELSE
              TheAnalysisViewEntry.SETRANGE("Liquidity Date",0D,DimCodeBuf."Period End");
          END;
        DimOption::Liquidity :
          TheAnalysisViewEntry.SETRANGE("Liquidity No.",DimCodeBuf.Code);
        DimOption::"Dimension 1" :
          IF DimCodeBuf.Totaling = '' THEN
            TheAnalysisViewEntry.SETRANGE("Dimension 1 Value Code",DimCodeBuf.Code)
          ELSE
            TheAnalysisViewEntry.SETFILTER("Dimension 1 Value Code",DimCodeBuf.Totaling);
        DimOption::"Dimension 2" :
          IF DimCodeBuf.Totaling = '' THEN
            TheAnalysisViewEntry.SETRANGE("Dimension 2 Value Code",DimCodeBuf.Code)
          ELSE
            TheAnalysisViewEntry.SETFILTER("Dimension 2 Value Code",DimCodeBuf.Totaling);
        DimOption::"Dimension 3" :
          IF DimCodeBuf.Totaling = '' THEN
            TheAnalysisViewEntry.SETRANGE("Dimension 3 Value Code",DimCodeBuf.Code)
          ELSE
            TheAnalysisViewEntry.SETFILTER("Dimension 3 Value Code",DimCodeBuf.Totaling);
        DimOption::"Dimension 4" :
          IF DimCodeBuf.Totaling = '' THEN
            TheAnalysisViewEntry.SETRANGE("Dimension 4 Value Code",DimCodeBuf.Code)
          ELSE
            TheAnalysisViewEntry.SETFILTER("Dimension 4 Value Code",DimCodeBuf.Totaling);
      END;
      TheAnalysisViewEntry.SETPERMISSIONFILTER;
    END;

    LOCAL PROCEDURE DrillDown@1397(SetColFilter@1140000 : Boolean);
    BEGIN
      IF ShowActual = ShowActual::Amounts THEN BEGIN
        SetCommonFilters(AnalysisViewEntry);
        SetDimFilters(AnalysisViewEntry,0);
        IF SetColFilter THEN
          SetDimFilters(AnalysisViewEntry,1);
        FORM.RUN(FORM::"Liq. Analysis View Entries",AnalysisViewEntry);
      END;
    END;

    LOCAL PROCEDURE ValidateAnalysisViewCode@1398();
    VAR
      AnalysisViewFilter@1399 : Record 5055270;
    BEGIN
      AnalysisView.Code := AnalysisViewCode;
      IF NOT AnalysisView.FIND('=<>') THEN
        ERROR(Text1140002);
      AnalysisViewCode := AnalysisView.Code;

      SETPERMISSIONFILTER;
    END;

    LOCAL PROCEDURE ValidateLineDimCode@1400();
    VAR
      Liquidity@1401 : Record 5055250;
    BEGIN
      IF (UPPERCASE(LineDimCode) <> UPPERCASE(LiqAcc.TABLECAPTION)) AND
         (UPPERCASE(LineDimCode) <> UPPERCASE(Liquidity.TABLECAPTION)) AND
         (UPPERCASE(LineDimCode) <> UPPERCASE(Text1140000)) AND
         (UPPERCASE(LineDimCode) <> AnalysisView."Dimension 1 Code") AND
         (UPPERCASE(LineDimCode) <> AnalysisView."Dimension 2 Code") AND
         (UPPERCASE(LineDimCode) <> AnalysisView."Dimension 3 Code") AND
         (UPPERCASE(LineDimCode) <> AnalysisView."Dimension 4 Code") AND
         (LineDimCode <> '') THEN BEGIN
        MESSAGE(Text1140003,LineDimCode);
        LineDimCode := '';
      END;
      LineDimOption := DimCodeToOption(LineDimCode);
      InternalDateFilter := AnalysisViewEntry.GETFILTER("Liquidity Date");
      IF (LineDimOption <> LineDimOption::Period) AND (ColumnDimOption <> ColumnDimOption::Period) THEN BEGIN
        DateFilter := InternalDateFilter;
        IF STRPOS(DateFilter,'&') > 1 THEN
          DateFilter := COPYSTR(DateFilter,1,STRPOS(DateFilter,'&') - 1);
      END ELSE
        PeriodInitialized := FALSE;
    END;

    LOCAL PROCEDURE ValidateColumnDimCode@1402();
    VAR
      Liquidity@1403 : Record 5055250;
    BEGIN
      IF (UPPERCASE(ColumnDimCode) <> UPPERCASE(LiqAcc.TABLECAPTION)) AND
         (UPPERCASE(ColumnDimCode) <> UPPERCASE(Liquidity.TABLECAPTION)) AND
         (UPPERCASE(ColumnDimCode) <> UPPERCASE(Text1140000)) AND
         (UPPERCASE(ColumnDimCode) <> AnalysisView."Dimension 1 Code") AND
         (UPPERCASE(ColumnDimCode) <> AnalysisView."Dimension 2 Code") AND
         (UPPERCASE(ColumnDimCode) <> AnalysisView."Dimension 3 Code") AND
         (UPPERCASE(ColumnDimCode) <> AnalysisView."Dimension 4 Code") AND
         (ColumnDimCode <> '') THEN BEGIN
        MESSAGE(Text1140004,ColumnDimCode);
        ColumnDimCode := '';
      END;
      ColumnDimOption := DimCodeToOption(ColumnDimCode);
      InternalDateFilter := AnalysisViewEntry.GETFILTER("Liquidity Date");
      IF (LineDimOption <> LineDimOption::Period) AND (ColumnDimOption <> ColumnDimOption::Period) THEN BEGIN
        DateFilter := InternalDateFilter;
        IF STRPOS(DateFilter,'&') > 1 THEN
          DateFilter := COPYSTR(DateFilter,1,STRPOS(DateFilter,'&') - 1);
      END ELSE
        PeriodInitialized := FALSE;
    END;

    LOCAL PROCEDURE CalcAmount@1404(SetColFilter@1140000 : Boolean) : Decimal;
    VAR
      Amount@1405 : Decimal;
      ColumnCode@1406 : Code[20];
    BEGIN
      IF SetColFilter THEN
        ColumnCode := MatrixRecord.Code
      ELSE
        ColumnCode := '';
      IF AVBreakdownBuffer.GET(Code,ColumnCode) THEN
        EXIT(AVBreakdownBuffer.Amount);
      CASE ShowActual OF
        ShowActual::Amounts:
          Amount := CalcActualAmount(SetColFilter);
      END;
      IF ShowOppositeSign THEN
        Amount := -Amount;
      AVBreakdownBuffer."Line Code" := Code;
      AVBreakdownBuffer."Column Code" := ColumnCode;
      AVBreakdownBuffer.Amount := Amount;
      AVBreakdownBuffer.INSERT;
      EXIT(Amount);
    END;

    LOCAL PROCEDURE CalcActualAmount@1407(SetColFilter@1140000 : Boolean) : Decimal;
    VAR
      Amount@1408 : Decimal;
    BEGIN
      AnalysisViewEntry.RESET;
      SetCommonFilters(AnalysisViewEntry);
      SetDimFilters(AnalysisViewEntry,0);
      IF SetColFilter THEN
        SetDimFilters(AnalysisViewEntry,1);
      AnalysisViewEntry.CALCSUMS(Amount);
      Amount := AnalysisViewEntry.Amount;
      EXIT(Amount);
    END;

    LOCAL PROCEDURE GetCaptionClass@1409(AnalysisViewDimType@1140000 : Integer) : Text[250];
    BEGIN
      IF AnalysisView.Code <> AnalysisViewCode THEN
        AnalysisView.GET(AnalysisViewCode);
      CASE AnalysisViewDimType OF
        1:
          BEGIN
            IF AnalysisView."Dimension 1 Code" <> '' THEN
              EXIT('1,6,' + AnalysisView."Dimension 1 Code")
            ELSE
              EXIT(Text1140005);
          END;
        2:
          BEGIN
            IF AnalysisView."Dimension 2 Code" <> '' THEN
              EXIT('1,6,' + AnalysisView."Dimension 2 Code")
            ELSE
              EXIT(Text1140006);
          END;
        3:
          BEGIN
            IF AnalysisView."Dimension 3 Code" <> '' THEN
              EXIT('1,6,' + AnalysisView."Dimension 3 Code")
            ELSE
              EXIT(Text1140007);
          END;
        4:
          BEGIN
            IF AnalysisView."Dimension 4 Code" <> '' THEN
              EXIT('1,6,' + AnalysisView."Dimension 4 Code")
            ELSE
              EXIT(Text1140008);
          END;
      END;
    END;

    LOCAL PROCEDURE ShownCurrency@1410() : Code[10];
    BEGIN
      EXIT('');
    END;

    LOCAL PROCEDURE MATRIX_UpdateMatrixRecord@1193(MATRIX_NewColumnOrdinal@1005 : Integer);
    VAR
      MATRIX_CurrentColumnOrdinal@1194 : Integer;
    BEGIN
      MATRIX_ColumnOrdinal := MATRIX_NewColumnOrdinal;
      MatrixRecord.SETPOSITION(MATRIX_PrimKeyFirstCol);
      MATRIX_OnFindRecord('=');
      MATRIX_CurrentColumnOrdinal := 1;
      IF MATRIX_ColumnOrdinal <> 1 THEN
        MATRIX_OnNextRecord(MATRIX_ColumnOrdinal - 1);
    END;

    LOCAL PROCEDURE MATRIX_OnFindRecord@1195(Which@1007 : Text[1024]) : Boolean;
    BEGIN
      EXIT(FindRec(ColumnDimOption,MatrixRecord,Which));
    END;

    LOCAL PROCEDURE MATRIX_OnNextRecord@1196(Steps@1008 : Integer) : Integer;
    BEGIN
      EXIT(NextRec(ColumnDimOption,MatrixRecord,Steps));
    END;

    LOCAL PROCEDURE MATRIX_OnAfterGetRecord@1197();
    BEGIN
      IF ShowColumnName THEN
        MatrixHeader := MatrixRecord.Name
      ELSE
        MatrixHeader := MatrixRecord.Code;

       MatrixAmount := CalcAmount(TRUE);

      IF MatrixAmount = 0 THEN
        MATRIX_CellData[MATRIX_ColumnOrdinal] := ''
      ELSE BEGIN
        CASE RoundingFactor OF
          RoundingFactor::"1":
            MatrixAmount := ROUND(MatrixAmount,1);
          RoundingFactor::"1000":
            MatrixAmount := ROUND(MatrixAmount / 1000,0.1);
          RoundingFactor::"1000000":
            MatrixAmount := ROUND(MatrixAmount / 1000000,0.1);
        END;
        MATRIX_CellData[MATRIX_ColumnOrdinal] := FORMAT(MatrixAmount,0,Text1140001);
      END;
    END;

    PROCEDURE SetVisible@8();
    BEGIN
      CurrForm.Field1.VISIBLE(ColumnCaptions[1] <> '');
      CurrForm.Field2.VISIBLE(ColumnCaptions[2] <> '');
      CurrForm.Field3.VISIBLE(ColumnCaptions[3] <> '');
      CurrForm.Field4.VISIBLE(ColumnCaptions[4] <> '');
      CurrForm.Field5.VISIBLE(ColumnCaptions[5] <> '');
      CurrForm.Field6.VISIBLE(ColumnCaptions[6] <> '');
      CurrForm.Field7.VISIBLE(ColumnCaptions[7] <> '');
      CurrForm.Field8.VISIBLE(ColumnCaptions[8] <> '');
      CurrForm.Field9.VISIBLE(ColumnCaptions[9] <> '');
      CurrForm.Field10.VISIBLE(ColumnCaptions[10] <> '');
      CurrForm.Field11.VISIBLE(ColumnCaptions[11] <> '');
      CurrForm.Field12.VISIBLE(ColumnCaptions[12] <> '');
      CurrForm.Field13.VISIBLE(ColumnCaptions[13] <> '');
      CurrForm.Field14.VISIBLE(ColumnCaptions[14] <> '');
      CurrForm.Field15.VISIBLE(ColumnCaptions[15] <> '');
      CurrForm.Field16.VISIBLE(ColumnCaptions[16] <> '');
      CurrForm.Field17.VISIBLE(ColumnCaptions[17] <> '');
      CurrForm.Field18.VISIBLE(ColumnCaptions[18] <> '');
      CurrForm.Field19.VISIBLE(ColumnCaptions[19] <> '');
      CurrForm.Field20.VISIBLE(ColumnCaptions[20] <> '');
      CurrForm.Field21.VISIBLE(ColumnCaptions[21] <> '');
      CurrForm.Field22.VISIBLE(ColumnCaptions[22] <> '');
      CurrForm.Field23.VISIBLE(ColumnCaptions[23] <> '');
      CurrForm.Field24.VISIBLE(ColumnCaptions[24] <> '');
      CurrForm.Field25.VISIBLE(ColumnCaptions[25] <> '');
      CurrForm.Field26.VISIBLE(ColumnCaptions[26] <> '');
      CurrForm.Field27.VISIBLE(ColumnCaptions[27] <> '');
      CurrForm.Field28.VISIBLE(ColumnCaptions[28] <> '');
      CurrForm.Field29.VISIBLE(ColumnCaptions[29] <> '');
      CurrForm.Field30.VISIBLE(ColumnCaptions[30] <> '');
      CurrForm.Field31.VISIBLE(ColumnCaptions[31] <> '');
      CurrForm.Field32.VISIBLE(ColumnCaptions[32] <> '');
    END;

    PROCEDURE Load@3(LineDimOptionLocal@1015 : 'G/L Account,Period,Business Unit,Dimension 1,Dimension 2,Dimension 3,Dimension 4';ColumnDimOptionLocal@1000 : 'G/L Account,Period,Business Unit,Dimension 1,Dimension 2,Dimension 3,Dimension 4';LineDimCodeLocal@1020 : Text[30];ColumnDimCodeLocal@1019 : Text[30];NewPeriodType@1002 : Option;NewDateFilter@1003 : Text[250];NewLiqAccFilter@1004 : Code[250];NewLiquidityFilter@1005 : Code[250];NewDim1Filter@1006 : Code[250];NewDim2Filter@1007 : Code[250];NewDim3Filter@1016 : Code[250];NewDim4Filter@1017 : Code[250];NewShowActual@1008 : Option;NewRoundingFactor@1011 : Option;NewMATRIX_ColumnCaptions@1013 : ARRAY [32] OF Text[250];NewPrimKeyFirstCol@1014 : Text[1024]);
    BEGIN
      LineDimOption := LineDimOptionLocal;
      ColumnDimOption := ColumnDimOptionLocal;
      LineDimCode := LineDimCodeLocal;
      ColumnDimCode := ColumnDimCodeLocal;
      PeriodType := NewPeriodType;
      DateFilter := NewDateFilter;
      PeriodInitialized := TRUE;
      LiqAccFilter := NewLiqAccFilter;
      LiquidityFilter := NewLiquidityFilter;
      Dim1Filter := NewDim1Filter;
      Dim2Filter := NewDim2Filter;
      Dim3Filter := NewDim3Filter;
      Dim4Filter := NewDim4Filter;
      ShowActual := NewShowActual;
      RoundingFactor := NewRoundingFactor;
      COPYARRAY(ColumnCaptions,NewMATRIX_ColumnCaptions,1);
      MATRIX_PrimKeyFirstCol := NewPrimKeyFirstCol;
    END;

    PROCEDURE Load2@1(NewAmountType@1000 : 'Balance at Date,Net Change';ViewCode@1003 : Code[50];ShowOp@1002 : Boolean;ShowColumnNameLocal@1001 : Boolean);
    BEGIN
      AmountType := NewAmountType;
      ShowOppositeSign := ShowOp;
      AnalysisViewCode := ViewCode;
      ShowColumnName := ShowColumnNameLocal;
    END;

    BEGIN
    END.
  }
}
