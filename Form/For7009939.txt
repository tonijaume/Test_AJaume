OBJECT Form 7009939 Tabla Agrupaciones generadas
{
  OBJECT-PROPERTIES
  {
    Date=01/06/15;
    Time=11:37:22;
    Modified=Yes;
    Version List=AIC2009;
  }
  PROPERTIES
  {
    Width=22770;
    Height=12980;
    CaptionML=[ENU=Generated Transfer services List;
               ESP=Lista Agrupaciones generadas];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    TableBoxID=1;
    SourceTable=Table7009796;
    UpdateOnActivate=Yes;
    SourceTableView=SORTING(Estado,Fecha,N§ Agrupacion)
                    WHERE(Estado=CONST(Generado));
    OnOpenForm=VAR
                 lrConfCol@1103355000 : Record 7009822;
                 lwCont@1103355001 : Integer;
               BEGIN
                 SETRANGE("N§ Agrupacion");

                 CLEAR(wClave);

                 CLEAR(lrConfCol);
                 lrConfCol.SETCURRENTKEY("Rango Desde", "Rango Hasta");
                 lrConfCol.SETRANGE(Tipo              , lrConfCol.Tipo::Transfer);
                 IF lrConfCol.FINDSET THEN
                 BEGIN
                   CLEAR(lwCont);
                   REPEAT
                     IF lrConfCol."Codigo Color" <> 0 THEN
                       wClave[lrConfCol."Codigo Color"] := STRSUBSTNO('%1-%2', lrConfCol."Rango Desde",lrConfCol."Rango Hasta");
                   UNTIL (lrConfCol.NEXT = 0) OR (lwCont = 10);
                 END;
               END;

  }
  CONTROLS
  {
    { 1   ;TableBox     ;220  ;220  ;22330;11330;HorzGlue=Both;
                                                 VertGlue=Both;
                                                 HeadingHeight=880 }
    { 8   ;TextBox      ;0    ;0    ;1650 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Fecha;
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm.Fecha.UPDATEFORECOLOR(wColor);
                                                            CurrForm.Fecha.UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 9   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=8;
                                                 InColumnHeading=Yes }
    { 2   ;TextBox      ;0    ;0    ;1603 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="N§ Agrupacion";
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm."N§ Agrupacion".UPDATEFORECOLOR(wColor);
                                                            CurrForm."N§ Agrupacion".UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 3   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=2;
                                                 InColumnHeading=Yes }
    { 4   ;TextBox      ;0    ;0    ;4400 ;0    ;HorzGlue=Both;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=TourOperadores;
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm.TourOperadores.UPDATEFORECOLOR(wColor);
                                                            CurrForm.TourOperadores.UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 5   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=4;
                                                 InColumnHeading=Yes }
    { 1100217010;TextBox;27967;660  ;4400 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Nombre Transportista" }
    { 1100217011;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100217010;
                                                 InColumnHeading=Yes }
    { 1000000009;Indicator;12250;4400;2750;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 CaptionML=[ENU=Profit margin;
                                                            ESP=Margen beneficio];
                                                 SourceExpr="Margen Beneficio"*100 }
    { 1000000010;Label  ;0    ;0    ;0    ;0    ;ParentControl=1000000009;
                                                 InColumnHeading=Yes }
    { 1100217015;TextBox;8043 ;660  ;1700 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Numero Bus";
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm."Numero Bus".UPDATEFORECOLOR(wColor);
                                                            CurrForm."Numero Bus".UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 1100217016;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100217015;
                                                 InColumnHeading=Yes }
    { 26  ;TextBox      ;0    ;0    ;1650 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Tipo vehiculo";
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm."Tipo vehiculo".UPDATEFORECOLOR(wColor);
                                                            CurrForm."Tipo vehiculo".UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 27  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=26;
                                                 InColumnHeading=Yes }
    { 1100217017;TextBox;9743 ;660  ;1502 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Capacidad Vehiculo";
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm."Capacidad Vehiculo".UPDATEFORECOLOR(wColor);
                                                            CurrForm."Capacidad Vehiculo".UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 1100217018;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100217017;
                                                 InColumnHeading=Yes }
    { 1100217004;TextBox;34893;550  ;1870 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Tipo servicio transportista" }
    { 1100217005;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100217004;
                                                 InColumnHeading=Yes }
    { 1000000000;CheckBox;18283;660 ;765  ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 ShowCaption=No;
                                                 SourceExpr="Sin coste" }
    { 1000000001;Label  ;0    ;0    ;0    ;0    ;ParentControl=1000000000;
                                                 InColumnHeading=Yes }
    { 1100217022;TextBox;18336;660  ;1700 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Hora presentacion";
                                                 Format=<Hours24>:<Minutes,2> }
    { 1100217023;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100217022;
                                                 InColumnHeading=Yes }
    { 54  ;TextBox      ;7805 ;330  ;3750 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Zonas;
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm.Zonas.UPDATEFORECOLOR(wColor);
                                                            CurrForm.Zonas.UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 55  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=54;
                                                 InColumnHeading=Yes }
    { 1000000002;TextBox;24975;3960 ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Tipo Servicio venta" }
    { 1000000003;Label  ;0    ;0    ;0    ;0    ;ParentControl=1000000002;
                                                 InColumnHeading=Yes }
    { 1103355005;CheckBox;18733;660 ;1213 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 ShowCaption=No;
                                                 SourceExpr="Transfer Privado" }
    { 1103355006;Label  ;0    ;0    ;0    ;0    ;ParentControl=1103355005;
                                                 InColumnHeading=Yes }
    { 1100217020;CheckBox;16193;440 ;1700 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 ShowCaption=No;
                                                 SourceExpr="Traslado en destino" }
    { 1100217021;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100217020;
                                                 InColumnHeading=Yes }
    { 6   ;TextBox      ;0    ;0    ;1079 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Tipo transfer";
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm."Tipo transfer".UPDATEFORECOLOR(wColor);
                                                            CurrForm."Tipo transfer".UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 7   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=6;
                                                 InColumnHeading=Yes }
    { 12  ;TextBox      ;0    ;0    ;1204 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Personas entrada";
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm."Personas entrada".UPDATEFORECOLOR(wColor);
                                                            CurrForm."Personas entrada".UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 13  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=12;
                                                 InColumnHeading=Yes }
    { 14  ;TextBox      ;0    ;0    ;990  ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Personas salida";
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm."Personas salida".UPDATEFORECOLOR(wColor);
                                                            CurrForm."Personas salida".UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 15  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=14;
                                                 InColumnHeading=Yes }
    { 32  ;TextBox      ;16933;550  ;1210 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Elementos entrada";
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm."Elementos entrada".UPDATEFORECOLOR(wColor);
                                                            CurrForm."Elementos entrada".UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 33  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=32;
                                                 InColumnHeading=Yes }
    { 34  ;TextBox      ;19133;550  ;990  ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Elementos salida";
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm."Elementos salida".UPDATEFORECOLOR(wColor);
                                                            CurrForm."Elementos salida".UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 35  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=34;
                                                 InColumnHeading=Yes }
    { 16  ;TextBox      ;0    ;0    ;1210 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Reservas entrada";
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm."Reservas entrada".UPDATEFORECOLOR(wColor);
                                                            CurrForm."Reservas entrada".UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 17  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=16;
                                                 InColumnHeading=Yes }
    { 18  ;TextBox      ;0    ;0    ;990  ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Reservas salida";
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm."Reservas salida".UPDATEFORECOLOR(wColor);
                                                            CurrForm."Reservas salida".UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 19  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=18;
                                                 InColumnHeading=Yes }
    { 57  ;TextBox      ;11642;660  ;1629 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Medio del transfer";
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm."Medio del transfer".UPDATEFORECOLOR(wColor);
                                                            CurrForm."Medio del transfer".UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 58  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=57;
                                                 InColumnHeading=Yes }
    { 1103355001;TextBox;20929;1100 ;1700 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 CaptionML=[ENU=Touroperator guests;
                                                            ESP=Invitados Touroperador];
                                                 SourceExpr=cCalMar.invitados_touroperador("N§ Agrupacion", "Tipo transfer") }
    { 1103355002;Label  ;0    ;0    ;0    ;0    ;ParentControl=1103355001;
                                                 InColumnHeading=Yes }
    { 1103355003;TextBox;22860;880  ;1700 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 CaptionML=[ENU=Carrier Guests;
                                                            ESP=Invitados Transportista];
                                                 SourceExpr=cCalMar.invitados_transportista("N§ Agrupacion", "Tipo transfer") }
    { 1103355004;Label  ;0    ;0    ;0    ;0    ;ParentControl=1103355003;
                                                 InColumnHeading=Yes }
    { 20  ;TextBox      ;0    ;0    ;1430 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Anuladas;
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm.Anuladas.UPDATEFORECOLOR(wColor);
                                                            CurrForm.Anuladas.UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 21  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=20;
                                                 InColumnHeading=Yes }
    { 22  ;TextBox      ;0    ;0    ;1980 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Transportista;
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm.Transportista.UPDATEFORECOLOR(wColor);
                                                            CurrForm.Transportista.UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 23  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=22;
                                                 InColumnHeading=Yes }
    { 60  ;TextBox      ;27859;880  ;4400 ;440  ;Name=Margen1;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 CaptionML=[ENU=Margin;
                                                            ESP=Margen];
                                                 SourceExpr=rConfC.GetTexto("Margen Beneficio",rConfC.Tipo::Transfer);
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm.Margen1.UPDATEFORECOLOR(wColor);
                                                            CurrForm.Margen1.UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 61  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=60;
                                                 InColumnHeading=Yes }
    { 1100217002;TextBox;34343;550  ;1815 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Tipo precio ingreso" }
    { 1100217003;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100217002;
                                                 InColumnHeading=Yes }
    { 28  ;TextBox      ;0    ;0    ;4400 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Vuelos;
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm.Vuelos.UPDATEFORECOLOR(wColor);
                                                            CurrForm.Vuelos.UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 29  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=28;
                                                 InColumnHeading=Yes }
    { 30  ;TextBox      ;0    ;0    ;1650 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="N§ vuelos";
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm."N§ vuelos".UPDATEFORECOLOR(wColor);
                                                            CurrForm."N§ vuelos".UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 31  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=30;
                                                 InColumnHeading=Yes }
    { 36  ;CommandButton;8030 ;11770;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Default=Yes;
                                                 PushAction=LookupOK;
                                                 InvalidActionAppearance=Hide }
    { 37  ;CommandButton;10450;11770;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Cancel=Yes;
                                                 PushAction=LookupCancel;
                                                 InvalidActionAppearance=Hide }
    { 38  ;CommandButton;20350;11770;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 39  ;MenuButton   ;17710;11770;2420 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=&Services;
                                                            ESP=A&grupaciones];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=40;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Ctrl+F5;
                                                     CaptionML=[ENU=&Card;
                                                                ESP=&Ficha agrupacion];
                                                     RunObject=Form 7009938;
                                                     RunFormView=SORTING(N§ Agrupacion);
                                                     RunFormLink=N§ Agrupacion=FIELD(N§ Agrupacion) }
                                                   { ID=44;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=&Calculation errors;
                                                                ESP=&Errores calculo];
                                                     RunObject=Form 7009936;
                                                     RunFormView=SORTING(Agrupacion,N§ Error);
                                                     RunFormLink=Agrupacion=FIELD(N§ Agrupacion) }
                                                   { ID=10;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=&Consult margins;
                                                                ESP=&Consulta Margenes];
                                                     RunObject=Form 7009934;
                                                     RunFormView=SORTING(Agrupacion,N§ Linea);
                                                     RunFormLink=Agrupacion=FIELD(N§ Agrupacion) }
                                                   { ID=50;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=&View zones;
                                                                ESP=&Ver Zonas agrupacion];
                                                     RunObject=Form 7009909;
                                                     RunFormView=SORTING(N§ Agrupacion,Zona,Tipo transfer,Tipo zona);
                                                     RunFormLink=N§ Agrupacion=FIELD(N§ Agrupacion) }
                                                   { ID=51;
                                                     CaptionML=[ENU=&Reservations list;
                                                                ESP=&Lista de Reservas];
                                                     OnPush=BEGIN
                                                              IF "Tipo transfer" = "Tipo transfer"::Entrada THEN BEGIN
                                                                rRsv.RESET;
                                                                rRsv.SETCURRENTKEY(rRsv."Agrupacion entrada");
                                                                rRsv.SETRANGE("Agrupacion entrada", "N§ Agrupacion");
                                                                fTabRes.SETTABLEVIEW(rRsv);
                                                                fTabRes.RUNMODAL;
                                                                CLEAR(fTabRes);
                                                                rRsv.RESET;
                                                              END
                                                              ELSE BEGIN
                                                                rRsv.RESET;
                                                                rRsv.SETCURRENTKEY(rRsv."Agrupacion salida");
                                                                rRsv.SETRANGE("Agrupacion salida", "N§ Agrupacion");
                                                                fTabRes.SETTABLEVIEW(rRsv);
                                                                fTabRes.RUNMODAL;
                                                                CLEAR(fTabRes);
                                                                rRsv.RESET;
                                                              END;
                                                            END;
                                                             }
                                                   { ID=1100253002;
                                                     MenuItemType=Separator }
                                                   { ID=11;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=&Comments;
                                                                ESP=&Comentarios agrupacion];
                                                     RunObject=Form 7009945;
                                                     RunFormView=SORTING(Agrupacion,N§ Comentario);
                                                     RunFormLink=Agrupacion=FIELD(N§ Agrupacion) }
                                                   { ID=45;
                                                     CaptionML=[ENU=Supplements;
                                                                ESP=Suplementos agrupacion];
                                                     OnPush=VAR
                                                              lrSupAgr@1103355001 : Record 7009816;
                                                              lfTabSuplem@1103355002 : Form 7009878;
                                                            BEGIN
                                                              lrSupAgr.RESET;
                                                              lrSupAgr.FILTERGROUP(2);
                                                              lrSupAgr.SETRANGE("Num Agrupacion", "N§ Agrupacion");
                                                              lrSupAgr.FILTERGROUP(0);

                                                              CLEAR(lfTabSuplem);
                                                              lfTabSuplem.SETTABLEVIEW(lrSupAgr);
                                                              lfTabSuplem.EDITABLE(TRUE);
                                                              lfTabSuplem.RUNMODAL;
                                                            END;
                                                             }
                                                   { ID=1100217019;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=Support services;
                                                                ESP=Servicios de soporte];
                                                     RunObject=Form 7009879;
                                                     RunFormLink=Agrupacion=FIELD(N§ Agrupacion) }
                                                   { ID=1100253000;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=Porters;
                                                                ESP=Maleteros];
                                                     RunObject=Form 7009811;
                                                     RunFormLink=Num Agrupacion=FIELD(N§ Agrupacion) }
                                                   { ID=1100253001;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=Guides;
                                                                ESP=Guias];
                                                     RunObject=Form 7009815;
                                                     RunFormLink=Num.Agrupacion=FIELD(N§ Agrupacion) }
                                                   { ID=1100217006;
                                                     MenuItemType=Separator }
                                                   { ID=1100217007;
                                                     CaptionML=[ENU=Purchase contract;
                                                                ESP=Contrato compra];
                                                     OnPush=BEGIN
                                                              ViewContratosCompra;
                                                            END;
                                                             }
                                                   { ID=1100217008;
                                                     CaptionML=[ENU=Sales contract;
                                                                ESP=Contrato venta];
                                                     OnPush=BEGIN
                                                              ViewContratrosVenta;
                                                            END;
                                                             }
                                                   { ID=1000000004;
                                                     MenuItemType=Separator }
                                                   { ID=1000000005;
                                                     CaptionML=[ENU=Pick-ups;
                                                                ESP=&Horarios agrupacion];
                                                     OnPush=VAR
                                                              lrHorAgr@1000000000 : Record 7009800;
                                                            BEGIN
                                                              IF "N§ Agrupacion" <> 0 THEN
                                                              BEGIN
                                                                lrHorAgr.RESET;
                                                                lrHorAgr.FILTERGROUP(0);
                                                                lrHorAgr.SETRANGE("N§ Agrupacion","N§ Agrupacion");
                                                                lrHorAgr.FILTERGROUP(2);
                                                                IF lrHorAgr.FINDFIRST THEN
                                                                  FORM.RUNMODAL(7009910, lrHorAgr);
                                                              END;
                                                            END;
                                                             }
                                                 }
                                                  }
    { 46  ;MenuButton   ;15290;11770;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=&Actions;
                                                            ESP=A&cciones];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=47;
                                                     ShortCutKey=F9;
                                                     CaptionML=[ENU=&Calculate margins;
                                                                ESP=&Calcular Margenes];
                                                     OnPush=BEGIN
                                                              cCalMar.calcular_margenes(FALSE, Rec);
                                                            END;
                                                             }
                                                   { ID=59;
                                                     ShortCutKey=Ctrl+F9;
                                                     CaptionML=[ENU=Calculate Filtered;
                                                                ESP=Calcular Filtrados];
                                                     OnPush=VAR
                                                              lrAgr@1103355001 : Record 7009796;
                                                              lwTotal@1103355002 : Integer;
                                                              lwCont@1103355003 : Integer;
                                                            BEGIN
                                                              CLEAR(lrAgr);
                                                              CurrForm.SETSELECTIONFILTER(lrAgr);
                                                              IF lrAgr.FIND('-') THEN BEGIN
                                                                CLEAR(lwCont);
                                                                lwTotal := lrAgr.COUNT;
                                                                wVentana.OPEN('@1@@@@@@@@@@@');
                                                                REPEAT
                                                                  cCalMar.calcular_margenesSin(lrAgr);
                                                                  lwCont +=1;
                                                                  wVentana.UPDATE(1,ROUND(lwCont/lwTotal*10000,1));
                                                                UNTIL lrAgr.NEXT=0;
                                                                wVentana.CLOSE;
                                                              END ELSE
                                                                ERROR(Text000);
                                                            END;
                                                             }
                                                   { ID=1100217024;
                                                     CaptionML=[ENU=Assign &supplement;
                                                                ESP=Asignar &suplemento];
                                                     OnPush=BEGIN
                                                              cCalMar.asignar_suplemento(Rec);
                                                            END;
                                                             }
                                                   { ID=1100217001;
                                                     MenuItemType=Separator }
                                                   { ID=1000000007;
                                                     CaptionML=ESP=&Fusionar servicios;
                                                     OnPush=BEGIN
                                                              cCalMar.FusionarAgrupaciones(Rec);
                                                            END;
                                                             }
                                                   { ID=48;
                                                     ShortCutKey=Ctrl+F11;
                                                     CaptionML=[ENU=&Return to pending services;
                                                                ESP=&Retroceder servicios];
                                                     OnPush=BEGIN
                                                              cCalMar.retroceder_servicios(Rec);
                                                            END;
                                                             }
                                                   { ID=49;
                                                     ShortCutKey=F11;
                                                     CaptionML=[ENU=Confirm &Services;
                                                                ESP=Confirmar &Servicios];
                                                     OnPush=BEGIN
                                                              cCalMar.confirmar_servicios(Rec);
                                                            END;
                                                             }
                                                   { ID=1100217000;
                                                     MenuItemType=Separator }
                                                   { ID=52;
                                                     ShortCutKey=F3;
                                                     CaptionML=[ENU=Create &Service;
                                                                ESP=Crear &Agrupacion];
                                                     OnPush=BEGIN
                                                              cFunTra.crear_transfer(Estado);
                                                            END;
                                                             }
                                                   { ID=53;
                                                     ShortCutKey=F4;
                                                     CaptionML=[ENU=&Delete service;
                                                                ESP=&Borrar agrupacion];
                                                     OnPush=BEGIN
                                                              cCodCua.Desagrupar(Rec);
                                                            END;
                                                             }
                                                 }
                                                  }
    { 64  ;TextBox      ;3410 ;11770;1760 ;440  ;Name=Clave3;
                                                 VertGlue=Bottom;
                                                 Focusable=No;
                                                 ParentControl=70;
                                                 HorzAlign=Left;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=Clave3;
                                                            ESP=Clave3];
                                                 SourceExpr=wClave[3] }
    { 65  ;TextBox      ;3410 ;12320;1760 ;440  ;Name=Clave4;
                                                 VertGlue=Bottom;
                                                 Focusable=No;
                                                 ParentControl=68;
                                                 HorzAlign=Left;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=Clave4;
                                                            ESP=Clave4];
                                                 SourceExpr=wClave[4] }
    { 66  ;TextBox      ;770  ;11770;1760 ;440  ;Name=Clave1;
                                                 VertGlue=Bottom;
                                                 Focusable=No;
                                                 ParentControl=71;
                                                 HorzAlign=Left;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=Clave1;
                                                            ESP=Clave1];
                                                 SourceExpr=wClave[1] }
    { 67  ;TextBox      ;770  ;12320;1760 ;440  ;Name=Clave2;
                                                 VertGlue=Bottom;
                                                 Focusable=No;
                                                 ParentControl=69;
                                                 HorzAlign=Left;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=Clave2;
                                                            ESP=Clave2];
                                                 SourceExpr=wClave[2] }
    { 68  ;Shape        ;2860 ;12320;440  ;440  ;Name=ShapeAzul;
                                                 VertGlue=Bottom;
                                                 BackColor=16711680;
                                                 BackTransparent=No }
    { 69  ;Shape        ;220  ;12320;440  ;440  ;Name=ShapeRojo;
                                                 VertGlue=Bottom;
                                                 BackColor=255;
                                                 BackTransparent=No }
    { 70  ;Shape        ;2860 ;11770;440  ;440  ;Name=ShapeVerde;
                                                 VertGlue=Bottom;
                                                 BackColor=45824;
                                                 BackTransparent=No }
    { 71  ;Shape        ;220  ;11770;440  ;440  ;Name=ShapeNegro;
                                                 VertGlue=Bottom;
                                                 BackColor=0;
                                                 BackTransparent=No }
    { 1100217012;MenuButton;12870;11770;2200;550;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=R&eports;
                                                            ESP=I&nformes];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=1100217013;
                                                     CaptionML=[ENU=Passengers x Service;
                                                                ESP=Pasajeros x Servicio];
                                                     OnPush=VAR
                                                              liCNTHojaServicio@1100217000 : Report 7010071;
                                                              liHojaServicioSa@1100217001 : Report 7009931;
                                                              liHojaServicioLle@1100217002 : Report 7009932;
                                                              lrAgrup@1100217004 : Record 7009796;
                                                            BEGIN
                                                              rDatIns.FINDFIRST;
                                                              CASE rDatIns."Empresa Real" OF
                                                                rDatIns."Empresa Real"::CNT:
                                                                BEGIN
                                                                  CLEAR(liCNTHojaServicio);
                                                                  liCNTHojaServicio.RUN;
                                                                END
                                                                ELSE
                                                                BEGIN
                                                                  IF "Tipo transfer" = "Tipo transfer"::Entrada THEN
                                                                  BEGIN
                                                                    lrAgrup.RESET;
                                                                    lrAgrup.SETRANGE(Fecha          , Fecha);
                                                                    lrAgrup.SETRANGE("N§ Agrupacion", "N§ Agrupacion");

                                                                    CLEAR(liHojaServicioLle);
                                                                    liHojaServicioLle.SETTABLEVIEW(lrAgrup);
                                                                    liHojaServicioLle.RUN;
                                                                  END
                                                                  ELSE
                                                                  BEGIN
                                                                    lrAgrup.RESET;
                                                                    lrAgrup.SETRANGE(Fecha          , Fecha);
                                                                    lrAgrup.SETRANGE("N§ Agrupacion", "N§ Agrupacion");

                                                                    CLEAR(liHojaServicioSa);
                                                                    liHojaServicioSa.SETTABLEVIEW(lrAgrup);
                                                                    liHojaServicioSa.RUN;
                                                                  END;
                                                                END;
                                                              END;
                                                            END;
                                                             }
                                                   { ID=1100217014;
                                                     CaptionML=[ENU=Suppliers summary;
                                                                ESP=Peticion transportista];
                                                     OnPush=VAR
                                                              liCNTPeticionTransfer@1100217000 : Report 7010072;
                                                            BEGIN
                                                              CLEAR(liCNTPeticionTransfer);
                                                              liCNTPeticionTransfer.RUN;
                                                            END;
                                                             }
                                                 }
                                                  }
  }
  CODE
  {
    VAR
      Text000@1103355010 : TextConst 'ENU=Any Grouping has been found;ESP=Nos se ha encontrado ninguna agrupaci¢n';
      cCalMar@1103355000 : Codeunit 7009736;
      cFunTra@1103355001 : Codeunit 7009732;
      cCodCua@1103355002 : Codeunit 7009733;
      fTabRes@1103355003 : Form 7009928;
      rRsv@1103355004 : Record 7009744;
      rConfC@1103355005 : Record 7009822;
      rDatIns@1100217000 : Record 7009768;
      wColor@1103355006 : Integer;
      wAgrpAnt@1103355007 : Integer;
      wVentana@1103355008 : Dialog;
      wClave@1103355009 : ARRAY [10] OF Code[20];

    PROCEDURE BuscaColor@1();
    BEGIN
      // BuscaColor
      // Cambia de color cambia la agrupacion

      IF wAgrpAnt="N§ Agrupacion" THEN
        EXIT;

      wAgrpAnt :="N§ Agrupacion";
      wColor   := rConfC.GetColor("Margen Beneficio",rConfC.Tipo::Transfer);
    END;

    BEGIN
    {
      $001 JPT 09/05/12 CNT-CAR-12004 // TRA06- Transfer Guides in Transfer Services - Nuevo acceso a Guias

      $002 AJS 08102012 Mostrar los campos "Tipo precio ingreso" y "Tipo precio coste"

      $003 AJS 09102012 Nuevas opciones para acceder a los contratos de compra y de venta desde esta ventana

      $004 AJS 16102012 Paso las funciones de acceso a los contratos a la tabla de agrupaciones

      $005 AJS 31102012 Mostrar el campo "Nombre Transportista"

      $006 AJS 19112012 Agregar el boton Informes para lanzar la peticion de transportista y lista de pasajeros
                        por servicio

      $007 AJS 09042013 Mostrar las columnas Capacidad y Numero de bus

      $008 AJS 14092013 Elimino si se ha dejado algun filtro puesto sobre el numero de agrupacion al abrir

      $009 AJS 05112013 CNT-OC-13018 Nueva opcion Servicios de soporte en el boton Agrupaciones

      $010 AJS 09042014 Mostrar el campo "Servicio cambio zona"

      $011 AJS 03052014 Mostrar el campo "Hora presentacion"

      $012 AJS 06052014 Nueva funcion asignar suplemento

      $013 AJS 04082014 Mostrar el campo "Sin Coste"

      $014 ARM 30092014 CNT-CAR-14063 Nuevo campo Tipo servicio

      $015 AJS 17122014 Agregar la opcion de horas de recogida

      $016 AJS 01062015 Eliminar informes obsoletos
    }
    END.
  }
}
