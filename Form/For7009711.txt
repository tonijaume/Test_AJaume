OBJECT Form 7009711 Entrada rapida excursiones
{
  OBJECT-PROPERTIES
  {
    Date=24/06/15;
    Time=17:09:29;
    Modified=Yes;
    Version List=AIC2009;
  }
  PROPERTIES
  {
    Width=21560;
    Height=14410;
    CaptionML=[ENU=Excursions quick entry;
               ESP=Entrada rapida excursiones];
    TableBoxID=1100253000;
    SourceTable=Table7010162;
    SourceTablePlacement=Last;
    PopulateAllFields=Yes;
    OnOpenForm=BEGIN
                 rPar.FINDFIRST;

                 RESET;
                 FILTERGROUP(2);
                 SETRANGE(Delegacion, rPar.Delegacion);
                 //. Filtro por usuario de creacion
                 SETRANGE("Usuario Creacion", USERID);

                 // +$021
                 IF vCredito THEN
                   SETRANGE("Reserva a credito", TRUE)
                 ELSE
                   SETRANGE("Reserva a credito", FALSE);

                 FILTERGROUP(0);

                 //$002
                 FiltraOficinaUsuario;

                 //. Inicialmente se visualizan las excursiones a futuro
                 SETFILTER("Fecha Excursion", '>=%1', TODAY);

                 SetEditables;
               END;

    OnAfterGetRecord=BEGIN
                       vAviso := '';

                       IF (NOT Anulada) AND (NOT Reembolsada) THEN
                         IF (TourOperador = '') OR ("N§ Ticket" = '') OR
                            (Producto = '') OR ("Hotel Cliente" = '') OR
                            ("Fecha Excursion" = 0D) OR ("Fecha Venta" = 0D) OR
                            ((Adultos = 0) AND (Ni¤os = 0)) THEN
                            vAviso := '**';

                         IF ("Reserva a credito") AND ("Booking Touroperador" = '') THEN
                           vAviso := '**';
                     END;

    OnNewRecord=BEGIN
                  "Fecha Venta" := TODAY;

                  "Fecha Excursion" := TODAY + 1;
                END;

  }
  CONTROLS
  {
    { 1100253000;TableBox;220 ;220  ;21120;13200;HorzGlue=Both;
                                                 VertGlue=Both;
                                                 HeadingHeight=880 }
    { 1000000019;TextBox;0    ;2200 ;603  ;440  ;Editable=No;
                                                 ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 ForeColor=255;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 BorderColor=16777215;
                                                 SourceExpr=vAviso }
    { 1000000020;Label  ;0    ;0    ;0    ;0    ;ParentControl=1000000019;
                                                 InColumnHeading=Yes;
                                                 CaptionML=ESP=Warning }
    { 1100217009;TextBox;0    ;660  ;2473 ;440  ;Editable=No;
                                                 ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="Usuario Creacion" }
    { 1100217010;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100217009;
                                                 InColumnHeading=Yes }
    { 1100253061;TextBox;48657;660  ;1980 ;440  ;ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="N§ Reserva";
                                                 OnFormat=BEGIN
                                                            CurrForm."N§ Reserva".UPDATEFORECOLOR := GetColor;
                                                          END;
                                                           }
    { 1100253062;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253061;
                                                 InColumnHeading=Yes }
    { 1100253048;TextBox;0    ;440  ;1700 ;440  ;ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="Fecha Venta";
                                                 OnFormat=BEGIN
                                                            CurrForm."Fecha Venta".UPDATEFORECOLOR := GetColor;
                                                          END;
                                                           }
    { 1100253049;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253048;
                                                 InColumnHeading=Yes }
    { 1100253016;TextBox;3334 ;330  ;2420 ;440  ;ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr=TourOperador;
                                                 OnFormat=BEGIN
                                                            CurrForm.TourOperador.UPDATEFORECOLOR := GetColor;
                                                          END;
                                                           }
    { 1100253017;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253016;
                                                 InColumnHeading=Yes }
    { 1100253005;TextBox;0    ;0    ;2998 ;0    ;ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="N§ Ticket";
                                                 OnFormat=BEGIN
                                                            CurrForm."N§ Ticket".UPDATEFORECOLOR := GetColor;
                                                          END;
                                                           }
    { 1100253006;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253005;
                                                 InColumnHeading=Yes }
    { 1100253058;TextBox;10742;440  ;2604 ;440  ;ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="Confirmacion proveedor" }
    { 1100253059;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253058;
                                                 InColumnHeading=Yes }
    { 1000000011;TextBox;12753;770  ;3108 ;440  ;ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="Booking Touroperador" }
    { 1000000012;Label  ;0    ;0    ;0    ;0    ;ParentControl=1000000011;
                                                 InColumnHeading=Yes }
    { 1000000022;CheckBox;17674;3630;1249 ;440  ;Editable=No;
                                                 ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 ShowCaption=No;
                                                 SourceExpr="Voucher printed" }
    { 1000000023;Label  ;0    ;0    ;0    ;0    ;ParentControl=1000000022;
                                                 InColumnHeading=Yes }
    { 1100253022;TextBox;8440 ;660  ;2520 ;440  ;ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="Guia Venta";
                                                 OnFormat=BEGIN
                                                            CurrForm."Guia Venta".UPDATEFORECOLOR := GetColor;
                                                          END;
                                                           }
    { 1100253023;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253022;
                                                 InColumnHeading=Yes }
    { 1100217018;TextBox;15372;6160 ;4884 ;440  ;Visible=No;
                                                 ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 CaptionML=[ENU=Sale Guide name;
                                                            ESP=Nombre Guia venta];
                                                 SourceExpr=cNom.nom_Representante("Guia Venta") }
    { 1100217019;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100217018;
                                                 InColumnHeading=Yes }
    { 1100253003;TextBox;0    ;0    ;2210 ;0    ;ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr=Producto;
                                                 OnFormat=BEGIN
                                                            CurrForm.Producto.UPDATEFORECOLOR := GetColor;
                                                          END;
                                                           }
    { 1100253004;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253003;
                                                 InColumnHeading=Yes }
    { 1100217003;TextBox;16378;4070 ;4132 ;440  ;Editable=No;
                                                 ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 CaptionML=[ENU=Excursion Name;
                                                            ESP=Nombre excursion];
                                                 SourceExpr=cNom.nom_producto(Producto) }
    { 1100217004;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100217003;
                                                 InColumnHeading=Yes }
    { 1100253001;TextBox;0    ;0    ;1700 ;0    ;ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="Fecha Excursion";
                                                 OnFormat=BEGIN
                                                            CurrForm."Fecha Excursion".UPDATEFORECOLOR := GetColor;
                                                          END;
                                                           }
    { 1100253002;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253001;
                                                 InColumnHeading=Yes }
    { 1000000007;TextBox;26750;4070 ;1700 ;440  ;ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="Turno Excursion" }
    { 1000000008;Label  ;0    ;0    ;0    ;0    ;ParentControl=1000000007;
                                                 InColumnHeading=Yes }
    { 1100253040;TextBox;5874 ;440  ;4400 ;440  ;ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="Nombre Cliente";
                                                 OnFormat=BEGIN
                                                            CurrForm."Nombre Cliente".UPDATEFORECOLOR := GetColor;
                                                          END;
                                                           }
    { 1100253041;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253040;
                                                 InColumnHeading=Yes }
    { 1100253042;TextBox;10081;440  ;1099 ;440  ;ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr=Idioma;
                                                 OnFormat=BEGIN
                                                            CurrForm.Idioma.UPDATEFORECOLOR := GetColor;
                                                          END;
                                                           }
    { 1100253043;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253042;
                                                 InColumnHeading=Yes }
    { 1100253018;TextBox;11880;770  ;1210 ;440  ;ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr=Adultos;
                                                 OnFormat=BEGIN
                                                            CurrForm.Adultos.UPDATEFORECOLOR := GetColor;
                                                          END;
                                                           }
    { 1100253019;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253018;
                                                 InColumnHeading=Yes }
    { 1100253020;TextBox;14080;770  ;1210 ;440  ;ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr=Ni¤os;
                                                 OnFormat=BEGIN
                                                            CurrForm.Ni¤os.UPDATEFORECOLOR := GetColor;
                                                          END;
                                                           }
    { 1100253021;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253020;
                                                 InColumnHeading=Yes }
    { 1100217034;TextBox;36036;550  ;1430 ;440  ;ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="Num. Vehiculos" }
    { 1100217035;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100217034;
                                                 InColumnHeading=Yes }
    { 1100253007;TextBox;0    ;0    ;2047 ;0    ;ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="Hotel Cliente";
                                                 OnFormat=BEGIN
                                                            CurrForm."Hotel Cliente".UPDATEFORECOLOR := GetColor;
                                                          END;

                                                 OnLookup=VAR
                                                            lrHotelE@1100253000 : Record 7010184;
                                                          BEGIN
                                                            CLEAR(lrHotelE);
                                                            lrHotelE.SETCURRENTKEY(Excursion, "Hora recogida");
                                                            lrHotelE.FILTERGROUP(2);
                                                            lrHotelE.SETRANGE (Excursion      , Producto);
                                                            lrHotelE.SETRANGE(lrHotelE.Turno, "Turno Excursion");
                                                            lrHotelE.SETFILTER("Hora recogida",'<>%1',0T);
                                                            lrHotelE.FILTERGROUP(0);
                                                            IF FORM.RUNMODAL(0, lrHotelE) = ACTION::LookupOK THEN
                                                              VALIDATE("Hotel Cliente", lrHotelE.Hotel);
                                                          END;
                                                           }
    { 1100253008;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253007;
                                                 InColumnHeading=Yes }
    { 1100217016;TextBox;10822;550  ;4840 ;440  ;Visible=No;
                                                 ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 CaptionML=[ENU=Hotel name;
                                                            ESP=Nombre hotel];
                                                 SourceExpr=cNom.nom_hotel("Hotel Cliente") }
    { 1100217017;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100217016;
                                                 InColumnHeading=Yes }
    { 1100253009;TextBox;0    ;0    ;1700 ;0    ;ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="N§ Habitacion";
                                                 OnFormat=BEGIN
                                                            CurrForm."N§ Habitacion".UPDATEFORECOLOR := GetColor;
                                                          END;
                                                           }
    { 1100253010;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253009;
                                                 InColumnHeading=Yes }
    { 1100253014;TextBox;9605 ;660  ;1320 ;440  ;ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="Hora Recogida";
                                                 Format=<Hours24,2>:<Minutes,2>;
                                                 OnFormat=BEGIN
                                                            CurrForm."Hora Recogida".UPDATEFORECOLOR := GetColor;
                                                          END;
                                                           }
    { 1100253015;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253014;
                                                 InColumnHeading=Yes }
    { 1100253034;TextBox;17833;660  ;1428 ;440  ;Editable=No;
                                                 ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="Precio Adulto";
                                                 OnFormat=BEGIN
                                                            CurrForm."Precio Adulto".UPDATEFORECOLOR := GetColor;
                                                          END;
                                                           }
    { 1100253035;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253034;
                                                 InColumnHeading=Yes }
    { 1100253036;TextBox;20033;660  ;1430 ;440  ;Editable=No;
                                                 ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="Precio Ni¤o";
                                                 OnFormat=BEGIN
                                                            CurrForm."Precio Ni¤o".UPDATEFORECOLOR := GetColor;
                                                          END;
                                                           }
    { 1100253037;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253036;
                                                 InColumnHeading=Yes }
    { 1100253038;TextBox;19765;660  ;2200 ;440  ;Editable=No;
                                                 ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="Ingreso reserva";
                                                 OnFormat=BEGIN
                                                            CurrForm."Ingreso reserva".UPDATEFORECOLOR := GetColor;
                                                          END;
                                                           }
    { 1100253039;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253038;
                                                 InColumnHeading=Yes }
    { 1100253032;TextBox;19685;440  ;4400 ;440  ;ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="Punto Recogida";
                                                 OnFormat=BEGIN
                                                            CurrForm."Punto Recogida".UPDATEFORECOLOR := GetColor;
                                                          END;
                                                           }
    { 1100253033;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253032;
                                                 InColumnHeading=Yes }
    { 1100253030;TextBox;19765;660  ;4400 ;440  ;ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr=Observaciones;
                                                 OnFormat=BEGIN
                                                            CurrForm.Observaciones.UPDATEFORECOLOR := GetColor;
                                                          END;
                                                           }
    { 1100253031;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253030;
                                                 InColumnHeading=Yes }
    { 1100253026;TextBox;18680;660  ;1320 ;440  ;ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="Venta - Invitados Adultos";
                                                 OnFormat=BEGIN
                                                            CurrForm."Venta - Invitados Adultos".UPDATEFORECOLOR := GetColor;
                                                          END;
                                                           }
    { 1100253027;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253026;
                                                 InColumnHeading=Yes }
    { 1100253028;TextBox;19553;660  ;1320 ;440  ;ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="Venta - Invitados ni¤os";
                                                 OnFormat=BEGIN
                                                            CurrForm."Venta - Invitados ni¤os".UPDATEFORECOLOR := GetColor;
                                                          END;
                                                           }
    { 1100253029;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253028;
                                                 InColumnHeading=Yes }
    { 1000000013;TextBox;69322;2530 ;1430 ;440  ;ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="Compra - Invitados Adultos";
                                                 OnFormat=BEGIN
                                                            CurrForm."Compra - Invitados Adultos".UPDATEFORECOLOR := GetColor;
                                                          END;
                                                           }
    { 1000000014;Label  ;0    ;0    ;0    ;0    ;ParentControl=1000000013;
                                                 InColumnHeading=Yes }
    { 1000000015;TextBox;70752;3520 ;1540 ;440  ;ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="Compra - Invitados ni¤os";
                                                 OnFormat=BEGIN
                                                            CurrForm."Compra - Invitados ni¤os".UPDATEFORECOLOR := GetColor;
                                                          END;
                                                           }
    { 1000000016;Label  ;0    ;0    ;0    ;0    ;ParentControl=1000000015;
                                                 InColumnHeading=Yes }
    { 1100253046;TextBox;42916;660  ;1700 ;440  ;Editable=No;
                                                 ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="N§ Servicio";
                                                 OnFormat=BEGIN
                                                            CurrForm."N§ Servicio".UPDATEFORECOLOR := GetColor;
                                                          END;
                                                           }
    { 1100253047;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253046;
                                                 InColumnHeading=Yes }
    { 1100253044;CheckBox;39608;440 ;1244 ;440  ;Editable=No;
                                                 ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 ShowCaption=No;
                                                 SourceExpr="Liquidado GV" }
    { 1100253045;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253044;
                                                 InColumnHeading=Yes }
    { 1100217024;TextBox;72900;660  ;1980 ;440  ;Visible=No;
                                                 Editable=No;
                                                 ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="Fecha Liquidacion GV" }
    { 1100217025;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100217024;
                                                 InColumnHeading=Yes }
    { 1100217020;TextBox;68951;770  ;2365 ;440  ;Visible=No;
                                                 Editable=No;
                                                 ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="Num. Factura" }
    { 1100217021;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100217020;
                                                 InColumnHeading=Yes }
    { 1100217030;TextBox;70035;550  ;1833 ;440  ;Visible=No;
                                                 Editable=No;
                                                 ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="N§ liquidacion GV" }
    { 1100217031;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100217030;
                                                 InColumnHeading=Yes }
    { 1100217007;CheckBox;54372;440 ;1760 ;440  ;Editable=No;
                                                 ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 ShowCaption=No;
                                                 SourceExpr=Reembolsada }
    { 1100217008;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100217007;
                                                 InColumnHeading=Yes }
    { 1100217022;TextBox;71200;660  ;2750 ;440  ;Visible=No;
                                                 Editable=No;
                                                 ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="Fecha anulaci¢n/Reembolso" }
    { 1100217023;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100217022;
                                                 InColumnHeading=Yes }
    { 1100217026;TextBox;72655;660  ;2310 ;440  ;Visible=No;
                                                 Editable=No;
                                                 ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="Fecha Liquidacion reembolso GV" }
    { 1100217027;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100217026;
                                                 InColumnHeading=Yes }
    { 1100217032;TextBox;78608;660  ;1863 ;440  ;Visible=No;
                                                 Editable=No;
                                                 ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="N§ liquidacion GV reembolso" }
    { 1100217033;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100217032;
                                                 InColumnHeading=Yes }
    { 1100217028;TextBox;74355;660  ;2530 ;440  ;Visible=No;
                                                 Editable=No;
                                                 ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="Num. abono reembolso" }
    { 1100217029;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100217028;
                                                 InColumnHeading=Yes }
    { 1000000024;TextBox;12250;5500 ;3359 ;440  ;Visible=No;
                                                 ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 CaptionML=[ENU=Credit card operation no.;
                                                            ESP=Num. operacion tarjeta];
                                                 SourceExpr=NumOperacionTarjeta }
    { 1000000025;Label  ;0    ;0    ;0    ;0    ;ParentControl=1000000024;
                                                 InColumnHeading=Yes }
    { 1100217005;CheckBox;53816;550 ;1100 ;440  ;Editable=No;
                                                 ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 ShowCaption=No;
                                                 SourceExpr=Anulada }
    { 1100217006;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100217005;
                                                 InColumnHeading=Yes }
    { 1000000009;TextBox;87127;770  ;2485 ;440  ;ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="Canal venta" }
    { 1000000010;Label  ;0    ;0    ;0    ;0    ;ParentControl=1000000009;
                                                 InColumnHeading=Yes }
    { 1100217000;TextBox;7964 ;5500 ;1700 ;440  ;Visible=No;
                                                 ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr=Oficina }
    { 1100217001;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100217000;
                                                 InColumnHeading=Yes }
    { 1000000017;TextBox;95779;770  ;1700 ;440  ;ParentControl=1100253000;
                                                 InColumn=Yes;
                                                 SourceExpr="Fecha Creacion" }
    { 1000000018;Label  ;0    ;0    ;0    ;0    ;ParentControl=1000000017;
                                                 InColumnHeading=Yes }
    { 1100253011;CommandButton;1870;13640;2200;550;
                                                 HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Default=Yes;
                                                 PushAction=LookupOK;
                                                 InvalidActionAppearance=Hide }
    { 1100253012;CommandButton;4290;13640;2200;550;
                                                 HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Cancel=Yes;
                                                 PushAction=LookupCancel;
                                                 InvalidActionAppearance=Hide }
    { 1100253013;CommandButton;19140;13640;2200;550;
                                                 HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 1100253052;MenuButton;9350;13640;2200;550 ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=&Actions;
                                                            ESP=&Acciones];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=1100253053;
                                                     ShortCutKey=F4;
                                                     CaptionML=[ENU=Void;
                                                                ESP=Anular];
                                                     OnPush=BEGIN
                                                              cFunExc.AnularTicket(Rec, FALSE);
                                                            END;
                                                             }
                                                   { ID=1100253054;
                                                     CaptionML=[ENU=Refund;
                                                                ESP=Reembolsar] }
                                                   { ID=1000000004;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Total refund;
                                                                ESP=Reembolso &total];
                                                     OnPush=BEGIN
                                                              cFunExc.ReembolsarTicket(Rec,0);
                                                            END;
                                                             }
                                                   { ID=1000000005;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Partial refund - Amount;
                                                                ESP=Reembolso parcial &importe];
                                                     OnPush=BEGIN
                                                              cFunExc.ReembolsarTicket(Rec,1);
                                                            END;
                                                             }
                                                   { ID=1000000006;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Partial refund - Persons;
                                                                ESP=Reembolso parcial &personas];
                                                     OnPush=BEGIN
                                                              cFunExc.ReembolsarTicket(Rec,2);
                                                            END;
                                                             }
                                                   { ID=1100253055;
                                                     MenuItemType=Separator }
                                                   { ID=1100253056;
                                                     CaptionML=[ENU=Assign to service;
                                                                ESP=Asignar Servicio];
                                                     OnPush=BEGIN
                                                              cFunExc.Asignar_Servicio(Rec);
                                                            END;
                                                             }
                                                   { ID=1100253057;
                                                     CaptionML=[ENU=Unassign from service;
                                                                ESP=Sacar de servicio];
                                                     OnPush=BEGIN
                                                              cFunExc.Desasigna_reserva(Rec);
                                                            END;
                                                             }
                                                   { ID=1100217011;
                                                     CaptionML=[ENU=Select sales office;
                                                                ESP=Seleccionar oficina ventas];
                                                     OnPush=BEGIN
                                                              cFunExc.SeleccionOficina;
                                                            END;
                                                             }
                                                   { ID=1100217015;
                                                     CaptionML=[ENU=Remove user filter;
                                                                ESP=Quitar filtro usuario];
                                                     OnPush=BEGIN
                                                              cFunExc.QuitarFiltroUsuario(Rec);
                                                              CurrForm.UPDATECONTROLS;
                                                            END;
                                                             }
                                                 }
                                                  }
    { 1100253060;CommandButton;11770;13640;2200;550;
                                                 HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=&Card;
                                                            ESP=&Ficha];
                                                 OnPush=VAR
                                                          lrReserva@1100253000 : Record 7010162;
                                                        BEGIN
                                                          lrReserva.RESET;
                                                          lrReserva.SETRANGE("N§ Reserva", "N§ Reserva");
                                                          FORM.RUNMODAL(7010183, lrReserva);
                                                        END;
                                                         }
    { 1100217012;MenuButton;14190;13640;2310;550;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=&Supplements;
                                                            ESP=&Suplementos];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=1100217013;
                                                     CaptionML=[ENU=Sale;
                                                                ESP=Venta];
                                                     OnPush=VAR
                                                              lrSuplemento@1100217000 : Record 7010165;
                                                            BEGIN
                                                              CLEAR(lrSuplemento);
                                                              lrSuplemento.FILTERGROUP(2);
                                                              lrSuplemento.SETRANGE(Delegacion  , Delegacion);
                                                              lrSuplemento.SETRANGE("N§ Reserva", "N§ Reserva");
                                                              lrSuplemento.FILTERGROUP(0);

                                                              FORM.RUNMODAL(7010188, lrSuplemento);
                                                            END;
                                                             }
                                                   { ID=1100217014;
                                                     CaptionML=[ENU=Purchase;
                                                                ESP=Compra];
                                                     OnPush=VAR
                                                              lrSuplCom@1100217000 : Record 7010180;
                                                            BEGIN
                                                              CLEAR(lrSuplCom);
                                                              lrSuplCom.FILTERGROUP(2);
                                                              lrSuplCom.SETRANGE(Delegacion    , Delegacion);
                                                              lrSuplCom.SETRANGE("Num. Reserva", "N§ Reserva");
                                                              lrSuplCom.FILTERGROUP(0);

                                                              FORM.RUNMODAL(7010222, lrSuplCom);
                                                            END;
                                                             }
                                                 }
                                                  }
    { 1000000000;MenuButton;16720;13640;2200;550;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=&Detail;
                                                            ESP=&Detalle];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=1000000001;
                                                     CaptionML=[ENU=&Payments;
                                                                ESP=&Cobros];
                                                     OnPush=VAR
                                                              lrCobros@1000000000 : Record 7010240;
                                                            BEGIN
                                                              lrCobros.LlamarVentanaCobro(Delegacion, "N§ Reserva");
                                                            END;
                                                             }
                                                   { ID=1000000002;
                                                     MenuItemType=Separator }
                                                   { ID=1000000003;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=&Refunds;
                                                                ESP=&Reembolsos];
                                                     RunObject=Form 7010240;
                                                     RunFormLink=Delegacion=FIELD(Delegacion),
                                                                 Num Reserva=FIELD(N§ Reserva) }
                                                 }
                                                  }
    { 1000000021;CommandButton;6710;13640;2420;550;
                                                 Name=btn_PrintVoucher;
                                                 HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=&Print Voucher;
                                                            ESP=&Imprimir Voucher];
                                                 OnPush=VAR
                                                          lrReserva@1100253000 : Record 7010162;
                                                        BEGIN
                                                          // SE DEBE IMPRIMIR EL VOUCHER Y MARCAR LA RESERVA COMO IMPRESA (campo Voucher printed)
                                                          lrReserva.RESET;
                                                          CurrForm.SETSELECTIONFILTER(lrReserva);

                                                          REPORT.RUNMODAL(7009920, FALSE, FALSE, lrReserva);

                                                          lrReserva.MODIFYALL(lrReserva."Voucher printed", TRUE);
                                                        END;
                                                         }
  }
  CODE
  {
    VAR
      rPar@1100253000 : Record 7009700;
      cFunExc@1100253001 : Codeunit 7010141;
      cNom@1100217000 : Codeunit 7009702;
      vAviso@1000000000 : Text[30];
      vCredito@1000000001 : Boolean;

    PROCEDURE SetCredito@1000000000(pCredito@1000000000 : Boolean);
    BEGIN
      // $021
      vCredito := pCredito;
    END;

    PROCEDURE SetEditables@1000000001();
    BEGIN
      // $021

      CurrForm."N§ Ticket".EDITABLE := NOT vCredito;
      CurrForm."Guia Venta".EDITABLE := vCredito;
      CurrForm.btn_PrintVoucher.VISIBLE := vCredito;
      CurrForm."Booking Touroperador".VISIBLE := vCredito;
      CurrForm."Voucher printed".VISIBLE := vCredito;
    END;

    PROCEDURE NumOperacionTarjeta@1000000002() : Code[20];
    VAR
      lrCobro@1000000000 : Record 7010240;
    BEGIN
      // NumOperacionTarjeta

      IF NOT "Reserva online" THEN
        EXIT;

      lrCobro.RESET;
      lrCobro.SETRANGE(Delegacion   , Delegacion);
      lrCobro.SETRANGE("Num Reserva", "N§ Reserva");
      IF lrCobro.FINDFIRST THEN
        EXIT(lrCobro."Autorizacion operacion");
    END;

    BEGIN
    {
      $001 JPT 29/05/12  CNT-CAR-12004/EXC-15 - Providers confirmations - Color de texto si no est  confirmado el proveedor

      $002 JPT 08/08/12 CNT-OC-12004 Incluir filtro por oficina en las excursiones. Control de Oficina en Excursion

      $003 AJS 22082012 Nueva Accion Confirmacion proveedor, por si la reserva ya tiene servicio asignado

      $004 AJS 10122012 Hacer que el campo Reembolsado no sea editable

      $005 AJS 30012013 Agregar columna usuario creacion y filtro de inicio

      $006 AJS 12062013 Nuevo boton Suplementos, tiene dos opciones Venta y Compra

      $007 AJS 02102013 Hago que el filtro de usuario no pueda quitarse con el boton "Mostrar Todos"

      $008 AJS 02102013 Nueva accion para que puedan quitar el filtro por usuario

      $009 AJS 17102013 Nuevo parametro en la funcion de anular ticket

      $010 AJS 07122013 Nueva columna Nombre hotel, inicialmente columna no visible

      $011 AJS 06022014 Nueva columna Nombre Guia venta, inicialmente columna no visible

      $012 AJS 30052014 Nuevas columnas "Num. Factura", "Fecha Liquidacion GV", "Fecha anulaci¢n/Reembolso",
                        "Fecha Liquidacion reembolso GV", "Num. abono reembolso"

      $013 AJS 26062014 CNT-CAR-14073, Mostrar el campo "Num. Vehiculos"

      $014 AJS 18092014 Mostrar el campo "Canal venta"

      $015 AJS 24092014 Mostrar el campo "Booking Touroperador"

      $016 AJS 29092014 Traducciones

      $017 AJS 04102014 Elimino la funcion Confirmacion proveedor porque ahora existe un formulario de edicion limitada de
                        reservas liquidadas

      $018 ARM 24112014 CNT-OC-14055 Separar invitados de venta y de compra

      $019 AJS 13012015 Agregar columna fecha creacion

      $020 AJS 05022015 Mostrar el aviso de datos faltantes, solo si no esta anulada o reembolsada

      $021 ARM 30032015 CNT-OC-14053 Se a¤ade filtro fijo de si es credito o no

      $022 AJS 24052015 Mostrar el campo "Voucher printed"

      $023 AJS 16062015 Nuevo boton para Imprimir los voucher para las reservas a credito

      $024 AJS 19062015 Reactivo la modificacion de venta a cr‚dito, ticket no editable, guia si editable en las ventas a credito

      $025 AJS 24062015 Ocultar los campos "Voucher printed" y "Booking Touroperador" en las reservas al contado
    }
    END.
  }
}
