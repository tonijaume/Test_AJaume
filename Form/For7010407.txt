OBJECT Form 7010407 Tabla Partes confirmados
{
  OBJECT-PROPERTIES
  {
    Date=06/05/15;
    Time=15:13:31;
    Modified=Yes;
    Version List=TRANSFER;
  }
  PROPERTIES
  {
    Width=25520;
    Height=15180;
    Editable=Yes;
    CaptionML=ESP=Tabla Partes confirmados;
    TableBoxID=1;
    SourceTable=Table7010360;
    UpdateOnActivate=Yes;
    SourceTableView=SORTING(Confirmado,Fecha,Gestor)
                    WHERE(Confirmado=CONST(Yes));
    OnOpenForm=BEGIN

                 // AJF 25/09/08 - Migracion 501
                 // Paso el filtro de garaje del bot¢n del men£ al form.
                 FiltrarGarajeUsuario;

                 IF NOT cFun.FiltraParte(Rec) THEN
                   CurrForm.CLOSE;

                 FILTERGROUP(0);
                 SETRANGE(Confirmado, TRUE);
                 FILTERGROUP(2);

                 FiltroGestor;
               END;

    OnActivateForm=VAR
                     lwTexto@1100244000 : Text[30];
                   BEGIN
                     lwTexto:= GETFILTER(Fecha);
                     IF lwTexto<>'' THEN BEGIN
                       IF EVALUATE(wFecha, lwTexto) THEN
                         ;
                     END
                     ELSE
                       wFecha := 0D;

                     lwTexto := GETFILTER("Tipo Servicio");
                     wTipoServicio := lwTexto;

                     lwTexto := GETFILTER(Cliente);
                     wCliente := lwTexto;
                   END;

  }
  CONTROLS
  {
    { 1   ;TableBox     ;220  ;1870 ;25080;12320;HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Editable=No;
                                                 HeadingHeight=880 }
    { 4   ;TextBox      ;0    ;0    ;2473 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="N§ Parte" }
    { 5   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=4;
                                                 InColumnHeading=Yes }
    { 6   ;TextBox      ;0    ;0    ;2095 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Fecha }
    { 7   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=6;
                                                 InColumnHeading=Yes }
    { 8   ;TextBox      ;0    ;0    ;2064 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Cliente }
    { 9   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=8;
                                                 InColumnHeading=Yes }
    { 41  ;TextBox      ;5424 ;990  ;1731 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Tipo Servicio" }
    { 42  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=41;
                                                 InColumnHeading=Yes }
    { 10  ;TextBox      ;0    ;0    ;2090 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Codigo Servicio" }
    { 11  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=10;
                                                 InColumnHeading=Yes }
    { 1100244000;TextBox;10054;2420 ;1700 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Zona trabajo" }
    { 1100244001;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100244000;
                                                 InColumnHeading=Yes }
    { 1103355005;TextBox;11774;2200 ;1700 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Zona parte" }
    { 1103355006;Label  ;0    ;0    ;0    ;0    ;ParentControl=1103355005;
                                                 InColumnHeading=Yes }
    { 1100244002;TextBox;11754;2420 ;1905 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Touroperador principal" }
    { 1100244003;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100244002;
                                                 InColumnHeading=Yes }
    { 45  ;TextBox      ;8573 ;2310 ;4400 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Touroperadores }
    { 46  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=45;
                                                 InColumnHeading=Yes }
    { 75  ;TextBox      ;14182;2310 ;2151 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Center;
                                                 SourceExpr="N§ Touroperadores" }
    { 76  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=75;
                                                 InColumnHeading=Yes }
    { 12  ;TextBox      ;0    ;0    ;2408 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Origen/Destino" }
    { 13  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=12;
                                                 InColumnHeading=Yes }
    { 14  ;TextBox      ;0    ;0    ;982  ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Hora inicio";
                                                 Format=<Hours24,2>:<Minutes,2> }
    { 15  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=14;
                                                 InColumnHeading=Yes }
    { 16  ;TextBox      ;0    ;0    ;1320 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="N§ Vehiculo" }
    { 17  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=16;
                                                 InColumnHeading=Yes }
    { 20  ;TextBox      ;23866;2200 ;1139 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 CaptionML=ESP=Adultos;
                                                 SourceExpr="Adultos trans. soporte" }
    { 21  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=20;
                                                 InColumnHeading=Yes }
    { 22  ;TextBox      ;26066;2200 ;880  ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 CaptionML=ESP=Ni¤os;
                                                 SourceExpr="Ni¤os trans. soporte" }
    { 23  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=22;
                                                 InColumnHeading=Yes }
    { 1103350000;TextBox;26644;2420 ;1044 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Paxes Previstos" }
    { 1103350001;Label  ;0    ;0    ;0    ;0    ;ParentControl=1103350000;
                                                 InColumnHeading=Yes;
                                                 CaptionML=ESP=Paxes }
    { 18  ;TextBox      ;0    ;0    ;2310 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Conductor }
    { 19  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=18;
                                                 InColumnHeading=Yes }
    { 1100253007;TextBox;20161;10340;2265 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 CaptionML=ESP=Usuario creacion;
                                                 SourceExpr=Usuario }
    { 1100253008;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253007;
                                                 InColumnHeading=Yes }
    { 61  ;TextBox      ;4551 ;2420 ;2310 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Num. Bono Excursiones" }
    { 62  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=61;
                                                 InColumnHeading=Yes }
    { 43  ;CheckBox     ;17965;660  ;1549 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 ShowCaption=No;
                                                 SourceExpr=Facturable }
    { 44  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=43;
                                                 InColumnHeading=Yes }
    { 2   ;TextBox      ;0    ;0    ;2033 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Garaje }
    { 3   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=2;
                                                 InColumnHeading=Yes }
    { 36  ;CheckBox     ;16298;660  ;1489 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 ShowCaption=No;
                                                 SourceExpr="Generada prevision" }
    { 40  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=36;
                                                 InColumnHeading=Yes }
    { 70  ;TextBox      ;22728;2420 ;2080 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Tipo calculo coste" }
    { 71  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=70;
                                                 InColumnHeading=Yes }
    { 72  ;TextBox      ;21378;2530 ;2190 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Ingreso Precios por" }
    { 73  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=72;
                                                 InColumnHeading=Yes }
    { 1103355000;TextBox;44397;2530 ;1700 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Fecha facturacion" }
    { 1103355001;Label  ;0    ;0    ;0    ;0    ;ParentControl=1103355000;
                                                 InColumnHeading=Yes }
    { 1100253000;TextBox;46196;2310 ;1700 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Copias Impresas" }
    { 1100253001;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253000;
                                                 InColumnHeading=Yes }
    { 1100253002;TextBox;47896;2310 ;1700 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Version }
    { 1100253003;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253002;
                                                 InColumnHeading=Yes }
    { 1100244008;TextBox;47255;2420 ;2750 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Referencia }
    { 1100244009;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100244008;
                                                 InColumnHeading=Yes }
    { 1000000002;TextBox;54160;2420 ;2200 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Ingreso DL Prod" }
    { 1000000003;Label  ;0    ;0    ;0    ;0    ;ParentControl=1000000002;
                                                 InColumnHeading=Yes }
    { 1000000000;TextBox;54610;2420 ;2200 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Ingreso DL" }
    { 1000000001;Label  ;0    ;0    ;0    ;0    ;ParentControl=1000000000;
                                                 InColumnHeading=Yes }
    { 1100244012;TextBox;45852;2310 ;4400 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Vuelos }
    { 1100244013;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100244012;
                                                 InColumnHeading=Yes }
    { 1100244014;TextBox;46699;2530 ;2531 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Cod Grupo" }
    { 1100244015;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100244014;
                                                 InColumnHeading=Yes }
    { 1100244004;TextBox;44900;2090 ;4290 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Codigo Barras" }
    { 1100244005;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100244004;
                                                 InColumnHeading=Yes }
    { 1103355008;TextBox;65299;2310 ;2420 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Proveedor }
    { 1103355009;Label  ;0    ;0    ;0    ;0    ;ParentControl=1103355008;
                                                 InColumnHeading=Yes }
    { 1103355010;TextBox;65326;2310 ;8357 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Observaciones }
    { 1103355011;Label  ;0    ;0    ;0    ;0    ;ParentControl=1103355010;
                                                 InColumnHeading=Yes }
    { 29  ;TextBox      ;12409;2420 ;990  ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Hora final";
                                                 Format=<Hours24,2>:<Minutes,2> }
    { 30  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=29;
                                                 InColumnHeading=Yes }
    { 24  ;CommandButton;15840;14410;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Default=Yes;
                                                 PushAction=LookupOK;
                                                 InvalidActionAppearance=Hide }
    { 25  ;CommandButton;18260;14410;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Cancel=Yes;
                                                 PushAction=LookupCancel;
                                                 InvalidActionAppearance=Hide }
    { 26  ;CommandButton;23100;14410;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 31  ;MenuButton   ;20680;14410;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=ESP=&Partes;
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=33;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Ctrl+F5;
                                                     CaptionML=ESP=Ficha;
                                                     RunObject=Form 7010400;
                                                     RunFormOnRec=Yes }
                                                   { ID=34;
                                                     PushAction=RunObject;
                                                     CaptionML=ESP=Zonas precios;
                                                     RunObject=Form 7010409;
                                                     RunFormView=SORTING(N§ Parte);
                                                     RunFormLink=N§ Parte=FIELD(N§ Parte) }
                                                   { ID=35;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Ctrl+T;
                                                     CaptionML=ESP=Touroperadores;
                                                     RunObject=Form 7010410;
                                                     RunFormView=SORTING(N§ Parte,Touroperador);
                                                     RunFormLink=N§ Parte=FIELD(N§ Parte) }
                                                   { ID=37;
                                                     PushAction=RunObject;
                                                     CaptionML=ESP=Consulta Ingresos;
                                                     RunObject=Form 7010519;
                                                     RunFormView=SORTING(N§ Parte,N§ Linea);
                                                     RunFormLink=N§ Parte=FIELD(N§ Parte) }
                                                   { ID=1103355007;
                                                     PushAction=RunObject;
                                                     CaptionML=ESP=Consulta Costes;
                                                     RunObject=Form 7010522;
                                                     RunFormView=SORTING(N§ Parte,N§ Linea);
                                                     RunFormLink=N§ Parte=FIELD(N§ Parte) }
                                                   { ID=27;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Ctrl+H;
                                                     CaptionML=ESP=Historico;
                                                     RunObject=Form 7010403;
                                                     RunFormLink=Tipo Fichero=CONST(Parte),
                                                                 N§=FIELD(N§ Parte) }
                                                   { ID=38;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Ctrl+E;
                                                     CaptionML=ESP=Extras;
                                                     RunObject=Form 7010405;
                                                     RunFormLink=N§ Parte=FIELD(N§ Parte) }
                                                   { ID=66;
                                                     PushAction=RunObject;
                                                     CaptionML=ESP=Mensajes calculo;
                                                     RunObject=Form 7010474;
                                                     RunFormLink=N§ Parte=FIELD(N§ Parte) }
                                                   { ID=1100253005;
                                                     ShortCutKey=Ctrl+N;
                                                     CaptionML=ESP=Anotaciones;
                                                     OnPush=BEGIN
                                                              ShowAnotaciones;
                                                            END;
                                                             }
                                                   { ID=64;
                                                     MenuItemType=Separator;
                                                     CaptionML=ESP="" }
                                                   { ID=1100244007;
                                                     ShortCutKey=Ctrl+Z;
                                                     CaptionML=ESP=Ver PDF del parte;
                                                     OnPush=BEGIN
                                                              VerPDF;
                                                            END;
                                                             }
                                                   { ID=1103350006;
                                                     ShortCutKey=Ctrl+G;
                                                     CaptionML=ESP=Filtro Gestor;
                                                     SourceExpr=wUsaGestor;
                                                     OnPush=BEGIN
                                                              wUsaGestor := NOT wUsaGestor;
                                                              FiltroGestor;
                                                            END;
                                                             }
                                                   { ID=1100244006;
                                                     MenuItemType=Separator }
                                                   { ID=63;
                                                     CaptionML=ESP=Resumen coste-ingreso;
                                                     OnPush=BEGIN
                                                              IF NOT CONFIRM(Text001) THEN
                                                                EXIT;

                                                              cFunBas.CreaTemporalConsulta(Rec);
                                                            END;
                                                             }
                                                   { ID=32;
                                                     MenuItemType=Separator;
                                                     CaptionML=ESP="" }
                                                   { ID=74;
                                                     Visible=No;
                                                     CaptionML=ESP=Contar maletas;
                                                     OnPush=VAR
                                                              lcFunUEX@1100244001 : Codeunit 7035320;
                                                            BEGIN
                                                              lcFunUEX.contar_maletas;
                                                            END;
                                                             }
                                                   { ID=1100244010;
                                                     CaptionML=ESP=Cambiar referencia;
                                                     OnPush=BEGIN
                                                              cFun.ModificaReferenciaParte(Rec);
                                                            END;
                                                             }
                                                   { ID=1100244011;
                                                     CaptionML=ESP=Cambiar vuelos;
                                                     OnPush=BEGIN
                                                              cFun.ModificaVuelosParte(Rec);
                                                            END;
                                                             }
                                                   { ID=28;
                                                     ShortCutKey=Ctrl+F11;
                                                     CaptionML=ESP=Desconfirmar;
                                                     OnPush=BEGIN
                                                              //BRM 25/05/04 A¤adimos ultimo parametro para incluir tratamiento grupos
                                                              cFun.desconfirmar_partes(Rec, TRUE,'',0);
                                                            END;
                                                             }
                                                   { ID=1103350002;
                                                     CaptionML=ESP=Recalcular }
                                                   { ID=1103350003;
                                                     MenuLevel=1;
                                                     CaptionML=ESP=Coste-Ingreso;
                                                     OnPush=BEGIN
                                                              Recalcula(0);
                                                            END;
                                                             }
                                                   { ID=1103350004;
                                                     MenuLevel=1;
                                                     CaptionML=ESP=Solo Ingreso;
                                                     OnPush=BEGIN
                                                              Recalcula(2);
                                                            END;
                                                             }
                                                   { ID=1103350005;
                                                     MenuLevel=1;
                                                     CaptionML=ESP=Solo Coste;
                                                     OnPush=BEGIN
                                                              Recalcula(1);
                                                            END;
                                                             }
                                                   { ID=1103355004;
                                                     CaptionML=ESP=Contar Partes Filtrados;
                                                     OnPush=VAR
                                                              lrParte@1103355000 : Record 7010360;
                                                              wCuentaRecs@1103355003 : Integer;
                                                              wSumAD@1103355002 : Decimal;
                                                              wSumNI@1103355001 : Decimal;
                                                            BEGIN
                                                              wCuentaRecs := 0;
                                                              wSumAD      := 0;
                                                              wSumNI      := 0;

                                                              lrParte.COPY(Rec);
                                                              IF lrParte.FINDSET THEN BEGIN
                                                                wCuentaRecs := COUNT;
                                                                REPEAT
                                                                  lrParte.CALCFIELDS("Adultos transportados", "Ni¤os transportados");
                                                                  wSumAD  += lrParte."Adultos transportados";
                                                                  wSumNI  += lrParte."Ni¤os transportados";
                                                                UNTIL lrParte.NEXT = 0;
                                                              END;

                                                              wVentana.OPEN(Text005);
                                                              wVentana.UPDATE(1, wCuentaRecs);
                                                              wVentana.UPDATE(2, wSumAD);
                                                              wVentana.INPUT(3, wSumNI);
                                                              wVentana.CLOSE;
                                                            END;
                                                             }
                                                   { ID=65;
                                                     MenuItemType=Separator;
                                                     CaptionML=ESP="" }
                                                   { ID=39;
                                                     PushAction=RunObject;
                                                     CaptionML=ESP=Informe de Produccion diaria;
                                                     RunObject=Report 7010326 }
                                                   { ID=1103355002;
                                                     MenuItemType=Separator }
                                                   { ID=1103355003;
                                                     CaptionML=ESP=Exportar a  XML;
                                                     OnPush=BEGIN
                                                              // AJS 18.07.2006 ## DRF 06008
                                                              // Nueva funcion para exportar los partes filtrados

                                                              cFun.ExportacionProvXML(0, wTipoExportacion::Confirmados, Rec);
                                                            END;
                                                             }
                                                 }
                                                  }
    { 53  ;TabControl   ;220  ;220  ;25080;1430 ;HorzGlue=Both;
                                                 PageNamesML=ESP=Filtros }
    { 48  ;TextBox      ;19470;990  ;2750 ;440  ;ParentControl=53;
                                                 InPage=0;
                                                 AutoEnter=Yes;
                                                 DrillDown=No;
                                                 ClearOnLookup=No;
                                                 SourceExpr=wTipoServicio;
                                                 TableRelation="Tipo Servicio".Codigo;
                                                 OnValidate=BEGIN
                                                              IF wTipoServicio <> '' THEN
                                                                SETFILTER("Tipo Servicio", wTipoServicio)
                                                              ELSE
                                                                SETRANGE("Tipo Servicio");
                                                            END;

                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 47  ;Label        ;16060;990  ;3300 ;440  ;ParentControl=48;
                                                 CaptionML=ESP=Tipo Servicio }
    { 49  ;TextBox      ;7920 ;990  ;2750 ;440  ;ParentControl=53;
                                                 InPage=0;
                                                 SourceExpr=wCliente;
                                                 TableRelation=Customer;
                                                 OnValidate=BEGIN
                                                              IF wCliente<>'' THEN
                                                              SETFILTER(Cliente,wCliente)
                                                              ELSE
                                                              SETRANGE(Cliente);
                                                            END;

                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 50  ;Label        ;4510 ;990  ;3300 ;440  ;ParentControl=49;
                                                 CaptionML=ESP=Cliente }
    { 51  ;CommandButton;440  ;990  ;660  ;440  ;ParentControl=53;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 HorzAlign=General;
                                                 BackTransparent=Yes;
                                                 Bitmap=15;
                                                 OnPush=VAR
                                                          cFunBas@1100244001 : Codeunit 7010310;
                                                          lwAuxFecha@1100244002 : Date;
                                                        BEGIN
                                                          IF wFecha = 0D THEN
                                                            primeraFecha
                                                          ELSE BEGIN
                                                            lwAuxFecha:=cFunBas.fdom(wFecha,0);
                                                            IF lwAuxFecha = wFecha THEN
                                                              wFecha:=cFunBas.fdom(wFecha,-1)
                                                            ELSE
                                                              wFecha := lwAuxFecha;
                                                          END;
                                                          Cambiafecha(wFecha);
                                                          CurrForm.UPDATE;
                                                        END;
                                                         }
    { 52  ;CommandButton;1100 ;990  ;440  ;440  ;ParentControl=53;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 HorzAlign=General;
                                                 BitmapPos=Right;
                                                 Bitmap=15;
                                                 OnPush=BEGIN
                                                          IF wFecha =0D THEN
                                                            primeraFecha
                                                          ELSE
                                                            wFecha := wFecha - 1;
                                                          Cambiafecha(wFecha);
                                                          CurrForm.UPDATE;
                                                        END;
                                                         }
    { 56  ;TextBox      ;1540 ;990  ;1650 ;440  ;Name=FilFecha;
                                                 ParentControl=53;
                                                 InPage=0;
                                                 BackColor=16777215;
                                                 FontName=Helvetica;
                                                 FontSize=8;
                                                 SourceExpr=wFecha;
                                                 OnValidate=BEGIN
                                                               Cambiafecha(wFecha);
                                                            END;

                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 57  ;CommandButton;3190 ;990  ;440  ;440  ;ParentControl=53;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 HorzAlign=General;
                                                 Bitmap=16;
                                                 OnPush=BEGIN
                                                          IF wFecha = 0D THEN
                                                            primeraFecha
                                                          ELSE
                                                            wFecha := wFecha + 1;
                                                          Cambiafecha(wFecha);
                                                          CurrForm.UPDATE;
                                                        END;
                                                         }
    { 58  ;CommandButton;3630 ;990  ;660  ;440  ;ParentControl=53;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 HorzAlign=General;
                                                 BackTransparent=Yes;
                                                 BitmapPos=Right;
                                                 Bitmap=16;
                                                 OnPush=VAR
                                                          cFunBas@1100244001 : Codeunit 7010310;
                                                          lwAuxFecha@1100244002 : Date;
                                                        BEGIN
                                                          IF wFecha = 0D THEN
                                                            primeraFecha
                                                          ELSE BEGIN
                                                            lwAuxFecha:=cFunBas.ldom(wFecha,0);
                                                            IF lwAuxFecha = wFecha THEN
                                                              wFecha:=cFunBas.ldom(wFecha,1)
                                                            ELSE
                                                              wFecha := lwAuxFecha;
                                                          END;

                                                          Cambiafecha(wFecha);
                                                          CurrForm.UPDATE;
                                                        END;
                                                         }
    { 69  ;TextBox      ;10780;990  ;5060 ;440  ;Editable=No;
                                                 Focusable=No;
                                                 ParentControl=53;
                                                 InPage=0;
                                                 SourceExpr=nombre_cliente;
                                                 TableRelation=Customer;
                                                 OnValidate=BEGIN
                                                              IF wCliente <> '' THEN
                                                                SETFILTER(Cliente, wCliente)
                                                              ELSE
                                                                SETRANGE(Cliente);
                                                            END;

                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 1100253004;TextBox;12980;14410;2640 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 ForeColor=8388608;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 FontSize=9;
                                                 FontBold=Yes;
                                                 SourceExpr="Tiene Anotaciones";
                                                 OnFormat=VAR
                                                            lText00001@1100253001 : TextConst 'ESP=Anotaciones';
                                                          BEGIN
                                                            CALCFIELDS("Tiene Anotaciones");
                                                            IF "Tiene Anotaciones" THEN
                                                              Text:=lText00001
                                                            ELSE
                                                              CLEAR(Text);
                                                          END;
                                                           }
    { 1100253006;CommandButton;12980;14410;2640;550;
                                                 HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 ShowCaption=No;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=ESP='';
                                                 OnPush=BEGIN
                                                          IF "Tiene Anotaciones" THEN
                                                            ShowAnotaciones;
                                                        END;
                                                         }
  }
  CODE
  {
    VAR
      Text000@1100244006 : TextConst 'ESP=N/D';
      rPar@1100244007 : Record 7010311;
      cFun@1100244000 : Codeunit 7010318;
      cFunBas@1100244001 : Codeunit 7010310;
      wTipoServicio@1100244002 : Code[10];
      wCliente@1100244003 : Code[20];
      wFecha@1100244004 : Date;
      Text001@1100244005 : TextConst 'ESP=Se va a crear la consulta con los partes filtrados en la ventana.';
      wNombreFichero@1100244008 : Text[250];
      Text002@1103350000 : TextConst 'ESP=No se encuentra el archivo %1';
      Text003@1103350001 : TextConst 'ESP=¨Seguro que quieres recalcular %1 del Parte?';
      Text004@1103350002 : TextConst 'ESP=Proceso Terminado';
      wUsaGestor@1103350003 : Boolean;
      wTipoExportacion@1103355000 : 'Proveedor,Confirmados';
      wVentana@1103355001 : Dialog;
      Text005@1103355002 : TextConst 'ESP=CUENTA DE PARTES FILTRADOS #1########\ADULTOS #2######\NI¥OS   #3######';

    PROCEDURE Cambiafecha@1(VAR pwFecha@1100244000 : Date);
    BEGIN
      // Cambiafecha
      //
      IF wFecha <> 0D THEN
        SETRANGE(Fecha, pwFecha)
      ELSE
        SETRANGE(Fecha);
    END;

    PROCEDURE primeraFecha@2();
    BEGIN
      // primerafecha
      // SI NO HAY FECHA SE LE ASIGNA UNA

      IF wFecha = 0D THEN BEGIN
        IF Fecha <> 0D THEN
          wFecha := Fecha
          ELSE
            wFecha := TODAY;
      END;
    END;

    PROCEDURE nombre_cliente@3() : Text[50];
    VAR
      lrCli@1100244000 : Record 18;
    BEGIN
      // nombre_cliente
      //
      IF NOT lrCli.GET(wCliente) THEN
        EXIT('')
      ELSE
        EXIT(lrCli.Name);
    END;

    PROCEDURE Recalcula@1103350001(pwModo@1103350000 : 'Coste-Ingreso,Solo Coste,Solo Ingreso');
    VAR
      lrParte@1103350001 : Record 7010360;
    BEGIN
      // Recalcula
      // Vuelve a calcular el parte confirmado

      lrParte.COPY(Rec);

      IF NOT CONFIRM(Text003,FALSE,pwModo) THEN
        EXIT;

      IF cFun.desconfirmar_partes(lrParte,FALSE,'',pwModo+1) THEN BEGIN
        cFun.confirmar_partes(lrParte,FALSE,'',pwModo+1);
        MESSAGE(Text004);
      END;
    END;

    PROCEDURE FiltroGestor@1103350000();
    BEGIN
      // FiltroGestor
      // Define el comportamiento del fintro del campo Gestor en Virtud de la variable

      FILTERGROUP(2);
      IF wUsaGestor THEN
        SETFILTER(Gestor,'%1|%2',USERID,'')
      ELSE
        SETRANGE(Gestor);
      FILTERGROUP(0);
    END;

    BEGIN
    {
      $001 AJS 11102013 Modifico la funcion nombre_cliente para que retorne Text(50)

        .- Mostrar el campo Observaciones, peticion Transunion
    }
    END.
  }
}
