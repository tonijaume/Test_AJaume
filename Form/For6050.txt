OBJECT Form 6050 Service Contract
{
  OBJECT-PROPERTIES
  {
    Date=14/08/09;
    Time=12:00:00;
    Version List=NAVW16.00.01,NAVES6.00;
  }
  PROPERTIES
  {
    Width=16500;
    Height=12540;
    CaptionML=[ENU=Service Contract;
               ESP=Contrato servicio];
    SourceTable=Table5965;
    UpdateOnActivate=Yes;
    SourceTableView=WHERE(Contract Type=FILTER(Contract));
    OnOpenForm=BEGIN
                 IF UserMgt.GetServiceFilter() <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETRANGE("Responsibility Center",UserMgt.GetServiceFilter());
                   FILTERGROUP(0);
                 END;

                 ActivateFields;
               END;

    OnAfterGetRecord=BEGIN
                       UpdateShiptoCode;
                     END;

    OnAfterGetCurrRecord=BEGIN
                           CALCFIELDS("Calcd. Annual Amount","No. of Posted Invoices","No. of Unposted Invoices");
                           ActivateFields;
                           CurrForm.UPDATECONTROLS;
                         END;

    OnNewRecord=BEGIN
                  "Responsibility Center" := UserMgt.GetServiceFilter();
                END;

  }
  CONTROLS
  {
    { 1   ;TabControl   ;220  ;220  ;16060;7810 ;HorzGlue=Both;
                                                 VertGlue=Top;
                                                 PageNamesML=[ENU=General,Invoicing,Shipping,Service,Invoice Details,Price Update,Details;
                                                              ESP=General,Facturaci¢n,Env¡o,Servicio,Detalles fact.,Actualiz. precio,Detalles] }
    { 2   ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Contract No.";
                                                 OnAssistEdit=BEGIN
                                                                IF AssistEdit(xRec) THEN
                                                                  CurrForm.UPDATE;
                                                              END;

                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 3   ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=2 }
    { 4   ;TextBox      ;12980;2200 ;1650 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Starting Date";
                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 5   ;Label        ;9570 ;2200 ;3300 ;440  ;ParentControl=4 }
    { 26  ;TextBox      ;12980;2750 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr=Status;
                                                 OnValidate=BEGIN
                                                              ActivateFields;
                                                            END;

                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 27  ;Label        ;9570 ;2750 ;3300 ;440  ;ParentControl=26 }
    { 48  ;TextBox      ;3850 ;1650 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr=Description }
    { 49  ;Label        ;440  ;1650 ;3300 ;440  ;ParentControl=48 }
    { 42  ;TextBox      ;3850 ;3410 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 DrillDown=No;
                                                 SourceExpr=Name }
    { 43  ;Label        ;440  ;3410 ;3300 ;440  ;ParentControl=42 }
    { 91  ;TextBox      ;3850 ;2310 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Customer No.";
                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 92  ;Label        ;440  ;2310 ;3300 ;440  ;ParentControl=91 }
    { 32  ;TextBox      ;3850 ;3960 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 DrillDown=No;
                                                 SourceExpr=Address }
    { 33  ;Label        ;440  ;3960 ;3300 ;440  ;ParentControl=32 }
    { 120 ;TextBox      ;3850 ;4510 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 DrillDown=No;
                                                 SourceExpr="Address 2" }
    { 121 ;Label        ;440  ;4510 ;3300 ;440  ;ParentControl=120 }
    { 34  ;PictureBox   ;6710 ;990  ;440  ;440  ;Focusable=No;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 Border=No;
                                                 BitmapPos=Center;
                                                 BitmapList=7,6;
                                                 SourceExpr=Comment }
    { 37  ;CommandButton;6710 ;990  ;440  ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 BackTransparent=Yes;
                                                 PushAction=RunObject;
                                                 ToolTipML=[ENU=Comment;
                                                            ESP=Comentario];
                                                 RunObject=Form 5911;
                                                 RunFormLinkType=OnUpdate;
                                                 RunFormLink=Table Name=CONST(Service Contract),
                                                             Table Subtype=FIELD(Contract Type),
                                                             No.=FIELD(Contract No.),
                                                             Table Line No.=FILTER(0) }
    { 30  ;TextBox      ;12980;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Salesperson Code" }
    { 31  ;Label        ;9570 ;1540 ;3300 ;440  ;ParentControl=30 }
    { 158 ;TextBox      ;12980;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Contract Group Code" }
    { 159 ;Label        ;9570 ;990  ;3300 ;440  ;ParentControl=158 }
    { 114 ;TextBox      ;3850 ;6270 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 DrillDown=No;
                                                 SourceExpr="Contact Name" }
    { 115 ;Label        ;440  ;6270 ;3300 ;440  ;ParentControl=114 }
    { 50  ;TextBox      ;3850 ;5060 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 DrillDown=No;
                                                 NextControl=126;
                                                 SourceExpr="Post Code" }
    { 51  ;Label        ;440  ;5060 ;3300 ;440  ;ParentControl=50;
                                                 CaptionML=[ENU=Post Code/City;
                                                            ESP=C.P.+Poblaci¢n] }
    { 126 ;TextBox      ;6710 ;5060 ;2640 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 DrillDown=No;
                                                 NextControl=114;
                                                 SourceExpr=City }
    { 23  ;TextBox      ;12980;3300 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Responsibility Center" }
    { 62  ;Label        ;9570 ;3300 ;3300 ;440  ;ParentControl=23 }
    { 6   ;TextBox      ;3850 ;6820 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Phone No." }
    { 7   ;Label        ;440  ;6820 ;3300 ;440  ;ParentControl=6 }
    { 67  ;TextBox      ;3850 ;7370 ;4950 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="E-Mail" }
    { 68  ;Label        ;440  ;7370 ;3300 ;440  ;ParentControl=67 }
    { 35  ;CommandButton;6710 ;6820 ;440  ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 Bitmap=34;
                                                 ToolTipML=[ENU=Make Phone Call;
                                                            ESP=Realizar llamada];
                                                 OnPush=VAR
                                                          TAPIManagement@1001 : Codeunit 5053;
                                                        BEGIN
                                                          TAPIManagement.DialContCustVendBank(DATABASE::Customer,"Customer No.","Phone No.",'');
                                                        END;
                                                         }
    { 78  ;CommandButton;8910 ;7370 ;440  ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 Bitmap=21;
                                                 ToolTipML=[ENU=New Mail Message;
                                                            ESP=Nuevo mensaje correo];
                                                 OnPush=VAR
                                                          Mail@1001 : Codeunit 397;
                                                        BEGIN
                                                          Mail.MailContCustVendBank(DATABASE::Customer,"Customer No.","E-Mail");
                                                        END;
                                                         }
    { 63  ;TextBox      ;12980;3850 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Change Status" }
    { 64  ;Label        ;9570 ;3850 ;3300 ;440  ;ParentControl=63 }
    { 80  ;TextBox      ;3850 ;2860 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Contact No." }
    { 81  ;Label        ;440  ;2860 ;3300 ;440  ;ParentControl=80 }
    { 1100000;TextBox   ;3850 ;5610 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr=County }
    { 1100001;Label     ;440  ;5610 ;3300 ;440  ;ParentControl=1100000;
                                                 InPage=0 }
    { 52  ;TextBox      ;12980;2640 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Payment Terms Code" }
    { 100 ;Label        ;9570 ;2640 ;3300 ;440  ;ParentControl=52 }
    { 53  ;TextBox      ;12980;3190 ;1650 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Currency Code" }
    { 101 ;Label        ;9570 ;3190 ;3300 ;440  ;ParentControl=53 }
    { 84  ;TextBox      ;12980;2090 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Shortcut Dimension 2 Code" }
    { 104 ;Label        ;9570 ;2090 ;3300 ;440  ;ParentControl=84 }
    { 85  ;TextBox      ;12980;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Shortcut Dimension 1 Code" }
    { 102 ;Label        ;9570 ;1540 ;3300 ;440  ;ParentControl=85 }
    { 118 ;TextBox      ;12980;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Serv. Contract Acc. Gr. Code" }
    { 119 ;Label        ;9570 ;990  ;3300 ;440  ;ParentControl=118 }
    { 122 ;TextBox      ;3850 ;2090 ;5500 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 DrillDown=No;
                                                 SourceExpr="Bill-to Name" }
    { 142 ;Label        ;440  ;2090 ;3300 ;440  ;ParentControl=122 }
    { 123 ;TextBox      ;3850 ;2640 ;5500 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 DrillDown=No;
                                                 SourceExpr="Bill-to Address" }
    { 143 ;Label        ;440  ;2640 ;3300 ;440  ;ParentControl=123 }
    { 130 ;TextBox      ;3850 ;3190 ;5500 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 DrillDown=No;
                                                 SourceExpr="Bill-to Address 2" }
    { 160 ;Label        ;440  ;3190 ;3300 ;440  ;ParentControl=130 }
    { 131 ;TextBox      ;6710 ;3740 ;2640 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 DrillDown=No;
                                                 NextControl=183;
                                                 SourceExpr="Bill-to City" }
    { 132 ;TextBox      ;3850 ;5500 ;5500 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Your Reference" }
    { 172 ;Label        ;440  ;5500 ;3300 ;440  ;ParentControl=132 }
    { 133 ;TextBox      ;3850 ;4290 ;5500 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Bill-to Contact" }
    { 176 ;Label        ;440  ;4290 ;3300 ;440  ;ParentControl=133 }
    { 138 ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Bill-to Customer No.";
                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 170 ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=138 }
    { 139 ;TextBox      ;3850 ;3740 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 DrillDown=No;
                                                 NextControl=180;
                                                 SourceExpr="Bill-to Post Code" }
    { 171 ;Label        ;440  ;3740 ;3300 ;440  ;ParentControl=139;
                                                 CaptionML=[ENU=Bill-to Post Code/City;
                                                            ESP=Fact. a-C.P.+Poblaci¢n] }
    { 140 ;TextBox      ;3850 ;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Bill-to Contact No." }
    { 175 ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=140 }
    { 1100002;TextBox   ;3850 ;4840 ;5500 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Bill-to County" }
    { 1100003;Label     ;440  ;4840 ;3300 ;440  ;ParentControl=1100002 }
    { 127 ;TextBox      ;6710 ;3190 ;2640 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 DrillDown=No;
                                                 SourceExpr="Ship-to City" }
    { 166 ;TextBox      ;3850 ;2640 ;5500 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 DrillDown=No;
                                                 SourceExpr="Ship-to Address 2" }
    { 167 ;Label        ;440  ;2640 ;3300 ;440  ;ParentControl=166 }
    { 128 ;TextBox      ;3850 ;3190 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 DrillDown=No;
                                                 NextControl=127;
                                                 SourceExpr="Ship-to Post Code" }
    { 129 ;Label        ;440  ;3190 ;3300 ;440  ;ParentControl=128;
                                                 CaptionML=[ENU=Ship-to Post Code/City;
                                                            ESP=Env¡o a-C.P.+Poblaci¢n] }
    { 164 ;TextBox      ;3850 ;2090 ;5500 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 DrillDown=No;
                                                 SourceExpr="Ship-to Address" }
    { 165 ;Label        ;440  ;2090 ;3300 ;440  ;ParentControl=164 }
    { 162 ;TextBox      ;3850 ;1540 ;5500 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 DrillDown=No;
                                                 SourceExpr="Ship-to Name" }
    { 163 ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=162 }
    { 44  ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Ship-to Code";
                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 45  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=44 }
    { 1100004;TextBox   ;3850 ;3740 ;5500 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Ship-to County" }
    { 1100005;Label     ;440  ;3740 ;3300 ;440  ;ParentControl=1100004 }
    { 180 ;TextBox      ;3850 ;3190 ;2750 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Service Order Type" }
    { 185 ;Label        ;440  ;3190 ;3300 ;440  ;ParentControl=180 }
    { 181 ;TextBox      ;3850 ;2640 ;2750 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Response Time (Hours)";
                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE(TRUE);
                                                                 END;
                                                                  }
    { 182 ;Label        ;440  ;2640 ;3300 ;440  ;ParentControl=181 }
    { 183 ;TextBox      ;3850 ;2090 ;1650 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="First Service Date" }
    { 184 ;Label        ;440  ;2090 ;3300 ;440  ;ParentControl=183 }
    { 186 ;TextBox      ;3850 ;1540 ;1650 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Service Period";
                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 187 ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=186 }
    { 188 ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Service Zone Code" }
    { 189 ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=188 }
    { 8   ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="Annual Amount";
                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 9   ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=8 }
    { 107 ;TextBox      ;3850 ;2750 ;2750 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="Invoice Period" }
    { 108 ;Label        ;440  ;2750 ;3300 ;440  ;ParentControl=107 }
    { 16  ;TextBox      ;3850 ;3300 ;1650 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="Next Invoice Date" }
    { 17  ;Label        ;440  ;3300 ;3300 ;440  ;ParentControl=16 }
    { 12  ;TextBox      ;3850 ;3850 ;2750 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="Amount per Period" }
    { 13  ;Label        ;440  ;3850 ;3300 ;440  ;ParentControl=12 }
    { 18  ;TextBox      ;3850 ;4400 ;2750 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 CaptionML=[ENU=Next Invoice Period;
                                                            ESP=Siguiente periodo factura];
                                                 SourceExpr=NextInvoicePeriod }
    { 19  ;Label        ;440  ;4400 ;3300 ;440  ;ParentControl=18 }
    { 134 ;TextBox      ;3850 ;4950 ;1650 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="Last Invoice Date" }
    { 135 ;Label        ;440  ;4950 ;3300 ;440  ;ParentControl=134 }
    { 151 ;CheckBox     ;12980;1540 ;440  ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 ShowCaption=No;
                                                 SourceExpr="Contract Lines on Invoice" }
    { 152 ;Label        ;9570 ;1540 ;3300 ;440  ;ParentControl=151 }
    { 173 ;CheckBox     ;3850 ;6600 ;440  ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 ShowCaption=No;
                                                 SourceExpr="Invoice after Service";
                                                 OnAfterValidate=BEGIN
                                                                   ActivateFields;
                                                                 END;
                                                                  }
    { 174 ;Label        ;440  ;6600 ;3300 ;440  ;ParentControl=173 }
    { 105 ;CheckBox     ;12980;990  ;440  ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 ShowCaption=No;
                                                 SourceExpr="Combine Invoices" }
    { 106 ;Label        ;9570 ;990  ;3300 ;440  ;ParentControl=105 }
    { 10  ;TextBox      ;12980;2090 ;1650 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="No. of Unposted Invoices" }
    { 11  ;Label        ;9570 ;2090 ;3300 ;440  ;ParentControl=10 }
    { 113 ;TextBox      ;12980;2640 ;1650 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="No. of Unposted Credit Memos" }
    { 117 ;Label        ;9570 ;2640 ;3300 ;440  ;ParentControl=113 }
    { 46  ;TextBox      ;12980;3190 ;1650 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="No. of Posted Invoices" }
    { 47  ;Label        ;9570 ;3190 ;3300 ;440  ;ParentControl=46 }
    { 146 ;TextBox      ;12980;3740 ;1650 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="No. of Posted Credit Memos" }
    { 177 ;Label        ;9570 ;3740 ;3300 ;440  ;ParentControl=146 }
    { 153 ;CheckBox     ;3850 ;1540 ;440  ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 ShowCaption=No;
                                                 SourceExpr="Allow Unbalanced Amounts";
                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 154 ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=153 }
    { 79  ;CheckBox     ;3850 ;6050 ;440  ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 ShowCaption=No;
                                                 SourceExpr="Automatic Credit Memos" }
    { 86  ;Label        ;440  ;6050 ;3300 ;440  ;ParentControl=79 }
    { 54  ;CheckBox     ;3850 ;5500 ;440  ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 ShowCaption=No;
                                                 SourceExpr=Prepaid;
                                                 OnAfterValidate=BEGIN
                                                                   ActivateFields;
                                                                 END;
                                                                  }
    { 55  ;Label        ;440  ;5500 ;3300 ;440  ;ParentControl=54 }
    { 25  ;TextBox      ;3850 ;2090 ;2750 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="Calcd. Annual Amount" }
    { 28  ;Label        ;440  ;2090 ;3300 ;440  ;ParentControl=25 }
    { 56  ;TextBox      ;3850 ;3740 ;2750 ;440  ;ParentControl=1;
                                                 InPage=5;
                                                 SourceExpr="Price Inv. Increase Code" }
    { 148 ;Label        ;440  ;3740 ;3300 ;440  ;ParentControl=56 }
    { 57  ;TextBox      ;3850 ;2640 ;1650 ;440  ;ParentControl=1;
                                                 InPage=5;
                                                 SourceExpr="Last Price Update Date" }
    { 141 ;Label        ;440  ;2640 ;3300 ;440  ;ParentControl=57 }
    { 58  ;TextBox      ;3850 ;2090 ;2750 ;440  ;ParentControl=1;
                                                 InPage=5;
                                                 SourceExpr="Last Price Update %" }
    { 61  ;Label        ;440  ;2090 ;3300 ;440  ;ParentControl=58 }
    { 59  ;CheckBox     ;3850 ;3190 ;440  ;440  ;ParentControl=1;
                                                 InPage=5;
                                                 ShowCaption=No;
                                                 SourceExpr="Print Increase Text" }
    { 147 ;Label        ;440  ;3190 ;3300 ;440  ;ParentControl=59 }
    { 60  ;TextBox      ;3850 ;1540 ;1650 ;440  ;ParentControl=1;
                                                 InPage=5;
                                                 SourceExpr="Next Price Update Date" }
    { 144 ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=60 }
    { 155 ;TextBox      ;3850 ;990  ;1650 ;440  ;ParentControl=1;
                                                 InPage=5;
                                                 SourceExpr="Price Update Period" }
    { 156 ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=155 }
    { 168 ;TextBox      ;3850 ;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=6;
                                                 SourceExpr="Cancel Reason Code" }
    { 179 ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=168 }
    { 40  ;TextBox      ;3850 ;990  ;1650 ;440  ;ParentControl=1;
                                                 InPage=6;
                                                 SourceExpr="Expiration Date";
                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 41  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=40 }
    { 14  ;TextBox      ;3850 ;2090 ;2750 ;440  ;ParentControl=1;
                                                 InPage=6;
                                                 SourceExpr="Max. Labor Unit Price" }
    { 15  ;Label        ;440  ;2090 ;3300 ;440  ;ParentControl=14 }
    { 90  ;CommandButton;14080;11770;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 94  ;MenuButton   ;4400 ;11770;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 HorzAlign=Center;
                                                 VertAlign=Center;
                                                 CaptionML=[ENU=&Contract;
                                                            ESP=&Contrato];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=95;
                                                     PushAction=LookupTable;
                                                     ShortCutKey=F5;
                                                     CaptionML=[ENU=&List;
                                                                ESP=&Lista] }
                                                   { ID=69;
                                                     PushAction=RunObject;
                                                     ShortCutKey=May£s+Ctrl+D;
                                                     CaptionML=[ENU=Dimensions;
                                                                ESP=Dimensiones];
                                                     RunObject=Form 581;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Table ID=CONST(5965),
                                                                 Type=FIELD(Contract Type),
                                                                 No.=FIELD(Contract No.),
                                                                 Line No.=CONST(0) }
                                                   { ID=65;
                                                     MenuItemType=Separator;
                                                     CaptionML=[ENU="";
                                                                ESP=""] }
                                                   { ID=96;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Ctrl+F5;
                                                     CaptionML=[ENU=Service Ledger E&ntries;
                                                                ESP=Movs. &servicio];
                                                     RunObject=Form 5912;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Service Contract No.);
                                                     RunFormLink=Service Contract No.=FIELD(Contract No.) }
                                                   { ID=149;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=&Warranty Ledger Entries;
                                                                ESP=Movs. &garant¡a];
                                                     RunObject=Form 5913;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Service Contract No.,Posting Date,Document No.);
                                                     RunFormLink=Service Contract No.=FIELD(Contract No.) }
                                                   { ID=36;
                                                     MenuItemType=Separator }
                                                   { ID=22;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=Service Dis&counts;
                                                                ESP=Descuentos ser&vicio];
                                                     RunObject=Form 6058;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Contract Type=FIELD(Contract Type),
                                                                 Contract No.=FIELD(Contract No.) }
                                                   { ID=136;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=Service &Hours;
                                                                ESP=&Horas servicio];
                                                     RunObject=Form 5916;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Service Contract No.=FIELD(Contract No.),
                                                                 Service Contract Type=FILTER(Contract) }
                                                   { ID=66;
                                                     MenuItemType=Separator;
                                                     CaptionML=[ENU="";
                                                                ESP=""] }
                                                   { ID=99;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=Co&mments;
                                                                ESP=C&omentarios];
                                                     RunObject=Form 5911;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Table Name=CONST(Service Contract),
                                                                 Table Subtype=FIELD(Contract Type),
                                                                 No.=FIELD(Contract No.),
                                                                 Table Line No.=CONST(0) }
                                                   { ID=82;
                                                     MenuItemType=Separator;
                                                     CaptionML=[ENU="";
                                                                ESP=""] }
                                                   { ID=21;
                                                     CaptionML=[ENU=Statistics;
                                                                ESP=Estad¡sticas] }
                                                   { ID=178;
                                                     PushAction=RunObject;
                                                     ShortCutKey=F9;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Statistics;
                                                                ESP=Estad¡sticas];
                                                     RunObject=Form 6059;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Contract Type=CONST(Contract),
                                                                 Contract No.=FIELD(Contract No.) }
                                                   { ID=97;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Tr&endscape;
                                                                ESP=Tr&endscape];
                                                     RunObject=Form 6060;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Contract Type=CONST(Contract),
                                                                 Contract No.=FIELD(Contract No.) }
                                                   { ID=24;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Bar Chart;
                                                                ESP=Gr fico de barras];
                                                     OnPush=VAR
                                                              ServLedgEntriesBarChart@1000 : Form 6085;
                                                            BEGIN
                                                              ServLedgEntriesBarChart.SetContractFilter("Contract No.");
                                                              ServLedgEntriesBarChart.RUN;
                                                            END;
                                                             }
                                                   { ID=98;
                                                     MenuItemType=Separator }
                                                   { ID=145;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=Filed Contracts;
                                                                ESP=Contratos archivados];
                                                     RunObject=Form 6073;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Contract Type Relation,Contract No. Relation,File Date,File Time)
                                                                 ORDER(Descending);
                                                     RunFormLink=Contract Type Relation=FIELD(Contract Type),
                                                                 Contract No. Relation=FIELD(Contract No.) }
                                                   { ID=161;
                                                     CaptionML=[ENU=Ser&vice Overview;
                                                                ESP=&Resumen servicio] }
                                                   { ID=87;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Service Orders;
                                                                ESP=Pedidos servicio];
                                                     RunObject=Form 5901;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Contract No.);
                                                     RunFormLink=Document Type=CONST(Order),
                                                                 Contract No.=FIELD(Contract No.) }
                                                   { ID=88;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Posted Service Shipments;
                                                                ESP=Env¡os servicios registrados];
                                                     RunFormLinkType=OnUpdate;
                                                     OnPush=VAR
                                                              TempServShptHeader@1001 : TEMPORARY Record 5990;
                                                            BEGIN
                                                              CollectShpmntsByLineContractNo(TempServShptHeader);
                                                              FORM.RUNMODAL(FORM::"Posted Service Shipments",TempServShptHeader);
                                                            END;
                                                             }
                                                   { ID=29;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Posted Service Invoices;
                                                                ESP=Facts. ventas (servicio) regis.];
                                                     RunObject=Form 5968;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Source Document Type,Source Document No.,Destination Document Type,Destination Document No.)
                                                                 WHERE(Source Document Type=CONST(Contract),
                                                                       Destination Document Type=CONST(Posted Invoice));
                                                     RunFormLink=Source Document No.=FIELD(Contract No.) }
                                                   { ID=116;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=C&hange Log;
                                                                ESP=&Log cambio];
                                                     RunObject=Form 6063;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Contract No.)
                                                                 ORDER(Descending);
                                                     RunFormLink=Contract No.=FIELD(Contract No.) }
                                                   { ID=194;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=&Gain/Loss Entries;
                                                                ESP=Movs. &p‚rd./ganancias];
                                                     RunObject=Form 6064;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormView=SORTING(Contract No.,Change Date)
                                                                 ORDER(Descending);
                                                     RunFormLink=Contract No.=FIELD(Contract No.) }
                                                 }
                                                  }
    { 137 ;MenuButton   ;9240 ;11770;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 HorzAlign=Center;
                                                 VertAlign=Center;
                                                 CaptionML=[ENU=F&unctions;
                                                            ESP=Acci&ones];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=75;
                                                     CaptionML=[ENU=&Select Contract Lines;
                                                                ESP=&Seleccionar l¡ns. contrato];
                                                     OnPush=BEGIN
                                                              CheckRequiredFields;
                                                              GetServItemLine;
                                                            END;
                                                             }
                                                   { ID=77;
                                                     CaptionML=[ENU=&Remove Contract Lines;
                                                                ESP=&Eliminar l¡ns. contrato];
                                                     OnPush=BEGIN
                                                              ServContractLine.RESET;
                                                              ServContractLine.SETRANGE("Contract Type","Contract Type");
                                                              ServContractLine.SETRANGE("Contract No.","Contract No.");
                                                              REPORT.RUNMODAL(REPORT::"Remove Lines from Contract",TRUE,TRUE,ServContractLine);
                                                              CurrForm.UPDATE;
                                                            END;
                                                             }
                                                   { ID=20;
                                                     CaptionML=[ENU=Copy &Document...;
                                                                ESP=Copiar &documento...];
                                                     OnPush=BEGIN
                                                              CheckRequiredFields;
                                                              CLEAR(CopyServDoc);
                                                              CopyServDoc.SetServContractHeader(Rec);
                                                              CopyServDoc.RUNMODAL;
                                                            END;
                                                             }
                                                   { ID=89;
                                                     MenuItemType=Separator }
                                                   { ID=76;
                                                     CaptionML=[ENU=Si&gn Contract;
                                                                ESP=Firmar con&trato];
                                                     OnPush=VAR
                                                              SignServContractDoc@1001 : Codeunit 5944;
                                                            BEGIN
                                                              CurrForm.UPDATE;
                                                              SignServContractDoc.SignContract(Rec);
                                                              CurrForm.UPDATE;
                                                            END;
                                                             }
                                                   { ID=83;
                                                     CaptionML=[ENU=Create Service &Invoice;
                                                                ESP=Crear factura serv&icio];
                                                     OnPush=BEGIN
                                                              CurrForm.UPDATE;
                                                              TESTFIELD(Status,Status::Signed);
                                                              TESTFIELD("Change Status","Change Status"::Locked);

                                                              IF "No. of Unposted Invoices" <> 0 THEN
                                                                IF NOT CONFIRM(Text003) THEN
                                                                  EXIT;

                                                              IF "Invoice Period" = "Invoice Period"::None THEN
                                                                ERROR(STRSUBSTNO(
                                                                  Text004,
                                                                  TABLECAPTION,"Contract No.",FIELDCAPTION("Invoice Period"),FORMAT("Invoice Period")));

                                                              IF ("Next Invoice Date" > WORKDATE) THEN
                                                                IF ("Last Invoice Date" = 0D) AND
                                                                   ("Starting Date" < "Next Invoice Period Start")
                                                                THEN BEGIN
                                                                  CLEAR(ServContractMgt);
                                                                  ServContractMgt.InitCodeUnit;
                                                                  IF ServContractMgt.CreateRemainingPeriodInvoice(Rec) <> '' THEN
                                                                    MESSAGE(Text006);
                                                                  ServContractMgt.FinishCodeunit;
                                                                  EXIT;
                                                                END ELSE
                                                                  ERROR(Text005);

                                                              ServContractMgt.CopyCheckSCDimToTempSCDim(Rec);

                                                              IF CONFIRM(Text007) THEN BEGIN
                                                                CLEAR(ServContractMgt);
                                                                ServContractMgt.InitCodeUnit;
                                                                ServContractMgt.CreateInvoice(Rec);
                                                                ServContractMgt.FinishCodeunit;
                                                                MESSAGE(Text008);
                                                              END;
                                                            END;
                                                             }
                                                   { ID=110;
                                                     CaptionML=[ENU=Create Credit &Memo;
                                                                ESP=Crear a&bono];
                                                     OnPush=VAR
                                                              CreditNoteNo@1001 : Code[20];
                                                              W1@1002 : Dialog;
                                                              i@1003 : Integer;
                                                              j@1004 : Integer;
                                                              LineFound@1005 : Boolean;
                                                            BEGIN
                                                              CurrForm.UPDATE;
                                                              TESTFIELD(Status,Status::Signed);
                                                              IF "No. of Unposted Credit Memos" <> 0 THEN
                                                                IF NOT CONFIRM(Text009) THEN
                                                                  EXIT;

                                                              ServContractMgt.CopyCheckSCDimToTempSCDim(Rec);

                                                              IF NOT CONFIRM(Text010,FALSE) THEN
                                                                EXIT;

                                                              ServContractLine.RESET;
                                                              ServContractLine.SETCURRENTKEY("Contract Type","Contract No.",Credited,"New Line");
                                                              ServContractLine.SETRANGE("Contract Type","Contract Type");
                                                              ServContractLine.SETRANGE("Contract No.","Contract No.");
                                                              ServContractLine.SETRANGE(Credited,FALSE);
                                                              ServContractLine.SETFILTER("Credit Memo Date",'>%1&<=%2',0D,WORKDATE);
                                                              i := ServContractLine.COUNTAPPROX;
                                                              j := 0;
                                                              IF ServContractLine.FIND('-') THEN BEGIN
                                                                LineFound := TRUE;
                                                                W1.OPEN(
                                                                  Text011 +
                                                                  '@1@@@@@@@@@@@@@@@@@@@@@');
                                                                CLEAR(ServContractMgt);
                                                                ServContractMgt.InitCodeUnit;
                                                                REPEAT
                                                                  ServContractLine1 := ServContractLine;
                                                                  CreditNoteNo := ServContractMgt.CreateContractLineCreditMemo(ServContractLine1,FALSE);
                                                                  j := j + 1;
                                                                  W1.UPDATE(1,ROUND(j / i * 10000,1));
                                                                UNTIL ServContractLine.NEXT = 0;
                                                                ServContractMgt.FinishCodeunit;
                                                                W1.CLOSE;
                                                                CurrForm.UPDATE(FALSE);
                                                              END;
                                                              ServContractLine.SETFILTER("Credit Memo Date",'>%1',WORKDATE);
                                                              IF CreditNoteNo <> '' THEN
                                                                MESSAGE(STRSUBSTNO(Text012,CreditNoteNo))
                                                              ELSE
                                                                IF NOT ServContractLine.FIND('-') OR LineFound THEN
                                                                  MESSAGE(Text013)
                                                                ELSE
                                                                  MESSAGE(Text016,ServContractLine.FIELDCAPTION("Credit Memo Date"),ServContractLine."Credit Memo Date");
                                                            END;
                                                             }
                                                   { ID=111;
                                                     MenuItemType=Separator;
                                                     CaptionML=[ENU="";
                                                                ESP=""] }
                                                   { ID=103;
                                                     CaptionML=[ENU=C&hange Customer;
                                                                ESP=Ca&mbiar cliente];
                                                     OnPush=BEGIN
                                                              CLEAR(ChangeCustomerinContract);
                                                              ChangeCustomerinContract.SetRecord("Contract No.");
                                                              ChangeCustomerinContract.RUNMODAL;
                                                            END;
                                                             }
                                                   { ID=109;
                                                     MenuItemType=Separator }
                                                   { ID=150;
                                                     CaptionML=[ENU=&File Contract;
                                                                ESP=&Archivar contrato];
                                                     OnPush=BEGIN
                                                              IF CONFIRM(Text014) THEN
                                                                FiledServContract.FileContract(Rec);
                                                            END;
                                                             }
                                                   { ID=72;
                                                     MenuItemType=Separator }
                                                   { ID=73;
                                                     CaptionML=[ENU=&Lock Contract;
                                                                ESP=B&loquear contrato];
                                                     OnPush=VAR
                                                              LockOpenServContract@1001 : Codeunit 5943;
                                                            BEGIN
                                                              CurrForm.UPDATE;
                                                              LockOpenServContract.LockServContract(Rec);
                                                              CurrForm.UPDATE;
                                                            END;
                                                             }
                                                   { ID=74;
                                                     CaptionML=[ENU=&Open Contract;
                                                                ESP=&Abrir contrato];
                                                     OnPush=VAR
                                                              LockOpenServContract@1001 : Codeunit 5943;
                                                            BEGIN
                                                              CurrForm.UPDATE;
                                                              LockOpenServContract.OpenServContract(Rec);
                                                              CurrForm.UPDATE;
                                                            END;
                                                             }
                                                 }
                                                  }
    { 93  ;SubForm      ;220  ;8250 ;16060;3300 ;Name=ServContractLines;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Border=No;
                                                 SubFormID=Form6052;
                                                 SubFormLink=Contract No.=FIELD(Contract No.) }
    { 112 ;CommandButton;11660;11770;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Ellipsis=Yes;
                                                 CaptionML=[ENU=&Print;
                                                            ESP=&Imprimir];
                                                 OnPush=VAR
                                                          DocPrint@1001 : Codeunit 229;
                                                        BEGIN
                                                          DocPrint.PrintServiceContract(Rec);
                                                        END;
                                                         }
    { 70  ;MenuButton   ;6820 ;11770;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=&Line;
                                                            ESP=&L¡nea];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=71;
                                                     CaptionML=[ENU=&Comments;
                                                                ESP=&Comentarios];
                                                     OnPush=BEGIN
                                                              CurrForm.ServContractLines.FORM.ShowComments;
                                                            END;
                                                             }
                                                 }
                                                  }
  }
  CODE
  {
    VAR
      Text000@1016 : TextConst 'ENU=%1 must not be blank in %2 %3;ESP=%1 no puede ser blanco en %2 %3';
      Text003@1003 : TextConst 'ENU=There are unposted invoices associated with this contract.\\Do you want to continue?;ESP=Existen facturas sin registrar para este contrato.\\¨Desea continuar?';
      Text004@1004 : TextConst 'ENU=You cannot create an invoice for %1 %2 because %3 is %4.;ESP=No puede crear una factura para %1 %2 porque %3 es %4.';
      Text005@1005 : TextConst 'ENU=The next invoice date has not expired.;ESP=La fecha de la siguiente factura no ha vencido.';
      Text006@1006 : TextConst 'ENU=An invoice was created successfully.;ESP=Se ha creado una factura.';
      Text007@1007 : TextConst 'ENU=Do you want to create an invoice for the contract?;ESP=¨Confirma que desea crear una factura para el contrato?';
      Text008@1008 : TextConst 'ENU=The invoice was created successfully.;ESP=Se ha creado la factura.';
      Text009@1009 : TextConst 'ENU=There are unposted credit memos associated with this contract.\\Do you want to continue?;ESP=Existen abonos sin registrar para este contrato.\\¨Desea continuar?';
      Text010@1010 : TextConst 'ENU=Do you want to create a credit note for the contract?;ESP=¨Confirma que desea crear una nota de abono para el contrato?';
      Text011@1011 : TextConst 'ENU=Processing...        \\;ESP=Procesando...        \\';
      Text012@1012 : TextConst 'ENU=Contract lines have been credited.\\Credit memo %1 was created.;ESP=Se han abonado las l¡ns. contrato.\\Se ha creado el abono %1.';
      Text013@1013 : TextConst 'ENU=A credit memo cannot be created. There must be at least one invoiced and expired service contract line which has not yet been credited.;ESP=No es posible crear un abono. Debe existir al menos una l¡nea de contrato facturada y vencida que a£n no haya sido abonada.';
      Text014@1014 : TextConst 'ENU=Do you want to file the contract?;ESP=¨Confirma que desea archivar el contrato?';
      ServContractLine@1015 : Record 5964;
      FiledServContract@1017 : Record 5970;
      ChangeCustomerinContract@1000 : Report 6037;
      CopyServDoc@1021 : Report 5979;
      ServContractMgt@1018 : Codeunit 5940;
      UserMgt@1019 : Codeunit 5700;
      Mail@1020 : Codeunit 397;
      Text015@1022 : TextConst 'ENU=%1 must not be %2 in %3 %4;ESP=%1 no debe ser %2 en %3 %4';
      Text016@1023 : TextConst 'ENU=A credit memo cannot be created, because the %1 %2 is after the work date.;ESP=No puede crear un abono, porque el %1 %2 es posterior a la fecha de trabajo.';
      ServContractLine1@1024 : Record 5964;

    PROCEDURE CollectShpmntsByLineContractNo@4(VAR TempServShptHeader@1002 : TEMPORARY Record 5990);
    VAR
      ServShptHeader@1000 : Record 5990;
      ServShptLine@1001 : Record 5991;
    BEGIN
      TempServShptHeader.RESET;
      TempServShptHeader.DELETEALL;
      ServShptLine.RESET;
      ServShptLine.SETCURRENTKEY("Contract No.");
      ServShptLine.SETRANGE("Contract No.","Contract No.");
      IF ServShptLine.FINDFIRST THEN
        REPEAT
          IF ServShptHeader.GET(ServShptLine."Document No.") THEN BEGIN
            TempServShptHeader.COPY(ServShptHeader);
            IF TempServShptHeader.INSERT THEN;
          END;
        UNTIL ServShptLine.NEXT = 0;
    END;

    PROCEDURE UpdateShiptoCode@3();
    BEGIN
      IF "Ship-to Code" = '' THEN BEGIN
        "Ship-to Name" := Name;
        "Ship-to Address" := Address;
        "Ship-to Address 2" := "Address 2";
        "Ship-to Post Code" := "Post Code";
        "Ship-to City" := City;
      END;
    END;

    PROCEDURE ActivateFields@2();
    BEGIN
      CurrForm."First Service Date".EDITABLE(Status <> Status::Signed);
      CurrForm.Prepaid.ENABLED := (NOT "Invoice after Service" OR Prepaid);
      CurrForm."Invoice after Service".ENABLED := (NOT Prepaid OR "Invoice after Service");
    END;

    PROCEDURE CheckRequiredFields@1();
    BEGIN
      IF "Contract No." = '' THEN
        ERROR(Text000,FIELDCAPTION("Contract No."),TABLECAPTION,"Contract No.");
      IF "Customer No." = '' THEN
        ERROR(Text000,FIELDCAPTION("Customer No."),TABLECAPTION,"Contract No.");
      IF FORMAT("Service Period") = '' THEN
        ERROR(Text000,FIELDCAPTION("Service Period"),TABLECAPTION,"Contract No.");
      IF "First Service Date" = 0D THEN
        ERROR(Text000,FIELDCAPTION("First Service Date"),TABLECAPTION,"Contract No.");
      IF Status = Status::Canceled THEN
        ERROR(Text015,FIELDCAPTION(Status),FORMAT(Status),TABLECAPTION,"Contract No.");
      IF "Change Status" = "Change Status"::Locked THEN
        ERROR(Text015,FIELDCAPTION("Change Status"),FORMAT("Change Status"),TABLECAPTION,"Contract No.");
    END;

    PROCEDURE GetServItemLine@5();
    VAR
      ContractLineSelection@1005 : Form 6057;
    BEGIN
      CLEAR(ContractLineSelection);
      ContractLineSelection.SetSelection("Customer No.","Ship-to Code","Contract Type","Contract No.",FALSE);
      ContractLineSelection.RUNMODAL;
      CurrForm.UPDATE(FALSE);
    END;

    BEGIN
    END.
  }
}
