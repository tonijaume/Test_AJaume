OBJECT Form 99000852 Planning Worksheet
{
  OBJECT-PROPERTIES
  {
    Date=05/11/08;
    Time=12:00:00;
    Version List=NAVW16.00;
  }
  PROPERTIES
  {
    Width=20900;
    Height=9020;
    CaptionML=[ENU=Planning Worksheet;
               ESP=Hoja planificaci¢n];
    SaveValues=Yes;
    MultipleNewLines=Yes;
    TableBoxID=1;
    SourceTable=Table246;
    AutoSplitKey=Yes;
    DelayedInsert=Yes;
    DataCaptionFields=Journal Batch Name;
    OnOpenForm=VAR
                 JnlSelected@1000 : Boolean;
               BEGIN
                 OpenedFromBatch := ("Journal Batch Name" <> '') AND ("Worksheet Template Name" = '');
                 IF OpenedFromBatch THEN BEGIN
                   CurrentWkshBatchName := "Journal Batch Name";
                   ReqJnlManagement.OpenJnl(CurrentWkshBatchName,Rec);
                   EXIT;
                 END;
                 ReqJnlManagement.TemplateSelection(FORM::"Planning Worksheet",FALSE,2,Rec,JnlSelected);
                 IF NOT JnlSelected THEN
                   ERROR('');
                 ReqJnlManagement.OpenJnl(CurrentWkshBatchName,Rec);
               END;

    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                     END;

    OnAfterGetCurrRecord=BEGIN
                           PlanningWkshManagement.GetDescriptionAndRcptName(Rec,ItemDescription,RoutingDescription);
                         END;

    OnNewRecord=BEGIN
                  SetUpNewLine(Rec);
                  Type := Type::Item;
                  CLEAR(ShortcutDimCode);
                END;

    OnDeleteRecord=BEGIN
                     "Accept Action Message" := FALSE;
                     DeleteMultiLevel;
                   END;

  }
  CONTROLS
  {
    { 1   ;TableBox     ;220  ;880  ;20460;5500 ;HorzGlue=Both;
                                                 VertGlue=Both }
    { 118 ;PictureBox   ;0    ;990  ;550  ;3740 ;Name=Warning;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BitmapList=45,8,6;
                                                 CaptionML=[ENU=Warning;
                                                            ESP=Advertencia];
                                                 SourceExpr=[PlanningWarningLevel - 1 ];
                                                 OnPush=VAR
                                                          Transparency@1000 : Codeunit 99000856;
                                                        BEGIN
                                                          Transparency.SetCurrReqLine(Rec);
                                                          Transparency.DrillDownUntrackedQty('');
                                                        END;
                                                         }
    { 119 ;Label        ;0    ;0    ;0    ;0    ;ParentControl=118;
                                                 InColumnHeading=Yes }
    { 40  ;TextBox      ;0    ;1210 ;550  ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Type }
    { 68  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=40;
                                                 InColumnHeading=Yes }
    { 2   ;TextBox      ;0    ;990  ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="No.";
                                                 OnValidate=BEGIN
                                                              PlanningWkshManagement.GetDescriptionAndRcptName(Rec,ItemDescription,RoutingDescription);
                                                            END;
                                                             }
    { 3   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=2;
                                                 InColumnHeading=Yes }
    { 29  ;TextBox      ;1746 ;990  ;1640 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Variant Code" }
    { 30  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=29;
                                                 InColumnHeading=Yes }
    { 96  ;TextBox      ;2540 ;2090 ;550  ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Action Message" }
    { 97  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=96;
                                                 InColumnHeading=Yes }
    { 98  ;CheckBox     ;3069 ;1210 ;507  ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 ShowCaption=No;
                                                 SourceExpr="Accept Action Message" }
    { 99  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=98;
                                                 InColumnHeading=Yes }
    { 72  ;TextBox      ;2117 ;2860 ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Original Due Date" }
    { 73  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=72;
                                                 InColumnHeading=Yes }
    { 82  ;TextBox      ;3096 ;990  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Order Date" }
    { 83  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=82;
                                                 InColumnHeading=Yes }
    { 12  ;TextBox      ;7473 ;990  ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Due Date" }
    { 13  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=12;
                                                 InColumnHeading=Yes }
    { 115 ;TextBox      ;8811 ;990  ;1700 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Transfer Shipment Date" }
    { 116 ;Label        ;0    ;0    ;0    ;0    ;ParentControl=115;
                                                 InColumnHeading=Yes }
    { 24  ;TextBox      ;8864 ;1650 ;3050 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Starting Date-Time";
                                                 OnFormat=BEGIN
                                                            IF ("Starting Date" < WORKDATE) AND
                                                               ("Action Message" IN ["Action Message"::New,"Action Message"::Reschedule,"Action Message"::"Resched. & Chg. Qty."])
                                                            THEN
                                                              CurrForm."Starting Date-Time".UPDATEFORECOLOR(255);
                                                          END;
                                                           }
    { 100 ;Label        ;0    ;0    ;0    ;0    ;ParentControl=24;
                                                 InColumnHeading=Yes }
    { 55  ;TextBox      ;2540 ;990  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Starting Time" }
    { 61  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=55;
                                                 InColumnHeading=Yes }
    { 6   ;TextBox      ;2523 ;990  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Starting Date";
                                                 OnFormat=BEGIN
                                                            IF "Starting Date" < WORKDATE THEN
                                                              CurrForm."Starting Date".UPDATEFORECOLOR(255);
                                                          END;
                                                           }
    { 7   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=6;
                                                 InColumnHeading=Yes }
    { 107 ;TextBox      ;11064;1650 ;3050 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Ending Date-Time" }
    { 108 ;Label        ;0    ;0    ;0    ;0    ;ParentControl=107;
                                                 InColumnHeading=Yes }
    { 8   ;TextBox      ;4173 ;990  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Ending Time" }
    { 9   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=8;
                                                 InColumnHeading=Yes }
    { 10  ;TextBox      ;5823 ;990  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Ending Date" }
    { 11  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=10;
                                                 InColumnHeading=Yes }
    { 80  ;TextBox      ;5027 ;990  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Low-Level Code" }
    { 81  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=80;
                                                 InColumnHeading=Yes }
    { 63  ;TextBox      ;10345;990  ;4400 ;440  ;HorzGlue=Both;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Description;
                                                 OnFormat=BEGIN
                                                            CurrForm.Description.UPDATEINDENT := "Planning Level" * 220;
                                                          END;
                                                           }
    { 64  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=63;
                                                 InColumnHeading=Yes }
    { 74  ;TextBox      ;14737;990  ;4400 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Description 2" }
    { 75  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=74;
                                                 InColumnHeading=Yes }
    { 43  ;TextBox      ;24686;990  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Production BOM No." }
    { 44  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=43;
                                                 InColumnHeading=Yes }
    { 14  ;TextBox      ;24633;990  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Production BOM Version Code" }
    { 15  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=14;
                                                 InColumnHeading=Yes }
    { 45  ;TextBox      ;26336;990  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Routing No.";
                                                 OnValidate=BEGIN
                                                              PlanningWkshManagement.GetDescriptionAndRcptName(Rec,ItemDescription,RoutingDescription);
                                                            END;
                                                             }
    { 50  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=45;
                                                 InColumnHeading=Yes }
    { 31  ;TextBox      ;26283;990  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Routing Version Code" }
    { 41  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=31;
                                                 InColumnHeading=Yes }
    { 27  ;TextBox      ;19659;990  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Shortcut Dimension 1 Code" }
    { 28  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=27;
                                                 InColumnHeading=Yes }
    { 25  ;TextBox      ;10292;990  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Shortcut Dimension 2 Code" }
    { 52  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=25;
                                                 InColumnHeading=Yes }
    { 111 ;TextBox      ;40958;3300 ;1700 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Transfer-from Code" }
    { 112 ;Label        ;0    ;0    ;0    ;0    ;ParentControl=111;
                                                 InColumnHeading=Yes }
    { 76  ;TextBox      ;24686;990  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Location Code" }
    { 77  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=76;
                                                 InColumnHeading=Yes }
    { 46  ;TextBox      ;38418;1430 ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Original Quantity" }
    { 47  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=46;
                                                 InColumnHeading=Yes }
    { 21  ;CheckBox     ;44344;1210 ;550  ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 ShowCaption=No;
                                                 SourceExpr="MPS Order" }
    { 103 ;Label        ;0    ;0    ;0    ;0    ;ParentControl=21;
                                                 InColumnHeading=Yes }
    { 4   ;TextBox      ;873  ;990  ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Quantity }
    { 5   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=4;
                                                 InColumnHeading=Yes }
    { 16  ;TextBox      ;44344;1540 ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Unit of Measure Code" }
    { 17  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=16;
                                                 InColumnHeading=Yes }
    { 88  ;TextBox      ;12515;1650 ;550  ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 OptionString=Purchase,Prod. Order,Transfer;
                                                 SourceExpr="Replenishment System" }
    { 89  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=88;
                                                 InColumnHeading=Yes }
    { 90  ;TextBox      ;46603;2530 ;550  ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Ref. Order Type" }
    { 91  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=90;
                                                 InColumnHeading=Yes }
    { 84  ;TextBox      ;44953;2530 ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Ref. Order No.";
                                                 OnFormat=VAR
                                                            PurchHeader@1000 : Record 38;
                                                            TransfHeader@1003 : Record 5740;
                                                          BEGIN
                                                            CASE "Ref. Order Type" OF
                                                              "Ref. Order Type"::Purchase:
                                                                IF PurchHeader.GET(PurchHeader."Document Type"::Order,"Ref. Order No.") AND
                                                                   (PurchHeader.Status = PurchHeader.Status::Released)
                                                                THEN
                                                                  CurrForm."Ref. Order No.".UPDATEFORECOLOR(255);
                                                              "Ref. Order Type"::"Prod. Order":
                                                                IF "Ref. Order Status" = "Ref. Order Status"::Released THEN
                                                                  CurrForm."Ref. Order No.".UPDATEFORECOLOR(255);
                                                              "Ref. Order Type"::Transfer:
                                                                IF TransfHeader.GET("Ref. Order No.") AND
                                                                   (TransfHeader.Status = TransfHeader.Status::Released)
                                                                THEN
                                                                  CurrForm."Ref. Order No.".UPDATEFORECOLOR(255);
                                                            END;
                                                          END;
                                                           }
    { 85  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=84;
                                                 InColumnHeading=Yes }
    { 92  ;TextBox      ;47153;2530 ;550  ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Ref. Order Status" }
    { 93  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=92;
                                                 InColumnHeading=Yes }
    { 94  ;TextBox      ;47703;2530 ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Ref. Line No." }
    { 95  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=94;
                                                 InColumnHeading=Yes }
    { 104 ;TextBox      ;49530;1210 ;550  ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Planning Flexibility" }
    { 105 ;Label        ;0    ;0    ;0    ;0    ;ParentControl=104;
                                                 InColumnHeading=Yes }
    { 51  ;TextBox      ;40614;990  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Reserved Quantity";
                                                 OnDrillDown=BEGIN
                                                               ShowReservationEntries(TRUE);
                                                             END;
                                                              }
    { 60  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=51;
                                                 InColumnHeading=Yes }
    { 33  ;TextBox      ;14790;990  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Gen. Prod. Posting Group" }
    { 34  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=33;
                                                 InColumnHeading=Yes }
    { 86  ;TextBox      ;41037;1100 ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Unit Cost" }
    { 87  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=86;
                                                 InColumnHeading=Yes }
    { 35  ;TextBox      ;16990;990  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Gen. Business Posting Group" }
    { 36  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=35;
                                                 InColumnHeading=Yes }
    { 37  ;TextBox      ;19190;990  ;2200 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Cost Amount" }
    { 38  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=37;
                                                 InColumnHeading=Yes }
    { 78  ;TextBox      ;33470;990  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Vendor No." }
    { 79  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=78;
                                                 InColumnHeading=Yes }
    { 22  ;CommandButton;18480;8250 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 56  ;Frame        ;220  ;6600 ;20460;1430 ;HorzGlue=Both;
                                                 VertGlue=Bottom;
                                                 ShowCaption=No }
    { 57  ;TextBox      ;440  ;7370 ;4400 ;440  ;VertGlue=Bottom;
                                                 Editable=No;
                                                 ParentControl=56;
                                                 InFrame=Yes;
                                                 SourceExpr=ItemDescription }
    { 70  ;TextBox      ;5060 ;7370 ;4400 ;440  ;VertGlue=Bottom;
                                                 Editable=No;
                                                 ParentControl=56;
                                                 InFrame=Yes;
                                                 CaptionML=[ENU=Routing Description;
                                                            ESP=Descripci¢n ruta];
                                                 SourceExpr=RoutingDescription }
    { 71  ;Label        ;5060 ;6820 ;4400 ;440  ;VertGlue=Bottom;
                                                 ParentControl=70;
                                                 LeaderDots=No }
    { 48  ;MenuButton   ;13640;8250 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=&Item;
                                                            ESP=&Producto];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=53;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=Components;
                                                                ESP=Componentes];
                                                     RunObject=Form 99000862;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Worksheet Template Name=FIELD(Worksheet Template Name),
                                                                 Worksheet Batch Name=FIELD(Journal Batch Name),
                                                                 Worksheet Line No.=FIELD(Line No.) }
                                                   { ID=54;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=Ro&uting;
                                                                ESP=R&uta];
                                                     RunObject=Form 99000863;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Worksheet Template Name=FIELD(Worksheet Template Name),
                                                                 Worksheet Batch Name=FIELD(Journal Batch Name),
                                                                 Worksheet Line No.=FIELD(Line No.) }
                                                   { ID=49;
                                                     CaptionML=[ENU=&Item Availability by;
                                                                ESP=&Disponibilidad prod. por] }
                                                   { ID=65;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Period;
                                                                ESP=Periodo];
                                                     RunFormLinkType=OnUpdate;
                                                     OnPush=BEGIN
                                                              ItemAvailability(0);
                                                            END;
                                                             }
                                                   { ID=66;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Variant;
                                                                ESP=Variante];
                                                     RunFormLinkType=OnUpdate;
                                                     OnPush=BEGIN
                                                              ItemAvailability(1);
                                                            END;
                                                             }
                                                   { ID=67;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Location;
                                                                ESP=Almac‚n];
                                                     RunFormLinkType=OnUpdate;
                                                     OnPush=BEGIN
                                                              ItemAvailability(2);
                                                            END;
                                                             }
                                                 }
                                                  }
    { 69  ;TextBox      ;3740 ;220  ;2750 ;440  ;CaptionML=[ENU=Name;
                                                            ESP=Nombre];
                                                 SourceExpr=CurrentWkshBatchName;
                                                 OnValidate=BEGIN
                                                              ReqJnlManagement.CheckName(CurrentWkshBatchName,Rec);
                                                            END;

                                                 OnLookup=BEGIN
                                                            CurrForm.SAVERECORD;
                                                            ReqJnlManagement.LookupName(CurrentWkshBatchName,Rec);
                                                            CurrForm.UPDATE(FALSE);
                                                          END;

                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.SAVERECORD;
                                                                   ReqJnlManagement.SetName(CurrentWkshBatchName,Rec);
                                                                   CurrForm.UPDATE(FALSE);
                                                                 END;
                                                                  }
    { 26  ;Label        ;220  ;220  ;3300 ;440  ;ParentControl=69 }
    { 20  ;MenuButton   ;16060;8250 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=F&unctions;
                                                            ESP=Acci&ones];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=106;
                                                     Ellipsis=Yes;
                                                     CaptionML=[ENU=Get &Action Messages;
                                                                ESP=&Traer mensajes acci¢n];
                                                     OnPush=BEGIN
                                                              GetActionMessages;

                                                              IF NOT Rec.FIND('-') THEN
                                                                SetUpNewLine(Rec);
                                                            END;
                                                             }
                                                   { ID=109;
                                                     MenuItemType=Separator;
                                                     CaptionML=[ENU="";
                                                                ESP=""] }
                                                   { ID=101;
                                                     Ellipsis=Yes;
                                                     CaptionML=[ENU=Calculate &Net Change Plan;
                                                                ESP=&Calc. plan. saldo periodo];
                                                     OnPush=VAR
                                                              CalcPlan@1001 : Report 99001017;
                                                            BEGIN
                                                              CalcPlan.SetTemplAndWorksheet("Worksheet Template Name","Journal Batch Name",FALSE);
                                                              CalcPlan.RUNMODAL;

                                                              IF NOT Rec.FIND('-') THEN
                                                                SetUpNewLine(Rec);

                                                              CLEAR(CalcPlan);
                                                            END;
                                                             }
                                                   { ID=102;
                                                     Ellipsis=Yes;
                                                     CaptionML=[ENU=Calculate Regenerative Plan;
                                                                ESP=Calc. planif. regenerativa];
                                                     OnPush=VAR
                                                              CalcPlan@1001 : Report 99001017;
                                                            BEGIN
                                                              CalcPlan.SetTemplAndWorksheet("Worksheet Template Name","Journal Batch Name",TRUE);
                                                              CalcPlan.RUNMODAL;

                                                              IF NOT Rec.FIND('-') THEN
                                                                SetUpNewLine(Rec);

                                                              CLEAR(CalcPlan);
                                                            END;
                                                             }
                                                   { ID=32;
                                                     MenuItemType=Separator }
                                                   { ID=23;
                                                     Ellipsis=Yes;
                                                     CaptionML=[ENU=Re&fresh Planning Line;
                                                                ESP=&Actualizar l¡nea plan.];
                                                     OnPush=VAR
                                                              ReqLine@1001 : Record 246;
                                                            BEGIN
                                                              ReqLine.SETRANGE("Worksheet Template Name","Worksheet Template Name");
                                                              ReqLine.SETRANGE("Journal Batch Name","Journal Batch Name");
                                                              ReqLine.SETRANGE("Line No.","Line No.");

                                                              REPORT.RUNMODAL(REPORT::"Refresh Planning Demand",TRUE,FALSE,ReqLine);
                                                            END;
                                                             }
                                                   { ID=42;
                                                     MenuItemType=Separator }
                                                   { ID=114;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=&Get Error Log;
                                                                ESP=Obtener lo&g errores];
                                                     RunObject=Form 5430;
                                                     RunFormLink=Worksheet Template Name=FIELD(Worksheet Template Name),
                                                                 Journal Batch Name=FIELD(Journal Batch Name) }
                                                   { ID=113;
                                                     MenuItemType=Separator }
                                                   { ID=59;
                                                     Ellipsis=Yes;
                                                     CaptionML=[ENU=Carry &Out Action Message;
                                                                ESP=&Ejecutar mensajes acci¢n];
                                                     OnPush=BEGIN
                                                              PerformAction.SetReqWkshLine(Rec);
                                                              PerformAction.RUNMODAL;
                                                              CLEAR(PerformAction);
                                                              CurrForm.UPDATE(TRUE);
                                                            END;
                                                             }
                                                   { ID=19;
                                                     MenuItemType=Separator }
                                                   { ID=62;
                                                     CaptionML=[ENU=&Reserve;
                                                                ESP=&Reservar];
                                                     OnPush=BEGIN
                                                              CurrForm.SAVERECORD;
                                                              ShowReservation;
                                                            END;
                                                             }
                                                   { ID=18;
                                                     CaptionML=[ENU=Order &Tracking;
                                                                ESP=&Seg. pedido];
                                                     OnPush=VAR
                                                              TrackingForm@1001 : Form 99000822;
                                                            BEGIN
                                                              TrackingForm.SetReqLine(Rec);
                                                              TrackingForm.RUNMODAL;
                                                            END;
                                                             }
                                                 }
                                                  }
    { 39  ;MenuButton   ;11220;8250 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=&Line;
                                                            ESP=&L¡nea];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=110;
                                                     PushAction=RunObject;
                                                     ShortCutKey=May£s+Ctrl+D;
                                                     CaptionML=[ENU=Dimensions;
                                                                ESP=Dimensiones];
                                                     RunObject=Form 545;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Table ID=CONST(246),
                                                                 Journal Template Name=FIELD(Worksheet Template Name),
                                                                 Journal Batch Name=FIELD(Journal Batch Name),
                                                                 Journal Line No.=FIELD(Line No.) }
                                                   { ID=6500;
                                                     ShortCutKey=May£s+Ctrl+I;
                                                     CaptionML=[ENU=Item &Tracking Lines;
                                                                ESP=L¡ns. &seguim. prod.];
                                                     OnPush=BEGIN
                                                              OpenItemTrackingLines;
                                                            END;
                                                             }
                                                 }
                                                  }
    { 58  ;Label        ;440  ;6820 ;4400 ;440  ;VertGlue=Bottom;
                                                 ParentControl=56;
                                                 LeaderDots=No;
                                                 CaptionML=[ENU=Item Description;
                                                            ESP=Descripci¢n producto] }
  }
  CODE
  {
    VAR
      PerformAction@1000 : Report 99001020;
      ReqJnlManagement@1001 : Codeunit 330;
      PlanningWkshManagement@1002 : Codeunit 99000812;
      CurrentWkshBatchName@1003 : Code[10];
      ItemDescription@1004 : Text[50];
      RoutingDescription@1005 : Text[50];
      ShortcutDimCode@1006 : ARRAY [8] OF Code[20];
      OpenedFromBatch@1007 : Boolean;

    PROCEDURE PlanningWarningLevel@40() : Integer;
    VAR
      Transparency@1001 : Codeunit 99000856;
    BEGIN
      EXIT(Transparency.ReqLineWarningLevel(Rec));
    END;

    BEGIN
    END.
  }
}
