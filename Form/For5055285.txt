OBJECT Form 5055285 Liq. Analysis by Dimensions
{
  OBJECT-PROPERTIES
  {
    Date=05/11/08;
    Time=12:00:00;
    Version List=LIQEM6.00;
  }
  PROPERTIES
  {
    Width=16500;
    Height=10010;
    CaptionML=[ENU=Liq. Analysis by Dimensions;
               ESP=An lisis liq. por dimensiones];
    SaveValues=Yes;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table367;
    DataCaptionExpr=AnalysisViewCode;
    OnOpenForm=BEGIN
                 ValidateAnalysisViewCode;

                 GLSetup.GET;

                 IF (LineDimCode = '') AND (ColumnDimCode = '') THEN BEGIN
                   LineDimCode := LiqAcc.TABLECAPTION;
                   ColumnDimCode := Text1140000;
                 END;
                 LineDimOption := DimCodeToOption(LineDimCode);
                 ColumnDimOption := DimCodeToOption(ColumnDimCode);

                 FindPeriod('');
                 CurrForm.UPDATECONTROLS;
               END;

    OnFindRecord=BEGIN
                   EXIT(FindRec(LineDimOption,Rec,Which));
                 END;

    OnNextRecord=BEGIN
                   EXIT(NextRec(LineDimOption,Rec,Steps));
                 END;

    OnAfterGetRecord=BEGIN
                       IF CurrForm.TotalAmount.VISIBLE THEN
                         Amount := CalcAmount(FALSE);
                     END;

  }
  CONTROLS
  {
    { 1140000;TabControl;220  ;220  ;16060;3080 ;HorzGlue=Both;
                                                 VertGlue=Top;
                                                 PageNamesML=[ENU=General,Filters,Options;
                                                              ESP=General,Filtros,Opciones] }
    { 1140001;TextBox   ;3850 ;990  ;2750 ;440  ;ParentControl=1140000;
                                                 InPage=0;
                                                 CaptionML=[ENU=Analysis View Code;
                                                            ESP=C¢d. vista an lisis];
                                                 SourceExpr=AnalysisViewCode;
                                                 TableRelation="Liquidity Analysis View";
                                                 OnValidate=BEGIN
                                                              AVBreakdownBuffer.DELETEALL;
                                                              ValidateAnalysisViewCode;
                                                              ValidateColumnDimCode;
                                                              ValidateLineDimCode;
                                                            END;

                                                 OnLookup=VAR
                                                            AnalysisViewList@1140000 : Form 5055287;
                                                          BEGIN
                                                            AnalysisViewList.LOOKUPMODE := TRUE;
                                                            AnalysisViewList.SETRECORD(AnalysisView);
                                                            IF AnalysisViewList.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                              AnalysisViewList.GETRECORD(AnalysisView);
                                                              AnalysisViewCode := AnalysisView.Code;
                                                              Text := AnalysisView.Code;
                                                              ValidateAnalysisViewCode;
                                                              ValidateColumnDimCode;
                                                              ValidateLineDimCode;
                                                              CurrForm.UPDATE;
                                                              EXIT(TRUE);
                                                            END ELSE BEGIN
                                                              ValidateAnalysisViewCode;
                                                              CurrForm.UPDATE;
                                                              EXIT(FALSE);
                                                            END;
                                                          END;

                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATECONTROLS;
                                                                 END;
                                                                  }
    { 1140002;Label     ;440  ;990  ;3300 ;440  ;ParentControl=1140001 }
    { 1140003;TextBox   ;3850 ;1650 ;2750 ;440  ;ParentControl=1140000;
                                                 InPage=0;
                                                 CaptionML=[ENU=Show as Lines;
                                                            ESP=Muestra como l¡neas];
                                                 SourceExpr=LineDimCode;
                                                 OnValidate=BEGIN
                                                              IF (UPPERCASE(LineDimCode) = UPPERCASE(ColumnDimCode)) AND (LineDimCode <> '') THEN BEGIN
                                                                ColumnDimCode := '';
                                                                ValidateColumnDimCode;
                                                              END;
                                                              AVBreakdownBuffer.DELETEALL;
                                                              ValidateLineDimCode;
                                                            END;

                                                 OnLookup=VAR
                                                            NewCode@1140000 : Text[30];
                                                          BEGIN
                                                            NewCode := GetDimSelection(LineDimCode);
                                                            IF NewCode = LineDimCode THEN
                                                              EXIT(FALSE)
                                                            ELSE BEGIN
                                                              Text := NewCode;
                                                              LineDimCode := NewCode;
                                                              ValidateLineDimCode;
                                                              CurrForm.UPDATE;
                                                              EXIT(TRUE);
                                                            END
                                                          END;

                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 1140004;Label     ;440  ;1650 ;3300 ;440  ;ParentControl=1140003 }
    { 1140005;TextBox   ;3850 ;2200 ;2750 ;440  ;ParentControl=1140000;
                                                 InPage=0;
                                                 CaptionML=[ENU=Show as Columns;
                                                            ESP=Muestra como columnas];
                                                 SourceExpr=ColumnDimCode;
                                                 OnValidate=BEGIN
                                                              IF (UPPERCASE(LineDimCode) = UPPERCASE(ColumnDimCode)) AND (LineDimCode <> '') THEN BEGIN
                                                                LineDimCode := '';
                                                                ValidateLineDimCode;
                                                              END;
                                                              AVBreakdownBuffer.DELETEALL;
                                                              ValidateColumnDimCode;
                                                            END;

                                                 OnLookup=VAR
                                                            NewCode@1140000 : Text[30];
                                                          BEGIN
                                                            NewCode := GetDimSelection(ColumnDimCode);
                                                            IF NewCode = ColumnDimCode THEN
                                                              EXIT(FALSE)
                                                            ELSE BEGIN
                                                              Text := NewCode;
                                                              ColumnDimCode := NewCode;
                                                              ValidateColumnDimCode;
                                                              CurrForm.UPDATE;
                                                              EXIT(TRUE);
                                                            END
                                                          END;

                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 1140006;Label     ;440  ;2200 ;3300 ;440  ;ParentControl=1140005 }
    { 1140007;TextBox   ;3850 ;990  ;2750 ;440  ;ParentControl=1140000;
                                                 InPage=1;
                                                 CaptionML=[ENU=Date Filter;
                                                            ESP=Filtro fecha];
                                                 SourceExpr=DateFilter;
                                                 OnValidate=VAR
                                                              LiqAcc@1140000 : Record 15;
                                                              ApplicationManagement@1140001 : Codeunit 1;
                                                            BEGIN
                                                              IF ApplicationManagement.MakeDateFilter(DateFilter) = 0 THEN;
                                                              LiqAcc.SETFILTER("Date Filter",DateFilter);
                                                              DateFilter := LiqAcc.GETFILTER("Date Filter");
                                                              InternalDateFilter := DateFilter;
                                                            END;

                                                 OnAfterValidate=BEGIN
                                                                   AVBreakdownBuffer.DELETEALL;
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 1140008;Label     ;440  ;990  ;3300 ;440  ;ParentControl=1140007 }
    { 1140009;TextBox   ;12980;1540 ;2750 ;440  ;Name=Dim2Filter;
                                                 ParentControl=1140000;
                                                 InPage=1;
                                                 CaptionML=[ENU=Dimension 2 Filter;
                                                            ESP=Filtro dimensi¢n 2];
                                                 ClearOnLookup=No;
                                                 SourceExpr=Dim2Filter;
                                                 CaptionClass=GetCaptionClass(2);
                                                 OnLookup=BEGIN
                                                            EXIT(LookUpDimFilter(AnalysisView."Dimension 2 Code",Text));
                                                          END;

                                                 OnAfterValidate=BEGIN
                                                                   AVBreakdownBuffer.DELETEALL;
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 1140010;TextBox   ;12980;990  ;2750 ;440  ;Name=Dim1Filter;
                                                 ParentControl=1140000;
                                                 InPage=1;
                                                 CaptionML=[ENU=Dimension 1 Filter;
                                                            ESP=Filtro dimensi¢n 1];
                                                 ClearOnLookup=No;
                                                 SourceExpr=Dim1Filter;
                                                 CaptionClass=GetCaptionClass(1);
                                                 OnLookup=BEGIN
                                                            EXIT(LookUpDimFilter(AnalysisView."Dimension 1 Code",Text));
                                                          END;

                                                 OnAfterValidate=BEGIN
                                                                   AVBreakdownBuffer.DELETEALL;
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 1140011;TextBox   ;12980;2640 ;2750 ;440  ;Name=Dim4Filter;
                                                 ParentControl=1140000;
                                                 InPage=1;
                                                 CaptionML=[ENU=Dimension 4 Filter;
                                                            ESP=Filtro dimensi¢n 4];
                                                 ClearOnLookup=No;
                                                 SourceExpr=Dim4Filter;
                                                 CaptionClass=GetCaptionClass(4);
                                                 OnLookup=BEGIN
                                                            EXIT(LookUpDimFilter(AnalysisView."Dimension 4 Code",Text));
                                                          END;

                                                 OnAfterValidate=BEGIN
                                                                   AVBreakdownBuffer.DELETEALL;
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 1140012;TextBox   ;12980;2090 ;2750 ;440  ;Name=Dim3Filter;
                                                 ParentControl=1140000;
                                                 InPage=1;
                                                 CaptionML=[ENU=Dimension 3 Filter;
                                                            ESP=Filtro dimensi¢n 3];
                                                 ClearOnLookup=No;
                                                 SourceExpr=Dim3Filter;
                                                 CaptionClass=GetCaptionClass(3);
                                                 OnLookup=BEGIN
                                                            EXIT(LookUpDimFilter(AnalysisView."Dimension 3 Code",Text));
                                                          END;

                                                 OnAfterValidate=BEGIN
                                                                   AVBreakdownBuffer.DELETEALL;
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 1140013;TextBox   ;3850 ;2090 ;2750 ;440  ;ParentControl=1140000;
                                                 InPage=1;
                                                 CaptionML=[ENU=Liquidity Filter;
                                                            ESP=Filtro liquidez];
                                                 SourceExpr=LiquidityFilter;
                                                 TableRelation=Liquidity.No.;
                                                 LookupFormID=Liquidity List;
                                                 OnAfterValidate=BEGIN
                                                                   AVBreakdownBuffer.DELETEALL;
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 1140014;Label     ;440  ;2090 ;3300 ;440  ;ParentControl=1140013 }
    { 1140015;TextBox   ;3850 ;1540 ;2750 ;440  ;ParentControl=1140000;
                                                 InPage=1;
                                                 CaptionML=[ENU=Liquidity Account Filter;
                                                            ESP=Filtro cta. liquidez];
                                                 ClearOnLookup=No;
                                                 SourceExpr=LiqAccFilter;
                                                 OnLookup=VAR
                                                            LiqAccList@1140000 : Form 5055265;
                                                          BEGIN
                                                            LiqAccList.LOOKUPMODE(TRUE);
                                                            IF NOT (LiqAccList.RUNMODAL = ACTION::LookupOK) THEN
                                                              EXIT(FALSE)
                                                            ELSE
                                                              Text := LiqAccList.GetSelectionFilter;
                                                            EXIT(TRUE);
                                                          END;

                                                 OnAfterValidate=BEGIN
                                                                   AVBreakdownBuffer.DELETEALL;
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 1140016;Label     ;440  ;1540 ;3300 ;440  ;ParentControl=1140015 }
    { 1140017;Label     ;9570 ;990  ;3300 ;440  ;ParentControl=1140010;
                                                 InPage=1 }
    { 1140018;Label     ;9570 ;1540 ;3300 ;440  ;ParentControl=1140009;
                                                 InPage=1 }
    { 1140019;Label     ;9570 ;2090 ;3300 ;440  ;ParentControl=1140012;
                                                 InPage=1 }
    { 1140020;Label     ;9570 ;2640 ;3300 ;440  ;ParentControl=1140011;
                                                 InPage=1 }
    { 1140021;CheckBox  ;12980;990  ;440  ;440  ;ParentControl=1140000;
                                                 InPage=2;
                                                 ShowCaption=No;
                                                 CaptionML=[ENU=Show Column Name;
                                                            ESP=Muestra nombre columna];
                                                 SourceExpr=ShowColumnName }
    { 1140022;Label     ;9570 ;990  ;3300 ;440  ;ParentControl=1140021 }
    { 1140023;TextBox   ;3850 ;1540 ;2750 ;440  ;ParentControl=1140000;
                                                 InPage=2;
                                                 CaptionML=[ENU=Rounding Factor;
                                                            ESP=Factor redondeo];
                                                 OptionCaptionML=[ENU=None,1,1000,1000000;
                                                                  ESP=No,1,1000,1000000];
                                                 OptionString=None,1,1000,1000000;
                                                 SourceExpr=RoundingFactor }
    { 1140024;Label     ;440  ;1540 ;3300 ;440  ;ParentControl=1140023 }
    { 1140025;TextBox   ;3850 ;990  ;2750 ;440  ;ParentControl=1140000;
                                                 InPage=2;
                                                 CaptionML=[ENU=Show;
                                                            ESP=Mostrar];
                                                 OptionCaptionML=[ENU=Amounts;
                                                                  ESP=Importes];
                                                 OptionString=Amounts;
                                                 SourceExpr=ShowActual;
                                                 OnValidate=BEGIN
                                                              AVBreakdownBuffer.DELETEALL;
                                                              Amount := CalcAmount(FALSE);
                                                            END;
                                                             }
    { 1140026;Label     ;440  ;990  ;3300 ;440  ;ParentControl=1140025 }
    { 1140027;CheckBox  ;12980;1540 ;440  ;440  ;ParentControl=1140000;
                                                 InPage=2;
                                                 ShowCaption=No;
                                                 CaptionML=[ENU=Show Opposite Sign;
                                                            ESP=Muestra signo opuesto];
                                                 SourceExpr=ShowOppositeSign;
                                                 OnValidate=BEGIN
                                                              AVBreakdownBuffer.DELETEALL;
                                                              Amount := CalcAmount(FALSE);
                                                            END;
                                                             }
    { 1140028;Label     ;9570 ;1540 ;3300 ;440  ;ParentControl=1140027;
                                                 MultiLine=Yes }
    { 1140029;CommandButton;14080;9240;2200;550 ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 1140030;MatrixBox ;220  ;3520 ;16060;5500 ;Name=Matrix;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Editable=No;
                                                 MatrixSourceTable=Table367;
                                                 OnFindRecord=BEGIN
                                                                EXIT(FindRec(ColumnDimOption,CurrForm.Matrix.MatrixRec,Which));
                                                              END;

                                                 OnNextRecord=BEGIN
                                                                EXIT(NextRec(ColumnDimOption,CurrForm.Matrix.MatrixRec,Steps));
                                                              END;

                                                 OnAfterGetRecord=BEGIN
                                                                    IF ShowColumnName THEN
                                                                      MatrixHeader := CurrForm.Matrix.MatrixRec.Name
                                                                    ELSE
                                                                      MatrixHeader := CurrForm.Matrix.MatrixRec.Code;

                                                                    MatrixAmount := CalcAmount(TRUE);
                                                                  END;
                                                                   }
    { 1140031;TextBox   ;397  ;3740 ;1650 ;440  ;ParentControl=1140030;
                                                 InColumn=Yes;
                                                 SourceExpr=Code;
                                                 OnFormat=BEGIN
                                                            CurrForm.Code.UPDATEFONTBOLD("Show in Bold");
                                                          END;

                                                 OnLookup=BEGIN
                                                            LookUpCode(LineDimOption,LineDimCode,Code);
                                                          END;
                                                           }
    { 1140032;Label     ;0    ;0    ;0    ;0    ;ParentControl=1140031;
                                                 InColumnHeading=Yes }
    { 1140033;TextBox   ;2047 ;3740 ;4400 ;440  ;HorzGlue=Both;
                                                 ParentControl=1140030;
                                                 InColumn=Yes;
                                                 SourceExpr=Name;
                                                 OnFormat=BEGIN
                                                            CurrForm.Name.UPDATEFONTBOLD("Show in Bold");
                                                            CurrForm.Name.UPDATEINDENT(220 * Indentation);
                                                          END;
                                                           }
    { 1140034;Label     ;0    ;0    ;0    ;0    ;ParentControl=1140033;
                                                 InColumnHeading=Yes }
    { 1140035;TextBox   ;6377 ;3740 ;2200 ;440  ;Name=TotalAmount;
                                                 ParentControl=1140030;
                                                 InColumn=Yes;
                                                 CaptionML=[ENU=Total Amount;
                                                            ESP=Importe total];
                                                 BlankZero=Yes;
                                                 SourceExpr=Amount;
                                                 AutoFormatType=1;
                                                 AutoFormatExpr=ShownCurrency;
                                                 OnActivate=BEGIN
                                                              Amount := CalcAmount(FALSE);
                                                            END;

                                                 OnFormat=BEGIN
                                                            FormatAmount(Text);
                                                            CurrForm.TotalAmount.UPDATEFONTBOLD("Show in Bold");
                                                          END;

                                                 OnDrillDown=BEGIN
                                                               DrillDown(FALSE);
                                                             END;
                                                              }
    { 1140036;Label     ;0    ;0    ;0    ;0    ;ParentControl=1140035;
                                                 InColumnHeading=Yes }
    { 1140037;TextBox   ;13200;4400 ;7260 ;440  ;Name=CellAmount;
                                                 ParentControl=1140030;
                                                 InMatrix=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MatrixAmount;
                                                 AutoFormatType=1;
                                                 AutoFormatExpr=ShownCurrency;
                                                 OnFormat=BEGIN
                                                            FormatAmount(Text);
                                                            CurrForm.CellAmount.UPDATEFONTBOLD("Show in Bold" OR CurrForm.Matrix.MatrixRec."Show in Bold");
                                                          END;

                                                 OnDrillDown=BEGIN
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1140038;TextBox   ;14300;2530 ;1650 ;440  ;Name=MatrixHeader;
                                                 ParentControl=1140037;
                                                 InMatrixHeading=Yes;
                                                 SourceExpr=MatrixHeader;
                                                 OnFormat=BEGIN
                                                            CurrForm.MatrixHeader.UPDATEFONTBOLD(CurrForm.Matrix.MatrixRec."Show in Bold");
                                                          END;

                                                 OnLookup=BEGIN
                                                            LookUpCode(ColumnDimOption,ColumnDimCode,CurrForm.Matrix.MatrixRec.Code);
                                                          END;
                                                           }
    { 1140039;CommandButton;5610;9240;550 ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 BitmapPos=Center;
                                                 AutoRepeat=Yes;
                                                 Bitmap=16;
                                                 ToolTipML=[ENU=Next Period;
                                                            ESP=Periodo siguiente];
                                                 OnPush=BEGIN
                                                          FindPeriod('>=');
                                                        END;
                                                         }
    { 1140040;CommandButton;5060;9240;550 ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 BitmapPos=Center;
                                                 AutoRepeat=Yes;
                                                 Bitmap=15;
                                                 ToolTipML=[ENU=Previous Period;
                                                            ESP=Periodo anterior];
                                                 OnPush=BEGIN
                                                          FindPeriod('<=');
                                                        END;
                                                         }
    { 1140041;OptionButton;4290;9240;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 Border=Yes;
                                                 BitmapPos=Center;
                                                 Bitmap=19;
                                                 ToolTipML=[ENU=Balance at Date;
                                                            ESP=Saldo a la fecha];
                                                 SourceExpr=AmountType;
                                                 OptionValue=Balance at Date;
                                                 OnPush=BEGIN
                                                          FindPeriod('');
                                                        END;
                                                         }
    { 1140042;OptionButton;3740;9240;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 Border=Yes;
                                                 BitmapPos=Center;
                                                 Bitmap=18;
                                                 ToolTipML=[ENU=Net Change;
                                                            ESP=Saldo periodo];
                                                 SourceExpr=AmountType;
                                                 OptionValue=Net Change;
                                                 OnPush=BEGIN
                                                          FindPeriod('');
                                                        END;
                                                         }
    { 1140043;OptionButton;2970;9240;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 Border=Yes;
                                                 BitmapPos=Center;
                                                 Bitmap=14;
                                                 ToolTipML=[ENU=Accounting Period;
                                                            ESP=Periodo contable];
                                                 SourceExpr=PeriodType;
                                                 OptionValue=Accounting Period;
                                                 OnPush=BEGIN
                                                          FindPeriod('');
                                                        END;
                                                         }
    { 1140044;OptionButton;2420;9240;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 Border=Yes;
                                                 BitmapPos=Center;
                                                 Bitmap=13;
                                                 ToolTipML=[ENU=Year;
                                                            ESP=A¤o];
                                                 SourceExpr=PeriodType;
                                                 OptionValue=Year;
                                                 OnPush=BEGIN
                                                          FindPeriod('');
                                                        END;
                                                         }
    { 1140045;OptionButton;1870;9240;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 Border=Yes;
                                                 BitmapPos=Center;
                                                 Bitmap=12;
                                                 ToolTipML=[ENU=Quarter;
                                                            ESP=Trimestre];
                                                 SourceExpr=PeriodType;
                                                 OptionValue=Quarter;
                                                 OnPush=BEGIN
                                                          FindPeriod('');
                                                        END;
                                                         }
    { 1140046;OptionButton;1320;9240;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 Border=Yes;
                                                 BitmapPos=Center;
                                                 Bitmap=11;
                                                 ToolTipML=[ENU=Month;
                                                            ESP=Mes];
                                                 SourceExpr=PeriodType;
                                                 OptionValue=Month;
                                                 OnPush=BEGIN
                                                          FindPeriod('');
                                                        END;
                                                         }
    { 1140047;OptionButton;770;9240 ;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 Border=Yes;
                                                 BitmapPos=Center;
                                                 Bitmap=10;
                                                 ToolTipML=[ENU=Week;
                                                            ESP=Semana];
                                                 SourceExpr=PeriodType;
                                                 OptionValue=Week;
                                                 OnPush=BEGIN
                                                          FindPeriod('');
                                                        END;
                                                         }
    { 1140048;OptionButton;220;9240 ;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 Border=Yes;
                                                 BitmapPos=Center;
                                                 Bitmap=9;
                                                 ToolTipML=[ENU=Day;
                                                            ESP=D¡a];
                                                 SourceExpr=PeriodType;
                                                 OptionValue=Day;
                                                 OnPush=BEGIN
                                                          FindPeriod('');
                                                        END;
                                                         }
    { 1140049;MenuButton;11660;9240 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=F&unctions;
                                                            ESP=Acci&ones];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=1140050;
                                                     CaptionML=[ENU=Reverse Lines and Columns;
                                                                ESP=Invertir l¡neas y columnas];
                                                     OnPush=VAR
                                                              TempDimCode@1140000 : Text[30];
                                                            BEGIN
                                                              TempDimCode := ColumnDimCode;
                                                              ColumnDimCode := LineDimCode;
                                                              LineDimCode := TempDimCode;
                                                              ValidateLineDimCode;
                                                              ValidateColumnDimCode;
                                                            END;
                                                             }
                                                   { ID=1140051;
                                                     CaptionML=[ENU=Export to Excel;
                                                                ESP=Exportar a Excel];
                                                     OnPush=VAR
                                                              AnalysisViewEntry@1140000 : Record 5055271;
                                                              LiqAnalysisViewToExcel@1140001 : Codeunit 5055267;
                                                            BEGIN
                                                              SetCommonFilters(AnalysisViewEntry);
                                                              AnalysisViewEntry.FIND('-');
                                                              LiqAnalysisViewToExcel.ExportData(
                                                                AnalysisViewEntry,LineDimCode,ColumnDimCode,ShowOppositeSign,
                                                                PeriodType,ShowColumnName, DateFilter,LiqAccFilter,
                                                                Dim1Filter, Dim2Filter, Dim3Filter, Dim4Filter, AmountType, ShowActual, LiquidityFilter);
                                                            END;
                                                             }
                                                 }
                                                  }
  }
  CODE
  {
    VAR
      Text1140000@1140000 : TextConst 'ENU=Period;ESP=Periodo';
      Text1140001@1140001 : TextConst 'ENU=<Sign><Integer Thousand><Decimals,2>;ESP=<Sign><Integer Thousand><Decimals,2>';
      Text1140002@1140002 : TextConst 'ENU=You have not yet defined an analysis view.;ESP=No tiene a£n definida una vista an lisis.';
      Text1140003@1140003 : TextConst 'ENU=%1 is not a valid line definition.;ESP=%1 no es una def. de l¡nea v lida.';
      Text1140004@1140004 : TextConst 'ENU=%1 is not a valid column definition.;ESP=%1 no es una def. de columna v lida.';
      Text1140005@1140005 : TextConst 'ENU=1,6,,Dimension 1 Filter;ESP=1,6,,Filtro dimensi¢n 1';
      Text1140006@1140006 : TextConst 'ENU=1,6,,Dimension 2 Filter;ESP=1,6,,Filtro dimensi¢n 2';
      Text1140007@1140007 : TextConst 'ENU=1,6,,Dimension 3 Filter;ESP=1,6,,Filtro dimensi¢n 3';
      Text1140008@1140008 : TextConst 'ENU=1,6,,Dimension 4 Filter;ESP=1,6,,Filtro dimensi¢n 4';
      GLSetup@1140009 : Record 98;
      LiqAcc@1140010 : Record 5055251;
      AnalysisView@1140011 : Record 5055269;
      AnalysisViewEntry@1140012 : Record 5055271;
      AVBreakdownBuffer@1140013 : TEMPORARY Record 375;
      LineDimOption@1140014 : 'Liquidity Account,Period,Liquidity,Dimension 1,Dimension 2,Dimension 3,Dimension 4';
      ColumnDimOption@1140015 : 'Liquidity Account,Period,Liquidity,Dimension 1,Dimension 2,Dimension 3,Dimension 4';
      PeriodType@1140016 : 'Day,Week,Month,Quarter,Year,Accounting Period';
      AmountType@1140017 : 'Net Change,Balance at Date';
      RoundingFactor@1140018 : 'None,1,1000,1000000';
      ShowActual@1140019 : 'Amounts';
      LineDimCode@1140020 : Text[30];
      ColumnDimCode@1140021 : Text[30];
      DateFilter@1140022 : Text[250];
      InternalDateFilter@1140023 : Text[250];
      LiquidityFilter@1140024 : Text[250];
      MatrixHeader@1140025 : Text[50];
      AnalysisViewCode@1140026 : Code[10];
      LiqAccFilter@1140027 : Code[250];
      Dim1Filter@1140028 : Code[250];
      Dim2Filter@1140029 : Code[250];
      Dim3Filter@1140030 : Code[250];
      Dim4Filter@1140031 : Code[250];
      MatrixAmount@1140032 : Decimal;
      ShowOppositeSign@1140033 : Boolean;
      ShowColumnName@1140034 : Boolean;
      PeriodInitialized@1140035 : Boolean;

    LOCAL PROCEDURE DimCodeToOption@1140000(DimCode@1140000 : Text[30]) : Integer;
    VAR
      Liquidity@1140001 : Record 5055250;
    BEGIN
      CASE DimCode OF
        '' :
          EXIT(-1);
        LiqAcc.TABLECAPTION :
          EXIT(0);
        Text1140000 :
          EXIT(1);
        Liquidity.TABLECAPTION :
          EXIT(2);
        AnalysisView."Dimension 1 Code" :
          EXIT(3);
        AnalysisView."Dimension 2 Code" :
          EXIT(4);
        AnalysisView."Dimension 3 Code" :
          EXIT(5);
        AnalysisView."Dimension 4 Code" :
          EXIT(6);
        ELSE
          EXIT(-1);
      END;
    END;

    LOCAL PROCEDURE FindRec@1140001(DimOption@1140000 : 'Liquidity Account,Period,Liquidity,Dimension 1,Dimension 2,Dimension 3,Dimension 4';VAR DimCodeBuf@1140001 : Record 367;Which@1140002 : Text[250]) : Boolean;
    VAR
      LiqAcc@1140003 : Record 5055251;
      Liquidity@1140004 : Record 5055250;
      Period@1140005 : Record 2000000007;
      DimVal@1140006 : Record 349;
      PeriodFormMgt@1140007 : Codeunit 359;
      Found@1140008 : Boolean;
    BEGIN
      CASE DimOption OF
        DimOption::"Liquidity Account" :
          BEGIN
            LiqAcc."No." := DimCodeBuf.Code;
            IF LiqAccFilter <> '' THEN
              LiqAcc.SETFILTER("No.",LiqAccFilter);
            Found := LiqAcc.FIND(Which);
            IF Found THEN
              CopyLiqAccToBuf(LiqAcc,DimCodeBuf);
          END;
        DimOption::Period :
          BEGIN
            IF NOT PeriodInitialized THEN
              DateFilter := '';
            PeriodInitialized := TRUE;
            Period."Period Start" := DimCodeBuf."Period Start";
            IF DateFilter <> '' THEN
              Period.SETFILTER("Period Start",DateFilter)
            ELSE
              IF NOT PeriodInitialized AND (InternalDateFilter <> '') THEN
                Period.SETFILTER("Period Start",InternalDateFilter);
            Found := PeriodFormMgt.FindDate(Which,Period,PeriodType);
            IF Found THEN
              CopyPeriodToBuf(Period,DimCodeBuf);
          END;
        DimOption::Liquidity :
          BEGIN
            Liquidity."No." := DimCodeBuf.Code;
            IF LiquidityFilter <> '' THEN
              Liquidity.SETFILTER("No.",LiquidityFilter);
            Found := Liquidity.FIND(Which);
            IF Found THEN
              CopyLiquidityToBuf(Liquidity,DimCodeBuf);
          END;
        DimOption::"Dimension 1" :
          BEGIN
            IF Dim1Filter <> '' THEN
              DimVal.SETFILTER(Code,Dim1Filter);
            DimVal."Dimension Code" := AnalysisView."Dimension 1 Code";
            DimVal.SETRANGE("Dimension Code",DimVal."Dimension Code");
            DimVal.Code := DimCodeBuf.Code;
            Found := DimVal.FIND(Which);
            IF Found THEN
              CopyDimValueToBuf(DimVal,DimCodeBuf);
          END;
        DimOption::"Dimension 2" :
          BEGIN
            IF Dim2Filter <> '' THEN
              DimVal.SETFILTER(Code,Dim2Filter);
            DimVal."Dimension Code" := AnalysisView."Dimension 2 Code";
            DimVal.SETRANGE("Dimension Code",DimVal."Dimension Code");
            DimVal.Code := DimCodeBuf.Code;
            Found := DimVal.FIND(Which);
            IF Found THEN
              CopyDimValueToBuf(DimVal,DimCodeBuf);
          END;
        DimOption::"Dimension 3" :
          BEGIN
            IF Dim3Filter <> '' THEN
              DimVal.SETFILTER(Code,Dim3Filter);
            DimVal."Dimension Code" := AnalysisView."Dimension 3 Code";
            DimVal.SETRANGE("Dimension Code",DimVal."Dimension Code");
            DimVal.Code := DimCodeBuf.Code;
            Found := DimVal.FIND(Which);
            IF Found THEN
              CopyDimValueToBuf(DimVal,DimCodeBuf);
          END;
        DimOption::"Dimension 4" :
          BEGIN
            IF Dim4Filter <> '' THEN
              DimVal.SETFILTER(Code,Dim4Filter);
            DimVal."Dimension Code" := AnalysisView."Dimension 4 Code";
            DimVal.SETRANGE("Dimension Code",DimVal."Dimension Code");
            DimVal.Code := DimCodeBuf.Code;
            Found := DimVal.FIND(Which);
            IF Found THEN
              CopyDimValueToBuf(DimVal,DimCodeBuf);
          END;
      END;
      EXIT(Found);
    END;

    LOCAL PROCEDURE NextRec@1140002(DimOption@1140000 : 'Liquidity Account,Period,Liquidity,Dimension 1,Dimension 2,Dimension 3,Dimension 4';VAR DimCodeBuf@1140001 : Record 367;Steps@1140002 : Integer) : Integer;
    VAR
      LiqAcc@1140003 : Record 5055251;
      Liquidity@1140004 : Record 5055250;
      Period@1140005 : Record 2000000007;
      DimVal@1140006 : Record 349;
      PeriodFormMgt@1140007 : Codeunit 359;
      ResultSteps@1140008 : Integer;
    BEGIN
      CASE DimOption OF
        DimOption::"Liquidity Account" :
          BEGIN
            LiqAcc."No." := DimCodeBuf.Code;
            IF LiqAccFilter <> '' THEN
              LiqAcc.SETFILTER("No.",LiqAccFilter);
            ResultSteps := LiqAcc.NEXT(Steps);
            IF ResultSteps <> 0 THEN
              CopyLiqAccToBuf(LiqAcc,DimCodeBuf);
          END;
        DimOption::Period :
          BEGIN
            IF DateFilter <> '' THEN
              Period.SETFILTER("Period Start",DateFilter);
            Period."Period Start" := DimCodeBuf."Period Start";
            ResultSteps := PeriodFormMgt.NextDate(Steps,Period,PeriodType);
            IF ResultSteps <> 0 THEN
              CopyPeriodToBuf(Period,DimCodeBuf);
          END;
        DimOption::Liquidity :
          BEGIN
            Liquidity."No." := DimCodeBuf.Code;
            IF LiquidityFilter <> '' THEN
              Liquidity.SETFILTER("No.",LiquidityFilter);
            ResultSteps := Liquidity.NEXT(Steps);
            IF ResultSteps <> 0 THEN
              CopyLiquidityToBuf(Liquidity,DimCodeBuf);
          END;
        DimOption::"Dimension 1" :
          BEGIN
            IF Dim1Filter <> '' THEN
              DimVal.SETFILTER(Code,Dim1Filter);
            DimVal."Dimension Code" := AnalysisView."Dimension 1 Code";
            DimVal.SETRANGE("Dimension Code",DimVal."Dimension Code");
            DimVal.Code := DimCodeBuf.Code;
            ResultSteps := DimVal.NEXT(Steps);
            IF ResultSteps <> 0 THEN
              CopyDimValueToBuf(DimVal,DimCodeBuf);
          END;
        DimOption::"Dimension 2" :
          BEGIN
            IF Dim2Filter <> '' THEN
              DimVal.SETFILTER(Code,Dim2Filter);
            DimVal."Dimension Code" := AnalysisView."Dimension 2 Code";
            DimVal.SETRANGE("Dimension Code",DimVal."Dimension Code");
            DimVal.Code := DimCodeBuf.Code;
            ResultSteps := DimVal.NEXT(Steps);
            IF ResultSteps <> 0 THEN
              CopyDimValueToBuf(DimVal,DimCodeBuf);
          END;
        DimOption::"Dimension 3" :
          BEGIN
            IF Dim3Filter <> '' THEN
              DimVal.SETFILTER(Code,Dim3Filter);
            DimVal."Dimension Code" := AnalysisView."Dimension 3 Code";
            DimVal.SETRANGE("Dimension Code",DimVal."Dimension Code");
            DimVal.Code := DimCodeBuf.Code;
            ResultSteps := DimVal.NEXT(Steps);
            IF ResultSteps <> 0 THEN
              CopyDimValueToBuf(DimVal,DimCodeBuf);
          END;
        DimOption::"Dimension 4" :
          BEGIN
            IF Dim4Filter <> '' THEN
              DimVal.SETFILTER(Code,Dim4Filter);
            DimVal."Dimension Code" := AnalysisView."Dimension 4 Code";
            DimVal.SETRANGE("Dimension Code",DimVal."Dimension Code");
            DimVal.Code := DimCodeBuf.Code;
            ResultSteps := DimVal.NEXT(Steps);
            IF ResultSteps <> 0 THEN
              CopyDimValueToBuf(DimVal,DimCodeBuf);
          END;
      END;
      EXIT(ResultSteps);
    END;

    LOCAL PROCEDURE CopyLiqAccToBuf@1140003(VAR TheLiqAcc@1140000 : Record 5055251;VAR TheDimCodeBuf@1140001 : Record 367);
    BEGIN
      WITH TheDimCodeBuf DO BEGIN
        INIT;
        Code := TheLiqAcc."No.";
        Name := TheLiqAcc.Name;
        Totaling := TheLiqAcc.Totaling;
        Indentation := TheLiqAcc.Indentation;
        "Show in Bold" := TheLiqAcc."Account Type" <> TheLiqAcc."Account Type"::Posting;
      END;
    END;

    LOCAL PROCEDURE CopyPeriodToBuf@1140004(VAR ThePeriod@1140000 : Record 2000000007;VAR TheDimCodeBuf@1140001 : Record 367);
    VAR
      Period2@1140002 : Record 2000000007;
    BEGIN
      WITH TheDimCodeBuf DO BEGIN
        INIT;
        Code := FORMAT(ThePeriod."Period Start");
        "Period Start" := ThePeriod."Period Start";
        "Period End" := ThePeriod."Period End";
        IF DateFilter <> '' THEN BEGIN
          Period2.SETFILTER("Period End",DateFilter);
          IF Period2.GETRANGEMAX("Period End") < "Period End" THEN
            "Period End" := Period2.GETRANGEMAX("Period End");
        END;
        Name := ThePeriod."Period Name";
      END;
    END;

    LOCAL PROCEDURE CopyLiquidityToBuf@1140005(VAR TheLiquidity@1140000 : Record 5055250;VAR TheDimCodeBuf@1140001 : Record 367);
    BEGIN
      WITH TheDimCodeBuf DO BEGIN
        INIT;
        Code := TheLiquidity."No.";
        Name := TheLiquidity.Description;
      END;
    END;

    LOCAL PROCEDURE CopyDimValueToBuf@1140006(VAR TheDimVal@1140000 : Record 349;VAR TheDimCodeBuf@1140001 : Record 367);
    BEGIN
      WITH TheDimCodeBuf DO BEGIN
        INIT;
        Code := TheDimVal.Code;
        Name := TheDimVal.Name;
        Totaling := TheDimVal.Totaling;
        Indentation := TheDimVal.Indentation;
        "Show in Bold" :=
          TheDimVal."Dimension Value Type" <> TheDimVal."Dimension Value Type"::Standard;
      END;
    END;

    LOCAL PROCEDURE FindPeriod@1140007(SearchText@1140000 : Code[10]);
    VAR
      Calendar@1140001 : Record 2000000007;
      PeriodFormMgt@1140002 : Codeunit 359;
    BEGIN
      IF DateFilter <> '' THEN BEGIN
        Calendar.SETFILTER("Period Start",DateFilter);
        IF NOT PeriodFormMgt.FindDate('+',Calendar,PeriodType) THEN
          PeriodFormMgt.FindDate('+',Calendar,PeriodType::Day);
        Calendar.SETRANGE("Period Start");
      END;
      IF PeriodFormMgt.FindDate(SearchText,Calendar,PeriodType) THEN;
      IF AmountType = AmountType::"Net Change" THEN BEGIN
        AnalysisViewEntry.SETRANGE("Liquidity Date",Calendar."Period Start",Calendar."Period End");
        IF AnalysisViewEntry.GETRANGEMIN("Liquidity Date") = AnalysisViewEntry.GETRANGEMAX("Liquidity Date") THEN
          AnalysisViewEntry.SETRANGE("Liquidity Date",AnalysisViewEntry.GETRANGEMIN("Liquidity Date"));
      END ELSE
        AnalysisViewEntry.SETRANGE("Liquidity Date",0D,Calendar."Period End");

      InternalDateFilter := AnalysisViewEntry.GETFILTER("Liquidity Date");
      IF (LineDimOption <> LineDimOption::Period) AND (ColumnDimOption <> ColumnDimOption::Period) THEN
        DateFilter := InternalDateFilter;
      AVBreakdownBuffer.DELETEALL;
    END;

    LOCAL PROCEDURE FormatAmount@1140008(VAR Text@1140000 : Text[250]);
    VAR
      Amount@1140001 : Decimal;
    BEGIN
      IF Text = '' THEN
        EXIT;

      EVALUATE(Amount,Text);


      IF RoundingFactor = RoundingFactor::None THEN
        EXIT;

      CASE RoundingFactor OF
        RoundingFactor::"1":
          Amount := ROUND(Amount,1);
        RoundingFactor::"1000":
          Amount := ROUND(Amount / 1000,0.1);
        RoundingFactor::"1000000":
          Amount := ROUND(Amount / 1000000,0.1);
      END;
      IF Amount = 0 THEN
        Text := ''
      ELSE
        CASE RoundingFactor OF
          RoundingFactor::"1":
            Text := FORMAT(Amount);
          RoundingFactor::"1000",RoundingFactor::"1000000":
            Text := FORMAT(Amount,0,Text1140001);
        END;
    END;

    LOCAL PROCEDURE GetDimSelection@1140009(OldDimSelCode@1140000 : Text[30]) : Text[30];
    VAR
      DimSelection@1140001 : Form 568;
    BEGIN
      DimSelection.InsertDimSelBuf(FALSE,LiqAcc.TABLECAPTION,LiqAcc.TABLECAPTION);
      DimSelection.InsertDimSelBuf(FALSE,Text1140000,Text1140000);
      IF AnalysisView."Dimension 1 Code" <> '' THEN
        DimSelection.InsertDimSelBuf(FALSE,AnalysisView."Dimension 1 Code",'');
      IF AnalysisView."Dimension 2 Code" <> '' THEN
        DimSelection.InsertDimSelBuf(FALSE,AnalysisView."Dimension 2 Code",'');
      IF AnalysisView."Dimension 3 Code" <> '' THEN
        DimSelection.InsertDimSelBuf(FALSE,AnalysisView."Dimension 3 Code",'');
      IF AnalysisView."Dimension 4 Code" <> '' THEN
        DimSelection.InsertDimSelBuf(FALSE,AnalysisView."Dimension 4 Code",'');

      DimSelection.LOOKUPMODE := TRUE;
      IF DimSelection.RUNMODAL = ACTION::LookupOK THEN
        EXIT(DimSelection.GetDimSelCode)
      ELSE
        EXIT(OldDimSelCode);
    END;

    LOCAL PROCEDURE LookUpCode@1140010(DimOption@1140000 : 'Liquidity Account,Period,Liquidity,Dimension 1,Dimension 2,Dimension 3,Dimension 4';DimCode@1140001 : Text[30];Code@1140002 : Text[30]);
    VAR
      LiqAcc@1140003 : Record 5055251;
      Liquidity@1140004 : Record 5055250;
      DimVal@1140005 : Record 349;
      DimValList@1140006 : Form 560;
    BEGIN
      CASE DimOption OF
        DimOption::"Liquidity Account" :
          BEGIN
            LiqAcc.GET(Code);
            FORM.RUNMODAL(FORM::"Liquidity Account List",LiqAcc);
          END;
        DimOption::Period : ;
        DimOption::Liquidity :
          BEGIN
            Liquidity.GET(Code);
            FORM.RUNMODAL(FORM::"Liquidity List",Liquidity);
          END;
        DimOption::"Dimension 1",DimOption::"Dimension 2",
        DimOption::"Dimension 3",DimOption::"Dimension 4" :
          BEGIN
            DimVal.SETRANGE("Dimension Code",DimCode);
            DimVal.GET(DimCode,Code);
            DimValList.SETTABLEVIEW(DimVal);
            DimValList.SETRECORD(DimVal);
            DimValList.RUNMODAL;
          END;
      END;
    END;

    LOCAL PROCEDURE LookUpDimFilter@1140011(Dim@1140000 : Code[20];VAR Text@1140001 : Text[250]) : Boolean;
    VAR
      DimVal@1140002 : Record 349;
      DimValList@1140003 : Form 560;
    BEGIN
      IF Dim = '' THEN
        EXIT(FALSE);
      DimValList.LOOKUPMODE(TRUE);
      DimVal.SETRANGE("Dimension Code",Dim);
      DimValList.SETTABLEVIEW(DimVal);
      IF DimValList.RUNMODAL = ACTION::LookupOK THEN BEGIN
        DimValList.GETRECORD(DimVal);
        Text := DimValList.GetSelectionFilter;
        EXIT(TRUE);
      END ELSE
        EXIT(FALSE)
    END;

    LOCAL PROCEDURE SetCommonFilters@1140012(VAR TheAnalysisViewEntry@1140000 : Record 5055271);
    VAR
      DateFilter2@1140001 : Text[1024];
    BEGIN
      WITH TheAnalysisViewEntry DO BEGIN
        RESET;
        SETRANGE("Analysis View Code",AnalysisView.Code);
        IF LiquidityFilter <> '' THEN
          SETFILTER("Liquidity No.",LiquidityFilter);
        IF LiqAccFilter <> '' THEN
          SETFILTER("Liquidity Account No.",LiqAccFilter);
        IF DateFilter = '' THEN
          SETFILTER("Liquidity Date",DateFilter);
        IF Dim1Filter <> '' THEN
          SETFILTER("Dimension 1 Value Code",Dim1Filter);
        IF Dim2Filter <> '' THEN
          SETFILTER("Dimension 2 Value Code",Dim2Filter);
        IF Dim3Filter <> '' THEN
          SETFILTER("Dimension 3 Value Code",Dim3Filter);
        IF Dim4Filter <> '' THEN
          SETFILTER("Dimension 4 Value Code",Dim4Filter);
        SETPERMISSIONFILTER;
      END;
    END;

    LOCAL PROCEDURE SetDimFilters@1140013(VAR TheAnalysisViewEntry@1140000 : Record 5055271;LineOrColumn@1140001 : 'Line,Column');
    VAR
      DimOption@1140002 : 'Liquidity Account,Period,Liquidity,Dimension 1,Dimension 2,Dimension 3,Dimension 4';
      DimCodeBuf@1140003 : Record 367;
    BEGIN
      IF LineOrColumn = LineOrColumn::Line THEN BEGIN
        DimCodeBuf := Rec;
        DimOption := LineDimOption;
      END ELSE BEGIN
        DimCodeBuf := CurrForm.Matrix.MatrixRec;
        DimOption := ColumnDimOption;
      END;
      CASE DimOption OF
        DimOption::"Liquidity Account" :
          IF DimCodeBuf.Totaling = '' THEN
            TheAnalysisViewEntry.SETRANGE("Liquidity Account No.",DimCodeBuf.Code)
          ELSE
            TheAnalysisViewEntry.SETFILTER("Liquidity Account No.",DimCodeBuf.Totaling);
        DimOption::Period :
          BEGIN
            IF AmountType = AmountType::"Net Change" THEN
              TheAnalysisViewEntry.SETRANGE(
                "Liquidity Date",DimCodeBuf."Period Start",DimCodeBuf."Period End")
            ELSE
              TheAnalysisViewEntry.SETRANGE("Liquidity Date",0D,DimCodeBuf."Period End");
          END;
        DimOption::Liquidity :
          TheAnalysisViewEntry.SETRANGE("Liquidity No.",DimCodeBuf.Code);
        DimOption::"Dimension 1" :
          IF DimCodeBuf.Totaling = '' THEN
            TheAnalysisViewEntry.SETRANGE("Dimension 1 Value Code",DimCodeBuf.Code)
          ELSE
            TheAnalysisViewEntry.SETFILTER("Dimension 1 Value Code",DimCodeBuf.Totaling);
        DimOption::"Dimension 2" :
          IF DimCodeBuf.Totaling = '' THEN
            TheAnalysisViewEntry.SETRANGE("Dimension 2 Value Code",DimCodeBuf.Code)
          ELSE
            TheAnalysisViewEntry.SETFILTER("Dimension 2 Value Code",DimCodeBuf.Totaling);
        DimOption::"Dimension 3" :
          IF DimCodeBuf.Totaling = '' THEN
            TheAnalysisViewEntry.SETRANGE("Dimension 3 Value Code",DimCodeBuf.Code)
          ELSE
            TheAnalysisViewEntry.SETFILTER("Dimension 3 Value Code",DimCodeBuf.Totaling);
        DimOption::"Dimension 4" :
          IF DimCodeBuf.Totaling = '' THEN
            TheAnalysisViewEntry.SETRANGE("Dimension 4 Value Code",DimCodeBuf.Code)
          ELSE
            TheAnalysisViewEntry.SETFILTER("Dimension 4 Value Code",DimCodeBuf.Totaling);
      END;
      TheAnalysisViewEntry.SETPERMISSIONFILTER;
    END;

    LOCAL PROCEDURE DrillDown@1140014(SetColFilter@1140000 : Boolean);
    BEGIN
      IF ShowActual = ShowActual::Amounts THEN BEGIN
        SetCommonFilters(AnalysisViewEntry);
        SetDimFilters(AnalysisViewEntry,0);
        IF SetColFilter THEN
          SetDimFilters(AnalysisViewEntry,1);
        FORM.RUN(FORM::"Liq. Analysis View Entries",AnalysisViewEntry);
      END;
    END;

    LOCAL PROCEDURE ValidateAnalysisViewCode@1140015();
    VAR
      AnalysisViewFilter@1140000 : Record 5055270;
    BEGIN
      AnalysisView.Code := AnalysisViewCode;
      IF NOT AnalysisView.FIND('=<>') THEN
        ERROR(Text1140002);
      AnalysisViewCode := AnalysisView.Code;
      LiqAccFilter := AnalysisView."Liquidity Account Filter";
      Dim1Filter := '';
      Dim2Filter := '';
      Dim3Filter := '';
      Dim4Filter := '';
      SETPERMISSIONFILTER;
      Dim1Filter := GETFILTER("Dimension 1 Value Filter");
      Dim2Filter := GETFILTER("Dimension 2 Value Filter");
      Dim3Filter := GETFILTER("Dimension 3 Value Filter");
      Dim4Filter := GETFILTER("Dimension 4 Value Filter");

      CurrForm.Dim1Filter.ENABLED :=
        (AnalysisView."Dimension 1 Code" <> '') AND
        (GETFILTER("Dimension 1 Value Filter") = '');
      CurrForm.Dim2Filter.ENABLED :=
        (AnalysisView."Dimension 2 Code" <> '') AND
        (GETFILTER("Dimension 2 Value Filter") = '');
      CurrForm.Dim3Filter.ENABLED :=
        (AnalysisView."Dimension 3 Code" <> '') AND
        (GETFILTER("Dimension 3 Value Filter") = '');
      CurrForm.Dim4Filter.ENABLED :=
        (AnalysisView."Dimension 4 Code" <> '') AND
        (GETFILTER("Dimension 4 Value Filter") = '');

      IF CurrForm.Dim1Filter.ENABLED THEN
        IF AnalysisViewFilter.GET(AnalysisView.Code,AnalysisView."Dimension 1 Code") THEN
          Dim1Filter := AnalysisViewFilter."Dimension Value Filter";

      IF CurrForm.Dim2Filter.ENABLED THEN
        IF AnalysisViewFilter.GET(AnalysisView.Code,AnalysisView."Dimension 2 Code") THEN
          Dim2Filter := AnalysisViewFilter."Dimension Value Filter";

      IF CurrForm.Dim3Filter.ENABLED THEN
        IF AnalysisViewFilter.GET(AnalysisView.Code,AnalysisView."Dimension 3 Code") THEN
          Dim3Filter := AnalysisViewFilter."Dimension Value Filter";

      IF CurrForm.Dim4Filter.ENABLED THEN
        IF AnalysisViewFilter.GET(AnalysisView.Code,AnalysisView."Dimension 4 Code") THEN
          Dim4Filter := AnalysisViewFilter."Dimension Value Filter";
    END;

    LOCAL PROCEDURE ValidateLineDimCode@1140016();
    VAR
      Liquidity@1140000 : Record 5055250;
    BEGIN
      IF (UPPERCASE(LineDimCode) <> UPPERCASE(LiqAcc.TABLECAPTION)) AND
         (UPPERCASE(LineDimCode) <> UPPERCASE(Liquidity.TABLECAPTION)) AND
         (UPPERCASE(LineDimCode) <> UPPERCASE(Text1140000)) AND
         (UPPERCASE(LineDimCode) <> AnalysisView."Dimension 1 Code") AND
         (UPPERCASE(LineDimCode) <> AnalysisView."Dimension 2 Code") AND
         (UPPERCASE(LineDimCode) <> AnalysisView."Dimension 3 Code") AND
         (UPPERCASE(LineDimCode) <> AnalysisView."Dimension 4 Code") AND
         (LineDimCode <> '') THEN BEGIN
        MESSAGE(Text1140003,LineDimCode);
        LineDimCode := '';
      END;
      LineDimOption := DimCodeToOption(LineDimCode);
      InternalDateFilter := AnalysisViewEntry.GETFILTER("Liquidity Date");
      IF (LineDimOption <> LineDimOption::Period) AND (ColumnDimOption <> ColumnDimOption::Period) THEN BEGIN
        DateFilter := InternalDateFilter;
        IF STRPOS(DateFilter,'&') > 1 THEN
          DateFilter := COPYSTR(DateFilter,1,STRPOS(DateFilter,'&') - 1);
      END ELSE
        PeriodInitialized := FALSE;
    END;

    LOCAL PROCEDURE ValidateColumnDimCode@1140017();
    VAR
      Liquidity@1140000 : Record 5055250;
    BEGIN
      IF (UPPERCASE(ColumnDimCode) <> UPPERCASE(LiqAcc.TABLECAPTION)) AND
         (UPPERCASE(ColumnDimCode) <> UPPERCASE(Liquidity.TABLECAPTION)) AND
         (UPPERCASE(ColumnDimCode) <> UPPERCASE(Text1140000)) AND
         (UPPERCASE(ColumnDimCode) <> AnalysisView."Dimension 1 Code") AND
         (UPPERCASE(ColumnDimCode) <> AnalysisView."Dimension 2 Code") AND
         (UPPERCASE(ColumnDimCode) <> AnalysisView."Dimension 3 Code") AND
         (UPPERCASE(ColumnDimCode) <> AnalysisView."Dimension 4 Code") AND
         (ColumnDimCode <> '') THEN BEGIN
        MESSAGE(Text1140004,ColumnDimCode);
        ColumnDimCode := '';
      END;
      ColumnDimOption := DimCodeToOption(ColumnDimCode);
      InternalDateFilter := AnalysisViewEntry.GETFILTER("Liquidity Date");
      IF (LineDimOption <> LineDimOption::Period) AND (ColumnDimOption <> ColumnDimOption::Period) THEN BEGIN
        DateFilter := InternalDateFilter;
        IF STRPOS(DateFilter,'&') > 1 THEN
          DateFilter := COPYSTR(DateFilter,1,STRPOS(DateFilter,'&') - 1);
      END ELSE
        PeriodInitialized := FALSE;
    END;

    LOCAL PROCEDURE CalcAmount@1140018(SetColFilter@1140000 : Boolean) : Decimal;
    VAR
      Amount@1140001 : Decimal;
      ColumnCode@1140002 : Code[20];
    BEGIN
      IF SetColFilter THEN
        ColumnCode := CurrForm.Matrix.MatrixRec.Code
      ELSE
        ColumnCode := '';
      IF AVBreakdownBuffer.GET(Code,ColumnCode) THEN
        EXIT(AVBreakdownBuffer.Amount);

      CASE ShowActual OF
        ShowActual::Amounts:
          Amount := CalcActualAmount(SetColFilter);
      END;

      IF ShowOppositeSign THEN
        Amount := -Amount;

      AVBreakdownBuffer."Line Code" := Code;
      AVBreakdownBuffer."Column Code" := ColumnCode;
      AVBreakdownBuffer.Amount := Amount;
      AVBreakdownBuffer.INSERT;

      EXIT(Amount);
    END;

    LOCAL PROCEDURE CalcActualAmount@1140019(SetColFilter@1140000 : Boolean) : Decimal;
    VAR
      Amount@1140001 : Decimal;
    BEGIN
      AnalysisViewEntry.RESET;
      SetCommonFilters(AnalysisViewEntry);
      SetDimFilters(AnalysisViewEntry,0);
      IF SetColFilter THEN
        SetDimFilters(AnalysisViewEntry,1);

      AnalysisViewEntry.CALCSUMS(Amount);
      Amount := AnalysisViewEntry.Amount;

      EXIT(Amount);
    END;

    LOCAL PROCEDURE GetCaptionClass@1140020(AnalysisViewDimType@1140000 : Integer) : Text[250];
    BEGIN
      IF AnalysisView.Code <> AnalysisViewCode THEN
        AnalysisView.GET(AnalysisViewCode);
      CASE AnalysisViewDimType OF
        1:
          BEGIN
            IF AnalysisView."Dimension 1 Code" <> '' THEN
              EXIT('1,6,' + AnalysisView."Dimension 1 Code")
            ELSE
              EXIT(Text1140005);
          END;
        2:
          BEGIN
            IF AnalysisView."Dimension 2 Code" <> '' THEN
              EXIT('1,6,' + AnalysisView."Dimension 2 Code")
            ELSE
              EXIT(Text1140006);
          END;
        3:
          BEGIN
            IF AnalysisView."Dimension 3 Code" <> '' THEN
              EXIT('1,6,' + AnalysisView."Dimension 3 Code")
            ELSE
              EXIT(Text1140007);
          END;
        4:
          BEGIN
            IF AnalysisView."Dimension 4 Code" <> '' THEN
              EXIT('1,6,' + AnalysisView."Dimension 4 Code")
            ELSE
              EXIT(Text1140008);
          END;
      END;
    END;

    LOCAL PROCEDURE ShownCurrency@1140021() : Code[10];
    BEGIN
      EXIT('');
    END;

    BEGIN
    END.
  }
}
