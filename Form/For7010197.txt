OBJECT Form 7010197 Tabla Servicio Generado
{
  OBJECT-PROPERTIES
  {
    Date=07/05/15;
    Time=18:25:17;
    Modified=Yes;
    Version List=AIC2009;
  }
  PROPERTIES
  {
    Width=24640;
    Height=13420;
    Editable=No;
    CaptionML=[ENU=Generated service List;
               ESP=Tabla Servicio Generado];
    TableBoxID=1;
    SourceTable=Table7010163;
    SourceTableView=SORTING(Estado,Fecha,Zona Excursion,Excursion)
                    WHERE(Estado=CONST(Generada));
    OnOpenForm=VAR
                 lrConfCol@1103355000 : Record 7009822;
                 lwCont@1103355001 : Integer;
               BEGIN
                 CLEAR(wClave);
                 CLEAR(lrConfCol);
                 lrConfCol.SETCURRENTKEY("Rango Desde","Rango Hasta");
                 lrConfCol.SETRANGE(Tipo, lrConfCol.Tipo::Excursiones);
                 IF lrConfCol.FINDSET THEN BEGIN
                   CLEAR(lwCont);
                   REPEAT
                     IF lrConfCol."Codigo Color" <> 0 THEN
                       wClave[lrConfCol."Codigo Color"] := STRSUBSTNO('%1-%2',lrConfCol."Rango Desde",lrConfCol."Rango Hasta");
                   UNTIL (lrConfCol.NEXT=0) OR (lwCont=10);
                 END;
                 // $001
                 FiltraOficinaUsuario;
               END;

  }
  CONTROLS
  {
    { 1   ;TableBox     ;220  ;220  ;24200;12210;HorzGlue=Both;
                                                 VertGlue=Both;
                                                 HeadingHeight=880 }
    { 14  ;TextBox      ;0    ;0    ;1640 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Fecha;
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm.Fecha.UPDATEFORECOLOR(wColor);
                                                            CurrForm.Fecha.UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 15  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=14;
                                                 InColumnHeading=Yes }
    { 4   ;TextBox      ;0    ;0    ;1273 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="N§ Servicio";
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm."N§ Servicio".UPDATEFORECOLOR(wColor);
                                                            CurrForm."N§ Servicio".UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 5   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=4;
                                                 InColumnHeading=Yes }
    { 6   ;CheckBox     ;0    ;0    ;1103 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 ShowCaption=No;
                                                 SourceExpr=Errores }
    { 7   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=6;
                                                 InColumnHeading=Yes }
    { 8   ;CheckBox     ;0    ;0    ;1553 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 ShowCaption=No;
                                                 SourceExpr="Pendiente Recalcular" }
    { 9   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=8;
                                                 InColumnHeading=Yes }
    { 10  ;CheckBox     ;0    ;0    ;1100 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 ShowCaption=No;
                                                 SourceExpr="Peticion servicio impresa" }
    { 11  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=10;
                                                 InColumnHeading=Yes }
    { 16  ;TextBox      ;0    ;0    ;2407 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Excursion;
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm.Excursion.UPDATEFORECOLOR(wColor);
                                                            CurrForm.Excursion.UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 17  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=16;
                                                 InColumnHeading=Yes }
    { 1100217002;TextBox;10901;1980 ;4075 ;440  ;Name=NomExcursion;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 CaptionML=[ENU=Excursion Name;
                                                            ESP=Nombre Excursion];
                                                 SourceExpr=cNom.nom_producto(Excursion);
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm.NomExcursion.UPDATEFORECOLOR(wColor);
                                                            CurrForm.NomExcursion.UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 1100217003;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100217002;
                                                 InColumnHeading=Yes }
    { 1000000000;TextBox;12409;550  ;1067 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Turno excursion" }
    { 1000000001;Label  ;0    ;0    ;0    ;0    ;ParentControl=1000000000;
                                                 InColumnHeading=Yes }
    { 60  ;TextBox      ;8520 ;660  ;3602 ;440  ;Name=Transportista1;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 CaptionML=[ENU=Carrier;
                                                            ESP=Transportista];
                                                 SourceExpr=nom_transportista;
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm.Transportista1.UPDATEFORECOLOR(wColor);
                                                            CurrForm.Transportista1.UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 61  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=60;
                                                 InColumnHeading=Yes }
    { 18  ;TextBox      ;0    ;0    ;1650 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Guia Oficial";
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm."Guia Oficial".UPDATEFORECOLOR(wColor);
                                                            CurrForm."Guia Oficial".UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 19  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=18;
                                                 InColumnHeading=Yes }
    { 24  ;TextBox      ;0    ;0    ;1320 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Reservas Anuladas";
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm."Reservas Anuladas".UPDATEFORECOLOR(wColor);
                                                            CurrForm."Reservas Anuladas".UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 25  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=24;
                                                 InColumnHeading=Yes }
    { 26  ;TextBox      ;0    ;0    ;1100 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="N§ Adultos";
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm."N§ Adultos".UPDATEFORECOLOR(wColor);
                                                            CurrForm."N§ Adultos".UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 27  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=26;
                                                 InColumnHeading=Yes }
    { 28  ;TextBox      ;0    ;0    ;880  ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="N§ Ni¤os";
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm."N§ Ni¤os".UPDATEFORECOLOR(wColor);
                                                            CurrForm."N§ Ni¤os".UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 29  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=28;
                                                 InColumnHeading=Yes }
    { 1100217006;Indicator;21643;5720;2750;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 CaptionML=[ENU=Benefit;
                                                            ESP=Beneficio];
                                                 SourceExpr="Margen Beneficio"*100 }
    { 1100217007;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100217006;
                                                 InColumnHeading=Yes }
    { 36  ;TextBox      ;0    ;0    ;2420 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Duracion;
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm.Duracion.UPDATEFORECOLOR(wColor);
                                                            CurrForm.Duracion.UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 37  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=36;
                                                 InColumnHeading=Yes }
    { 1000000008;TextBox;32306;660  ;2034 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Venta - Adultos Invitados" }
    { 1000000009;Label  ;0    ;0    ;0    ;0    ;ParentControl=1000000008;
                                                 InColumnHeading=Yes }
    { 1000000010;TextBox;33443;1870 ;1870 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Venta - Ni¤os Invitados" }
    { 1000000011;Label  ;0    ;0    ;0    ;0    ;ParentControl=1000000010;
                                                 InColumnHeading=Yes }
    { 1000000003;TextBox;32992;3080 ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Compra - Adultos Invitados";
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm."Compra - Adultos Invitados".UPDATEFORECOLOR(wColor);
                                                            CurrForm."Compra - Adultos Invitados".UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 1000000005;Label  ;0    ;0    ;0    ;0    ;ParentControl=1000000003;
                                                 InColumnHeading=Yes }
    { 1000000006;TextBox;34642;3080 ;1540 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Compra - Ni¤os Invitados";
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm."Compra - Ni¤os Invitados".UPDATEFORECOLOR(wColor);
                                                            CurrForm."Compra - Ni¤os Invitados".UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 1000000007;Label  ;0    ;0    ;0    ;0    ;ParentControl=1000000006;
                                                 InColumnHeading=Yes }
    { 75  ;TextBox      ;27196;770  ;3080 ;440  ;Name=Margen1;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 CaptionML=[ENU=Margin;
                                                            ESP=Margen];
                                                 SourceExpr=rConfC.GetTexto("Margen Beneficio",rConfC.Tipo::Excursiones);
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm.Margen1.UPDATEFORECOLOR(wColor);
                                                            CurrForm.Margen1.UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 76  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=75;
                                                 InColumnHeading=Yes }
    { 1100253001;TextBox;18098;3630 ;1700 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 HorzAlign=Center;
                                                 SourceExpr=Soportes;
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm.Soportes.UPDATEFORECOLOR(wColor);
                                                            CurrForm.Soportes.UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 1100253002;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253001;
                                                 InColumnHeading=Yes }
    { 1100217000;TextBox;8731 ;2420 ;1896 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Oficina;
                                                 OnFormat=BEGIN
                                                            BuscaColor;
                                                            CurrForm.Oficina.UPDATEFORECOLOR(wColor);
                                                            CurrForm.Oficina.UPDATEFONTBOLD(wColor=1);
                                                          END;
                                                           }
    { 1100217001;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100217000;
                                                 InColumnHeading=Yes }
    { 38  ;CommandButton;14960;12650;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Default=Yes;
                                                 PushAction=LookupOK;
                                                 InvalidActionAppearance=Hide }
    { 39  ;CommandButton;17380;12650;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Cancel=Yes;
                                                 PushAction=LookupCancel;
                                                 InvalidActionAppearance=Hide }
    { 40  ;CommandButton;22220;12650;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 41  ;MenuButton   ;19800;12650;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=&Service;
                                                            ESP=&Servicio];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=45;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Ctrl+F5;
                                                     CaptionML=[ENU=Card;
                                                                ESP=Ficha];
                                                     RunObject=Form 7010198;
                                                     RunFormOnRec=Yes;
                                                     RunFormView=SORTING(Delegacion,N§ Servicio);
                                                     RunFormLink=Delegacion=FIELD(Delegacion),
                                                                 N§ Servicio=FIELD(N§ Servicio) }
                                                   { ID=46;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=Reservations;
                                                                ESP=Reservas];
                                                     RunObject=Form 7010199;
                                                     RunFormView=SORTING(N§ Servicio,TourOperador,Zona Hotel,Guia Venta);
                                                     RunFormLink=N§ Servicio=FIELD(N§ Servicio) }
                                                   { ID=69;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=Errors;
                                                                ESP=Errores];
                                                     RunObject=Form 7010195;
                                                     RunFormLink=Servicio=FIELD(N§ Servicio) }
                                                   { ID=1000000004;
                                                     MenuItemType=Separator }
                                                   { ID=47;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=Provisions;
                                                                ESP=Prestaciones];
                                                     RunObject=Form 7010193;
                                                     RunFormLink=Delegacion=FIELD(Delegacion),
                                                                 N§ Servicio=FIELD(N§ Servicio) }
                                                   { ID=49;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=Purchase surcharge;
                                                                ESP=Suplemento Compra];
                                                     RunObject=Form 7010194;
                                                     RunFormLink=Delegacion=FIELD(Delegacion),
                                                                 N§ Servicio=FIELD(N§ Servicio) }
                                                   { ID=68;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=Official Guide Surcharges;
                                                                ESP=Suplementos Guia Oficial];
                                                     RunObject=Form 7010226;
                                                     RunFormView=SORTING(Delegacion,N§ Servicio,Codigo Suplemento,Contrato Compra);
                                                     RunFormLink=Delegacion=FIELD(Delegacion),
                                                                 N§ Servicio=FIELD(N§ Servicio) }
                                                   { ID=1000000002;
                                                     MenuItemType=Separator }
                                                   { ID=1100253000;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=Support services;
                                                                ESP=Servicios de soporte];
                                                     RunObject=Form 7010210;
                                                     RunFormLink=Delegacion=FIELD(Delegacion),
                                                                 N§ Servicio=FIELD(N§ Servicio) }
                                                   { ID=43;
                                                     MenuItemType=Separator;
                                                     CaptionML=[ENU=Actions;
                                                                ESP=Acciones] }
                                                   { ID=51;
                                                     CaptionML=[ENU=Assign Official guide;
                                                                ESP=Asignar Guia Oficial];
                                                     OnPush=VAR
                                                              rProveedor@1103355001 : Record 23;
                                                              rCond@1103355002 : Record 7010085;
                                                              Dialogo@1103355003 : Dialog;
                                                            BEGIN
                                                              {
                                                              IF rCond.GET(USERID()) THEN
                                                                rCond.DELETE;
                                                              rCond.INIT;
                                                              rCond.Usuario := USERID();
                                                              rCond.INSERT;
                                                              rCond.FILTERGROUP(2);
                                                              rCond.SETRANGE(Usuario, USERID());
                                                              rCond.FILTERGROUP(0);
                                                              FORM.RUNMODAL(FORM::"Ficha Condicion Guia Oficial", rCond);
                                                              rCond.FILTERGROUP(2);
                                                              rCond.SETRANGE(Usuario, USERID());
                                                              rCond.FILTERGROUP(0);
                                                              IF NOT rCond.GET(USERID()) THEN
                                                                ERROR(Text000);
                                                              IF NOT rCond.Correcto THEN
                                                                EXIT;
                                                              "Guia Oficial" := rCond."Proveedor Excursi¢n";
                                                              }


                                                              CODEUNIT.RUN(CODEUNIT::"Asignar Guia Oficial", Rec);


                                                              { AJS -> 11-05-99
                                                              rProveedor.SETCURRENTKEY("Tipo Proveedor", "N§");
                                                              rProveedor.SETRANGE("Tipo Proveedor", Text001);
                                                              Dialogo.OPEN(Text002);
                                                              Dialogo.INPUT(1, rProveedor."N§");
                                                              Dialogo.CLOSE;
                                                              IF rProveedor."N§" <> '' THEN BEGIN
                                                                IF NOT rProveedor.GET(rProveedor."N§") THEN
                                                                  ERROR(Text003);
                                                                "Guia Oficial" := rProveedor."N§";
                                                                MODIFY;
                                                                rProveedor.RESET;
                                                              END;
                                                              }
                                                            END;
                                                             }
                                                   { ID=52;
                                                     ShortCutKey=F4;
                                                     CaptionML=[ENU=Undo service;
                                                                ESP=Deshacer servicio];
                                                     OnPush=BEGIN

                                                              cFuncExc.DeshacerServicio(Rec);
                                                            END;
                                                             }
                                                   { ID=53;
                                                     CaptionML=[ENU=Print work order;
                                                                ESP=Imprimir hoja de servicio];
                                                     OnPush=VAR
                                                              rServicio@1103355001 : Record 7010163;
                                                              rReserva@1103355002 : Record 7010162;
                                                              rPar@1103355003 : Record 7009700;
                                                            BEGIN
                                                              IF NOT rPar.FINDFIRST THEN
                                                                ERROR(Text005);
                                                              rPar.TESTFIELD("Hoja Servicio Excursion");

                                                              rServicio.SETRANGE("N§ Servicio", "N§ Servicio");
                                                              IF rServicio.FINDFIRST THEN
                                                              BEGIN
                                                                //rReserva.SETRANGE("N§ Servicio", "N§ Servicio");  //$005 No hace falta pasar parametro rReserva, sino rServicio

                                                                rServicio.SETRANGE(Delegacion   , Delegacion);
                                                                rServicio.SETRANGE("N§ Servicio", "N§ Servicio");
                                                                rServicio.SETRANGE(Fecha        , rServicio.Fecha);

                                                                REPORT.RUNMODAL(rPar."Hoja Servicio Excursion" , TRUE, FALSE, rServicio);

                                                                //-$009IF CONFIRM(Text007, TRUE) THEN
                                                                //-$009BEGIN
                                                                //-$009  "Peticion servicio impresa" := TRUE;
                                                                //-$009  MODIFY;
                                                                //-$009  COMMIT;
                                                                //-$009END;
                                                              END;
                                                            END;
                                                             }
                                                   { ID=1000000012;
                                                     CaptionML=[ENU=Change Day/Turn;
                                                                ESP=Cambiar Dia/Turno];
                                                     OnPush=BEGIN
                                                              CLEAR(cFuncExc);
                                                              cFuncExc.CambioDiaServicio(Rec);
                                                            END;
                                                             }
                                                   { ID=50;
                                                     ShortCutKey=F11;
                                                     CaptionML=[ENU=Confirm;
                                                                ESP=Confirmar];
                                                     OnPush=BEGIN

                                                              codCONF.ConfirmarExcursion(Rec);
                                                            END;
                                                             }
                                                   { ID=44;
                                                     MenuItemType=Separator;
                                                     CaptionML=[ENU=Margins;
                                                                ESP=Margenes] }
                                                   { ID=55;
                                                     ShortCutKey=F9;
                                                     CaptionML=[ENU=Calculate service;
                                                                ESP=Calcular servicio];
                                                     OnPush=VAR
                                                              rReserva@1103355001 : Record 7010162;
                                                            BEGIN

                                                              "Tipo Calculo" := "Tipo Calculo"::Margenes;
                                                              MODIFY;

                                                              COMMIT;

                                                              codVAL.CostesIngresosExcursion(Rec, TRUE); //+$004

                                                              COMMIT;

                                                              FORM.RUNMODAL(7010196, Rec);
                                                            END;
                                                             }
                                                   { ID=42;
                                                     CaptionML=[ENU=Calculate filtered services;
                                                                ESP=Calcular servicios filtrados];
                                                     OnPush=BEGIN
                                                              codVAL.CalculaFiltradas(Rec);
                                                            END;
                                                             }
                                                   { ID=56;
                                                     CaptionML=[ENU=Calculate day;
                                                                ESP=Calcular Dia];
                                                     OnPush=VAR
                                                              rVerMargen@1103355001 : Record 7010176;
                                                              rServicio@1103355002 : Record 7010163;
                                                              rMargenes@1103355003 : Record 7010174;
                                                              IngresoServicio@1103355004 : Decimal;
                                                              CosteServicio@1103355005 : Decimal;
                                                              CosteAutocar@1103355006 : Decimal;
                                                              CosteGV@1103355007 : Decimal;
                                                              CosteGO@1103355008 : Decimal;
                                                              CosteProvExc@1103355009 : Decimal;
                                                              CosteTO@1103355010 : Decimal;
                                                            BEGIN

                                                              codDIA.MargenesDiaExcursion(Rec);
                                                            END;
                                                             }
                                                   { ID=57;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=Margins View;
                                                                ESP=Ver Margenes];
                                                     RunObject=Form 7010201;
                                                     RunFormLink=Delegacion=FIELD(Delegacion),
                                                                 N§ Servicio=FIELD(N§ Servicio) }
                                                   { ID=1100253003;
                                                     MenuItemType=Separator;
                                                     CaptionML=ESP=- }
                                                   { ID=1100253004;
                                                     CaptionML=[ENU=Print Cash Receipt;
                                                                ESP=Imprimir Recibo Contados];
                                                     RunFormOnRec=Yes;
                                                     OnPush=BEGIN
                                                              ImpReciboContados;
                                                            END;
                                                             }
                                                 }
                                                  }
    { 48  ;TextBox      ;3410 ;12760;1760 ;440  ;Name=Clave3;
                                                 VertGlue=Bottom;
                                                 Focusable=No;
                                                 HorzAlign=Left;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=Clave3;
                                                            ESP=Clave3];
                                                 SourceExpr=wClave[3] }
    { 54  ;TextBox      ;8690 ;12760;1760 ;440  ;Name=Clave4;
                                                 VertGlue=Bottom;
                                                 Focusable=No;
                                                 HorzAlign=Left;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=Clave4;
                                                            ESP=Clave4];
                                                 SourceExpr=wClave[4] }
    { 58  ;Shape        ;8140 ;12760;440  ;440  ;Name=ShapeAzul;
                                                 VertGlue=Bottom;
                                                 BackColor=16711680;
                                                 BackTransparent=No }
    { 70  ;Shape        ;2860 ;12760;440  ;440  ;Name=ShapeVerde;
                                                 VertGlue=Bottom;
                                                 BackColor=45824;
                                                 BackTransparent=No }
    { 71  ;TextBox      ;770  ;12760;1760 ;440  ;Name=Clave1;
                                                 VertGlue=Bottom;
                                                 Focusable=No;
                                                 HorzAlign=Left;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=Clave1;
                                                            ESP=Clave1];
                                                 SourceExpr=wClave[1] }
    { 72  ;TextBox      ;6050 ;12760;1760 ;440  ;Name=Clave2;
                                                 VertGlue=Bottom;
                                                 Focusable=No;
                                                 HorzAlign=Left;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=Clave2;
                                                            ESP=Clave2];
                                                 SourceExpr=wClave[2] }
    { 73  ;Shape        ;5500 ;12760;440  ;440  ;Name=ShapeRojo;
                                                 VertGlue=Bottom;
                                                 BackColor=255;
                                                 BackTransparent=No }
    { 74  ;Shape        ;220  ;12760;440  ;440  ;Name=ShapeNegro;
                                                 VertGlue=Bottom;
                                                 BackColor=0;
                                                 BackTransparent=No }
  }
  CODE
  {
    VAR
      Text000@1103355008 : TextConst 'ENU=Error in the system;ESP=Error inesperado en el sistema.';
      Text001@1103355009 : TextConst 'ENU=GO;ESP=GO';
      Text002@1103355010 : TextConst 'ENU=Enter an official guide: #1##################;ESP=Introduzca el Guia Oficial: #1##################';
      Text003@1103355011 : TextConst 'ENU=Official guide was not found;ESP=Guia Oficial no encontrado.';
      Text004@1103355012 : TextConst 'ENU=Are you sure about to cancel assigning the service?;ESP=Seguro que quiere desasignar el servicio?';
      Text005@1103355013 : TextConst 'ENU=Information does not exist in agency parameters folder;ESP=No existe informacion en el fichero de parametros Agencia.';
      Text006@1103355014 : TextConst 'ENU=Selected report does not exist for the Excursion Service Sheet;ESP=No existe el informe seleccionado para la Hoja de Servicio excursion.';
      Text007@1103355015 : TextConst 'ENU=Has been correct the print?;ESP=Ha sido correcta la impresion?';
      Text008@1103355016 : TextConst 'ENU=Contract supplier does not exist;ESP=No existe el proveedor del contrato';
      Text009@1103355017 : TextConst 'ENU=Carrier contract does not exist;ESP=No existe el contrato del transportista';
      Text010@1103355018 : TextConst 'ENU=It has more than one carrier;ESP=Tiene mas de un transportista';
      Text011@1103355019 : TextConst 'ENU=It does not have carrier service;ESP=No tiene prestacion de transporte';
      codVAL@1103355000 : Codeunit 7010143;
      codCONF@1103355001 : Codeunit 7010147;
      codDIA@1103355002 : Codeunit 7010148;
      cFuncExc@1100253000 : Codeunit 7010141;
      cNom@1100217000 : Codeunit 7009702;
      rMar@1103355003 : Record 7010174;
      rConfC@1103355004 : Record 7009822;
      wColor@1103355005 : Integer;
      wServAnt@1103355006 : Integer;
      wClave@1103355007 : ARRAY [10] OF Code[20];

    PROCEDURE nom_transportista@1() : Text[60];
    VAR
      rPrs@1103355000 : Record 7010170;
      rCont@1103355001 : Record 7010142;
      rPro@1103355002 : Record 23;
    BEGIN
      // nom_transportista

      rPrs.RESET;
      rPrs.SETRANGE(Delegacion     , Delegacion);
      rPrs.SETRANGE("N§ Servicio"  , "N§ Servicio");
      rPrs.SETRANGE("Tipo Contrato", rPrs."Tipo Contrato"::Transportista);
      IF rPrs.FINDFIRST THEN
      BEGIN
        IF rPrs.COUNT = 1 THEN
        BEGIN
          rCont.RESET;
          IF rCont.GET(Delegacion, rPrs."N§ Contrato", rCont."Tipo Contrato"::Transportista) THEN
          BEGIN
             IF rPro.GET(rCont.Proveedor) THEN
               EXIT(rPro.Name)
             ELSE
               EXIT(Text008);
          END
          ELSE
            EXIT(Text009);
          rCont.RESET;
        END
        ELSE
          EXIT(Text010);
      END
      ELSE
        EXIT(Text011);
      rPrs.RESET;
    END;

    PROCEDURE BuscaColor@2();
    BEGIN
      // BuscaColor
      // Cambia de color cambia la agrupacion

      IF wServAnt="N§ Servicio" THEN
        EXIT;

      wServAnt :="N§ Servicio";
      wColor   := rConfC.GetColor("Margen Beneficio",rConfC.Tipo::Excursiones);
    END;

    BEGIN
    {
      $001 JPT 08/08/12 CNT-OC-12004 Incluir filtro por oficina en las excursiones. Control de Oficina en Excursion

      $002 AJS 04122013 El caption de la opcion Zonas lo pongo como Zonas Transportista para que quede m s claro

      $003 AJS 11052014 Elimino los campos de minimos porque son obsoletos

      $004 AJS 13052014 Nuevo parametro en funcion de calcular servicios

      $005 MNC 180714 Paso parametro rServicio

      $006 AJS 08102014 Mostrar la columna "Turno excursion"

      $007 AJS 11102014 Oculto los campos "Adultos Reservados" y "Ni¤os Reservados" porque no son necesarios

      $008 AJS 11102014 Oculto el campo "Vehiculo exclusivo" porque es obsoleto

      $009 AJS 11102014 La marca de "Peticion servicio impresa" la pongo en el informe

      $010 AJS 16102014 Elimino la opci¢n de Zonas transportista, no aporta informacion

      $011 ARM 24112014 CNT-OC-14055 Nuevos campos invitados compra

      $012 AJS 28112014 Mostrar campos de invitados venta
    }
    END.
  }
}
