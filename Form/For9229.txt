OBJECT Form 9229 Res. Avail. (Service) Matrix
{
  OBJECT-PROPERTIES
  {
    Date=05/11/08;
    Time=12:00:00;
    Version List=NAVW16.00;
  }
  PROPERTIES
  {
    Width=20790;
    Height=9020;
    CaptionML=ENU=Res. Availability (Service) Matrix;
    InsertAllowed=No;
    DeleteAllowed=No;
    LinksAllowed=No;
    SourceTable=Table156;
    DataCaptionExpr='';
    OnOpenForm=BEGIN
                 ServMgtSetup.GET;
                 SetSkills;
                 SetVisible;
               END;

    OnAfterGetRecord=VAR
                       QualifiedForAll@1043 : Boolean;
                       MATRIX_CurrentColumnOrdinal@1044 : Integer;
                       MATRIX_Steps@1045 : Integer;
                     BEGIN
                       MatrixOnAfterGetRecord;
                       IF QualifiedForServItems = QualifiedForServItems::"Selected Service Item" THEN BEGIN
                         IF ServItemLine.GET(CurrentDocumentType,CurrentDocumentNo,CurrentServItemLineNo) THEN
                           Qualified := ServOrderAllocMgt.QualifiedForServiceItemLine(ServItemLine,"No.")
                         ELSE
                           Qualified := FALSE;
                       END ELSE BEGIN
                         QualifiedForAll := TRUE;
                         ServItemLine.SETRANGE("Document Type",ServHeader."Document Type");
                         ServItemLine.SETRANGE("Document No.",ServHeader."No.");
                         IF ServItemLine.FIND('-') THEN
                           REPEAT
                             QualifiedForAll := ServOrderAllocMgt.QualifiedForServiceItemLine(ServItemLine,"No.")
                           UNTIL (QualifiedForAll = FALSE) OR (ServItemLine.NEXT = 0);
                         IF QualifiedForAll THEN
                           Qualified := TRUE
                         ELSE
                           Qualified := FALSE;
                       END;

                       IF ServHeader.GET(CurrentDocumentType,CurrentDocumentNo) THEN
                         "Service Zone Filter" := ServHeader."Service Zone Code"
                       ELSE
                         "Service Zone Filter" := '';
                       PreferredResource := FALSE;
                       IF ServItem.GET(ServItemLine."Service Item No.") THEN
                         IF ServItem."Preferred Resource" = "No." THEN
                           PreferredResource := TRUE;

                       CALCFIELDS("In Customer Zone");
                     END;

    OnAfterGetCurrRecord=VAR
                           QualifiedForAll@1046 : Boolean;
                         BEGIN
                         END;

  }
  CONTROLS
  {
    { 1   ;TableBox     ;220  ;2530 ;20240;5500 ;HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Editable=No }
    { 24  ;TextBox      ;3493 ;3080 ;603  ;440  ;Name=;
                                                 Focusable=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 CaptionML=ENU=Preferred Resource;
                                                 SourceExpr=PreferredResource }
    { 1047;Label        ;0    ;0    ;0    ;0    ;ParentControl=24;
                                                 InColumnHeading=Yes }
    { 26  ;TextBox      ;3493 ;3080 ;660  ;440  ;Name=Skilled;
                                                 Focusable=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 CaptionML=ENU=Skilled;
                                                 SourceExpr=Qualified }
    { 1048;Label        ;0    ;0    ;0    ;0    ;ParentControl=26;
                                                 InColumnHeading=Yes }
    { 28  ;TextBox      ;3493 ;3080 ;737  ;440  ;Name=In Customer Zone;
                                                 Focusable=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="In Customer Zone" }
    { 1049;Label        ;0    ;0    ;0    ;0    ;ParentControl=28;
                                                 InColumnHeading=Yes }
    { 2   ;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 CaptionML=ENU=No.;
                                                 SourceExpr="No." }
    { 1050;Label        ;0    ;0    ;0    ;0    ;ParentControl=2;
                                                 InColumnHeading=Yes }
    { 6   ;TextBox      ;3493 ;3080 ;3740 ;440  ;Name=;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 CaptionML=ENU=Name;
                                                 SourceExpr=Name }
    { 1051;Label        ;0    ;0    ;0    ;0    ;ParentControl=6;
                                                 InColumnHeading=Yes }
    { 1011;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field1;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[1];
                                                 CaptionClass='3,' + MatrixColumnCaptions[1];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(1);
                                                             END;
                                                              }
    { 1052;Label        ;0    ;0    ;0    ;0    ;ParentControl=1011;
                                                 InColumnHeading=Yes }
    { 1012;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field2;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[2];
                                                 CaptionClass='3,' + MatrixColumnCaptions[2];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(2);
                                                             END;
                                                              }
    { 1053;Label        ;0    ;0    ;0    ;0    ;ParentControl=1012;
                                                 InColumnHeading=Yes }
    { 1013;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field3;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[3];
                                                 CaptionClass='3,' + MatrixColumnCaptions[3];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(3);
                                                             END;
                                                              }
    { 1054;Label        ;0    ;0    ;0    ;0    ;ParentControl=1013;
                                                 InColumnHeading=Yes }
    { 1014;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field4;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[4];
                                                 CaptionClass='3,' + MatrixColumnCaptions[4];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(4);
                                                             END;
                                                              }
    { 1055;Label        ;0    ;0    ;0    ;0    ;ParentControl=1014;
                                                 InColumnHeading=Yes }
    { 1015;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field5;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[5];
                                                 CaptionClass='3,' + MatrixColumnCaptions[5];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(5);
                                                             END;
                                                              }
    { 1056;Label        ;0    ;0    ;0    ;0    ;ParentControl=1015;
                                                 InColumnHeading=Yes }
    { 1016;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field6;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[6];
                                                 CaptionClass='3,' + MatrixColumnCaptions[6];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(6);
                                                             END;
                                                              }
    { 1057;Label        ;0    ;0    ;0    ;0    ;ParentControl=1016;
                                                 InColumnHeading=Yes }
    { 1017;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field7;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[7];
                                                 CaptionClass='3,' + MatrixColumnCaptions[7];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(7);
                                                             END;
                                                              }
    { 1058;Label        ;0    ;0    ;0    ;0    ;ParentControl=1017;
                                                 InColumnHeading=Yes }
    { 1018;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field8;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[8];
                                                 CaptionClass='3,' + MatrixColumnCaptions[8];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(8);
                                                             END;
                                                              }
    { 1059;Label        ;0    ;0    ;0    ;0    ;ParentControl=1018;
                                                 InColumnHeading=Yes }
    { 1019;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field9;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[9];
                                                 CaptionClass='3,' + MatrixColumnCaptions[9];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(9);
                                                             END;
                                                              }
    { 1060;Label        ;0    ;0    ;0    ;0    ;ParentControl=1019;
                                                 InColumnHeading=Yes }
    { 1020;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field10;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[10];
                                                 CaptionClass='3,' + MatrixColumnCaptions[10];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(10);
                                                             END;
                                                              }
    { 1061;Label        ;0    ;0    ;0    ;0    ;ParentControl=1020;
                                                 InColumnHeading=Yes }
    { 1021;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field11;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[11];
                                                 CaptionClass='3,' + MatrixColumnCaptions[11];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(11);
                                                             END;
                                                              }
    { 1062;Label        ;0    ;0    ;0    ;0    ;ParentControl=1021;
                                                 InColumnHeading=Yes }
    { 1022;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field12;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[12];
                                                 CaptionClass='3,' + MatrixColumnCaptions[12];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(12);
                                                             END;
                                                              }
    { 1063;Label        ;0    ;0    ;0    ;0    ;ParentControl=1022;
                                                 InColumnHeading=Yes }
    { 1023;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field13;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[13];
                                                 CaptionClass='3,' + MatrixColumnCaptions[13];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(13);
                                                             END;
                                                              }
    { 1064;Label        ;0    ;0    ;0    ;0    ;ParentControl=1023;
                                                 InColumnHeading=Yes }
    { 1024;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field14;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[14];
                                                 CaptionClass='3,' + MatrixColumnCaptions[14];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(14);
                                                             END;
                                                              }
    { 1065;Label        ;0    ;0    ;0    ;0    ;ParentControl=1024;
                                                 InColumnHeading=Yes }
    { 1025;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field15;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[15];
                                                 CaptionClass='3,' + MatrixColumnCaptions[15];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(15);
                                                             END;
                                                              }
    { 1066;Label        ;0    ;0    ;0    ;0    ;ParentControl=1025;
                                                 InColumnHeading=Yes }
    { 1026;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field16;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[16];
                                                 CaptionClass='3,' + MatrixColumnCaptions[16];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(16);
                                                             END;
                                                              }
    { 1067;Label        ;0    ;0    ;0    ;0    ;ParentControl=1026;
                                                 InColumnHeading=Yes }
    { 1027;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field17;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[17];
                                                 CaptionClass='3,' + MatrixColumnCaptions[17];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(17);
                                                             END;
                                                              }
    { 1068;Label        ;0    ;0    ;0    ;0    ;ParentControl=1027;
                                                 InColumnHeading=Yes }
    { 1028;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field18;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[18];
                                                 CaptionClass='3,' + MatrixColumnCaptions[18];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(18);
                                                             END;
                                                              }
    { 1069;Label        ;0    ;0    ;0    ;0    ;ParentControl=1028;
                                                 InColumnHeading=Yes }
    { 1029;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field19;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[19];
                                                 CaptionClass='3,' + MatrixColumnCaptions[19];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(19);
                                                             END;
                                                              }
    { 1070;Label        ;0    ;0    ;0    ;0    ;ParentControl=1029;
                                                 InColumnHeading=Yes }
    { 1030;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field20;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[20];
                                                 CaptionClass='3,' + MatrixColumnCaptions[20];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(20);
                                                             END;
                                                              }
    { 1071;Label        ;0    ;0    ;0    ;0    ;ParentControl=1030;
                                                 InColumnHeading=Yes }
    { 1031;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field21;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[21];
                                                 CaptionClass='3,' + MatrixColumnCaptions[21];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(21);
                                                             END;
                                                              }
    { 1072;Label        ;0    ;0    ;0    ;0    ;ParentControl=1031;
                                                 InColumnHeading=Yes }
    { 1032;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field22;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[22];
                                                 CaptionClass='3,' + MatrixColumnCaptions[22];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(22);
                                                             END;
                                                              }
    { 1073;Label        ;0    ;0    ;0    ;0    ;ParentControl=1032;
                                                 InColumnHeading=Yes }
    { 1033;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field23;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[23];
                                                 CaptionClass='3,' + MatrixColumnCaptions[23];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(23);
                                                             END;
                                                              }
    { 1074;Label        ;0    ;0    ;0    ;0    ;ParentControl=1033;
                                                 InColumnHeading=Yes }
    { 1034;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field24;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[24];
                                                 CaptionClass='3,' + MatrixColumnCaptions[24];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(24);
                                                             END;
                                                              }
    { 1075;Label        ;0    ;0    ;0    ;0    ;ParentControl=1034;
                                                 InColumnHeading=Yes }
    { 1035;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field25;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[25];
                                                 CaptionClass='3,' + MatrixColumnCaptions[25];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(25);
                                                             END;
                                                              }
    { 1076;Label        ;0    ;0    ;0    ;0    ;ParentControl=1035;
                                                 InColumnHeading=Yes }
    { 1036;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field26;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[26];
                                                 CaptionClass='3,' + MatrixColumnCaptions[26];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(26);
                                                             END;
                                                              }
    { 1077;Label        ;0    ;0    ;0    ;0    ;ParentControl=1036;
                                                 InColumnHeading=Yes }
    { 1037;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field27;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[27];
                                                 CaptionClass='3,' + MatrixColumnCaptions[27];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(27);
                                                             END;
                                                              }
    { 1078;Label        ;0    ;0    ;0    ;0    ;ParentControl=1037;
                                                 InColumnHeading=Yes }
    { 1038;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field28;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[28];
                                                 CaptionClass='3,' + MatrixColumnCaptions[28];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(28);
                                                             END;
                                                              }
    { 1079;Label        ;0    ;0    ;0    ;0    ;ParentControl=1038;
                                                 InColumnHeading=Yes }
    { 1039;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field29;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[29];
                                                 CaptionClass='3,' + MatrixColumnCaptions[29];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(29);
                                                             END;
                                                              }
    { 1080;Label        ;0    ;0    ;0    ;0    ;ParentControl=1039;
                                                 InColumnHeading=Yes }
    { 1040;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field30;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[30];
                                                 CaptionClass='3,' + MatrixColumnCaptions[30];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(30);
                                                             END;
                                                              }
    { 1081;Label        ;0    ;0    ;0    ;0    ;ParentControl=1040;
                                                 InColumnHeading=Yes }
    { 1041;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field31;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[31];
                                                 CaptionClass='3,' + MatrixColumnCaptions[31];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(31);
                                                             END;
                                                              }
    { 1082;Label        ;0    ;0    ;0    ;0    ;ParentControl=1041;
                                                 InColumnHeading=Yes }
    { 1042;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field32;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 DecimalPlaces=0:5;
                                                 SourceExpr=MATRIX_CellData[32];
                                                 CaptionClass='3,' + MatrixColumnCaptions[32];
                                                 OnDrillDown=BEGIN
                                                               MatrixOnDrillDown(32);
                                                             END;
                                                              }
    { 1083;Label        ;0    ;0    ;0    ;0    ;ParentControl=1042;
                                                 InColumnHeading=Yes }
    { 5   ;CommandButton;18370;8250 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 17  ;TabControl   ;220  ;220  ;20240;2090 ;HorzGlue=Both }
    { 13  ;TextBox      ;9570 ;1540 ;2640 ;440  ;Name=Qtytoallocate;
                                                 ParentControl=17;
                                                 InPage=0;
                                                 CaptionML=ENU=Qty. To Allocate;
                                                 SourceExpr=QtytoAllocate;
                                                 MinValue=0 }
    { 14  ;Label        ;6600 ;1540 ;2750 ;440  ;Name=Qtytoallocate;
                                                 ParentControl=13 }
    { 9   ;TextBox      ;9570 ;990  ;2640 ;440  ;Name=SelectedDay;
                                                 VertGlue=Top;
                                                 ParentControl=17;
                                                 InPage=0;
                                                 CaptionML=ENU=Selected Day;
                                                 SourceExpr=SelectedDate }
    { 10  ;Label        ;6600 ;990  ;2750 ;440  ;Name=SelectedDay;
                                                 VertGlue=Bottom;
                                                 ParentControl=9 }
    { 11  ;TextBox      ;3410 ;990  ;2750 ;440  ;Editable=No;
                                                 ParentControl=17;
                                                 InPage=0;
                                                 CaptionML=ENU=Selected Resource;
                                                 SourceExpr=Name }
    { 12  ;Label        ;440  ;990  ;2750 ;440  ;ParentControl=11;
                                                 LeaderDots=No }
    { 15  ;TextBox      ;3410 ;1540 ;2750 ;440  ;Name=Skills;
                                                 VertGlue=Top;
                                                 ParentControl=17;
                                                 InPage=0;
                                                 CaptionML=ENU=Resource Skilled For;
                                                 OptionCaptionML=ENU=Selected Service Item,All Service Items in Order;
                                                 SourceExpr=QualifiedForServItems;
                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE(FALSE);
                                                                 END;
                                                                  }
    { 16  ;Label        ;440  ;1540 ;2750 ;440  ;VertGlue=Top;
                                                 ParentControl=15 }
    { 23  ;MenuButton   ;15950;8250 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=ENU=F&unctions;
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=29;
                                                     CaptionML=ENU=&Allocate;
                                                     OnPush=BEGIN
                                                              IF PeriodType <> PeriodType::Day THEN
                                                                ERROR(Text000,SELECTSTR(PeriodType + 1,Text001));

                                                              CLEAR(ServOrderAllocMgt);
                                                              ServOrderAllocMgt.AllocateDate(
                                                                CurrentDocumentType,CurrentDocumentNo,CurrentEntryNo,Rec."No.",'',SelectedDate,QtytoAllocate);
                                                              CurrForm.CLOSE;
                                                            END;
                                                             }
                                                 }
                                                  }
    { 3   ;MenuButton   ;13530;8250 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=ENU=&Resource;
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=4;
                                                     PushAction=LookupTable;
                                                     ShortCutKey=F5;
                                                     CaptionML=ENU=List }
                                                   { ID=7;
                                                     PushAction=RunObject;
                                                     ShortCutKey=May£s+F5;
                                                     CaptionML=ENU=Card;
                                                     RunObject=Form 76;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=No.=FIELD(No.) }
                                                 }
                                                  }
  }
  CODE
  {
    VAR
      Text000@1084 : TextConst 'ENU=You cannot allocate a resource when selected period is %1.';
      MatrixRec@1002 : Record 156;
      ServMgtSetup@1085 : Record 5911;
      ServHeader@1086 : Record 5900;
      ServItemLine@1087 : Record 5901;
      ServItem@1088 : Record 5940;
      MatrixColumnDateFilters@1001 : ARRAY [32] OF Record 2000000007;
      PeriodFormMgt@1089 : Codeunit 359;
      ServOrderAllocMgt@1090 : Codeunit 5930;
      CurrentDocumentType@1091 : Integer;
      CurrentDocumentNo@1092 : Code[20];
      CurrentServItemLineNo@1093 : Integer;
      CurrentEntryNo@1094 : Integer;
      SelectedDate@1095 : Date;
      SelectedResource@1096 : Code[20];
      PeriodType@1097 : 'Day,Week,Month,Quarter,Year,Accounting Period';
      QualifiedForServItems@1098 : 'Selected Service Item,All Service Items in Order';
      QtytoAllocate@1099 : Decimal;
      AvailableHrs@1100 : Decimal;
      Qualified@1101 : Boolean;
      PreferredResource@1102 : Boolean;
      Text001@1103 : TextConst 'ENU=Day,Week,Month,Quarter,Year,Accounting Period';
      MATRIX_ColumnOrdinal@1105 : Integer;
      MATRIX_NoOfMatrixColumns@1106 : Integer;
      MATRIX_CellData@1107 : ARRAY [32] OF Decimal;
      MatrixColumnCaptions@1000 : ARRAY [32] OF Text[100];

    PROCEDURE SetData@1109(DocumentType@1003 : Integer;DocumentNo@1000 : Code[20];ServItemLineNo@1001 : Integer;EntryNo@1002 : Integer;VAR NewMatrixColumnCaptions@1004 : ARRAY [32] OF Text[100];VAR NewMatrixDateFilters@1006 : ARRAY [32] OF Record 2000000007;Periods@1005 : Integer;Period@1007 : 'Day,Week,Month,Quarter,Year,Accounting Period');
    BEGIN
      CurrentDocumentType := DocumentType;
      CurrentDocumentNo := DocumentNo;
      CurrentServItemLineNo := ServItemLineNo;
      CurrentEntryNo := EntryNo;
      COPYARRAY(MatrixColumnCaptions,NewMatrixColumnCaptions,1);
      COPYARRAY(MatrixColumnDateFilters,NewMatrixDateFilters,1);
      PeriodType := Period;
    END;

    LOCAL PROCEDURE UpdateFields@1111();
    BEGIN
      IF PeriodType = PeriodType::Day THEN BEGIN
        IF NOT CurrForm.SelectedDay.ENABLED THEN
          CurrForm.SelectedDay.ENABLED := TRUE;
        IF NOT CurrForm.Qtytoallocate.ENABLED THEN
          CurrForm.Qtytoallocate.ENABLED := TRUE;
      END ELSE BEGIN
        IF CurrForm.SelectedDay.ENABLED THEN
          CurrForm.SelectedDay.ENABLED := FALSE;
        IF CurrForm.Qtytoallocate.ENABLED THEN
          CurrForm.Qtytoallocate.ENABLED := FALSE;
      END;
    END;

    PROCEDURE MatrixOnAfterGetRecord@4();
    VAR
      I@1000 : Integer;
      StartFilter@1001 : Date;
      EndFilter@1002 : Date;
    BEGIN
      MatrixRec.RESET;
      MatrixRec.SETRANGE(MatrixRec."No.","No.");
      FOR I := 1 TO ARRAYLEN(MatrixColumnDateFilters) DO BEGIN
        MATRIX_CellData[I] := 0;
        MatrixRec.SETRANGE("Date Filter",MatrixColumnDateFilters[I]."Period Start",
          MatrixColumnDateFilters[I]."Period End");
        IF MatrixRec.FIND('-') THEN BEGIN
          REPEAT
            MatrixRec.CALCFIELDS(Capacity,"Qty. on Service Order");
            MATRIX_CellData[I] := MatrixRec.Capacity -
                MatrixRec."Qty. on Service Order";
          UNTIL MatrixRec.NEXT = 0;
        END;
      END;

      SetVisible;
    END;

    PROCEDURE MatrixOnDrillDown@7(Column@1000 : Integer);
    VAR
      PlanningLine@1001 : Record 5950;
      Res@1004 : Record 156;
      PlanningLineForm@1002 : Form 6001;
      ResAvailability@1003 : Form 6006;
    BEGIN
      CLEAR(ResAvailability);
      CLEAR(Res);
      Res.SETRANGE("No.","No.");
      Res.SETRANGE("Date Filter",MatrixColumnDateFilters[Column]."Period Start",
        MatrixColumnDateFilters[Column]."Period End");
      ResAvailability.SETTABLEVIEW(Res);
      ResAvailability.SETRECORD(Res);
      ResAvailability.RUNMODAL;
    END;

    PROCEDURE SetSkills@6();
    BEGIN
      IF ServMgtSetup."Resource Skills Option" = ServMgtSetup."Resource Skills Option"::"Not Used" THEN
        CurrForm.Skilled.VISIBLE(FALSE)
      ELSE
        CurrForm.Skilled.VISIBLE(TRUE);
      IF ServMgtSetup."Service Zones Option" = ServMgtSetup."Service Zones Option"::"Not Used" THEN
        CurrForm."In Customer Zone".VISIBLE(FALSE)
      ELSE
        CurrForm."In Customer Zone".VISIBLE(TRUE);
      CLEAR(QtytoAllocate);

      ServHeader.GET(CurrentDocumentType,CurrentDocumentNo);

      UpdateFields;
    END;

    PROCEDURE SetVisible@8();
    BEGIN
      CurrForm.Field1.VISIBLE(MatrixColumnCaptions[1] <> '');
      CurrForm.Field2.VISIBLE(MatrixColumnCaptions[2] <> '');
      CurrForm.Field3.VISIBLE(MatrixColumnCaptions[3] <> '');
      CurrForm.Field4.VISIBLE(MatrixColumnCaptions[4] <> '');
      CurrForm.Field5.VISIBLE(MatrixColumnCaptions[5] <> '');
      CurrForm.Field6.VISIBLE(MatrixColumnCaptions[6] <> '');
      CurrForm.Field7.VISIBLE(MatrixColumnCaptions[7] <> '');
      CurrForm.Field8.VISIBLE(MatrixColumnCaptions[8] <> '');
      CurrForm.Field9.VISIBLE(MatrixColumnCaptions[9] <> '');
      CurrForm.Field10.VISIBLE(MatrixColumnCaptions[10] <> '');
      CurrForm.Field11.VISIBLE(MatrixColumnCaptions[11] <> '');
      CurrForm.Field12.VISIBLE(MatrixColumnCaptions[12] <> '');
      CurrForm.Field13.VISIBLE(MatrixColumnCaptions[13] <> '');
      CurrForm.Field14.VISIBLE(MatrixColumnCaptions[14] <> '');
      CurrForm.Field15.VISIBLE(MatrixColumnCaptions[15] <> '');
      CurrForm.Field16.VISIBLE(MatrixColumnCaptions[16] <> '');
      CurrForm.Field17.VISIBLE(MatrixColumnCaptions[17] <> '');
      CurrForm.Field18.VISIBLE(MatrixColumnCaptions[18] <> '');
      CurrForm.Field19.VISIBLE(MatrixColumnCaptions[19] <> '');
      CurrForm.Field20.VISIBLE(MatrixColumnCaptions[20] <> '');
      CurrForm.Field21.VISIBLE(MatrixColumnCaptions[21] <> '');
      CurrForm.Field22.VISIBLE(MatrixColumnCaptions[22] <> '');
      CurrForm.Field23.VISIBLE(MatrixColumnCaptions[23] <> '');
      CurrForm.Field24.VISIBLE(MatrixColumnCaptions[24] <> '');
      CurrForm.Field25.VISIBLE(MatrixColumnCaptions[25] <> '');
      CurrForm.Field26.VISIBLE(MatrixColumnCaptions[26] <> '');
      CurrForm.Field27.VISIBLE(MatrixColumnCaptions[27] <> '');
      CurrForm.Field28.VISIBLE(MatrixColumnCaptions[28] <> '');
      CurrForm.Field29.VISIBLE(MatrixColumnCaptions[29] <> '');
      CurrForm.Field30.VISIBLE(MatrixColumnCaptions[30] <> '');
      CurrForm.Field31.VISIBLE(MatrixColumnCaptions[31] <> '');
      CurrForm.Field32.VISIBLE(MatrixColumnCaptions[32] <> '');
    END;

    BEGIN
    END.
  }
}
