OBJECT Form 9209 Invt. Analys by Dim. Matrix
{
  OBJECT-PROPERTIES
  {
    Date=14/08/09;
    Time=12:00:00;
    Version List=NAVW16.00.01;
  }
  PROPERTIES
  {
    Width=20790;
    Height=5940;
    Editable=No;
    CaptionML=ENU=Invt. Analys by Dim. Matrix;
    LinksAllowed=No;
    SourceTable=Table367;
    DataCaptionExpr=CurrentItemAnalysisViewCode;
    OnOpenForm=BEGIN
                 CurrentAnalysisArea := CurrentAnalysisArea::Inventory;

                 GLSetup.GET;
                 NormalFormatString := Text001 + GLSetup."Amount Decimal Places" + Text002;
                 ItemAnalysisMgt.AnalysisViewSelection(
                     CurrentAnalysisArea,CurrentItemAnalysisViewCode,ItemAnalysisView,ItemStatisticsBuffer,
                     Dim1Filter,Dim2Filter,Dim3Filter);

                 FindPeriod('');
               END;

    OnFindRecord=BEGIN
                   EXIT(
                       ItemAnalysisMgt.FindRec(
                         ItemAnalysisView,LineDimOption,Rec,Which,
                         ItemFilter,LocationFilter,PeriodType,DateFilter,PeriodInitialized,InternalDateFilter,
                         Dim1Filter,Dim2Filter,Dim3Filter));
                 END;

    OnNextRecord=BEGIN
                   EXIT(
                      ItemAnalysisMgt.NextRec(
                          ItemAnalysisView,LineDimOption,Rec,Steps,
                          ItemFilter,LocationFilter,PeriodType,DateFilter,
                           Dim1Filter,Dim2Filter,Dim3Filter));
                 END;

    OnAfterGetRecord=VAR
                       MATRIX_CurrentColumnOrdinal@1044 : Integer;
                     BEGIN
                       //IF CurrForm.TotalQuantity.VISIBLE THEN
                         Quantity := CalcAmt(2,FALSE);
                       //IF CurrForm.TotalQuantity.VISIBLE THEN
                         Amount := CalcAmt(1,FALSE);
                       MATRIX_CurrentColumnOrdinal := 0;
                       WHILE MATRIX_CurrentColumnOrdinal < MATRIX_CurrentNoOfMatrixColumn DO BEGIN
                         MATRIX_CurrentColumnOrdinal := MATRIX_CurrentColumnOrdinal + 1;
                         MATRIX_OnAfterGetRecord(MATRIX_CurrentColumnOrdinal);
                       END;
                     END;

    OnAfterGetCurrRecord=VAR
                           MATRIX_CurrentColumnOrdinal@1000 : Integer;
                         BEGIN
                           //IF CurrForm.TotalQuantity.VISIBLE THEN
                             Quantity := CalcAmt(2,FALSE);
                           //IF CurrForm.TotalInvtValue.VISIBLE THEN
                             Amount := CalcAmt(1,FALSE);
                         END;

  }
  CONTROLS
  {
    { 1   ;TableBox     ;220  ;220  ;20350;5500 ;HorzGlue=Both;
                                                 VertGlue=Both }
    { 20  ;TextBox      ;3493 ;3080 ;2420 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Code;
                                                 OnFormat=BEGIN
                                                            CurrForm.Code.UPDATEFONTBOLD("Show in Bold");
                                                          END;

                                                 OnLookup=BEGIN
                                                            ItemAnalysisMgt.LookUpCode(LineDimOption,LineDimCode,Code);
                                                          END;
                                                           }
    { 1045;Label        ;0    ;0    ;0    ;0    ;ParentControl=20;
                                                 InColumnHeading=Yes }
    { 22  ;TextBox      ;3493 ;3080 ;2420 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Name;
                                                 OnFormat=BEGIN
                                                            CurrForm.Name.UPDATEFONTBOLD("Show in Bold");
                                                            CurrForm.Name.UPDATEINDENT(220 * Indentation);
                                                          END;
                                                           }
    { 1046;Label        ;0    ;0    ;0    ;0    ;ParentControl=22;
                                                 InColumnHeading=Yes }
    { 45  ;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=TotalQuantity;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 CaptionML=ENU=Total Quantity;
                                                 BlankZero=Yes;
                                                 SourceExpr=+Quantity;
                                                 OnFormat=BEGIN
                                                            ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
                                                            CurrForm.TotalQuantity.UPDATEFONTBOLD("Show in Bold");
                                                          END;

                                                 OnDrillDown=BEGIN
                                                               ItemAnalysisMgt.DrillDown(
                                                                 CurrentAnalysisArea,ItemStatisticsBuffer,CurrentItemAnalysisViewCode,
                                                                 ItemFilter,LocationFilter,DateFilter,
                                                                 Dim1Filter,Dim2Filter,Dim3Filter,BudgetFilter,
                                                                 LineDimOption,Rec,
                                                                 ColumnDimOption,MatrixRecord,
                                                                               FALSE,2,ShowActualBudget);
                                                               //  Line with .. ColumnDimOption,MatrixRecord, might be wrong...
                                                             END;
                                                              }
    { 1047;Label        ;0    ;0    ;0    ;0    ;ParentControl=45;
                                                 InColumnHeading=Yes }
    { 24  ;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=TotalInvtValue;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 CaptionML=ENU=Total Inventory Value;
                                                 BlankZero=Yes;
                                                 SourceExpr=+Amount;
                                                 OnFormat=BEGIN
                                                            ItemAnalysisMgt.FormatAmount(Text,RoundingFactor);
                                                            CurrForm.TotalInvtValue.UPDATEFONTBOLD("Show in Bold");
                                                          END;

                                                 OnDrillDown=BEGIN
                                                               ItemAnalysisMgt.DrillDown(
                                                                      CurrentAnalysisArea,ItemStatisticsBuffer,CurrentItemAnalysisViewCode,
                                                                      ItemFilter,LocationFilter,DateFilter,
                                                                      Dim1Filter,Dim2Filter,Dim3Filter,BudgetFilter,
                                                                      LineDimOption,Rec,
                                                                      ColumnDimOption,Rec,
                                                                      FALSE,1,ShowActualBudget);

                                                               // Line with might be wrong... ColumnDimOption,Rec,
                                                             END;
                                                              }
    { 1048;Label        ;0    ;0    ;0    ;0    ;ParentControl=24;
                                                 InColumnHeading=Yes }
    { 1012;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field1;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[1];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[1];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_OnDrillDown(1);
                                                             END;
                                                              }
    { 1049;Label        ;0    ;0    ;0    ;0    ;ParentControl=1012;
                                                 InColumnHeading=Yes }
    { 1013;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field2;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[2];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[2];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_OnDrillDown(2);
                                                             END;
                                                              }
    { 1050;Label        ;0    ;0    ;0    ;0    ;ParentControl=1013;
                                                 InColumnHeading=Yes }
    { 1014;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field3;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[3];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[3];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_OnDrillDown(3);
                                                             END;
                                                              }
    { 1051;Label        ;0    ;0    ;0    ;0    ;ParentControl=1014;
                                                 InColumnHeading=Yes }
    { 1015;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field4;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[4];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[4];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(4);
                                                             END;
                                                              }
    { 1052;Label        ;0    ;0    ;0    ;0    ;ParentControl=1015;
                                                 InColumnHeading=Yes }
    { 1016;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field5;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[5];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[5];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(5);
                                                             END;
                                                              }
    { 1053;Label        ;0    ;0    ;0    ;0    ;ParentControl=1016;
                                                 InColumnHeading=Yes }
    { 1017;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field6;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[6];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[6];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(6);
                                                             END;
                                                              }
    { 1054;Label        ;0    ;0    ;0    ;0    ;ParentControl=1017;
                                                 InColumnHeading=Yes }
    { 1018;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field7;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[7];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[7];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(7);
                                                             END;
                                                              }
    { 1055;Label        ;0    ;0    ;0    ;0    ;ParentControl=1018;
                                                 InColumnHeading=Yes }
    { 1019;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field8;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[8];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[8];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(8);
                                                             END;
                                                              }
    { 1056;Label        ;0    ;0    ;0    ;0    ;ParentControl=1019;
                                                 InColumnHeading=Yes }
    { 1020;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field9;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[9];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[9];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(9);
                                                             END;
                                                              }
    { 1057;Label        ;0    ;0    ;0    ;0    ;ParentControl=1020;
                                                 InColumnHeading=Yes }
    { 1021;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field10;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[10];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[10];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(10);
                                                             END;
                                                              }
    { 1058;Label        ;0    ;0    ;0    ;0    ;ParentControl=1021;
                                                 InColumnHeading=Yes }
    { 1022;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field11;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[11];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[11];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(11);
                                                             END;
                                                              }
    { 1059;Label        ;0    ;0    ;0    ;0    ;ParentControl=1022;
                                                 InColumnHeading=Yes }
    { 1023;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field12;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[12];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[12];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(12);
                                                             END;
                                                              }
    { 1060;Label        ;0    ;0    ;0    ;0    ;ParentControl=1023;
                                                 InColumnHeading=Yes }
    { 1024;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field13;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[13];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[13];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(13);
                                                             END;
                                                              }
    { 1061;Label        ;0    ;0    ;0    ;0    ;ParentControl=1024;
                                                 InColumnHeading=Yes }
    { 1025;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field14;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[14];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[14];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(14);
                                                             END;
                                                              }
    { 1062;Label        ;0    ;0    ;0    ;0    ;ParentControl=1025;
                                                 InColumnHeading=Yes }
    { 1026;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field15;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[15];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[15];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(15);
                                                             END;
                                                              }
    { 1063;Label        ;0    ;0    ;0    ;0    ;ParentControl=1026;
                                                 InColumnHeading=Yes }
    { 1027;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field16;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[16];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[16];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(16);
                                                             END;
                                                              }
    { 1064;Label        ;0    ;0    ;0    ;0    ;ParentControl=1027;
                                                 InColumnHeading=Yes }
    { 1028;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field17;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[17];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[17];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(17);
                                                             END;
                                                              }
    { 1065;Label        ;0    ;0    ;0    ;0    ;ParentControl=1028;
                                                 InColumnHeading=Yes }
    { 1029;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field18;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[18];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[18];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(18);
                                                             END;
                                                              }
    { 1066;Label        ;0    ;0    ;0    ;0    ;ParentControl=1029;
                                                 InColumnHeading=Yes }
    { 1030;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field19;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[19];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[19];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(19);
                                                             END;
                                                              }
    { 1067;Label        ;0    ;0    ;0    ;0    ;ParentControl=1030;
                                                 InColumnHeading=Yes }
    { 1031;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field20;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[20];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[20];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(20);
                                                             END;
                                                              }
    { 1068;Label        ;0    ;0    ;0    ;0    ;ParentControl=1031;
                                                 InColumnHeading=Yes }
    { 1032;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field21;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[21];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[21];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(21);
                                                             END;
                                                              }
    { 1069;Label        ;0    ;0    ;0    ;0    ;ParentControl=1032;
                                                 InColumnHeading=Yes }
    { 1033;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field22;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[22];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[22];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(22);
                                                             END;
                                                              }
    { 1070;Label        ;0    ;0    ;0    ;0    ;ParentControl=1033;
                                                 InColumnHeading=Yes }
    { 1034;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field23;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[23];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[23];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(23);
                                                             END;
                                                              }
    { 1071;Label        ;0    ;0    ;0    ;0    ;ParentControl=1034;
                                                 InColumnHeading=Yes }
    { 1035;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field24;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[24];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[24];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(24);
                                                             END;
                                                              }
    { 1072;Label        ;0    ;0    ;0    ;0    ;ParentControl=1035;
                                                 InColumnHeading=Yes }
    { 1036;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field25;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[25];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[25];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(25);
                                                             END;
                                                              }
    { 1073;Label        ;0    ;0    ;0    ;0    ;ParentControl=1036;
                                                 InColumnHeading=Yes }
    { 1037;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field26;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[26];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[26];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(26);
                                                             END;
                                                              }
    { 1074;Label        ;0    ;0    ;0    ;0    ;ParentControl=1037;
                                                 InColumnHeading=Yes }
    { 1038;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field27;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[27];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[27];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(27);
                                                             END;
                                                              }
    { 1075;Label        ;0    ;0    ;0    ;0    ;ParentControl=1038;
                                                 InColumnHeading=Yes }
    { 1039;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field28;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[28];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[28];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(28);
                                                             END;
                                                              }
    { 1076;Label        ;0    ;0    ;0    ;0    ;ParentControl=1039;
                                                 InColumnHeading=Yes }
    { 1040;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field29;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[29];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[29];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(29);
                                                             END;
                                                              }
    { 1077;Label        ;0    ;0    ;0    ;0    ;ParentControl=1040;
                                                 InColumnHeading=Yes }
    { 1041;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field30;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[30];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[30];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(30);
                                                             END;
                                                              }
    { 1078;Label        ;0    ;0    ;0    ;0    ;ParentControl=1041;
                                                 InColumnHeading=Yes }
    { 1042;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field31;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[31];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[31];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(31);
                                                             END;
                                                              }
    { 1079;Label        ;0    ;0    ;0    ;0    ;ParentControl=1042;
                                                 InColumnHeading=Yes }
    { 1043;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field32;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[32];
                                                 CaptionClass='3,' + MATRIX_CaptionSet[32];
                                                 OnDrillDown=BEGIN
                                                                MATRIX_OnDrillDown(32);
                                                             END;
                                                              }
    { 1080;Label        ;0    ;0    ;0    ;0    ;ParentControl=1043;
                                                 InColumnHeading=Yes }
  }
  CODE
  {
    VAR
      GLSetup@1081 : Record 98;
      ItemAnalysisView@1082 : Record 7152;
      ItemStatisticsBuffer@1083 : Record 5821;
      ItemAnalysisMgt@1085 : Codeunit 7153;
      CurrentAnalysisArea@1086 : 'Sales,Purchase,Inventory';
      CurrentItemAnalysisViewCode@1087 : Code[10];
      ItemFilter@1088 : Code[250];
      LocationFilter@1089 : Code[250];
      BudgetFilter@1090 : Code[250];
      ValueType@1091 : 'Sales Amount,Inventory Value,Sales Quantity';
      ShowActualBudget@1092 : 'Actual Amounts,Budgeted Amounts,Variance,Variance%,Index%';
      RoundingFactor@1093 : 'None,1,1000,1000000';
      LineDimOption@1094 : 'Item,Period,Location,Dimension 1,Dimension 2,Dimension 3';
      ColumnDimOption@1095 : 'Item,Period,Location,Dimension 1,Dimension 2,Dimension 3';
      PeriodType@1096 : 'Day,Week,Month,Quarter,Year,Accounting Period';
      Dim1Filter@1097 : Code[250];
      Dim2Filter@1098 : Code[250];
      Dim3Filter@1099 : Code[250];
      LineDimCode@1100 : Text[30];
      ColumnDimCode@1101 : Text[30];
      DateFilter@1102 : Text[30];
      InternalDateFilter@1103 : Text[30];
      PeriodInitialized@1104 : Boolean;
      AnalysisValue@1105 : Decimal;
      MatrixHeader@1106 : Text[50];
      ShowColumnName@1107 : Boolean;
      ShowOppositeSign@1108 : Boolean;
      NormalFormatString@1109 : Text[80];
      Text001@1110 : TextConst 'ENU=<Precision,';
      Text002@1111 : TextConst 'ENU=><Standard Format,0>';
      MatrixRecords@1112 : ARRAY [32] OF Record 367;
      MatrixRecord@1000 : Record 367;
      MATRIX_CurrentNoOfMatrixColumn@1113 : Integer;
      MATRIX_CellData@1114 : ARRAY [32] OF Decimal;
      MATRIX_CaptionSet@1115 : ARRAY [32] OF Text[1024];

    LOCAL PROCEDURE FindPeriod@1116(SearchText@1000 : Code[10]);
    VAR
      Item@1117 : Record 27;
      Calendar@1118 : Record 2000000007;
      PeriodFormMgt@1119 : Codeunit 359;
    BEGIN
      IF DateFilter <> '' THEN BEGIN
        Calendar.SETFILTER("Period Start",DateFilter);
        IF NOT PeriodFormMgt.FindDate('+',Calendar,PeriodType) THEN
          PeriodFormMgt.FindDate('+',Calendar,PeriodType::Day);
        Calendar.SETRANGE("Period Start");
      END;
      PeriodFormMgt.FindDate(SearchText,Calendar,PeriodType);
      Item.SETRANGE("Date Filter",Calendar."Period Start",Calendar."Period End");
      IF Item.GETRANGEMIN("Date Filter") = Item.GETRANGEMAX("Date Filter") THEN
        Item.SETRANGE("Date Filter",Item.GETRANGEMIN("Date Filter"));
      InternalDateFilter := Item.GETFILTER("Date Filter");
      IF (LineDimOption <> LineDimOption::Period) AND (ColumnDimOption <> ColumnDimOption::Period) THEN
        DateFilter := InternalDateFilter;
    END;

    LOCAL PROCEDURE CalcAmt@1120(ValueType@1001 : Integer;SetColFilter@1000 : Boolean) : Decimal;
    VAR
      Amt@1121 : Decimal;
      AmtFromBuffer@1122 : Boolean;
    BEGIN
      Amt := ItemAnalysisMgt.CalcAmount(
              ValueType,SetColFilter,
              CurrentAnalysisArea,ItemStatisticsBuffer,CurrentItemAnalysisViewCode,
              ItemFilter,LocationFilter,DateFilter,BudgetFilter,
              Dim1Filter,Dim2Filter,Dim3Filter,
              LineDimOption,Rec,
              ColumnDimOption,MatrixRecord,
              ShowActualBudget);
      IF ShowOppositeSign THEN
         Amt := -Amt;
      EXIT(Amt);
    END;

    PROCEDURE Load@1125(VAR MatrixColumns1@1005 : ARRAY [32] OF Text[1024];VAR MatrixRecords1@1006 : ARRAY [32] OF Record 367;CurrentNoOfMatrixColumns@1007 : Integer;_LineDimOption@1000 : Integer;_ColumnDimOption@1001 : Integer;_RoundingFactor@1002 : Integer;_DateFilter@1003 : Text[30];_ValueType@1004 : Integer;_ItemAnalysisView@1008 : Record 7152;_CurrentItemAnalysisViewCode@1010 : Code[10]);
    VAR
      i@1009 : Integer;
    BEGIN
      COPYARRAY(MATRIX_CaptionSet,MatrixColumns1,1);
      FOR i := 1 TO ARRAYLEN(MatrixRecords) DO
        MatrixRecords[i].COPY(MatrixRecords1[i]);
      MATRIX_CurrentNoOfMatrixColumn := CurrentNoOfMatrixColumns;
      LineDimOption := _LineDimOption;
      ColumnDimOption := _ColumnDimOption;
      RoundingFactor := _RoundingFactor;
      DateFilter := _DateFilter;
      ValueType := _ValueType;
      ItemAnalysisView := _ItemAnalysisView;
      CurrentItemAnalysisViewCode := _CurrentItemAnalysisViewCode;
    END;

    LOCAL PROCEDURE MATRIX_OnDrillDown@1126(MATRIX_ColumnOrdinal@1008 : Integer);
    BEGIN
      {
      MATRIX_ColumnTempRec := MatrixRecords[MATRIX_ColumnOrdinal];
      DrillDown(FALSE,ValueType);
      }

      ItemAnalysisMgt.DrillDown(
        CurrentAnalysisArea,ItemStatisticsBuffer,CurrentItemAnalysisViewCode,
        ItemFilter,LocationFilter,DateFilter,
        Dim1Filter,Dim2Filter,Dim3Filter,BudgetFilter,
        LineDimOption,Rec,
        ColumnDimOption,MatrixRecords[MATRIX_ColumnOrdinal],
        TRUE,ValueType,ShowActualBudget);
    END;

    LOCAL PROCEDURE MATRIX_OnLookUp@1127(MATRIX_ColumnOrdinal@1009 : Integer);
    BEGIN
    END;

    LOCAL PROCEDURE MATRIX_OnAfterGetRecord@1128(MATRIX_ColumnOrdinal@1010 : Integer);
    BEGIN
      {
      IF ShowColumnName THEN
        MatrixHeader := MatrixRecords[MATRIX_ColumnOrdinal].Name
      ELSE
        MatrixHeader := MatrixRecords[MATRIX_ColumnOrdinal].Code;
      }
      MatrixRecord := MatrixRecords[MATRIX_ColumnOrdinal];
      AnalysisValue := CalcAmt(ValueType,TRUE);
      MATRIX_CellData[MATRIX_ColumnOrdinal] := AnalysisValue;
    END;

    BEGIN
    END.
  }
}
