OBJECT Form 7181 Vendor Purchase History
{
  OBJECT-PROPERTIES
  {
    Date=05/11/08;
    Time=12:00:00;
    Version List=NAVW16.00;
  }
  PROPERTIES
  {
    Width=19030;
    Height=7920;
    CaptionML=[ENU=Vendor Purchase History;
               ESP=Historial compra proveedor];
    SaveValues=Yes;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    TableBoxID=1;
    SourceTable=Table23;
    OnOpenForm=BEGIN
                 IF ToPurchHeader."No." = '' THEN
                   CurrForm.CopyToDoc.ENABLED := FALSE;
                 ChangeSubMenu(CurrentMenuType);
                 CASE CurrentMenuType OF
                   0:
                     CurrForm.QuotesBtn.ACTIVATE;
                   1:
                     CurrForm.OrdersBtn.ACTIVATE;
                   2:
                     CurrForm.InvoicesBtn.ACTIVATE;
                   3:
                     CurrForm.CreditMemosBtn.ACTIVATE;
                   4:
                     CurrForm.BlanketOrdersBtn.ACTIVATE;
                   5:
                     CurrForm.ReturnOrdersBtn.ACTIVATE;
                   6:
                     CurrForm.PostedReturnReceiptsBtn.ACTIVATE;
                   7:
                     CurrForm.PostedInvoicesBtn.ACTIVATE;
                   8:
                     CurrForm.PostedShipmentsBtn.ACTIVATE;
                   9:
                     CurrForm.PostedCreditMemosBtn.ACTIVATE;
                   10:
                     CurrForm.ArchiveOrdersBtn.ACTIVATE;
                 END;
                 SETRANGE("No.","No.");
               END;

    OnAfterGetRecord=BEGIN
                       IF PayTo THEN BEGIN
                         PurchInfoPaneMgt.CalcNoOfPayToDocuments(Rec);
                         NoOfQuotes := "Pay-to No. of Quotes";
                         NoOfBlanketOrders := "Pay-to No. of Blanket Orders";
                         NoOfOrders := "Pay-to No. of Orders";
                         NoofInvoices := "Pay-to No. of Invoices";
                         NoOfReturnOrders := "Pay-to No. of Return Orders";
                         NoOfCreditMemos := "Pay-to No. of Credit Memos";
                         NoOfPstdReceipts :=  "Pay-to No. of Pstd. Return S.";
                         NoOfPstdInvoices := "Pay-to No. of Pstd. Invoices";
                         NoOfPstdReturnReceipts :="Pay-to No. of Pstd. Receipts";
                         NoOfPstdCreditMemos := "Pay-to No. of Pstd. Cr. Memos";
                         NoOfArchivedOrders := "Pay-to No. Of Archived Doc."
                       END ELSE BEGIN
                         PurchInfoPaneMgt.CalcNoOfDocuments(Rec);
                         NoOfQuotes := "No. of Quotes";
                         NoOfBlanketOrders := "No. of Blanket Orders";
                         NoOfOrders := "No. of Orders";
                         NoofInvoices := "No. of Invoices";
                         NoOfReturnOrders := "No. of Return Orders";
                         NoOfCreditMemos := "No. of Credit Memos";
                         NoOfPstdReceipts := "No. of Pstd. Receipts";
                         NoOfPstdInvoices := "No. of Pstd. Invoices";
                         NoOfPstdReturnReceipts := "No. of Pstd. Return Shipments";
                         NoOfPstdCreditMemos := "No. of Pstd. Credit Memos";
                         NoOfArchivedOrders := "Buy-from No. Of Archived Doc."
                        END;
                     END;

  }
  CONTROLS
  {
    { 54  ;SubForm      ;4290 ;220  ;14520;6600 ;Name=PayPostedReturnShpts;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Visible=No;
                                                 Border=No;
                                                 SubFormID=Form7184;
                                                 SubFormView=SORTING(Pay-to Vendor No.);
                                                 SubFormLink=Pay-to Vendor No.=FIELD(No.) }
    { 50  ;SubForm      ;4290 ;220  ;14520;6600 ;Name=PayPostedInvoices;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Visible=No;
                                                 Border=No;
                                                 SubFormID=Form7185;
                                                 SubFormLink=Pay-to Vendor No.=FIELD(No.) }
    { 51  ;SubForm      ;4290 ;220  ;14520;6600 ;Name=PayPostedRcpts;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Visible=No;
                                                 Border=No;
                                                 SubFormID=Form7183;
                                                 SubFormView=SORTING(Pay-to Vendor No.);
                                                 SubFormLink=Pay-to Vendor No.=FIELD(No.) }
    { 52  ;SubForm      ;4290 ;220  ;14520;6600 ;Name=PayPurchLines;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Visible=No;
                                                 Border=No;
                                                 SubFormID=Form7182;
                                                 SubFormLink=Pay-to Vendor No.=FIELD(No.) }
    { 1   ;SubForm      ;4290 ;220  ;14520;6600 ;Name=PostedCrMemos;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Visible=No;
                                                 Border=No;
                                                 SubFormID=Form7186;
                                                 SubFormView=SORTING(Buy-from Vendor No.);
                                                 SubFormLink=Buy-from Vendor No.=FIELD(No.) }
    { 44  ;TextBox      ;880  ;0    ;2200 ;440  ;Name=CurrentMenuTypeValue;
                                                 Visible=No;
                                                 SourceExpr=CurrentMenuType }
    { 2   ;CommandButton;11770;7150 ;2200 ;550  ;Name=CopyToDoc;
                                                 HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 InvalidActionAppearance=Hide;
                                                 CaptionML=[ENU=Cop&y to Document;
                                                            ESP=Cop&iar al documento];
                                                 OnPush=BEGIN
                                                          CopyLineToDoc;
                                                          CurrForm.CLOSE;
                                                        END;
                                                         }
    { 4   ;CommandButton;16610;7150 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 5   ;SubForm      ;4290 ;220  ;14520;6600 ;Name=PostedReturnShpts;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Visible=No;
                                                 Border=No;
                                                 SubFormID=Form7184;
                                                 SubFormView=SORTING(Buy-from Vendor No.);
                                                 SubFormLink=Buy-from Vendor No.=FIELD(No.) }
    { 6   ;SubForm      ;4290 ;220  ;14520;6600 ;Name=PostedInvoices;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Visible=No;
                                                 Border=No;
                                                 SubFormID=Form7185;
                                                 SubFormView=SORTING(Buy-from Vendor No.);
                                                 SubFormLink=Buy-from Vendor No.=FIELD(No.) }
    { 7   ;SubForm      ;4290 ;220  ;14520;6600 ;Name=PostedRcpts;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Visible=No;
                                                 Border=No;
                                                 SubFormID=Form7183;
                                                 SubFormView=SORTING(Buy-from Vendor No.);
                                                 SubFormLink=Buy-from Vendor No.=FIELD(No.) }
    { 8   ;SubForm      ;4290 ;220  ;14520;6600 ;Name=PurchLines;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Visible=No;
                                                 Border=No;
                                                 SubFormID=Form7182;
                                                 SubFormLink=Buy-from Vendor No.=FIELD(No.) }
    { 53  ;SubForm      ;4290 ;220  ;14520;6600 ;Name=PayPostedCrMemos;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Visible=No;
                                                 Border=No;
                                                 SubFormID=Form7186;
                                                 SubFormLink=Pay-to Vendor No.=FIELD(No.) }
    { 3   ;CommandButton;14190;7150 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=&Show;
                                                            ESP=&Mostrar];
                                                 OnPush=VAR
                                                          PurchHeader@1009 : Record 38;
                                                          PurchLine@1008 : Record 39;
                                                          PurchRcptHeader@1007 : Record 120;
                                                          PurchRcptLine@1006 : Record 121;
                                                          PurchInvHeader@1005 : Record 122;
                                                          PurchInvLine@1004 : Record 123;
                                                          PurchCrMemoHeader@1003 : Record 124;
                                                          PurchCrMemoLine@1002 : Record 125;
                                                          ReturnShptHeader@1001 : Record 6650;
                                                          ReturnShptLine@1000 : Record 6651;
                                                          PurchHeaderArchive@1102628002 : Record 5109;
                                                          PurchLineArchive@1102628001 : Record 5110;
                                                        BEGIN
                                                          CASE CurrentMenuType OF
                                                            0..5:
                                                              BEGIN
                                                                IF PayTo THEN
                                                                  CurrForm.PayPurchLines.FORM.GETRECORD(PurchLine)
                                                                ELSE
                                                                  CurrForm.PurchLines.FORM.GETRECORD(PurchLine);
                                                                IF NOT PurchHeader.GET(PurchLine."Document Type",PurchLine."Document No.") THEN
                                                                  EXIT;
                                                                CASE CurrentMenuType OF
                                                                  0:
                                                                    FORM.RUN(FORM::"Purchase Quote",PurchHeader);
                                                                  1:
                                                                    FORM.RUN(FORM::"Purchase Order",PurchHeader);
                                                                  2:
                                                                    FORM.RUN(FORM::"Purchase Invoice",PurchHeader);
                                                                  3:
                                                                    FORM.RUN(FORM::"Purchase Credit Memo",PurchHeader);
                                                                  4:
                                                                    FORM.RUN(FORM::"Blanket Purchase Order",PurchHeader);
                                                                  5:
                                                                    FORM.RUN(FORM::"Purchase Return Order",PurchHeader);
                                                                END;
                                                              END;
                                                            6:
                                                              BEGIN
                                                                IF PayTo THEN
                                                                  CurrForm.PayPostedRcpts.FORM.GETRECORD(PurchRcptLine)
                                                                ELSE
                                                                  CurrForm.PostedRcpts.FORM.GETRECORD(PurchRcptLine);
                                                                IF NOT PurchRcptHeader.GET(PurchRcptLine."Document No.") THEN
                                                                  EXIT;
                                                                FORM.RUN(FORM::"Posted Purchase Receipt",PurchRcptHeader);
                                                              END;
                                                            7:
                                                              BEGIN
                                                                IF PayTo THEN
                                                                  CurrForm.PayPostedInvoices.FORM.GETRECORD(PurchInvLine)
                                                                ELSE
                                                                  CurrForm.PostedInvoices.FORM.GETRECORD(PurchInvLine);
                                                                IF NOT PurchInvHeader.GET(PurchInvLine."Document No.") THEN
                                                                  EXIT;
                                                                FORM.RUN(FORM::"Posted Purchase Invoice",PurchInvHeader);
                                                              END;
                                                            8:
                                                              BEGIN
                                                                IF PayTo THEN
                                                                  CurrForm.PayPostedReturnShpts.FORM.GETRECORD(ReturnShptLine)
                                                                ELSE
                                                                  CurrForm.PostedReturnShpts.FORM.GETRECORD(ReturnShptLine);
                                                                IF NOT ReturnShptHeader.GET(ReturnShptLine."Document No.") THEN
                                                                  EXIT;
                                                                FORM.RUN(FORM::"Posted Return Shipment",ReturnShptHeader);
                                                              END;

                                                            9:
                                                              BEGIN
                                                                IF PayTo THEN
                                                                  CurrForm.PostedCrMemos.FORM.GETRECORD(PurchCrMemoLine)
                                                                ELSE
                                                                  CurrForm.PostedCrMemos.FORM.GETRECORD(PurchCrMemoLine);
                                                                IF NOT PurchCrMemoHeader.GET(PurchCrMemoLine."Document No.") THEN
                                                                  EXIT;
                                                                FORM.RUN(FORM::"Posted Purchase Credit Memo",PurchCrMemoHeader);
                                                              END;
                                                            10:
                                                              BEGIN
                                                                IF PayTo THEN
                                                                  CurrForm.PayArchivedOrders.FORM.GETRECORD(PurchLineArchive)
                                                                ELSE
                                                                  CurrForm.ArchivedOrders.FORM.GETRECORD(PurchLineArchive);
                                                                IF NOT PurchHeaderArchive.GET(PurchLineArchive."Document Type",PurchLineArchive."Document No.",
                                                                    PurchLineArchive."Doc. No. Occurrence",PurchLineArchive."Version No.") THEN
                                                                   EXIT;
                                                                FORM.RUN(FORM::"Purchase Order Archive",PurchHeaderArchive);
                                                              END;

                                                          END;
                                                        END;
                                                         }
    { 9   ;Frame        ;220  ;220  ;3850 ;6600 ;VertGlue=Both;
                                                 ShowCaption=No;
                                                 BackTransparent=Yes;
                                                 Border=No }
    { 10  ;CommandButton;880  ;5500 ;2200 ;550  ;Name=PostedCreditMemosBtn;
                                                 FocusOnClick=Yes;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 ForeColor=0;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=Posted Cr. &Memos;
                                                            ESP=&Abonos contabilizados];
                                                 OnPush=BEGIN
                                                          ChangeSubMenu(9);
                                                        END;
                                                         }
    { 11  ;TextBox      ;3080 ;5500 ;770  ;550  ;Editable=No;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',NoOfPstdCreditMemos) }
    { 12  ;CommandButton;880  ;4950 ;2200 ;550  ;Name=PostedReturnReceiptsBtn;
                                                 FocusOnClick=Yes;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 ForeColor=0;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=Posted Ret&urn Receipts;
                                                            ESP=Hist¢rico &recep. devoluci¢n];
                                                 OnPush=BEGIN
                                                          ChangeSubMenu(8);
                                                        END;
                                                         }
    { 13  ;CommandButton;880  ;4400 ;2200 ;550  ;Name=PostedInvoicesBtn;
                                                 FocusOnClick=Yes;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 ForeColor=0;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=Posted I&nvoices;
                                                            ESP=Hist¢rico &facturas];
                                                 OnPush=BEGIN
                                                          ChangeSubMenu(7);
                                                        END;
                                                         }
    { 14  ;TextBox      ;3080 ;4400 ;770  ;550  ;Editable=No;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',NoOfPstdInvoices) }
    { 15  ;CommandButton;880  ;3850 ;2200 ;550  ;Name=PostedShipmentsBtn;
                                                 FocusOnClick=Yes;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 ForeColor=0;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=&Posted Receipts;
                                                            ESP=Hist¢rico &albaranes];
                                                 OnPush=BEGIN
                                                          ChangeSubMenu(6);
                                                        END;
                                                         }
    { 16  ;TextBox      ;3080 ;3850 ;770  ;550  ;Editable=No;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',NoOfPstdReceipts) }
    { 17  ;CommandButton;880  ;3190 ;2200 ;550  ;Name=CreditMemosBtn;
                                                 FocusOnClick=Yes;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 ForeColor=0;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=Cre&dit Memos;
                                                            ESP=Ab&onos];
                                                 OnPush=BEGIN
                                                          ChangeSubMenu(3);
                                                        END;
                                                         }
    { 18  ;TextBox      ;3080 ;3190 ;770  ;550  ;Editable=No;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',NoOfCreditMemos) }
    { 19  ;CommandButton;880  ;2640 ;2200 ;550  ;Name=ReturnOrdersBtn;
                                                 FocusOnClick=Yes;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 ForeColor=0;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=&Return Orders;
                                                            ESP=De&voluciones];
                                                 OnPush=BEGIN
                                                          ChangeSubMenu(5);
                                                        END;
                                                         }
    { 20  ;TextBox      ;3080 ;2640 ;770  ;550  ;Editable=No;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',NoOfReturnOrders) }
    { 21  ;CommandButton;880  ;2090 ;2200 ;550  ;Name=InvoicesBtn;
                                                 FocusOnClick=Yes;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 ForeColor=0;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=&Invoices;
                                                            ESP=&Facturas];
                                                 OnPush=BEGIN
                                                          ChangeSubMenu(2);
                                                        END;
                                                         }
    { 22  ;TextBox      ;3080 ;2090 ;770  ;550  ;Editable=No;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',NoofInvoices) }
    { 23  ;CommandButton;880  ;1540 ;2200 ;550  ;Name=OrdersBtn;
                                                 FocusOnClick=Yes;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 ForeColor=0;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=&Orders;
                                                            ESP=&Pedidos];
                                                 OnPush=BEGIN
                                                          ChangeSubMenu(1);
                                                        END;
                                                         }
    { 24  ;TextBox      ;3080 ;1540 ;770  ;550  ;Editable=No;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',NoOfOrders) }
    { 25  ;CommandButton;880  ;990  ;2200 ;550  ;Name=BlanketOrdersBtn;
                                                 FocusOnClick=Yes;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 ForeColor=0;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=&Blanket Orders;
                                                            ESP=Pedidos &abiertos];
                                                 OnPush=BEGIN
                                                          ChangeSubMenu(4);
                                                        END;
                                                         }
    { 26  ;TextBox      ;3080 ;990  ;770  ;550  ;Editable=No;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',NoOfBlanketOrders) }
    { 27  ;CommandButton;880  ;440  ;2200 ;550  ;Name=QuotesBtn;
                                                 FocusOnClick=Yes;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 ForeColor=0;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=&Quotes;
                                                            ESP=&Ofertas];
                                                 OnPush=BEGIN
                                                          ChangeSubMenu(0);
                                                        END;
                                                         }
    { 28  ;TextBox      ;3080 ;440  ;770  ;550  ;Editable=No;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',NoOfQuotes) }
    { 29  ;PictureBox   ;440  ;440  ;440  ;550  ;Name=QuotesPic;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 Border=No;
                                                 BitmapList=35,39;
                                                 SourceExpr=0=CurrentMenuType }
    { 30  ;PictureBox   ;440  ;990  ;440  ;550  ;Name=BlanketOrdersPic;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 Border=No;
                                                 BitmapList=35,39;
                                                 SourceExpr=4=CurrentMenuType }
    { 31  ;PictureBox   ;440  ;1540 ;440  ;550  ;Name=OrdersPic;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 Border=No;
                                                 BitmapList=35,39;
                                                 SourceExpr=1=CurrentMenuType }
    { 32  ;PictureBox   ;440  ;2090 ;440  ;550  ;Name=PostedInvoicesPic;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 Border=No;
                                                 BitmapList=35,39;
                                                 SourceExpr=2=CurrentMenuType }
    { 34  ;PictureBox   ;440  ;2640 ;440  ;550  ;Name=ReturnOrdersPic;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 Border=No;
                                                 BitmapList=35,39;
                                                 SourceExpr=5=CurrentMenuType }
    { 36  ;PictureBox   ;440  ;3190 ;440  ;550  ;Name=CreditMemosPic;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 Border=No;
                                                 BitmapList=35,39;
                                                 SourceExpr=3=CurrentMenuType }
    { 37  ;PictureBox   ;440  ;3850 ;440  ;550  ;Name=PostedShipmentsPic;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 Border=No;
                                                 BitmapList=35,39;
                                                 SourceExpr=6=CurrentMenuType }
    { 38  ;PictureBox   ;440  ;4400 ;440  ;550  ;Name=PostedInvoicesPic;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 Border=No;
                                                 BitmapList=35,39;
                                                 SourceExpr=7=CurrentMenuType }
    { 39  ;PictureBox   ;440  ;4950 ;440  ;550  ;Name=PostedReturnReceiptsPic;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 Border=No;
                                                 BitmapList=35,39;
                                                 SourceExpr=8=CurrentMenuType }
    { 40  ;PictureBox   ;440  ;5500 ;440  ;550  ;Name=PostedCredit MemosPic;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 Border=No;
                                                 BitmapList=35,39;
                                                 SourceExpr=9=CurrentMenuType }
    { 41  ;TextBox      ;3080 ;4950 ;770  ;550  ;Editable=No;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',NoOfPstdReturnReceipts) }
    { 1102628000;PictureBox;440;6050;440  ;550  ;Name=PostedCredit MemosPic;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 Border=No;
                                                 BitmapList=35,39;
                                                 SourceExpr=10=CurrentMenuType }
    { 1102628001;CommandButton;880;6050;2200;550;Name=ArchiveOrdersBtn;
                                                 FocusOnClick=Yes;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 ForeColor=0;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=Archived Orders;
                                                            ESP=Pedidos archivados];
                                                 OnPush=BEGIN
                                                          ChangeSubMenu(10);
                                                        END;
                                                         }
    { 1102628002;TextBox;3080 ;6050 ;770  ;550  ;Editable=No;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',NoOfArchivedOrders) }
    { 1102628003;SubForm;4290 ;220  ;14520;6600 ;Name=ArchivedOrders;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Visible=No;
                                                 Border=No;
                                                 SubFormID=Form7187;
                                                 SubFormView=SORTING(Buy-from Vendor No.);
                                                 SubFormLink=Buy-from Vendor No.=FIELD(No.),
                                                             Document Type=CONST(Order) }
    { 1102628004;SubForm;4290 ;220  ;14520;6600 ;Name=PayArchivedOrders;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Visible=No;
                                                 Border=No;
                                                 SubFormID=Form7187;
                                                 SubFormView=SORTING(Pay-to Vendor No.);
                                                 SubFormLink=Pay-to Vendor No.=FIELD(No.),
                                                             Document Type=CONST(Order) }
  }
  CODE
  {
    VAR
      ToPurchHeader@1002 : Record 38;
      PurchInfoPaneMgt@1004 : Codeunit 7181;
      PurchHistCopyLineMgt@1003 : Codeunit 7182;
      OldMenuType@1001 : Integer;
      CurrentMenuType@1000 : Integer;
      PayTo@1005 : Boolean;
      NoOfQuotes@1006 : Integer;
      NoOfBlanketOrders@1007 : Integer;
      NoOfOrders@1008 : Integer;
      NoofInvoices@1009 : Integer;
      NoOfReturnOrders@1010 : Integer;
      NoOfCreditMemos@1011 : Integer;
      NoOfPstdReceipts@1012 : Integer;
      NoOfPstdInvoices@1013 : Integer;
      NoOfPstdReturnReceipts@1014 : Integer;
      NoOfPstdCreditMemos@1015 : Integer;
      NoOfArchivedOrders@1102628000 : Integer;

    LOCAL PROCEDURE CopyLineToDoc@5();
    VAR
      FromPurchLine@1008 : Record 39;
      FromPurchRcptLine@1001 : Record 121;
      FromPurchInvLine@1002 : Record 123;
      FromPurchCrMemoLine@1003 : Record 125;
      FromReturnShptLine@1004 : Record 6651;
      FromPurchLineArchive@1102628000 : Record 5110;
    BEGIN
      CASE CurrentMenuType OF
        0..5:
          BEGIN
            IF PayTo THEN
              CurrForm.PayPurchLines.FORM.GetSelectedLine(FromPurchLine)
            ELSE
              CurrForm.PurchLines.FORM.GetSelectedLine(FromPurchLine);
            PurchHistCopyLineMgt.CopyPurchLinesToDoc(ToPurchHeader,FromPurchLine,CurrentMenuType);
          END;
        6:
          BEGIN
            IF PayTo THEN
              CurrForm.PayPostedRcpts.FORM.GetSelectedLine(FromPurchRcptLine)
            ELSE
              CurrForm.PostedRcpts.FORM.GetSelectedLine(FromPurchRcptLine);
            PurchHistCopyLineMgt.CopyPurchRcptLineToDoc(ToPurchHeader,FromPurchRcptLine,CurrentMenuType);
          END;
        7:
          BEGIN
            IF PayTo THEN
              CurrForm.PayPostedInvoices.FORM.GetSelectedLine(FromPurchInvLine)
            ELSE
              CurrForm.PostedInvoices.FORM.GetSelectedLine(FromPurchInvLine);
            PurchHistCopyLineMgt.CopyPurchInvLineToDoc(ToPurchHeader,FromPurchInvLine,CurrentMenuType)
          END;
        8:
          BEGIN
            IF PayTo THEN
              CurrForm.PayPostedReturnShpts.FORM.GetSelectedLine(FromReturnShptLine)
            ELSE
              CurrForm.PostedReturnShpts.FORM.GetSelectedLine(FromReturnShptLine);
            PurchHistCopyLineMgt.CopyReturnShptLineToDoc(ToPurchHeader,FromReturnShptLine,CurrentMenuType)
          END;
        9:
          BEGIN
            IF PayTo THEN
              CurrForm.PayPostedCrMemos.FORM.GetSelectedLine(FromPurchCrMemoLine)
            ELSE
              CurrForm.PostedCrMemos.FORM.GetSelectedLine(FromPurchCrMemoLine);
            PurchHistCopyLineMgt.CopyPurchCrMemoLineToDoc(ToPurchHeader,FromPurchCrMemoLine,CurrentMenuType)
          END;
        10:
          BEGIN
            IF PayTo THEN
              CurrForm.PayArchivedOrders.FORM.GetSelectedLine(FromPurchLineArchive)
            ELSE
              CurrForm.ArchivedOrders.FORM.GetSelectedLine(FromPurchLineArchive);
            PurchHistCopyLineMgt.CopyPurchArchLineToDoc(ToPurchHeader,FromPurchLineArchive,CurrentMenuType);
          END;
      END;
    END;

    LOCAL PROCEDURE ChangeSubMenu@1(NewMenuType@1000 : Integer);
    BEGIN
      IF OldMenuType <> NewMenuType THEN
        SetSubMenu(OldMenuType,FALSE);
      SetSubMenu(NewMenuType,TRUE);
      OldMenuType := NewMenuType;
      CurrentMenuType := NewMenuType;
    END;

    LOCAL PROCEDURE SetSubMenu@2(MenuType@1000 : Integer;Visible@1001 : Boolean);
    VAR
      PurchLine@1002 : Record 39;
    BEGIN
      CASE MenuType OF
        0..5:
          BEGIN
            IF Visible THEN BEGIN
              IF PayTo THEN BEGIN
                PurchLine.SETCURRENTKEY("Document Type","Pay-to Vendor No.");
                PurchLine.SETRANGE("Document Type",MenuType);
                CurrForm.PayPurchLines.FORM.SETTABLEVIEW(PurchLine)
              END ELSE BEGIN
                PurchLine.SETCURRENTKEY("Document Type","Buy-from Vendor No.");
                PurchLine.SETRANGE("Document Type",MenuType);
                CurrForm.PurchLines.FORM.SETTABLEVIEW(PurchLine);
              END;
            END;
            IF PayTo THEN
              CurrForm.PayPurchLines.VISIBLE := Visible
            ELSE
              CurrForm.PurchLines.VISIBLE := Visible;
          END;
        6:
          BEGIN
            IF PayTo THEN
              CurrForm.PayPostedRcpts.VISIBLE := Visible
            ELSE
              CurrForm.PostedRcpts.VISIBLE := Visible;
          END;
        7:
          BEGIN
            IF PayTo THEN
              CurrForm.PayPostedInvoices.VISIBLE := Visible
            ELSE
              CurrForm.PostedInvoices.VISIBLE := Visible;
          END;
        8:
          BEGIN
            IF PayTo THEN
              CurrForm.PayPostedReturnShpts.VISIBLE := Visible
            ELSE
              CurrForm.PostedReturnShpts.VISIBLE := Visible;
          END;
         9:
          BEGIN
            IF PayTo THEN
              CurrForm.PayPostedCrMemos.VISIBLE := Visible
            ELSE
              CurrForm.PostedCrMemos.VISIBLE := Visible;
          END;
        10:
          BEGIN
              IF PayTo THEN
              CurrForm.PayArchivedOrders.VISIBLE := Visible
            ELSE
              CurrForm.ArchivedOrders.VISIBLE := Visible;
          END;
      END;
    END;

    PROCEDURE SetToPurchHeader@4(NewToPurchHeader@1000 : Record 38;UsePayTo@1001 : Boolean);
    BEGIN
      ToPurchHeader := NewToPurchHeader;
      PayTo := UsePayTo;
    END;

    BEGIN
    END.
  }
}
