OBJECT Form 7035306 Calendario - Atennea Transfer
{
  OBJECT-PROPERTIES
  {
    Date=16/10/09;
    Time=12:32:58;
    Modified=Yes;
    Version List=TRANSFER;
  }
  PROPERTIES
  {
    Width=5500;
    Height=5170;
    BackColor=16777215;
    CaptionML=[ENU=" ";
               ESP=" "];
    Minimizable=No;
    Maximizable=No;
    Sizeable=No;
    ActiveControlOnOpen=5;
    SaveControlInfo=No;
    HorzGrid=55;
    VertGrid=55;
    DataCaptionExpr=FORMAT(dateChosen, 0,'<Month Text>, <Day>, <Year4> - Sem <Week>');
    OnInit=BEGIN
             intBaseYear := 1 // <= Change this date if you desire to a different starting year  ( 1..9998 )
           END;

    OnOpenForm=VAR
                 txtDayNames@1100217000 : Text[250];
                 intCounter@1100217001 : Integer;
                 dateStart@1100217002 : Date;
               BEGIN
                 txtDayNames := Text000;

                 wXOrigin := 770;
                 wYOrigin := 1485;
                 wXStep := 550;
                 wYStep := 440;

                 FOR intCounter := 1 TO 7 DO
                   txtDayLabel[intCounter] := SELECTSTR(intCounter,txtDayNames);

                 IF FORMAT(dateChosen) = '' THEN
                   IF (DATE2DMY( WORKDATE, 3) >=intBaseYear) AND (DATE2DMY( WORKDATE, 3) <= 9998)  THEN
                     dateChosen := WORKDATE
                   ELSE
                     dateChosen := DMY2DATE(1,1,intBaseYear);

                 dateStart := dateChosen;

                 optMonth := DATE2DMY( dateChosen, 2 ) - 1;
                 IntYear := DATE2DMY( dateChosen, 3 );
                 UpdateDays(dateChosen, optMonth, IntYear, intDayNumber);
                 UpdateWeeks(dateChosen, optMonth, IntYear, IntWeekNumber);
                 dateChosen := dateStart;
                 UpdateEnableDays;
               END;

  }
  CONTROLS
  {
    { 13  ;Shape        ;110  ;770  ;550  ;440  ;Name=ctlFrame;
                                                 Visible=No;
                                                 BackColor=12632256;
                                                 BackTransparent=No;
                                                 BorderColor=16711680;
                                                 BorderWidth=2pt }
    { 4   ;TextBox      ;770  ;770  ;550  ;440  ;Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 ForeColor=8388608;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderColor=16777215;
                                                 BorderStyle=BumpUp;
                                                 BorderWidth=Hairline;
                                                 FontBold=Yes;
                                                 SourceExpr=txtDayLabel[1] }
    { 5   ;CommandButton;4015 ;4455 ;605  ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Default=Yes;
                                                 ShowCaption=No;
                                                 BitmapPos=Center;
                                                 PushAction=OK;
                                                 InvalidActionAppearance=Normal;
                                                 Bitmap=\\server-lpd\productos\bdfin\FinHotel\iconos&imagenes\calendario\aceptar.bmp;
                                                 CaptionML=[ENU=&Accept;
                                                            ESP=&Aceptar];
                                                 ToolTipML=[ENU=Accept;
                                                            ESP=Aceptar;
                                                            ESN=Aceptar];
                                                 OnPush=BEGIN
                                                          dateReturnValue := dateChosen;
                                                        END;
                                                         }
    { 6   ;CommandButton;4730 ;4455 ;605  ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Cancel=No;
                                                 ShowCaption=No;
                                                 HorzAlign=Center;
                                                 VertAlign=Center;
                                                 BitmapPos=Center;
                                                 PushAction=Close;
                                                 InvalidActionAppearance=Normal;
                                                 Bitmap=\\server-lpd\productos\bdfin\FinHotel\iconos&imagenes\calendario\cancelar.bmp;
                                                 CaptionML=[ENU=&Cancel;
                                                            ESN=&Cancelar];
                                                 ToolTipML=[ENU=Cancel;
                                                            ESP=Cancelar;
                                                            ESN=Cancelar];
                                                 OnPush=BEGIN
                                                          dateReturnValue := dateInitial;
                                                          dateReturnValue := 0D;
                                                        END;
                                                         }
    { 7   ;TextBox      ;1430 ;770  ;550  ;440  ;Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 ForeColor=8388608;
                                                 BackColor=12632256;
                                                 Border=No;
                                                 BorderStyle=BumpUp;
                                                 FontBold=Yes;
                                                 SourceExpr=txtDayLabel[2] }
    { 8   ;TextBox      ;2090 ;770  ;550  ;440  ;Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 ForeColor=8388608;
                                                 BackColor=12632256;
                                                 Border=No;
                                                 BorderStyle=BumpUp;
                                                 FontBold=Yes;
                                                 SourceExpr=txtDayLabel[3] }
    { 9   ;TextBox      ;2750 ;770  ;550  ;440  ;Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 ForeColor=8388608;
                                                 BackColor=8421376;
                                                 BackTransparent=No;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 SourceExpr=txtDayLabel[4] }
    { 10  ;TextBox      ;3410 ;770  ;550  ;440  ;Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 ForeColor=8388608;
                                                 BackColor=12632256;
                                                 Border=No;
                                                 BorderStyle=BumpUp;
                                                 FontBold=Yes;
                                                 SourceExpr=txtDayLabel[5] }
    { 11  ;TextBox      ;4070 ;770  ;550  ;440  ;Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 ForeColor=8388608;
                                                 BackColor=12632256;
                                                 Border=No;
                                                 BorderStyle=BumpUp;
                                                 FontBold=Yes;
                                                 SourceExpr=txtDayLabel[6] }
    { 12  ;TextBox      ;4730 ;770  ;550  ;440  ;Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 ForeColor=8388608;
                                                 BackColor=12632256;
                                                 Border=No;
                                                 BorderStyle=BumpUp;
                                                 FontBold=Yes;
                                                 SourceExpr=txtDayLabel[7] }
    { 32  ;TextBox      ;2090 ;1980 ;550  ;440  ;Name=dia10;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[10];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 10, dateChosen );
                                                            END;
                                                             }
    { 33  ;TextBox      ;2090 ;1485 ;550  ;440  ;Name=dia3;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[3];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 3, dateChosen );
                                                            END;
                                                             }
    { 34  ;TextBox      ;2090 ;2475 ;550  ;440  ;Name=dia17;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[17];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 17, dateChosen );
                                                            END;
                                                             }
    { 37  ;TextBox      ;2090 ;2970 ;550  ;440  ;Name=dia24;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[24];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 24, dateChosen );
                                                            END;
                                                             }
    { 38  ;TextBox      ;2090 ;3465 ;550  ;440  ;Name=dia31;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[31];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 31, dateChosen );
                                                            END;
                                                             }
    { 40  ;TextBox      ;770  ;3960 ;550  ;440  ;Name=dia36;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[36];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 36, dateChosen );
                                                            END;
                                                             }
    { 41  ;TextBox      ;770  ;3465 ;550  ;440  ;Name=dia29;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[29];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 29, dateChosen );
                                                            END;
                                                             }
    { 42  ;TextBox      ;770  ;2970 ;550  ;440  ;Name=dia22;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[22];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 22, dateChosen );
                                                            END;
                                                             }
    { 43  ;TextBox      ;770  ;2475 ;550  ;440  ;Name=dia15;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[15];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 15, dateChosen );
                                                            END;
                                                             }
    { 44  ;TextBox      ;770  ;1980 ;550  ;440  ;Name=dia8;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[8];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 8, dateChosen );
                                                            END;
                                                             }
    { 45  ;TextBox      ;770  ;1485 ;550  ;440  ;Name=dia1;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[1];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 1, dateChosen );
                                                            END;
                                                             }
    { 46  ;TextBox      ;1430 ;3960 ;550  ;440  ;Name=dia37;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[37];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 37, dateChosen );
                                                            END;
                                                             }
    { 47  ;TextBox      ;1430 ;3465 ;550  ;440  ;Name=dia30;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[30];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 30, dateChosen );
                                                            END;
                                                             }
    { 48  ;TextBox      ;1430 ;2970 ;550  ;440  ;Name=dia23;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[23];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 23, dateChosen );
                                                            END;
                                                             }
    { 49  ;TextBox      ;1430 ;2475 ;550  ;440  ;Name=dia16;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[16];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 16, dateChosen );
                                                            END;
                                                             }
    { 50  ;TextBox      ;1430 ;1980 ;550  ;440  ;Name=dia9;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[9];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 9, dateChosen );
                                                            END;
                                                             }
    { 51  ;TextBox      ;1430 ;1485 ;550  ;440  ;Name=dia2;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[2];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 2, dateChosen )
                                                            END;
                                                             }
    { 52  ;TextBox      ;2750 ;3465 ;550  ;440  ;Name=dia32;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[32];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 32, dateChosen );
                                                            END;
                                                             }
    { 53  ;TextBox      ;2750 ;2970 ;550  ;440  ;Name=dia25;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[25];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 25, dateChosen );
                                                            END;
                                                             }
    { 54  ;TextBox      ;2750 ;2475 ;550  ;440  ;Name=dia18;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[18];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 18, dateChosen );
                                                            END;
                                                             }
    { 55  ;TextBox      ;2750 ;1980 ;550  ;440  ;Name=dia11;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[11];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 11, dateChosen );
                                                            END;
                                                             }
    { 56  ;TextBox      ;2750 ;1485 ;550  ;440  ;Name=dia4;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[4];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 4, dateChosen );
                                                            END;
                                                             }
    { 57  ;TextBox      ;3410 ;3465 ;550  ;440  ;Name=dia33;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[33];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 33, dateChosen );
                                                            END;
                                                             }
    { 58  ;TextBox      ;3410 ;2970 ;550  ;440  ;Name=dia26;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[26];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 26, dateChosen );
                                                            END;
                                                             }
    { 59  ;TextBox      ;3410 ;2475 ;550  ;440  ;Name=dia19;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[19];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 19, dateChosen );
                                                            END;
                                                             }
    { 60  ;TextBox      ;3410 ;1980 ;550  ;440  ;Name=dia12;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[12];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 12, dateChosen );
                                                            END;
                                                             }
    { 61  ;TextBox      ;3410 ;1485 ;550  ;440  ;Name=dia5;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[5];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 5, dateChosen );
                                                            END;
                                                             }
    { 62  ;TextBox      ;4070 ;3465 ;550  ;440  ;Name=dia34;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[34];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 34, dateChosen );
                                                            END;
                                                             }
    { 63  ;TextBox      ;4070 ;2970 ;550  ;440  ;Name=dia27;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[27];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 27, dateChosen );
                                                            END;
                                                             }
    { 64  ;TextBox      ;4070 ;2475 ;550  ;440  ;Name=dia20;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[20];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 20, dateChosen );
                                                            END;
                                                             }
    { 65  ;TextBox      ;4070 ;1980 ;550  ;440  ;Name=dia13;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[13];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 13, dateChosen );
                                                            END;
                                                             }
    { 66  ;TextBox      ;4070 ;1485 ;550  ;440  ;Name=dia6;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[6];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 6, dateChosen );
                                                            END;
                                                             }
    { 67  ;TextBox      ;4730 ;3465 ;550  ;440  ;Name=dia35;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 ForeColor=128;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[35];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 35, dateChosen );
                                                            END;
                                                             }
    { 68  ;TextBox      ;4730 ;2970 ;550  ;440  ;Name=dia28;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 ForeColor=128;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[28];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 28, dateChosen );
                                                            END;
                                                             }
    { 69  ;TextBox      ;4730 ;2475 ;550  ;440  ;Name=dia21;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 ForeColor=128;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[21];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 21, dateChosen );
                                                            END;
                                                             }
    { 70  ;TextBox      ;4730 ;1980 ;550  ;440  ;Name=dia14;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 ForeColor=128;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[14];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 14, dateChosen );
                                                            END;
                                                             }
    { 71  ;TextBox      ;4730 ;1485 ;550  ;440  ;Name=dia7;
                                                 Editable=No;
                                                 Focusable=Yes;
                                                 HorzAlign=Center;
                                                 ForeColor=128;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontBold=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=intDayNumber[7];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 7, dateChosen );
                                                            END;
                                                             }
    { 73  ;Shape        ;715  ;1925 ;4620 ;55   ;BorderColor=8421504;
                                                 ShapeStyle=HorzLine }
    { 74  ;Shape        ;715  ;2420 ;4620 ;55   ;BorderColor=8421504;
                                                 ShapeStyle=HorzLine }
    { 75  ;Shape        ;715  ;2915 ;4620 ;55   ;BorderColor=8421504;
                                                 ShapeStyle=HorzLine }
    { 76  ;Shape        ;715  ;3410 ;4620 ;55   ;BorderColor=8421504;
                                                 ShapeStyle=HorzLine }
    { 77  ;Shape        ;715  ;3905 ;4620 ;55   ;BorderColor=8421504;
                                                 ShapeStyle=HorzLine }
    { 78  ;Shape        ;715  ;1265 ;4620 ;110  ;BackColor=8421504;
                                                 BackTransparent=No;
                                                 Border=Yes;
                                                 BorderColor=8421504 }
    { 17  ;CommandButton;220  ;110  ;275  ;440  ;ShowCaption=No;
                                                 HorzAlign=Center;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 BitmapPos=Center;
                                                 AutoRepeat=Yes;
                                                 Bitmap=15;
                                                 ToolTipML=ESN=Mes anterior;
                                                 OnPush=BEGIN
                                                          IF optMonth >0 THEN
                                                            optMonth := optMonth - 1
                                                          ELSE
                                                            IF IntYear > intBaseYear THEN
                                                              BEGIN
                                                                optMonth := 11;
                                                                IntYear  := IntYear-1
                                                              END
                                                            ELSE
                                                              BEEP(500,300);

                                                          UpdateDays( dateChosen, optMonth, IntYear, intDayNumber );
                                                          UpdateWeeks( dateChosen, optMonth, IntYear, IntWeekNumber );
                                                          UpdateEnableDays;
                                                        END;
                                                         }
    { 18  ;CommandButton;2640 ;110  ;275  ;440  ;ShowCaption=No;
                                                 HorzAlign=Left;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 BitmapPos=Center;
                                                 AutoRepeat=Yes;
                                                 Bitmap=16;
                                                 ToolTipML=ESN=Mes siguiente;
                                                 OnPush=VAR
                                                          i@1100217001 : Integer;
                                                        BEGIN
                                                          IF optMonth <11 THEN
                                                            optMonth := optMonth + 1
                                                          ELSE
                                                            IF IntYear < 9998 THEN
                                                              BEGIN
                                                                optMonth := 0;
                                                                IntYear := IntYear+1
                                                              END
                                                            ELSE
                                                              BEEP( 500,300);

                                                          UpdateDays( dateChosen, optMonth, IntYear, intDayNumber );
                                                          UpdateWeeks( dateChosen, optMonth, IntYear, IntWeekNumber );
                                                          UpdateEnableDays;
                                                        END;
                                                         }
    { 14  ;CommandButton;3465 ;110  ;330  ;440  ;ShowCaption=No;
                                                 HorzAlign=Center;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 BitmapPos=Center;
                                                 AutoRepeat=Yes;
                                                 Bitmap=15;
                                                 ToolTipML=ESN=Ao anterior;
                                                 OnPush=BEGIN
                                                            IF IntYear > intBaseYear THEN
                                                                IntYear := IntYear-1
                                                            ELSE
                                                              BEEP(500,300);

                                                          UpdateDays( dateChosen, optMonth, IntYear, intDayNumber );
                                                          UpdateWeeks( dateChosen, optMonth, IntYear, IntWeekNumber );
                                                          UpdateEnableDays;
                                                        END;
                                                         }
    { 15  ;CommandButton;5005 ;110  ;275  ;440  ;ShowCaption=No;
                                                 HorzAlign=Center;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 BitmapPos=Center;
                                                 AutoRepeat=Yes;
                                                 Bitmap=16;
                                                 ToolTipML=ESN=Ao siguiente;
                                                 OnPush=BEGIN
                                                            IF IntYear < 9998 THEN
                                                              IntYear := IntYear+1
                                                            ELSE
                                                              BEEP(500,300);

                                                          UpdateDays( dateChosen, optMonth, IntYear, intDayNumber );
                                                          UpdateWeeks( dateChosen, optMonth, IntYear, IntWeekNumber );
                                                          UpdateEnableDays;
                                                        END;
                                                         }
    { 24  ;TextBox      ;110  ;1485 ;550  ;440  ;Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 VertAlign=Bottom;
                                                 ForeColor=255;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontSize=6;
                                                 FontBold=No;
                                                 BlankZero=Yes;
                                                 SourceExpr=IntWeekNumber[1];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 1, dateChosen );
                                                            END;
                                                             }
    { 25  ;TextBox      ;110  ;1980 ;550  ;440  ;Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 VertAlign=Bottom;
                                                 ForeColor=255;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontSize=6;
                                                 FontBold=No;
                                                 BlankZero=Yes;
                                                 SourceExpr=IntWeekNumber[2];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 1, dateChosen );
                                                            END;
                                                             }
    { 26  ;TextBox      ;110  ;2475 ;550  ;440  ;Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 VertAlign=Bottom;
                                                 ForeColor=255;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontSize=6;
                                                 FontBold=No;
                                                 BlankZero=Yes;
                                                 SourceExpr=IntWeekNumber[3];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 1, dateChosen );
                                                            END;
                                                             }
    { 27  ;TextBox      ;110  ;2970 ;550  ;440  ;Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 VertAlign=Bottom;
                                                 ForeColor=255;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontSize=6;
                                                 FontBold=No;
                                                 BlankZero=Yes;
                                                 SourceExpr=IntWeekNumber[4];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 1, dateChosen );
                                                            END;
                                                             }
    { 28  ;TextBox      ;110  ;3465 ;550  ;440  ;Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 VertAlign=Bottom;
                                                 ForeColor=255;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontSize=6;
                                                 FontBold=No;
                                                 BlankZero=Yes;
                                                 SourceExpr=IntWeekNumber[5];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 1, dateChosen );
                                                            END;
                                                             }
    { 29  ;TextBox      ;110  ;3960 ;550  ;440  ;Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 VertAlign=Bottom;
                                                 ForeColor=255;
                                                 BackColor=16777215;
                                                 Border=No;
                                                 BorderStyle=Normal;
                                                 FontSize=6;
                                                 FontBold=No;
                                                 BlankZero=Yes;
                                                 SourceExpr=IntWeekNumber[6];
                                                 OnActivate=VAR
                                                              intDay@1100217001 : Integer;
                                                            BEGIN
                                                              OnActivateDayLabel( 1, dateChosen );
                                                            END;
                                                             }
    { 1100217000;CommandButton;3300;4455;605;550;FontBold=Yes;
                                                 CaptionML=[ENU=T;
                                                            ESP=H;
                                                            ESN=H];
                                                 ToolTipML=[ENU=Today;
                                                            ESP=Hoy;
                                                            ESN=Hoy];
                                                 OnPush=VAR
                                                          dateStart@1100217000 : Date;
                                                        BEGIN
                                                          dateChosen := WORKDATE;
                                                          dateStart := dateChosen;

                                                          optMonth := DATE2DMY(dateChosen, 2) - 1;
                                                          IntYear := DATE2DMY(dateChosen, 3);
                                                          UpdateDays(dateChosen, optMonth, IntYear, intDayNumber);
                                                          UpdateWeeks(dateChosen, optMonth, IntYear, IntWeekNumber);
                                                          dateChosen := dateStart;
                                                          UpdateEnableDays;
                                                        END;
                                                         }
    { 1100217003;TextBox;495  ;110  ;2145 ;440  ;Name=ctlSelectMonth;
                                                 SourceExpr=optMonth;
                                                 OnAfterValidate=BEGIN
                                                                   UpdateDays( dateChosen, optMonth, IntYear, intDayNumber );
                                                                   UpdateWeeks( dateChosen, optMonth, IntYear, IntWeekNumber );
                                                                   UpdateEnableDays;
                                                                 END;
                                                                  }
    { 1100217004;TextBox;3795 ;110  ;1210 ;440  ;SourceExpr=IntYear;
                                                 OnValidate=BEGIN
                                                              UpdateDays( dateChosen, optMonth, IntYear, intDayNumber );
                                                              UpdateWeeks( dateChosen, optMonth, IntYear, IntWeekNumber );
                                                              UpdateEnableDays;
                                                            END;
                                                             }
  }
  CODE
  {
    VAR
      Text000@1100217000 : TextConst 'ESP=Lu,Ma,Mi,Ju,Vi,Sa,Do';
      optMonth@1100217001 : 'Enero,Febrero,Marzo,Abril,Mayo,Junio,Julio,Agosto,Septiembre,Octubre,Noviembre,Diciembre';
      txtDayLabel@1100217002 : ARRAY [7] OF Text[30];
      dateChosen@1100217004 : Date;
      dateReturnValue@1100217005 : Date;
      dateInitial@1100217006 : Date;
      intDayNumber@1100217003 : ARRAY [37] OF Integer;
      intBaseYear@1100217007 : Integer;
      IntYear@1100217008 : Integer;
      IntWeekNumber@1100217009 : ARRAY [6] OF Integer;
      wXOrigin@1100217010 : Integer;
      wYOrigin@1100217011 : Integer;
      wXStep@1100217012 : Integer;
      wYStep@1100217013 : Integer;
      wFirstDayMonth@1100217014 : Integer;
      wLastDayMonth@1100217015 : Integer;
      Text001@1100217016 : TextConst 'ESP=CurrForm.dia37.ENABLED';

    PROCEDURE UpdateDays@18(VAR p_dateSetDate@1100217000 : Date;p_optMonth@1100217001 : 'January,February,March,April,May,June,July,August,September,October,November,December';p_intYear@1100217002 : Integer;VAR p_intDayArray@1100217003 : ARRAY [37] OF Integer);
    VAR
      dateDayNumber@1100217004 : ARRAY [42] OF Integer;
      dateFirstDayOfSelection@1100217005 : Date;
      dateOpDate@1100217006 : Date;
      intDayStart@1100217007 : Integer;
      intCounter@1100217008 : Integer;
      intMonth@1100217009 : Integer;
    BEGIN
      //------------------------------------------------------------------------------------------------------------
      //WHAT:  Given a month <p_optMonth> and a year <p_optYear>, updates the array <p_intDayArray> which holds the
      //       day number for every day in that month of that year. It also sets the parameter <p_dateSetDate> to
      //       the first day of that month.
      //
      //INPUT: VAR <p_dateSetDate> : Holds the variable where we'll set the first day of the month
      //           <p_optMonth>    : Month chosen
      //           <p_intYear>     : Year chosen
      //       VAR <p_intDayArray> : Holder for the array of the days of that month
      //
      //
      //WHO:     JFC 22.06.99
      //------------------------------------------------------------------------------------------------------------

      intMonth := p_optMonth;
      dateFirstDayOfSelection := DMY2DATE( 1, 1+p_optMonth, p_intYear );
      p_dateSetDate := dateFirstDayOfSelection;
      dateOpDate := dateFirstDayOfSelection;
      FOR intCounter := 1 TO 37 DO
        p_intDayArray[intCounter] := 0;

      intCounter := 0;
      intDayStart := DATE2DWY(dateFirstDayOfSelection,1);
      wFirstDayMonth := 0;
      wLastDayMonth := 0;

      WHILE DATE2DMY(dateOpDate,2) = DATE2DMY(dateFirstDayOfSelection,2) DO
        BEGIN
          p_intDayArray[intCounter + intDayStart] := intCounter+1;
          IF wFirstDayMonth = 0 THEN
            wFirstDayMonth := intCounter + intDayStart;
          dateOpDate := dateOpDate + 1;
          intCounter := intCounter + 1;
        END;

      wLastDayMonth := intCounter + intDayStart - 1;
    END;

    PROCEDURE UpdateFrame@22(p_intDayNumber@1100217000 : Integer;p_intXOrigin@1100217001 : Integer;p_intYOrigin@1100217002 : Integer;p_intXStep@1100217003 : Integer;p_intYStep@1100217004 : Integer);
    BEGIN
      //------------------------------------------------------------------------------------------------------------
      //WHAT:  Given the index of a day <p_intDayNumber> and a set of origin coordinates, computes the adequate
      //       coordinates and sets the frame to the correct position
      //
      //INPUT: <p_intDayNumber> : The index of a day within a month
      //       <p_intXOrigin>,
      //       <p_intYOrigin>,
      //       <p_intXStep>,
      //       <p_intYStep>     : Coordinates of the origin and distance between days
      //
      //OUTPUT: Nothing
      //
      //WHO:    JFC 22.06.99
      //------------------------------------------------------------------------------------------------------------

      CurrForm.ctlFrame.VISIBLE := TRUE;
      CurrForm.ctlFrame.XPOS := p_intXOrigin+((p_intDayNumber-1) MOD 7)* (p_intXStep + 110);
      CurrForm.ctlFrame.YPOS := p_intYOrigin+((p_intDayNumber-1) DIV 7)* (p_intYStep + 55);
    END;

    PROCEDURE DateOffset@1(p_dateAnyDate@1100217000 : Date) : Integer;
    VAR
      dateFirstOfMonth@1100217001 : Date;
    BEGIN
      //------------------------------------------------------------------------------------------------------------
      //WHAT:  Given a date <p_dateAnyDate>, returns the number of days between that date and the first day of
      //       its month.
      //
      //INPUT: <p_dateAnyDate> The date whose month offset we are looking for
      //
      //OUTPUT: [Integer] -> The month offset for the parameter.
      //
      //WHO:    JFC 22.06.99
      //------------------------------------------------------------------------------------------------------------
      dateFirstOfMonth := DMY2DATE( 1, DATE2DMY(p_dateAnyDate,2), DATE2DMY(p_dateAnyDate,3)) ;
      EXIT( DATE2DWY( dateFirstOfMonth, 1 )-1);
    END;

    PROCEDURE SetStartDate@17(p_dateStart@1100217000 : Date);
    BEGIN
      //------------------------------------------------------------------------------------------------------------
      //WHAT:  Sets the three globals dateInitial, dateReturnValue, dateChosen to the value of the parameter
      //
      //INPUT: <p_dateStart> The date we want to set the globals to
      //
      //OUTPUT: Nothing
      //
      //WHO:    JFC 22.06.99
      //------------------------------------------------------------------------------------------------------------
      dateInitial     := p_dateStart;
      dateReturnValue := p_dateStart;
      dateChosen      := p_dateStart;
    END;

    PROCEDURE GetChosenDate@2() : Date;
    BEGIN
      //------------------------------------------------------------------------------------------------------------
      //WHAT:  Returns the global variable dateReturnValue
      //       Note: It is needed because functions are the only way to communicate with forms
      //
      //
      //OUTPUT: Date -> dateReturnValue; the value chosen by the user
      //
      //
      //WHO:    JFC 22.06.99
      //------------------------------------------------------------------------------------------------------------
      EXIT( dateReturnValue );
    END;

    PROCEDURE OnActivateDayLabel@7(p_intDay@1100217000 : Integer;VAR p_dateChosen@1100217001 : Date);
    BEGIN
      //------------------------------------------------------------------------------------------------------------
      //WHAT:  Perform the common code of the OnActivate triggers of the Day fields. Moves the frame over the
      //       focused field and updates the second parameter to the corresponding date.
      //
      //INPUT: <p_intDay>         : Index to the intDay[] array.
      //       VAR <p_dateChosen> : Variable which will get the chosen date.
      //
      //OUTPUT: Nothing
      //
      //GLOBALS: Uses intDayNumber[], optMonth, intYear
      //
      //WHO:    JFC 22.06.99
      //------------------------------------------------------------------------------------------------------------
      IF intDayNumber[p_intDay] <>0 THEN
        BEGIN
          UpdateFrame( p_intDay, wXOrigin,wYOrigin,wXStep,wYStep );
          CurrForm.UPDATE(FALSE);
          p_dateChosen := DMY2DATE( intDayNumber[p_intDay], optMonth+1, IntYear );
        END
    END;

    PROCEDURE UpdateWeeks@3(VAR p_dateSetDate@1100217000 : Date;p_optMonth@1100217001 : 'Enero,Febrero,Marzo,Abril,Mayo,Junio,Julio,Agosto,Setiembre,Octubre,Noviembre,Diciembre';p_intYear@1100217002 : Integer;VAR p_intWeekArray@1100217003 : ARRAY [6] OF Integer);
    VAR
      dateDayNumber@1100217004 : ARRAY [42] OF Integer;
      dateFirstWeekOfSelection@1100217005 : Date;
      dateOpDate@1100217006 : Date;
      intDayStart@1100217007 : Integer;
      intCounter@1100217008 : Integer;
      intMonth@1100217009 : Integer;
      intCounterWeek@1100217010 : Integer;
    BEGIN
      //------------------------------------------------------------------------------------------------------------
      //WHAT:  Given a month <p_optMonth> and a year <p_optYear>, updates the array <p_intWeekArray> which holds the
      //       week number for every week in that month of that year. It also sets the parameter <p_dateSetDate> to
      //       the first day of that month.
      //
      //INPUT: VAR <p_dateSetDate> : Holds the variable where we'll set the first day of the month
      //           <p_optMonth>    : Month chosen
      //           <p_intYear>     : Year chosen
      //       VAR <p_intDayArray> : Holder for the array of the days of that month
      //
      //
      //WHO:     FLB 23.10.00
      //------------------------------------------------------------------------------------------------------------

      intMonth := p_optMonth;
      dateFirstWeekOfSelection := DMY2DATE( 1, 1+p_optMonth, p_intYear );
      p_dateSetDate := dateFirstWeekOfSelection;
      dateOpDate := dateFirstWeekOfSelection;
      FOR intCounter := 1 TO 6 DO p_intWeekArray[ intCounter ] := 0;
      intCounter := 1;
      intCounterWeek := 1;

      p_intWeekArray[1] := DATE2DWY(dateFirstWeekOfSelection, 2);

      WHILE intCounter < 36 DO
        BEGIN
          intCounter := intCounter + 7;
          intCounterWeek := intCounterWeek + 1;
          IF intDayNumber[intCounter] <> 0 THEN
            p_intWeekArray[intCounterWeek] := DATE2DWY(
                                   DMY2DATE(intDayNumber[intCounter], p_optMonth + 1, p_intYear),2);
        END;
    END;

    PROCEDURE UpdateEnableDays@1100217000();
    BEGIN
      //UpdateEnablesDays

      //Pone como no disponibles los controles de dias no utilizados por el mes actual.
      //Situa el cursor en el dia seleccionado.

      CurrForm.dia1.ENABLED := TRUE; CurrForm.dia2.ENABLED := TRUE; CurrForm.dia3.ENABLED := TRUE;
      CurrForm.dia4.ENABLED := TRUE; CurrForm.dia5.ENABLED := TRUE; CurrForm.dia6.ENABLED := TRUE;

      IF wFirstDayMonth > 1 THEN
        CurrForm.dia1.ENABLED := FALSE;
      IF wFirstDayMonth > 2 THEN
        CurrForm.dia2.ENABLED := FALSE;
      IF wFirstDayMonth > 3 THEN
        CurrForm.dia3.ENABLED := FALSE;
      IF wFirstDayMonth > 4 THEN
        CurrForm.dia4.ENABLED := FALSE;
      IF wFirstDayMonth > 5 THEN
        CurrForm.dia5.ENABLED := FALSE;
      IF wFirstDayMonth > 6 THEN
        CurrForm.dia6.ENABLED := FALSE;

      CurrForm.dia29.ENABLED := TRUE; CurrForm.dia30.ENABLED := TRUE; CurrForm.dia31.ENABLED := TRUE;
      CurrForm.dia32.ENABLED := TRUE; CurrForm.dia33.ENABLED := TRUE; CurrForm.dia34.ENABLED := TRUE;
      CurrForm.dia35.ENABLED := TRUE; CurrForm.dia36.ENABLED := TRUE; CurrForm.dia37.ENABLED := TRUE;

      IF wLastDayMonth < 37 THEN
        CurrForm.dia37.ENABLED := FALSE;
      IF wLastDayMonth < 36 THEN
        CurrForm.dia36.ENABLED := FALSE;
      IF wLastDayMonth < 35 THEN
        CurrForm.dia35.ENABLED := FALSE;
      IF wLastDayMonth < 34 THEN
        CurrForm.dia34.ENABLED := FALSE;
      IF wLastDayMonth < 33 THEN
        CurrForm.dia33.ENABLED := FALSE;
      IF wLastDayMonth < 32 THEN
        CurrForm.dia32.ENABLED := FALSE;
      IF wLastDayMonth < 31 THEN
        CurrForm.dia31.ENABLED := FALSE;
      IF wLastDayMonth < 30 THEN
        CurrForm.dia30.ENABLED := FALSE;
      IF wLastDayMonth < 29 THEN
        CurrForm.dia29.ENABLED := FALSE;

      CASE (DATE2DMY(dateChosen,1)+DateOffset(dateChosen)) OF
        1 : CurrForm.dia1.ACTIVATE;
        2 : CurrForm.dia2.ACTIVATE;
        3 : CurrForm.dia3.ACTIVATE;
        4 : CurrForm.dia4.ACTIVATE;
        5 : CurrForm.dia5.ACTIVATE;
        6 : CurrForm.dia6.ACTIVATE;
        7 : CurrForm.dia7.ACTIVATE;
        8 : CurrForm.dia8.ACTIVATE;
        9 : CurrForm.dia9.ACTIVATE;
        10 : CurrForm.dia10.ACTIVATE;
        11 : CurrForm.dia11.ACTIVATE;
        12 : CurrForm.dia12.ACTIVATE;
        13 : CurrForm.dia13.ACTIVATE;
        14 : CurrForm.dia14.ACTIVATE;
        15 : CurrForm.dia15.ACTIVATE;
        16 : CurrForm.dia16.ACTIVATE;
        17 : CurrForm.dia17.ACTIVATE;
        18 : CurrForm.dia18.ACTIVATE;
        19 : CurrForm.dia19.ACTIVATE;
        20 : CurrForm.dia20.ACTIVATE;
        21 : CurrForm.dia21.ACTIVATE;
        22 : CurrForm.dia22.ACTIVATE;
        23 : CurrForm.dia23.ACTIVATE;
        24 : CurrForm.dia24.ACTIVATE;
        25 : CurrForm.dia25.ACTIVATE;
        26 : CurrForm.dia26.ACTIVATE;
        27 : CurrForm.dia27.ACTIVATE;
        28 : CurrForm.dia28.ACTIVATE;
        29 : CurrForm.dia29.ACTIVATE;
        30 : CurrForm.dia30.ACTIVATE;
        31 : CurrForm.dia31.ACTIVATE;
        32 : CurrForm.dia32.ACTIVATE;
        33 : CurrForm.dia33.ACTIVATE;
        34 : CurrForm.dia34.ACTIVATE;
        35 : CurrForm.dia35.ACTIVATE;
        36 : CurrForm.dia36.ACTIVATE;
        37 : CurrForm.dia37.ACTIVATE;
      END;
    END;

    BEGIN
    END.
  }
}
