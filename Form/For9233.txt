OBJECT Form 9233 G/L Balance by Dim. Matrix
{
  OBJECT-PROPERTIES
  {
    Date=14/08/09;
    Time=12:00:00;
    Version List=NAVW16.00.01;
  }
  PROPERTIES
  {
    Width=20790;
    Height=6710;
    CaptionML=ENU=G/L Balance by Dim. Matrix;
    InsertAllowed=No;
    DeleteAllowed=No;
    LinksAllowed=No;
    SourceTable=Table367;
    OnOpenForm=BEGIN
                 GLAcc.SETPERMISSIONFILTER;
                 Code := '';

                 GLSetup.GET;

                 IF (LineDimCode = '') AND (ColumnDimCode = '') THEN BEGIN
                   LineDimCode := GLAcc.TABLECAPTION;
                   ColumnDimCode := Text001;
                 END;
                 LineDimOption := DimCodeToOption(LineDimCode);
                 ColumnDimOption := DimCodeToOption(ColumnDimCode);

                 CalculateClosingDateFilter;

                 MATRIX_NoOfMatrixColumns := ARRAYLEN(MATRIX_CellData);
                 FindRec(ColumnDimOption,MatrixRecord,'=');
                 SetColumnVisibility;
               END;

    OnFindRecord=BEGIN
                   EXIT(FindRec(LineDimOption,Rec,Which));
                 END;

    OnNextRecord=BEGIN
                   EXIT(NextRec(LineDimOption,Rec,Steps));
                 END;

    OnAfterGetRecord=VAR
                       MATRIX_CurrentColumnOrdinal@1148 : Integer;
                       MATRIX_Steps@1149 : Integer;
                     BEGIN
                       //IF CurrForm.TotalAmount.VISIBLE THEN
                         Amount := CalcAmount(FALSE);

                       CASE RoundingFactor OF
                         RoundingFactor::"1":
                           Amount := ROUND(Amount,1);
                         RoundingFactor::"1000":
                           Amount := ROUND(Amount / 1000,0.1);
                         RoundingFactor::"1000000":
                           Amount := ROUND(Amount / 1000000,0.1);
                       END;

                       MATRIX_CurrentColumnOrdinal := 0;
                       MatrixRecord.SETPOSITION(MATRIX_PrimKeyFirstCol);


                       IF MATRIX_OnFindRecord('=><') THEN BEGIN
                         MATRIX_CurrentColumnOrdinal := 1;
                         REPEAT
                           MATRIX_ColumnOrdinal := MATRIX_CurrentColumnOrdinal;
                           MATRIX_OnAfterGetRecord;
                           MATRIX_Steps := MATRIX_OnNextRecord(1);
                           MATRIX_CurrentColumnOrdinal := MATRIX_CurrentColumnOrdinal + MATRIX_Steps;
                         UNTIL (MATRIX_CurrentColumnOrdinal - MATRIX_Steps = MATRIX_NoOfMatrixColumns) OR (MATRIX_Steps = 0);
                         IF MATRIX_CurrentColumnOrdinal <> 1 THEN
                           MATRIX_OnNextRecord(1 - MATRIX_CurrentColumnOrdinal);
                       END
                     END;

  }
  CONTROLS
  {
    { 1   ;TableBox     ;220  ;220  ;20350;5500 ;HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Editable=No }
    { 120 ;TextBox      ;3493 ;3080 ;2420 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Code;
                                                 OnLookup=BEGIN
                                                            LookUpCode(LineDimOption,LineDimCode,Code);
                                                          END;
                                                           }
    { 1150;Label        ;0    ;0    ;0    ;0    ;ParentControl=120;
                                                 InColumnHeading=Yes }
    { 22  ;TextBox      ;3493 ;3080 ;2420 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Name }
    { 1151;Label        ;0    ;0    ;0    ;0    ;ParentControl=22;
                                                 InColumnHeading=Yes }
    { 24  ;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=TotalAmount;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 CaptionML=ENU=Total Amount;
                                                 BlankZero=Yes;
                                                 SourceExpr=+Amount;
                                                 OnActivate=BEGIN
                                                              // Amount := CalcAmount(FALSE);
                                                            END;

                                                 OnDrillDown=BEGIN
                                                               DrillDown(FALSE);
                                                             END;
                                                              }
    { 1152;Label        ;0    ;0    ;0    ;0    ;ParentControl=24;
                                                 InColumnHeading=Yes }
    { 1116;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field1;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[1];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[1];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(1);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1153;Label        ;0    ;0    ;0    ;0    ;ParentControl=1116;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1117;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field2;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[2];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[2];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(2);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1154;Label        ;0    ;0    ;0    ;0    ;ParentControl=1117;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1118;TextBox      ;3493 ;3080 ;2408 ;440  ;Name=Field3;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[3];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[3];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(3);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1155;Label        ;0    ;0    ;0    ;0    ;ParentControl=1118;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1119;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field4;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[4];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[4];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(4);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1156;Label        ;0    ;0    ;0    ;0    ;ParentControl=1119;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1120;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field5;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[5];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[5];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(5);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1157;Label        ;0    ;0    ;0    ;0    ;ParentControl=1120;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1121;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field6;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[6];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[6];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(6);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1158;Label        ;0    ;0    ;0    ;0    ;ParentControl=1121;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1122;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field7;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[7];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[7];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(7);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1159;Label        ;0    ;0    ;0    ;0    ;ParentControl=1122;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1123;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field8;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[8];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[8];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(8);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1160;Label        ;0    ;0    ;0    ;0    ;ParentControl=1123;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1124;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field9;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[9];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[9];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(9);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1161;Label        ;0    ;0    ;0    ;0    ;ParentControl=1124;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1125;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field10;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[10];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[10];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(10);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1162;Label        ;0    ;0    ;0    ;0    ;ParentControl=1125;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1126;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field11;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[11];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[11];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(11);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1163;Label        ;0    ;0    ;0    ;0    ;ParentControl=1126;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1127;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field12;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[12];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[12];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(12);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1164;Label        ;0    ;0    ;0    ;0    ;ParentControl=1127;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1128;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field13;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[13];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[13];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(13);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1165;Label        ;0    ;0    ;0    ;0    ;ParentControl=1128;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1129;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field14;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[14];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[14];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(14);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1166;Label        ;0    ;0    ;0    ;0    ;ParentControl=1129;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1130;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field15;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[15];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[15];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(15);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1167;Label        ;0    ;0    ;0    ;0    ;ParentControl=1130;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1131;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field16;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[16];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[16];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(16);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1168;Label        ;0    ;0    ;0    ;0    ;ParentControl=1131;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1132;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field17;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[17];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[17];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(17);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1169;Label        ;0    ;0    ;0    ;0    ;ParentControl=1132;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1133;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field18;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[18];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[18];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(18);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1170;Label        ;0    ;0    ;0    ;0    ;ParentControl=1133;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1134;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field19;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[19];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[19];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(19);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1171;Label        ;0    ;0    ;0    ;0    ;ParentControl=1134;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1135;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field20;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[20];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[20];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(20);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1172;Label        ;0    ;0    ;0    ;0    ;ParentControl=1135;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1136;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field21;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[21];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[21];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(21);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1173;Label        ;0    ;0    ;0    ;0    ;ParentControl=1136;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1137;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field22;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[22];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[22];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(22);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1174;Label        ;0    ;0    ;0    ;0    ;ParentControl=1137;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1138;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field23;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[23];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[23];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(23);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1175;Label        ;0    ;0    ;0    ;0    ;ParentControl=1138;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1139;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field24;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[24];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[24];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(24);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1176;Label        ;0    ;0    ;0    ;0    ;ParentControl=1139;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1140;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field25;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[25];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[25];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(25);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1177;Label        ;0    ;0    ;0    ;0    ;ParentControl=1140;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1141;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field26;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[26];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[26];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(26);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1178;Label        ;0    ;0    ;0    ;0    ;ParentControl=1141;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1142;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field27;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[27];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[27];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(27);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1179;Label        ;0    ;0    ;0    ;0    ;ParentControl=1142;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1143;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field28;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[28];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[28];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(28);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1180;Label        ;0    ;0    ;0    ;0    ;ParentControl=1143;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1144;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field29;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[29];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[29];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(29);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1181;Label        ;0    ;0    ;0    ;0    ;ParentControl=1144;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1145;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field30;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[30];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[30];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(30);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1182;Label        ;0    ;0    ;0    ;0    ;ParentControl=1145;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1146;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field31;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[31];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[31];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(31);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1183;Label        ;0    ;0    ;0    ;0    ;ParentControl=1146;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 1147;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field32;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 BlankZero=Yes;
                                                 SourceExpr=MATRIX_CellData[32];
                                                 AutoFormatType=1;
                                                 CaptionClass='3,' + MATRIX_ColumnCaptions[32];
                                                 OnDrillDown=BEGIN
                                                               MATRIX_UpdateMatrixRecord(32);
                                                               DrillDown(TRUE);
                                                             END;
                                                              }
    { 1184;Label        ;0    ;0    ;0    ;0    ;ParentControl=1147;
                                                 InColumnHeading=Yes;
                                                 HorzAlign=Right }
    { 2   ;CommandButton;18370;5940 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
  }
  CODE
  {
    VAR
      Text000@1185 : TextConst 'ENU=<Sign><Integer Thousand><Decimals,3>';
      Text001@1186 : TextConst 'ENU=Period';
      GLSetup@1189 : Record 98;
      GLAcc@1190 : Record 15;
      DimCodAmtBuf@1191 : TEMPORARY Record 375;
      CurrExchRate@1192 : Record 330;
      LineDimOption@1193 : 'G/L Account,Period,Business Unit,Dimension 1,Dimension 2,Dimension 3,Dimension 4';
      ColumnDimOption@1194 : 'G/L Account,Period,Business Unit,Dimension 1,Dimension 2,Dimension 3,Dimension 4';
      LineDimCode@1195 : Text[30];
      ColumnDimCode@1196 : Text[30];
      PeriodType@1197 : 'Day,Week,Month,Quarter,Year,Accounting Period';
      AmountType@1198 : 'Net Change,Balance at Date';
      RoundingFactor@1199 : 'None,1,1000,1000000';
      AmountField@1200 : 'Amount,Debit Amount,Credit Amount';
      ShowActualBudg@1201 : 'Actual Amounts,Budgeted Amounts,Variance,Variance%,Index%';
      ShowInAddCurr@1202 : Boolean;
      ClosingEntryFilter@1203 : 'Include,Exclude';
      ShowColumnName@1204 : Boolean;
      DateFilter@1205 : Text[250];
      InternalDateFilter@1206 : Text[250];
      ExcludeClosingDateFilter@1207 : Text[250];
      GLAccFilter@1208 : Code[250];
      BudgetFilter@1209 : Code[250];
      BusUnitFilter@1210 : Code[250];
      GlobalDim1Filter@1211 : Code[250];
      GlobalDim2Filter@1212 : Code[250];
      MatrixHeader@1213 : Text[50];
      MatrixAmount@1214 : Decimal;
      PeriodInitialized@1215 : Boolean;
      CurrExchDate@1216 : Date;
      MatrixRecord@1217 : Record 367;
      MATRIX_ColumnOrdinal@1218 : Integer;
      MATRIX_NoOfMatrixColumns@1219 : Integer;
      MATRIX_CellData@1220 : ARRAY [32] OF Decimal;
      MATRIX_ColumnCaptions@1000 : ARRAY [32] OF Text[1024];
      MATRIX_PrimKeyFirstCol@1002 : Text[1024];
      MATRIX_CurrSetLength@1001 : Integer;

    LOCAL PROCEDURE DimCodeToOption@1221(DimCode@1000 : Text[30]) : Integer;
    VAR
      BusUnit@1222 : Record 220;
    BEGIN
      CASE DimCode OF
        '':
          EXIT(-1);
        GLAcc.TABLECAPTION:
          EXIT(0);
        Text001:
          EXIT(1);
        BusUnit.TABLECAPTION:
          EXIT(2);
        GLSetup."Global Dimension 1 Code":
          EXIT(3);
        GLSetup."Global Dimension 2 Code":
          EXIT(4);
        ELSE
          EXIT(-1);
      END;
    END;

    LOCAL PROCEDURE FindRec@1223(DimOption@1000 : 'G/L Account,Period,Business Unit,Dimension 1,Dimension 2';VAR DimCodeBuf@1001 : Record 367;Which@1002 : Text[1024]) : Boolean;
    VAR
      GLAcc@1224 : Record 15;
      BusUnit@1225 : Record 220;
      Period@1226 : Record 2000000007;
      DimVal@1227 : Record 349;
      PeriodFormMgt@1228 : Codeunit 359;
      Found@1229 : Boolean;
    BEGIN
      GLAcc.SETPERMISSIONFILTER;
      CASE DimOption OF
        DimOption::"G/L Account":
          BEGIN
            GLAcc."No." := DimCodeBuf.Code;
            IF GLAccFilter <> '' THEN
              GLAcc.SETFILTER("No.",GLAccFilter);
            Found := GLAcc.FIND(Which);
            IF Found THEN
              CopyGLAccToBuf(GLAcc,DimCodeBuf);
          END;
        DimOption::Period:
          BEGIN
            IF NOT PeriodInitialized THEN
              DateFilter := '';
            PeriodInitialized := TRUE;
            EVALUATE(Period."Period Start",DimCodeBuf.Code);
            IF DateFilter <> '' THEN
              Period.SETFILTER("Period Start",DateFilter)
            ELSE
              IF NOT PeriodInitialized AND (InternalDateFilter <> '') THEN
                Period.SETFILTER("Period Start",InternalDateFilter);
            Found := PeriodFormMgt.FindDate(Which,Period,PeriodType);
            IF Found THEN
              CopyPeriodToBuf(Period,DimCodeBuf);
          END;
        DimOption::"Business Unit":
          BEGIN
            BusUnit.Code := DimCodeBuf.Code;
            IF BusUnitFilter <> '' THEN
              BusUnit.SETFILTER(Code,BusUnitFilter);
            Found := BusUnit.FIND(Which);
            IF Found THEN
              CopyBusUnitToBuf(BusUnit,DimCodeBuf);
          END;
        DimOption::"Dimension 1":
          BEGIN
            IF GlobalDim1Filter <> '' THEN
              DimVal.SETFILTER(Code,GlobalDim1Filter);
            DimVal."Dimension Code" := GLSetup."Global Dimension 1 Code";
            DimVal.SETRANGE("Dimension Code",DimVal."Dimension Code");
            DimVal.Code := DimCodeBuf.Code;
            Found := DimVal.FIND(Which);
            IF Found THEN
              CopyDimValueToBuf(DimVal,DimCodeBuf);
          END;
        DimOption::"Dimension 2":
          BEGIN
            IF GlobalDim2Filter <> '' THEN
              DimVal.SETFILTER(Code,GlobalDim2Filter);
            DimVal."Dimension Code" := GLSetup."Global Dimension 2 Code";
            DimVal.SETRANGE("Dimension Code",DimVal."Dimension Code");
            DimVal.Code := DimCodeBuf.Code;
            Found := DimVal.FIND(Which);
            IF Found THEN
              CopyDimValueToBuf(DimVal,DimCodeBuf);
          END;
      END;
      EXIT(Found);
    END;

    LOCAL PROCEDURE NextRec@1230(DimOption@1000 : 'G/L Account,Period,Business Unit,Dimension 1,Dimension 2';VAR DimCodeBuf@1001 : Record 367;Steps@1002 : Integer) : Integer;
    VAR
      GLAcc@1231 : Record 15;
      BusUnit@1232 : Record 220;
      Period@1233 : Record 2000000007;
      DimVal@1234 : Record 349;
      PeriodFormMgt@1235 : Codeunit 359;
      ResultSteps@1236 : Integer;
    BEGIN
      GLAcc.SETPERMISSIONFILTER;
      CASE DimOption OF
        DimOption::"G/L Account":
          BEGIN
            GLAcc."No." := DimCodeBuf.Code;
            IF GLAccFilter <> '' THEN
              GLAcc.SETFILTER("No.",GLAccFilter);
            ResultSteps := GLAcc.NEXT(Steps);
            IF ResultSteps <> 0 THEN
              CopyGLAccToBuf(GLAcc,DimCodeBuf);
          END;
        DimOption::Period:
          BEGIN
            IF DateFilter <> '' THEN
              Period.SETFILTER("Period Start",DateFilter);
            Period."Period Start" := DimCodeBuf."Period Start";
            ResultSteps := PeriodFormMgt.NextDate(Steps,Period,PeriodType);
            IF ResultSteps <> 0 THEN
              CopyPeriodToBuf(Period,DimCodeBuf);
          END;
        DimOption::"Business Unit":
          BEGIN
            BusUnit.Code := DimCodeBuf.Code;
            IF BusUnitFilter <> '' THEN
              BusUnit.SETFILTER(Code,BusUnitFilter);
            ResultSteps := BusUnit.NEXT(Steps);
            IF ResultSteps <> 0 THEN
              CopyBusUnitToBuf(BusUnit,DimCodeBuf);
          END;
        DimOption::"Dimension 1":
          BEGIN
            IF GlobalDim1Filter <> '' THEN
              DimVal.SETFILTER(Code,GlobalDim1Filter);
            DimVal."Dimension Code" := GLSetup."Global Dimension 1 Code";
            DimVal.SETRANGE("Dimension Code",DimVal."Dimension Code");
            DimVal.Code := DimCodeBuf.Code;
            ResultSteps := DimVal.NEXT(Steps);
            IF ResultSteps <> 0 THEN
              CopyDimValueToBuf(DimVal,DimCodeBuf);
          END;
        DimOption::"Dimension 2":
          BEGIN
            IF GlobalDim2Filter <> '' THEN
              DimVal.SETFILTER(Code,GlobalDim2Filter);
            DimVal."Dimension Code" := GLSetup."Global Dimension 2 Code";
            DimVal.SETRANGE("Dimension Code",DimVal."Dimension Code");
            DimVal.Code := DimCodeBuf.Code;
            ResultSteps := DimVal.NEXT(Steps);
            IF ResultSteps <> 0 THEN
              CopyDimValueToBuf(DimVal,DimCodeBuf);
          END;
      END;
      EXIT(ResultSteps);
    END;

    LOCAL PROCEDURE CopyGLAccToBuf@1237(VAR TheGLAcc@1000 : Record 15;VAR TheDimCodeBuf@1001 : Record 367);
    BEGIN
      WITH TheDimCodeBuf DO BEGIN
        INIT;
        Code := TheGLAcc."No.";
        Name := TheGLAcc.Name;
        Totaling := TheGLAcc.Totaling;
        Indentation := TheGLAcc.Indentation;
        "Show in Bold" := TheGLAcc."Account Type" <> TheGLAcc."Account Type"::Posting;
      END;
    END;

    LOCAL PROCEDURE CopyPeriodToBuf@1238(VAR ThePeriod@1000 : Record 2000000007;VAR TheDimCodeBuf@1001 : Record 367);
    VAR
      Period2@1239 : Record 2000000007;
    BEGIN
      WITH TheDimCodeBuf DO BEGIN
        INIT;
        Code := FORMAT(ThePeriod."Period Start");
        "Period Start" := ThePeriod."Period Start";
        IF ClosingEntryFilter = ClosingEntryFilter::Include THEN
          "Period End" := CLOSINGDATE(ThePeriod."Period End")
        ELSE
          "Period End" := ThePeriod."Period End";
        IF DateFilter <> '' THEN BEGIN
          Period2.SETFILTER("Period End",DateFilter);
          IF Period2.GETRANGEMAX("Period End") < "Period End" THEN
            "Period End" := Period2.GETRANGEMAX("Period End");
        END;
        Name := ThePeriod."Period Name";
      END;
    END;

    LOCAL PROCEDURE CopyBusUnitToBuf@1240(VAR TheBusUnit@1000 : Record 220;VAR TheDimCodeBuf@1001 : Record 367);
    BEGIN
      WITH TheDimCodeBuf DO BEGIN
        INIT;
        Code := TheBusUnit.Code;
        Name := TheBusUnit.Name;
      END;
    END;

    LOCAL PROCEDURE CopyDimValueToBuf@1241(VAR TheDimVal@1000 : Record 349;VAR TheDimCodeBuf@1001 : Record 367);
    BEGIN
      WITH TheDimCodeBuf DO BEGIN
        INIT;
        Code := TheDimVal.Code;
        Name := TheDimVal.Name;
        Totaling := TheDimVal.Totaling;
        Indentation := TheDimVal.Indentation;
        "Show in Bold" :=
          TheDimVal."Dimension Value Type" <> TheDimVal."Dimension Value Type"::Standard;
      END;
    END;

    LOCAL PROCEDURE FindPeriod@1242(SearchText@1000 : Code[10]);
    VAR
      Period@1243 : Record 2000000007;
      PeriodFormMgt@1244 : Codeunit 359;
    BEGIN
      IF DateFilter <> '' THEN BEGIN
        Period.SETFILTER("Period Start",DateFilter);
        IF NOT PeriodFormMgt.FindDate('+',Period,PeriodType) THEN
          PeriodFormMgt.FindDate('+',Period,PeriodType::Day);
        Period.SETRANGE("Period Start");
      END;
      IF PeriodFormMgt.FindDate(SearchText,Period,PeriodType) THEN
        IF ClosingEntryFilter = ClosingEntryFilter::Include THEN
          Period."Period End" := CLOSINGDATE(Period."Period End");
      IF AmountType = AmountType::"Net Change" THEN BEGIN
        GLAcc.SETRANGE("Date Filter",Period."Period Start",Period."Period End");
        IF GLAcc.GETRANGEMIN("Date Filter") = GLAcc.GETRANGEMAX("Date Filter") THEN
          GLAcc.SETRANGE("Date Filter",GLAcc.GETRANGEMIN("Date Filter"));
      END ELSE
        GLAcc.SETRANGE("Date Filter",0D,Period."Period End");
      InternalDateFilter := GLAcc.GETFILTER("Date Filter");
      IF (LineDimOption <> LineDimOption::Period) AND (ColumnDimOption <> ColumnDimOption::Period) THEN
        DateFilter := InternalDateFilter;
      DimCodAmtBuf.DELETEALL;
    END;

    LOCAL PROCEDURE CalculateClosingDateFilter@1245();
    VAR
      AccountingPeriod@1246 : Record 50;
      FirstRec@1247 : Boolean;
    BEGIN
      IF ClosingEntryFilter = ClosingEntryFilter::Include THEN
        ExcludeClosingDateFilter := ''
      ELSE BEGIN
        AccountingPeriod.SETCURRENTKEY("New Fiscal Year");
        AccountingPeriod.SETRANGE("New Fiscal Year",TRUE);
        FirstRec := TRUE;
        IF AccountingPeriod.FIND('-') THEN
          REPEAT
            IF FirstRec THEN
              ExcludeClosingDateFilter :=
                STRSUBSTNO('<>%1',CLOSINGDATE(AccountingPeriod."Starting Date" - 1))
            ELSE
              ExcludeClosingDateFilter :=
                ExcludeClosingDateFilter + STRSUBSTNO('&<>%1',CLOSINGDATE(AccountingPeriod."Starting Date" - 1));
            FirstRec := FALSE;
          UNTIL AccountingPeriod.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE FormatAmount@1248(VAR Text@1000 : Text[250]);
    VAR
      Amount@1249 : Decimal;
    BEGIN
      IF Text = '' THEN
        EXIT;
      EVALUATE(Amount,Text);
      IF ShowActualBudg IN [ShowActualBudg::"Variance%",ShowActualBudg::"Index%"] THEN BEGIN
        IF Amount = 0 THEN
          Text := ''
        ELSE
          Text := FORMAT(ROUND(Amount,0.1),0,Text000);
        EXIT;
      END;
      IF RoundingFactor = RoundingFactor::None THEN
        EXIT;
      CASE RoundingFactor OF
        RoundingFactor::"1":
          Amount := ROUND(Amount,1);
        RoundingFactor::"1000":
          Amount := ROUND(Amount / 1000,0.1);
        RoundingFactor::"1000000":
          Amount := ROUND(Amount / 1000000,0.1);
      END;
      IF Amount = 0 THEN
        Text := ''
      ELSE
        CASE RoundingFactor OF
          RoundingFactor::"1":
            Text := FORMAT(Amount);
          RoundingFactor::"1000",RoundingFactor::"1000000":
            Text := FORMAT(Amount,0,Text000);
        END;
    END;

    LOCAL PROCEDURE GetDimSelection@1250(OldDimSelCode@1000 : Text[30]) : Text[30];
    VAR
      DimSelection@1251 : Form 568;
    BEGIN
      DimSelection.InsertDimSelBuf(FALSE,GLAcc.TABLECAPTION,GLAcc.TABLECAPTION);
      DimSelection.InsertDimSelBuf(FALSE,Text001,Text001);
      IF GLSetup."Global Dimension 1 Code" <> '' THEN
        DimSelection.InsertDimSelBuf(FALSE,GLSetup."Global Dimension 1 Code",'');
      IF GLSetup."Global Dimension 2 Code" <> '' THEN
        DimSelection.InsertDimSelBuf(FALSE,GLSetup."Global Dimension 2 Code",'');
      DimSelection.LOOKUPMODE := TRUE;
      IF DimSelection.RUNMODAL = ACTION::LookupOK THEN
        EXIT(DimSelection.GetDimSelCode)
      ELSE
        EXIT(OldDimSelCode);
    END;

    LOCAL PROCEDURE LookUpCode@1252(DimOption@1000 : 'G/L Account,Period,Business Unit,Dimension 1,Dimension 2';DimCode@1001 : Text[30];Code@1002 : Text[30]);
    VAR
      GLAcc@1253 : Record 15;
      BusUnit@1254 : Record 220;
      DimVal@1255 : Record 349;
      DimValList@1256 : Form 560;
    BEGIN
      CASE DimOption OF
        DimOption::"G/L Account":
          BEGIN
            GLAcc.GET(Code);
            FORM.RUNMODAL(FORM::"G/L Account List",GLAcc);
          END;
        DimOption::Period: ;
        DimOption::"Business Unit":
          BEGIN
            BusUnit.GET(Code);
            FORM.RUNMODAL(FORM::"Business Unit List",BusUnit);
          END;
        DimOption::"Dimension 1",DimOption::"Dimension 2":
          BEGIN
            DimVal.SETRANGE("Dimension Code",DimCode);
            DimVal.GET(DimCode,Code);
            DimValList.SETTABLEVIEW(DimVal);
            DimValList.SETRECORD(DimVal);
            DimValList.RUNMODAL;
          END;
      END;
    END;

    LOCAL PROCEDURE SetCommonFilters@1260(VAR TheGLAcc@1000 : Record 15);
    VAR
      DateFilter2@1261 : Text[1024];
    BEGIN
      CLEAR(TheGLAcc);
      WITH TheGLAcc DO BEGIN
        IF DateFilter = '' THEN
          DateFilter2 := ExcludeClosingDateFilter
        ELSE BEGIN
          IF AmountType = AmountType::"Net Change" THEN BEGIN
            DateFilter2 := DateFilter;
          END ELSE BEGIN
            SETFILTER("Date Filter",DateFilter);
            DateFilter2 := STRSUBSTNO('..%1',GETRANGEMAX("Date Filter"));
          END;
          IF ExcludeClosingDateFilter <> '' THEN
            DateFilter2 := DateFilter2 + '&' + ExcludeClosingDateFilter;
        END;
        RESET;
        IF GLAccFilter <> '' THEN
          SETFILTER("No.",GLAccFilter)
        ELSE
          SETRANGE("No.");
        IF GLAccFilter <> '' THEN
          Totaling := GLAccFilter
        ELSE
          IF "No." = '' THEN
            Totaling := STRSUBSTNO('>%1','''''');
        SETFILTER("Date Filter",DateFilter2);
        IF BusUnitFilter <> '' THEN
          SETFILTER("Business Unit Filter",BusUnitFilter);
        IF GlobalDim1Filter <> '' THEN
          SETFILTER("Global Dimension 1 Filter",GlobalDim1Filter);
        IF GlobalDim2Filter <> '' THEN
          SETFILTER("Global Dimension 2 Filter",GlobalDim2Filter);
        IF BudgetFilter = '' THEN
          SETRANGE("Budget Filter")
        ELSE
          SETFILTER("Budget Filter",BudgetFilter);
      END;
    END;

    LOCAL PROCEDURE SetDimFilters@1262(VAR TheGLAcc@1000 : Record 15;LineOrColumn@1001 : 'Line,Column');
    VAR
      DimOption@1263 : 'G/L Account,Period,Business Unit,Dimension 1,Dimension 2,Dimension 3,Dimension 4';
      DimCodeBuf@1264 : Record 367;
    BEGIN
      IF LineOrColumn = LineOrColumn::Line THEN BEGIN
        DimCodeBuf := Rec;
        DimOption := LineDimOption;
      END ELSE BEGIN
        DimCodeBuf := MatrixRecord;
        DimOption := ColumnDimOption;
      END;
      CASE DimOption OF
        DimOption::"G/L Account":
          BEGIN
            TheGLAcc."No." := DimCodeBuf.Code;
            TheGLAcc.Totaling := DimCodeBuf.Totaling;
          END;
        DimOption::Period:
          BEGIN
            IF AmountType = AmountType::"Net Change" THEN
              TheGLAcc.SETRANGE(
                "Date Filter",DimCodeBuf."Period Start",DimCodeBuf."Period End")
            ELSE
              TheGLAcc.SETRANGE("Date Filter",0D,DimCodeBuf."Period End");
            IF (ClosingEntryFilter = ClosingEntryFilter::Exclude) AND (ExcludeClosingDateFilter <> '') THEN
              TheGLAcc.SETFILTER(
                "Date Filter",TheGLAcc.GETFILTER("Date Filter") +
                '&' + ExcludeClosingDateFilter);
          END;
        DimOption::"Business Unit":
          TheGLAcc.SETRANGE("Business Unit Filter",DimCodeBuf.Code);
        DimOption::"Dimension 1":
          IF DimCodeBuf.Totaling = '' THEN
            TheGLAcc.SETRANGE("Global Dimension 1 Filter",DimCodeBuf.Code)
          ELSE
            TheGLAcc.SETFILTER("Global Dimension 1 Filter",DimCodeBuf.Totaling);
        DimOption::"Dimension 2":
          IF DimCodeBuf.Totaling = '' THEN
            TheGLAcc.SETRANGE("Global Dimension 2 Filter",DimCodeBuf.Code)
          ELSE
            TheGLAcc.SETFILTER("Global Dimension 2 Filter",DimCodeBuf.Totaling);
      END;
    END;

    LOCAL PROCEDURE DrillDown@1265(SetColFilter@1000 : Boolean);
    VAR
      GLEntry@1266 : Record 17;
      GLBudgetEntry@1267 : Record 96;
    BEGIN
      SetCommonFilters(GLAcc);
      SetDimFilters(GLAcc,0);
      IF SetColFilter THEN
        SetDimFilters(GLAcc,1);
      IF ShowActualBudg = ShowActualBudg::"Actual Amounts" THEN BEGIN
        WITH GLEntry DO BEGIN
          IF GLAcc."No." <> '' THEN
            SETRANGE("G/L Account No.",GLAcc."No.");
          IF GLAcc.Totaling <> '' THEN
            SETFILTER("G/L Account No.",GLAcc.Totaling);
          GLAcc.COPYFILTER("Date Filter","Posting Date");
          GLAcc.COPYFILTER("Global Dimension 1 Filter","Global Dimension 1 Code");
          GLAcc.COPYFILTER("Global Dimension 2 Filter","Global Dimension 2 Code");
          GLAcc.COPYFILTER("Business Unit Filter","Business Unit Code");
          IF (GETFILTER("Global Dimension 1 Code") <> '') OR (GETFILTER("Global Dimension 2 Code") <> '') OR
             (GETFILTER("Business Unit Code") <> '')
          THEN
            SETCURRENTKEY("G/L Account No.","Business Unit Code","Global Dimension 1 Code")
          ELSE
            SETCURRENTKEY("G/L Account No.","Posting Date");
        END;
        FORM.RUN(FORM::"General Ledger Entries",GLEntry);
      END;
      IF ShowActualBudg = ShowActualBudg::"Budgeted Amounts" THEN BEGIN
        WITH GLBudgetEntry DO BEGIN
          GLAcc.COPYFILTER("Budget Filter","Budget Name");
          IF GLAcc."No." <> '' THEN
            SETRANGE("G/L Account No.",GLAcc."No.");
          IF GLAcc.Totaling <> '' THEN
            SETFILTER("G/L Account No.",GLAcc.Totaling);
          GLAcc.COPYFILTER("Date Filter",Date);
          GLAcc.COPYFILTER("Global Dimension 1 Filter","Global Dimension 1 Code");
          GLAcc.COPYFILTER("Global Dimension 2 Filter","Global Dimension 2 Code");
          GLAcc.COPYFILTER("Business Unit Filter","Business Unit Code");
          IF (GETFILTER("Global Dimension 1 Code") <> '') OR (GETFILTER("Global Dimension 2 Code") <> '') OR
             (GETFILTER("Business Unit Code") <> '')
          THEN
            SETCURRENTKEY("Budget Name","G/L Account No.","Business Unit Code","Global Dimension 1 Code")
          ELSE
            SETCURRENTKEY("Budget Name","G/L Account No.",Date);
        END;
        FORM.RUN(FORM::"G/L Budget Entries",GLBudgetEntry);
      END;
    END;

    LOCAL PROCEDURE CalcAmount@1272(SetColFilter@1000 : Boolean) : Decimal;
    VAR
      Amount@1273 : Decimal;
      ColumnCode@1274 : Code[20];
    BEGIN
      IF SetColFilter THEN
        ColumnCode := MatrixRecord.Code
      ELSE
        ColumnCode := '';
      IF DimCodAmtBuf.GET(Code,ColumnCode) THEN
        EXIT(DimCodAmtBuf.Amount);
      GLAcc.RESET;
      SetCommonFilters(GLAcc);
      SetDimFilters(GLAcc,0);
      IF SetColFilter THEN
        SetDimFilters(GLAcc,1);
      CASE ShowActualBudg OF
        ShowActualBudg::"Actual Amounts":
          Amount := CalcActualAmount;
        ShowActualBudg::"Budgeted Amounts":
          Amount := CalcBudgAmount;
        ShowActualBudg::Variance:
          Amount := CalcActualAmount - CalcBudgAmount;
        ShowActualBudg::"Variance%":
          BEGIN
            Amount := CalcBudgAmount;
            IF Amount <> 0 THEN
              Amount := ROUND(100 * (CalcActualAmount - Amount) / Amount);
          END;
        ShowActualBudg::"Index%":
          BEGIN
            Amount := CalcBudgAmount;
            IF Amount <> 0 THEN
              Amount := ROUND(100 * CalcActualAmount / Amount);
          END;
      END;
      DimCodAmtBuf."Line Code" := Code;
      DimCodAmtBuf."Column Code" := ColumnCode;
      DimCodAmtBuf.Amount := Amount;
      DimCodAmtBuf.INSERT;
      EXIT(Amount);
    END;

    LOCAL PROCEDURE CalcActualAmount@1275() : Decimal;
    VAR
      Amount@1276 : Decimal;
    BEGIN
      IF ShowInAddCurr THEN
        CASE AmountField OF
          AmountField::Amount:
            BEGIN
              GLAcc.CALCFIELDS("Additional-Currency Net Change");
              Amount := GLAcc."Additional-Currency Net Change";
            END;
          AmountField::"Debit Amount":
            BEGIN
              GLAcc.CALCFIELDS("Add.-Currency Debit Amount");
              Amount := GLAcc."Add.-Currency Debit Amount";
            END;
          AmountField::"Credit Amount":
            BEGIN
              GLAcc.CALCFIELDS("Add.-Currency Credit Amount");
              Amount := GLAcc."Add.-Currency Credit Amount";
            END;
        END
      ELSE
        CASE AmountField OF
          AmountField::Amount:
            BEGIN
              GLAcc.CALCFIELDS("Net Change");
              Amount := GLAcc."Net Change";
            END;
          AmountField::"Debit Amount":
            BEGIN
              GLAcc.CALCFIELDS("Debit Amount");
              Amount := GLAcc."Debit Amount";
            END;
          AmountField::"Credit Amount":
            BEGIN
              GLAcc.CALCFIELDS("Credit Amount");
              Amount := GLAcc."Credit Amount";
            END;
        END;
      EXIT(Amount);
    END;

    LOCAL PROCEDURE CalcBudgAmount@1277() : Decimal;
    VAR
      Amount@1278 : Decimal;
    BEGIN
      IF BudgetFilter = '' THEN
        GLAcc.SETRANGE("Budget Filter")
      ELSE
        GLAcc.SETFILTER("Budget Filter",BudgetFilter);
      GLAcc.CALCFIELDS("Budgeted Amount");
      Amount := GLAcc."Budgeted Amount";
      CASE AmountField OF
        AmountField::"Debit Amount":
          IF Amount < 0 THEN
            Amount := 0;
        AmountField::"Credit Amount":
          IF Amount > 0 THEN
            Amount := 0
          ELSE
            Amount := -Amount;
      END;
      IF (Amount <> 0) AND ShowInAddCurr THEN BEGIN
        IF GLAcc.GETFILTER("Date Filter") = '' THEN
          CurrExchDate := WORKDATE
        ELSE
          CurrExchDate := GLAcc.GETRANGEMIN("Date Filter");
        Amount :=
          CurrExchRate.ExchangeAmtLCYToFCY(
            CurrExchDate,GLSetup."Additional Reporting Currency",Amount,
            CurrExchRate.ExchangeRate(CurrExchDate,GLSetup."Additional Reporting Currency"));
      END;
      EXIT(Amount);
    END;

    LOCAL PROCEDURE MATRIX_UpdateMatrixRecord@1279(MATRIX_NewColumnOrdinal@1110 : Integer);
    VAR
      MATRIX_CurrentColumnOrdinal@1280 : Integer;
    BEGIN
      MATRIX_ColumnOrdinal := MATRIX_NewColumnOrdinal;
      MatrixRecord.SETPOSITION(MATRIX_PrimKeyFirstCol);
      MATRIX_OnFindRecord('=');
      MATRIX_CurrentColumnOrdinal := 1;
      IF MATRIX_ColumnOrdinal <> 1 THEN
        MATRIX_OnNextRecord(MATRIX_ColumnOrdinal - 1);
    END;

    LOCAL PROCEDURE MATRIX_OnFindRecord@1281(Which@1112 : Text[1024]) : Boolean;
    BEGIN
      EXIT(FindRec(ColumnDimOption,MatrixRecord,Which));
    END;

    LOCAL PROCEDURE MATRIX_OnNextRecord@1282(Steps@1113 : Integer) : Integer;
    BEGIN
      EXIT(NextRec(ColumnDimOption,MatrixRecord,Steps));
    END;

    LOCAL PROCEDURE MATRIX_OnAfterGetRecord@1283();
    BEGIN
      IF ShowColumnName THEN
        MatrixHeader := MatrixRecord.Name
      ELSE
        MatrixHeader := MatrixRecord.Code;
      MatrixAmount := CalcAmount(TRUE);

      CASE RoundingFactor OF
        RoundingFactor::"1":
          MatrixAmount := ROUND(MatrixAmount,1);
        RoundingFactor::"1000":
          MatrixAmount := ROUND(MatrixAmount / 1000,0.1);
        RoundingFactor::"1000000":
          MatrixAmount := ROUND(MatrixAmount / 1000000,0.1);
      END;

      MATRIX_CellData[MATRIX_ColumnOrdinal] := MatrixAmount;
    END;

    PROCEDURE Load@1(NewLineDimCode@1000 : Text[30];NewColumnDimCode@1001 : Text[30];NewPeriodType@1002 : Option;NewDateFilter@1003 : Text[250];NewGLAccFilter@1004 : Code[250];NewBusUnitFilter@1017 : Code[250];NewBudgetFilter@1005 : Code[250];NewGlobalDim1Filter@1006 : Code[250];NewGlobalDim2Filter@1007 : Code[250];NewShowActualBudg@1008 : Option;NewAmountField@1009 : Option;NewClosingEntryFilter@1010 : Option;NewRoundingFactor@1011 : Option;NewShowInAddCurr@1012 : Boolean;NewMATRIX_ColumnCaptions@1013 : ARRAY [32] OF Text[1024];NewPrimKeyFirstCol@1014 : Text[1024];NewAmountType@1015 : 'Net Change,Balance at Date';CurrSetLength@1016 : Integer);
    BEGIN
      FindPeriod('');
      LineDimCode := NewLineDimCode;
      ColumnDimCode := NewColumnDimCode;
      PeriodType := NewPeriodType;
      DateFilter := NewDateFilter;
      PeriodInitialized := TRUE;
      GLAccFilter := NewGLAccFilter;
      BusUnitFilter := NewBusUnitFilter;
      BudgetFilter := NewBudgetFilter;
      GlobalDim1Filter := NewGlobalDim1Filter;
      GlobalDim2Filter := NewGlobalDim2Filter;
      ShowActualBudg := NewShowActualBudg;
      AmountField := NewAmountField;
      ClosingEntryFilter := NewClosingEntryFilter;
      RoundingFactor := NewRoundingFactor;
      ShowInAddCurr := NewShowInAddCurr;
      COPYARRAY(MATRIX_ColumnCaptions,NewMATRIX_ColumnCaptions,1);
      MATRIX_PrimKeyFirstCol := NewPrimKeyFirstCol;
      AmountType := NewAmountType;
      MATRIX_CurrSetLength := CurrSetLength;
    END;

    PROCEDURE SetColumnVisibility@2();
    BEGIN
      CurrForm.Field1.VISIBLE := MATRIX_CurrSetLength >= 1;
      CurrForm.Field2.VISIBLE := MATRIX_CurrSetLength >= 2;
      CurrForm.Field3.VISIBLE := MATRIX_CurrSetLength >= 3;
      CurrForm.Field4.VISIBLE := MATRIX_CurrSetLength >= 4;
      CurrForm.Field5.VISIBLE := MATRIX_CurrSetLength >= 5;
      CurrForm.Field6.VISIBLE := MATRIX_CurrSetLength >= 6;
      CurrForm.Field7.VISIBLE := MATRIX_CurrSetLength >= 7;
      CurrForm.Field8.VISIBLE := MATRIX_CurrSetLength >= 8;
      CurrForm.Field9.VISIBLE := MATRIX_CurrSetLength >= 9;
      CurrForm.Field10.VISIBLE := MATRIX_CurrSetLength >= 10;
      CurrForm.Field11.VISIBLE := MATRIX_CurrSetLength >= 11;
      CurrForm.Field12.VISIBLE := MATRIX_CurrSetLength >= 12;
      CurrForm.Field13.VISIBLE := MATRIX_CurrSetLength >= 13;
      CurrForm.Field14.VISIBLE := MATRIX_CurrSetLength >= 14;
      CurrForm.Field15.VISIBLE := MATRIX_CurrSetLength >= 15;
      CurrForm.Field16.VISIBLE := MATRIX_CurrSetLength >= 16;
      CurrForm.Field17.VISIBLE := MATRIX_CurrSetLength >= 17;
      CurrForm.Field18.VISIBLE := MATRIX_CurrSetLength >= 18;
      CurrForm.Field19.VISIBLE := MATRIX_CurrSetLength >= 19;
      CurrForm.Field20.VISIBLE := MATRIX_CurrSetLength >= 20;
      CurrForm.Field21.VISIBLE := MATRIX_CurrSetLength >= 21;
      CurrForm.Field22.VISIBLE := MATRIX_CurrSetLength >= 22;
      CurrForm.Field23.VISIBLE := MATRIX_CurrSetLength >= 23;
      CurrForm.Field24.VISIBLE := MATRIX_CurrSetLength >= 24;
      CurrForm.Field25.VISIBLE := MATRIX_CurrSetLength >= 25;
      CurrForm.Field26.VISIBLE := MATRIX_CurrSetLength >= 26;
      CurrForm.Field27.VISIBLE := MATRIX_CurrSetLength >= 27;
      CurrForm.Field28.VISIBLE := MATRIX_CurrSetLength >= 28;
      CurrForm.Field29.VISIBLE := MATRIX_CurrSetLength >= 29;
      CurrForm.Field30.VISIBLE := MATRIX_CurrSetLength >= 30;
      CurrForm.Field31.VISIBLE := MATRIX_CurrSetLength >= 31;
      CurrForm.Field32.VISIBLE := MATRIX_CurrSetLength >= 32;
    END;

    BEGIN
    END.
  }
}
