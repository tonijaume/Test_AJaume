OBJECT Form 630 Bar Chart 12x1 Subform
{
  OBJECT-PROPERTIES
  {
    Date=05/11/08;
    Time=12:00:00;
    Version List=NAVW16.00;
  }
  PROPERTIES
  {
    Width=16060;
    Height=5500;
    CaptionML=[ENU=Bar Chart 12x1 Subform;
               ESP=Subformulario gr fico de barras 12x1];
    TimerInterval=250;
    OnInit=BEGIN
             NoOfColumns := 12;
           END;

    OnTimer=BEGIN
              IF (CurrentHeight <> CurrForm.HEIGHT) OR (CurrentWidth <> CurrForm.WIDTH) THEN BEGIN
                CurrentHeight := CurrForm.HEIGHT;
                CurrentWidth := CurrForm.WIDTH;
                ResizeForm;
              END;
            END;

  }
  CONTROLS
  {
    { 2   ;Shape        ;2200 ;990  ;13860;3950 ;Name=BackGrnd;
                                                 HorzGlue=Both;
                                                 BackColor=12632256;
                                                 BackTransparent=No;
                                                 Border=Yes;
                                                 BorderColor=12632256 }
    { 32  ;Shape        ;2200 ;1650 ;13860;550  ;Name=Horizon3;
                                                 HorzGlue=Both;
                                                 BorderColor=32896;
                                                 ShapeStyle=HorzLine }
    { 40  ;Shape        ;2200 ;2970 ;13860;550  ;Name=Horizon2;
                                                 HorzGlue=Both;
                                                 BorderColor=32896;
                                                 ShapeStyle=HorzLine }
    { 41  ;Shape        ;2200 ;4180 ;13860;550  ;Name=Horizon1;
                                                 HorzGlue=Both;
                                                 BorderColor=32896;
                                                 ShapeStyle=HorzLine }
    { 1   ;Shape        ;2310 ;1980 ;990  ;2970 ;Name=Bar1;
                                                 BackColor=16751001;
                                                 BackTransparent=No;
                                                 BorderColor=16751001;
                                                 ShapeStyle=Rectangle;
                                                 OnPush=BEGIN
                                                          ShowValue(1,1);
                                                        END;
                                                         }
    { 5   ;Shape        ;3410 ;1210 ;990  ;3740 ;Name=Bar7;
                                                 BackColor=16751001;
                                                 BackTransparent=No;
                                                 BorderColor=16751001;
                                                 ShapeStyle=Rectangle;
                                                 OnPush=BEGIN
                                                          ShowValue(1,7);
                                                        END;
                                                         }
    { 6   ;TextBox      ;0    ;770  ;2090 ;440  ;Name=Y_Text_Lbl5;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=Y_Text[5] }
    { 7   ;TextBox      ;2310 ;5060 ;880  ;440  ;Name=X_Text_Lbl1;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 BorderStyle=BumpDown;
                                                 SourceExpr=X_Text[1] }
    { 8   ;TextBox      ;0    ;3630 ;2090 ;440  ;Name=Y_Text_Lbl2;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=Y_Text[2] }
    { 9   ;TextBox      ;0    ;1760 ;2090 ;440  ;Name=Y_Text_Lbl4;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=Y_Text[4] }
    { 10  ;TextBox      ;0    ;2640 ;2090 ;440  ;Name=Y_Text_Lbl3;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=Y_Text[3] }
    { 11  ;TextBox      ;0    ;4510 ;2090 ;440  ;Name=Y_Text_Lbl1;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=Y_Text[1] }
    { 12  ;Shape        ;4620 ;1210 ;990  ;3740 ;Name=Bar2;
                                                 BackColor=16751001;
                                                 BackTransparent=No;
                                                 BorderColor=16751001;
                                                 ShapeStyle=Rectangle;
                                                 OnPush=BEGIN
                                                          ShowValue(1,2);
                                                        END;
                                                         }
    { 13  ;Shape        ;5720 ;1210 ;990  ;3740 ;Name=Bar8;
                                                 BackColor=16751001;
                                                 BackTransparent=No;
                                                 BorderColor=16751001;
                                                 ShapeStyle=Rectangle;
                                                 OnPush=BEGIN
                                                          ShowValue(1,8);
                                                        END;
                                                         }
    { 14  ;TextBox      ;3410 ;5060 ;990  ;440  ;Name=X_Text_Lbl2;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 BorderStyle=BumpDown;
                                                 SourceExpr=X_Text[2] }
    { 15  ;Shape        ;11550;1210 ;990  ;3740 ;Name=Bar5;
                                                 BackColor=16751001;
                                                 BackTransparent=No;
                                                 BorderColor=16751001;
                                                 ShapeStyle=Rectangle;
                                                 OnPush=BEGIN
                                                          ShowValue(1,5);
                                                        END;
                                                         }
    { 16  ;Shape        ;9240 ;1210 ;990  ;3740 ;Name=Bar4;
                                                 BackColor=16751001;
                                                 BackTransparent=No;
                                                 BorderColor=16751001;
                                                 ShapeStyle=Rectangle;
                                                 OnPush=BEGIN
                                                          ShowValue(1,4);
                                                        END;
                                                         }
    { 17  ;Shape        ;13860;1210 ;990  ;3740 ;Name=Bar6;
                                                 BackColor=16751001;
                                                 BackTransparent=No;
                                                 BorderColor=16751001;
                                                 ShapeStyle=Rectangle;
                                                 OnPush=BEGIN
                                                          ShowValue(1,6);
                                                        END;
                                                         }
    { 18  ;Shape        ;6930 ;1210 ;990  ;3740 ;Name=Bar3;
                                                 BackColor=16751001;
                                                 BackTransparent=No;
                                                 BorderColor=16751001;
                                                 ShapeStyle=Rectangle;
                                                 OnPush=BEGIN
                                                          ShowValue(1,3);
                                                        END;
                                                         }
    { 19  ;Shape        ;14960;1210 ;990  ;3740 ;Name=Bar12;
                                                 BackColor=16751001;
                                                 BackTransparent=No;
                                                 BorderColor=16751001;
                                                 ShapeStyle=Rectangle;
                                                 OnPush=BEGIN
                                                          ShowValue(1,12);
                                                        END;
                                                         }
    { 20  ;Shape        ;12650;1210 ;990  ;3740 ;Name=Bar11;
                                                 BackColor=16751001;
                                                 BackTransparent=No;
                                                 BorderColor=16751001;
                                                 ShapeStyle=Rectangle;
                                                 OnPush=BEGIN
                                                          ShowValue(1,11);
                                                        END;
                                                         }
    { 21  ;Shape        ;10340;1210 ;990  ;3740 ;Name=Bar10;
                                                 BackColor=16751001;
                                                 BackTransparent=No;
                                                 BorderColor=16751001;
                                                 ShapeStyle=Rectangle;
                                                 OnPush=BEGIN
                                                          ShowValue(1,10);
                                                        END;
                                                         }
    { 22  ;Shape        ;8030 ;1210 ;990  ;3740 ;Name=Bar9;
                                                 BackColor=16751001;
                                                 BackTransparent=No;
                                                 BorderColor=16751001;
                                                 ShapeStyle=Rectangle;
                                                 OnPush=BEGIN
                                                          ShowValue(1,9);
                                                        END;
                                                         }
    { 23  ;TextBox      ;8030 ;5060 ;990  ;440  ;Name=X_Text_Lbl6;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 BorderStyle=BumpDown;
                                                 SourceExpr=X_Text[6] }
    { 24  ;TextBox      ;6930 ;5060 ;990  ;440  ;Name=X_Text_Lbl5;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 BorderStyle=BumpDown;
                                                 SourceExpr=X_Text[5] }
    { 25  ;TextBox      ;5720 ;5060 ;990  ;440  ;Name=X_Text_Lbl4;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 BorderStyle=BumpDown;
                                                 SourceExpr=X_Text[4] }
    { 26  ;TextBox      ;4620 ;5060 ;990  ;440  ;Name=X_Text_Lbl3;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 BorderStyle=BumpDown;
                                                 SourceExpr=X_Text[3] }
    { 4   ;TextBox      ;13860;1210 ;990  ;440  ;Name=BarVal11;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 Border=No;
                                                 DecimalPlaces=0:0;
                                                 SourceExpr=Value1[11] }
    { 29  ;TextBox      ;11550;1210 ;990  ;440  ;Name=BarVal9;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 Border=No;
                                                 DecimalPlaces=0:0;
                                                 SourceExpr=Value1[9] }
    { 30  ;TextBox      ;9240 ;1210 ;990  ;440  ;Name=BarVal7;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 Border=No;
                                                 DecimalPlaces=0:0;
                                                 SourceExpr=Value1[7] }
    { 31  ;TextBox      ;6930 ;1210 ;990  ;440  ;Name=BarVal5;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 Border=No;
                                                 DecimalPlaces=0:0;
                                                 SourceExpr=Value1[5] }
    { 33  ;TextBox      ;4620 ;1210 ;990  ;440  ;Name=BarVal3;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 Border=No;
                                                 DecimalPlaces=0:0;
                                                 SourceExpr=Value1[3] }
    { 34  ;TextBox      ;3410 ;1210 ;990  ;440  ;Name=BarVal2;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 Border=No;
                                                 DecimalPlaces=0:0;
                                                 SourceExpr=Value1[2] }
    { 35  ;TextBox      ;5720 ;1210 ;990  ;440  ;Name=BarVal4;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 Border=No;
                                                 DecimalPlaces=0:0;
                                                 SourceExpr=Value1[4] }
    { 36  ;TextBox      ;8030 ;1210 ;990  ;440  ;Name=BarVal6;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 Border=No;
                                                 DecimalPlaces=0:0;
                                                 SourceExpr=Value1[6] }
    { 37  ;TextBox      ;10340;1210 ;990  ;440  ;Name=BarVal8;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 Border=No;
                                                 DecimalPlaces=0:0;
                                                 SourceExpr=Value1[8] }
    { 38  ;TextBox      ;12650;1210 ;990  ;440  ;Name=BarVal10;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 Border=No;
                                                 DecimalPlaces=0:0;
                                                 SourceExpr=Value1[10] }
    { 39  ;TextBox      ;14960;1210 ;990  ;440  ;Name=BarVal12;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 Border=No;
                                                 DecimalPlaces=0:0;
                                                 SourceExpr=Value1[12] }
    { 27  ;Shape        ;2200 ;0    ;440  ;440  ;VertGlue=Top;
                                                 BackColor=16751001;
                                                 BackTransparent=No;
                                                 BorderColor=16751001;
                                                 ShapeStyle=Rectangle;
                                                 OnPush=BEGIN
                                                          ShowValue(1,1);
                                                        END;
                                                         }
    { 28  ;TextBox      ;2750 ;0    ;4290 ;440  ;Name=LegendLbl1;
                                                 VertGlue=Top;
                                                 Editable=No;
                                                 Focusable=No;
                                                 Border=No;
                                                 SourceExpr=Legend1 }
    { 3   ;TextBox      ;2310 ;1210 ;990  ;440  ;Name=BarVal1;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 Border=No;
                                                 DecimalPlaces=0:0;
                                                 SourceExpr=Value1[1] }
    { 42  ;TextBox      ;14960;5060 ;990  ;440  ;Name=X_Text_Lbl12;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 BorderStyle=BumpDown;
                                                 SourceExpr=X_Text[12] }
    { 43  ;TextBox      ;13860;5060 ;990  ;440  ;Name=X_Text_Lbl11;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 BorderStyle=BumpDown;
                                                 SourceExpr=X_Text[11] }
    { 44  ;TextBox      ;12650;5060 ;990  ;440  ;Name=X_Text_Lbl10;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 BorderStyle=BumpDown;
                                                 SourceExpr=X_Text[10] }
    { 45  ;TextBox      ;11550;5060 ;990  ;440  ;Name=X_Text_Lbl9;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 BorderStyle=BumpDown;
                                                 SourceExpr=X_Text[9] }
    { 46  ;TextBox      ;10340;5060 ;990  ;440  ;Name=X_Text_Lbl8;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 BorderStyle=BumpDown;
                                                 SourceExpr=X_Text[8] }
    { 47  ;TextBox      ;9240 ;5060 ;880  ;440  ;Name=X_Text_Lbl7;
                                                 Editable=No;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 BorderStyle=BumpDown;
                                                 SourceExpr=X_Text[7] }
  }
  CODE
  {
    VAR
      Legend1@1010 : Text[50];
      Y_Text@1000 : ARRAY [5] OF Text[30];
      X_Text@1001 : ARRAY [12] OF Text[100];
      Value1@1002 : ARRAY [12] OF Decimal;
      Tag@1017 : ARRAY [12] OF Text[250];
      MinValue@1013 : Decimal;
      MaxValue@1006 : Decimal;
      Percent@1007 : Text[1];
      CallBackCodeunitNo@1011 : Integer;
      Text002@1014 : TextConst 'ENU=Minimum value must be less than maximum value.;ESP=El valor m¡nimo no debe ser superior al m ximo.';
      CurrentHeight@1015 : Integer;
      CurrentWidth@1016 : Integer;
      SuspendUpdateIsSet@1018 : Boolean;
      NoOfColumns@1012 : Integer;
      Text003@1019 : TextConst 'ENU=You must choose to show between 1 and 12 columns.;ESP=Elija el n£mero de columnas que desea ver (entre 1 y 12).';

    PROCEDURE SuspendUpdate@7(NewSuspendUpdateIsSet@1000 : Boolean);
    BEGIN
      SuspendUpdateIsSet := NewSuspendUpdateIsSet;
    END;

    PROCEDURE ResetBars@1();
    VAR
      i@1000 : Integer;
    BEGIN
      FOR i := 1 TO 12 DO
        InsertValue(i,'',0,'');
    END;

    PROCEDURE SetLegend@9(NewLegend1@1000 : Text[50]);
    BEGIN
      Legend1 := NewLegend1;
      CurrForm.LegendLbl1.UPDATE;
    END;

    PROCEDURE SetNoOfSeries@13(NewNoOfSeries@1000 : Integer);
    BEGIN
      // this function is only provided for consistency
    END;

    PROCEDURE SetNoOfColumns@12(NewNoOfColumns@1000 : Integer);
    BEGIN
      IF (NewNoOfColumns < 1) OR (NewNoOfColumns > 12) THEN
        ERROR(Text003);
      NoOfColumns := NewNoOfColumns;
      CurrForm.Bar1.VISIBLE := TRUE;
      CurrForm.Bar2.VISIBLE := NoOfColumns >= 2;
      CurrForm.Bar3.VISIBLE := NoOfColumns >= 3;
      CurrForm.Bar4.VISIBLE := NoOfColumns >= 4;
      CurrForm.Bar5.VISIBLE := NoOfColumns >= 5;
      CurrForm.Bar6.VISIBLE := NoOfColumns >= 6;
      CurrForm.Bar7.VISIBLE := NoOfColumns >= 7;
      CurrForm.Bar8.VISIBLE := NoOfColumns >= 8;
      CurrForm.Bar9.VISIBLE := NoOfColumns >= 9;
      CurrForm.Bar10.VISIBLE := NoOfColumns >= 10;
      CurrForm.Bar11.VISIBLE := NoOfColumns >= 11;
      CurrForm.Bar12.VISIBLE := NoOfColumns >= 12;

      CurrForm.BarVal1.VISIBLE := TRUE;
      CurrForm.BarVal2.VISIBLE := NoOfColumns >= 2;
      CurrForm.BarVal3.VISIBLE := NoOfColumns >= 3;
      CurrForm.BarVal4.VISIBLE := NoOfColumns >= 4;
      CurrForm.BarVal5.VISIBLE := NoOfColumns >= 5;
      CurrForm.BarVal6.VISIBLE := NoOfColumns >= 6;
      CurrForm.BarVal7.VISIBLE := NoOfColumns >= 7;
      CurrForm.BarVal8.VISIBLE := NoOfColumns >= 8;
      CurrForm.BarVal9.VISIBLE := NoOfColumns >= 9;
      CurrForm.BarVal10.VISIBLE := NoOfColumns >= 10;
      CurrForm.BarVal11.VISIBLE := NoOfColumns >= 11;
      CurrForm.BarVal12.VISIBLE := NoOfColumns >= 12;

      CurrForm.X_Text_Lbl1.VISIBLE := TRUE;
      CurrForm.X_Text_Lbl2.VISIBLE := NoOfColumns >= 2;
      CurrForm.X_Text_Lbl3.VISIBLE := NoOfColumns >= 3;
      CurrForm.X_Text_Lbl4.VISIBLE := NoOfColumns >= 4;
      CurrForm.X_Text_Lbl5.VISIBLE := NoOfColumns >= 5;
      CurrForm.X_Text_Lbl6.VISIBLE := NoOfColumns >= 6;
      CurrForm.X_Text_Lbl7.VISIBLE := NoOfColumns >= 7;
      CurrForm.X_Text_Lbl8.VISIBLE := NoOfColumns >= 8;
      CurrForm.X_Text_Lbl9.VISIBLE := NoOfColumns >= 9;
      CurrForm.X_Text_Lbl10.VISIBLE := NoOfColumns >= 10;
      CurrForm.X_Text_Lbl11.VISIBLE := NoOfColumns >= 11;
      CurrForm.X_Text_Lbl12.VISIBLE := NoOfColumns >= 12;

      ResizeForm;
    END;

    PROCEDURE SetMinMaxValue@18(NewMinValue@1002 : Decimal;NewMaxValue@1000 : Decimal;IsPercent@1001 : Boolean);
    VAR
      Step@1003 : Decimal;
      NoOfStepsToMin@1004 : Integer;
      NoOfStepsToMax@1005 : Integer;
      i@1006 : Integer;
      Quotient@1009 : Decimal;
      Potens10@1010 : Integer;
    BEGIN
      MaxValue := NewMaxValue;
      MinValue := NewMinValue;
      IF MinValue >= MaxValue THEN
        ERROR(Text002);

      IF (MinValue < 0) AND (MaxValue > 0) THEN BEGIN
        IF ABS(MinValue) > 3 * ABS(MaxValue) THEN
          Step := ABS(MinValue) / 3
        ELSE
          IF ABS(MaxValue) > 3 * ABS(MinValue) THEN
            Step := ABS(MaxValue) / 3
          ELSE
            Step := Max(ABS(MinValue),ABS(MaxValue)) / 2;
      END ELSE
        Step := Max(ABS(MaxValue),ABS(MinValue)) / 4;

      IF (Step > 10) OR (Step < 0.1) THEN BEGIN
        Quotient := Step;
        Potens10 := 0;
        WHILE Quotient > 1 DO BEGIN
          Quotient := Quotient / 10;
          Potens10 := Potens10 + 1;
        END;
        WHILE Quotient < 0.1 DO BEGIN
          Quotient := Quotient * 10;
          Potens10 := Potens10 - 1;
        END;
      END;

      IF Quotient <= 0.1 THEN
         Quotient := 0.1
      ELSE
        IF (Quotient > 0.2) AND (Quotient <= 0.25) THEN
           Quotient := 0.25
        ELSE
          Quotient := ROUND(Quotient,0.1,'>');

      Step := Quotient;
      IF Potens10 > 0 THEN
        FOR i := 1 TO Potens10 DO
          Step := Step * 10;
      IF Potens10 < 0 THEN
        FOR i := -1 DOWNTO Potens10 DO
          Step := Step / 10;

      IF IsPercent THEN
        Percent := '%'
      ELSE
        Percent := '';

      IF (MinValue <= 0) AND (MaxValue >= 0) THEN BEGIN
        NoOfStepsToMin := ROUND(-MinValue / Step,1,'>');
        NoOfStepsToMax := ROUND(MaxValue / Step,1,'>');
        WHILE NoOfStepsToMin + NoOfStepsToMax < 4 DO BEGIN
          IF NoOfStepsToMax = 0 THEN
            NoOfStepsToMin := NoOfStepsToMin + 1
          ELSE
            IF NoOfStepsToMin = 0 THEN
              NoOfStepsToMax := NoOfStepsToMax + 1
            ELSE
              IF NoOfStepsToMax * Step - MaxValue > NoOfStepsToMin * Step + MinValue THEN
                NoOfStepsToMin := NoOfStepsToMin + 1
              ELSE
                NoOfStepsToMax := NoOfStepsToMax + 1;
        END;
        MaxValue := Step * NoOfStepsToMax;
        MinValue := -Step * NoOfStepsToMin;
      END ELSE BEGIN
        IF Sign(MinValue) > 0 THEN BEGIN
          NoOfStepsToMin := ROUND(MinValue / Step,1,'<');
          NoOfStepsToMax := NoOfStepsToMin + 4;
        END ELSE BEGIN
          NoOfStepsToMax := ROUND(-MaxValue / Step,1,'<');
          NoOfStepsToMin := NoOfStepsToMax + 4;
        END;
        MinValue := Sign(MinValue) * Step * NoOfStepsToMin;
        MaxValue := Sign(MaxValue) * Step * NoOfStepsToMax;
      END;

      Y_Text[1] := FORMAT(ROUND(MinValue,Step)) + Percent;
      Y_Text[2] := FORMAT(ROUND(MinValue + (MaxValue - MinValue) * 0.25,Step)) + Percent;
      Y_Text[3] := FORMAT(ROUND(MinValue + (MaxValue - MinValue) * 0.5,Step)) + Percent;
      Y_Text[4] := FORMAT(ROUND(MinValue + (MaxValue - MinValue) * 0.75,Step)) + Percent;
      Y_Text[5] := FORMAT(ROUND(MaxValue,Step)) + Percent;
      UpdateView;
    END;

    PROCEDURE InsertFromLeft@10(X_Value_As_Text@1000 : Text[100];Y_Value1@1001 : Decimal;NewTag@1004 : Text[250]);
    VAR
      i@1002 : Integer;
    BEGIN
      FOR i := NoOfColumns - 1 DOWNTO 1 DO BEGIN
        X_Text[i + 1] := X_Text[i];
        Value1[i + 1] := Value1[i];
        Tag[i + 1] := Tag[i];
      END;
      X_Text[1] := X_Value_As_Text;
      Value1[1] := Y_Value1;
      Tag[1] := NewTag;
      UpdateView;
    END;

    PROCEDURE InsertFromRight@21(X_Value_As_Text@1000 : Text[100];Y_Value1@1001 : Decimal;NewTag@1004 : Text[250]);
    VAR
      i@1002 : Integer;
    BEGIN
      FOR i := 1 TO NoOfColumns - 1 DO BEGIN
        X_Text[i] := X_Text[i + 1];
        Value1[i] := Value1[i + 1];
        Tag[i] := Tag[i + 1];
      END;
      X_Text[NoOfColumns] := X_Value_As_Text;
      Value1[NoOfColumns] := Y_Value1;
      Tag[NoOfColumns] := NewTag;
      UpdateView;
    END;

    PROCEDURE InsertValue@11(Index@1005 : Integer;X_Value_As_Text@1000 : Text[100];Y_Value1@1001 : Decimal;NewTag@1004 : Text[250]);
    VAR
      i@1002 : Integer;
    BEGIN
      IF (NoOfColumns < 1) OR (NoOfColumns > 12) THEN
        ERROR(Text003);
      X_Text[Index] := X_Value_As_Text;
      Value1[Index] := Y_Value1;
      Tag[Index] := NewTag;
      UpdateView;
    END;

    PROCEDURE UpdateView@16();
    BEGIN
      IF SuspendUpdateIsSet THEN
        EXIT;

      CurrForm.Bar1.HEIGHT := ScaleValue(Value1[1]);
      CurrForm.Bar1.YPOS := GetBarYPos(Value1[1]);
      CurrForm.BarVal1.YPOS := SetBarValYPOS(CurrForm.Bar1.YPOS);

      CurrForm.Bar2.HEIGHT := ScaleValue(Value1[2]);
      CurrForm.Bar2.YPOS := GetBarYPos(Value1[2]);
      CurrForm.BarVal2.YPOS := SetBarValYPOS(CurrForm.Bar2.YPOS);

      CurrForm.Bar3.HEIGHT := ScaleValue(Value1[3]);
      CurrForm.Bar3.YPOS := GetBarYPos(Value1[3]);
      CurrForm.BarVal3.YPOS := SetBarValYPOS(CurrForm.Bar3.YPOS);

      CurrForm.Bar4.HEIGHT := ScaleValue(Value1[4]);
      CurrForm.Bar4.YPOS := GetBarYPos(Value1[4]);
      CurrForm.BarVal4.YPOS := SetBarValYPOS(CurrForm.Bar4.YPOS);

      CurrForm.Bar5.HEIGHT := ScaleValue(Value1[5]);
      CurrForm.Bar5.YPOS := GetBarYPos(Value1[5]);
      CurrForm.BarVal5.YPOS := SetBarValYPOS(CurrForm.Bar5.YPOS);

      CurrForm.Bar6.HEIGHT := ScaleValue(Value1[6]);
      CurrForm.Bar6.YPOS := GetBarYPos(Value1[6]);
      CurrForm.BarVal6.YPOS := SetBarValYPOS(CurrForm.Bar6.YPOS);

      CurrForm.Bar7.HEIGHT := ScaleValue(Value1[7]);
      CurrForm.Bar7.YPOS := GetBarYPos(Value1[7]);
      CurrForm.BarVal7.YPOS := SetBarValYPOS(CurrForm.Bar7.YPOS);

      CurrForm.Bar8.HEIGHT := ScaleValue(Value1[8]);
      CurrForm.Bar8.YPOS := GetBarYPos(Value1[8]);
      CurrForm.BarVal8.YPOS := SetBarValYPOS(CurrForm.Bar8.YPOS);

      CurrForm.Bar9.HEIGHT := ScaleValue(Value1[9]);
      CurrForm.Bar9.YPOS := GetBarYPos(Value1[9]);
      CurrForm.BarVal9.YPOS := SetBarValYPOS(CurrForm.Bar9.YPOS);

      CurrForm.Bar10.HEIGHT := ScaleValue(Value1[10]);
      CurrForm.Bar10.YPOS := GetBarYPos(Value1[10]);
      CurrForm.BarVal10.YPOS := SetBarValYPOS(CurrForm.Bar10.YPOS);

      CurrForm.Bar11.HEIGHT := ScaleValue(Value1[11]);
      CurrForm.Bar11.YPOS := GetBarYPos(Value1[11]);
      CurrForm.BarVal11.YPOS := SetBarValYPOS(CurrForm.Bar11.YPOS);

      CurrForm.Bar12.HEIGHT := ScaleValue(Value1[12]);
      CurrForm.Bar12.YPOS := GetBarYPos(Value1[12]);
      CurrForm.BarVal12.YPOS := SetBarValYPOS(CurrForm.Bar12.YPOS);

      CurrForm.UPDATECONTROLS;
      CurrForm.Y_Text_Lbl1.UPDATE;
      CurrForm.Y_Text_Lbl2.UPDATE;
      CurrForm.Y_Text_Lbl3.UPDATE;
      CurrForm.Y_Text_Lbl4.UPDATE;
      CurrForm.Y_Text_Lbl5.UPDATE;
      CurrForm.X_Text_Lbl6.UPDATE;
      CurrForm.X_Text_Lbl7.UPDATE;
      CurrForm.X_Text_Lbl8.UPDATE;
      CurrForm.X_Text_Lbl9.UPDATE;
      CurrForm.X_Text_Lbl10.UPDATE;
      CurrForm.X_Text_Lbl11.UPDATE;
      CurrForm.X_Text_Lbl12.UPDATE;
      CurrForm.BarVal1.UPDATE;
      CurrForm.BarVal2.UPDATE;
      CurrForm.BarVal3.UPDATE;
      CurrForm.BarVal4.UPDATE;
      CurrForm.BarVal5.UPDATE;
      CurrForm.BarVal6.UPDATE;
      CurrForm.BarVal7.UPDATE;
      CurrForm.BarVal8.UPDATE;
      CurrForm.BarVal9.UPDATE;
      CurrForm.BarVal10.UPDATE;
      CurrForm.BarVal11.UPDATE;
      CurrForm.BarVal12.UPDATE;
    END;

    LOCAL PROCEDURE ScaleValue@8(Value@1000 : Decimal) : Integer;
    VAR
      Y@1001 : Integer;
    BEGIN
      IF MaxValue <= MinValue THEN
        EXIT(1);

      IF Value > MaxValue THEN
        Value := MaxValue
      ELSE
        IF Value < MinValue THEN
          Value := MinValue;

      IF MinValue >= 0 THEN
        Y := ROUND(CurrForm.BackGrnd.HEIGHT * (Value - MinValue) / (MaxValue - MinValue),1)
      ELSE
        IF MaxValue <= 0 THEN
          Y := ROUND(CurrForm.BackGrnd.HEIGHT * (-Value + MaxValue) / (MaxValue - MinValue),1)
        ELSE
          Y := ROUND(CurrForm.BackGrnd.HEIGHT * ABS(Value) / (MaxValue - MinValue),1);
      IF Y < 1 THEN
        Y := 1;
      IF Y > CurrForm.BackGrnd.HEIGHT THEN
        Y := CurrForm.BackGrnd.HEIGHT;
      EXIT(Y);
    END;

    LOCAL PROCEDURE GetBarYPos@50(Value@1000 : Decimal) : Integer;
    VAR
      Y@1001 : Integer;
    BEGIN
      IF MaxValue <= MinValue THEN
        EXIT(1);

      IF Value > MaxValue THEN
        Value := MaxValue
      ELSE
        IF Value < MinValue THEN
          Value := MinValue;

      IF MinValue >= 0 THEN
        Y :=
          CurrForm.BackGrnd.HEIGHT + CurrForm.BackGrnd.YPOS - ScaleValue(Value)
      ELSE
        IF MaxValue <= 0 THEN
          Y := CurrForm.BackGrnd.YPOS
        ELSE
          IF Sign(Value) > 0 THEN
            Y :=
              CurrForm.BackGrnd.YPOS +
              ROUND(CurrForm.BackGrnd.HEIGHT * ABS(MaxValue) / (MaxValue - MinValue),1) - ScaleValue(Value)
          ELSE
            Y :=
              CurrForm.BackGrnd.YPOS +
              ROUND(CurrForm.BackGrnd.HEIGHT * ABS(MaxValue) / (MaxValue - MinValue),1);
      EXIT(Y);
    END;

    LOCAL PROCEDURE SetBarValYPOS@23(BarYPOS@1000 : Integer) : Integer;
    BEGIN
      IF BarYPOS > CurrForm.BackGrnd.HEIGHT + CurrForm.BackGrnd.YPOS - 440 THEN
        EXIT(BarYPOS - 440)
      ELSE
        EXIT(BarYPOS);
    END;

    LOCAL PROCEDURE ShowValue@2(SeriesNo@1000 : Integer;Index@1002 : Integer);
    VAR
      BarChartBuf@1001 : Record 450;
    BEGIN
      IF CallBackCodeunitNo = 0 THEN
        EXIT;
      BarChartBuf."Series No." := SeriesNo;
      BarChartBuf."Column No." := Index;
      BarChartBuf."Y Value" := Value1[Index];
      BarChartBuf."X Value" := X_Text[Index];
      BarChartBuf.Tag := Tag[Index];
      CODEUNIT.RUN(CallBackCodeunitNo,BarChartBuf);
    END;

    PROCEDURE SetCallbackID@3(NewCodeunitNo@1000 : Integer);
    BEGIN
      CallBackCodeunitNo := NewCodeunitNo;
    END;

    LOCAL PROCEDURE Abs@4(x@1000 : Decimal) : Decimal;
    BEGIN
      IF x >= 0 THEN
        EXIT(x)
      ELSE
        EXIT(-x);
    END;

    LOCAL PROCEDURE Sign@61(x@1000 : Decimal) : Decimal;
    BEGIN
      IF x >= 0 THEN
        EXIT(1)
      ELSE
        EXIT(-1);
    END;

    LOCAL PROCEDURE Max@5(x@1000 : Decimal;y@1001 : Decimal) : Decimal;
    BEGIN
      IF x >= y THEN
        EXIT(x)
      ELSE
        EXIT(y);
    END;

    LOCAL PROCEDURE Min@6(x@1000 : Decimal;y@1001 : Decimal) : Decimal;
    BEGIN
      IF x <= y THEN
        EXIT(x)
      ELSE
        EXIT(y);
    END;

    LOCAL PROCEDURE ResizeForm@14();
    VAR
      ColumnSpacing@1000 : Integer;
    BEGIN
      ColumnSpacing := ROUND((CurrForm.BackGrnd.WIDTH - (NoOfColumns - 1) * 220) / NoOfColumns,1);

      CurrForm.BackGrnd.YPOS := 660;
      CurrForm.BackGrnd.HEIGHT := CurrForm.HEIGHT - 660 - 550;

      CurrForm.X_Text_Lbl1.YPOS := CurrForm.HEIGHT - 440;
      CurrForm.X_Text_Lbl2.YPOS := CurrForm.X_Text_Lbl1.YPOS;
      CurrForm.X_Text_Lbl3.YPOS := CurrForm.X_Text_Lbl1.YPOS;
      CurrForm.X_Text_Lbl4.YPOS := CurrForm.X_Text_Lbl1.YPOS;
      CurrForm.X_Text_Lbl5.YPOS := CurrForm.X_Text_Lbl1.YPOS;
      CurrForm.X_Text_Lbl6.YPOS := CurrForm.X_Text_Lbl1.YPOS;
      CurrForm.X_Text_Lbl7.YPOS := CurrForm.X_Text_Lbl1.YPOS;
      CurrForm.X_Text_Lbl8.YPOS := CurrForm.X_Text_Lbl1.YPOS;
      CurrForm.X_Text_Lbl9.YPOS := CurrForm.X_Text_Lbl1.YPOS;
      CurrForm.X_Text_Lbl10.YPOS := CurrForm.X_Text_Lbl1.YPOS;
      CurrForm.X_Text_Lbl11.YPOS := CurrForm.X_Text_Lbl1.YPOS;
      CurrForm.X_Text_Lbl12.YPOS := CurrForm.X_Text_Lbl1.YPOS;

      CurrForm.X_Text_Lbl1.WIDTH := CurrForm.BackGrnd.WIDTH DIV NoOfColumns - 220;
      CurrForm.X_Text_Lbl2.WIDTH := CurrForm.X_Text_Lbl1.WIDTH;
      CurrForm.X_Text_Lbl3.WIDTH := CurrForm.X_Text_Lbl1.WIDTH;
      CurrForm.X_Text_Lbl4.WIDTH := CurrForm.X_Text_Lbl1.WIDTH;
      CurrForm.X_Text_Lbl5.WIDTH := CurrForm.X_Text_Lbl1.WIDTH;
      CurrForm.X_Text_Lbl6.WIDTH := CurrForm.X_Text_Lbl1.WIDTH;
      CurrForm.X_Text_Lbl7.WIDTH := CurrForm.X_Text_Lbl1.WIDTH;
      CurrForm.X_Text_Lbl8.WIDTH := CurrForm.X_Text_Lbl1.WIDTH;
      CurrForm.X_Text_Lbl9.WIDTH := CurrForm.X_Text_Lbl1.WIDTH;
      CurrForm.X_Text_Lbl10.WIDTH := CurrForm.X_Text_Lbl1.WIDTH;
      CurrForm.X_Text_Lbl11.WIDTH := CurrForm.X_Text_Lbl1.WIDTH;
      CurrForm.X_Text_Lbl12.WIDTH := CurrForm.X_Text_Lbl1.WIDTH;

      CurrForm.X_Text_Lbl2.XPOS := CurrForm.X_Text_Lbl1.XPOS + CurrForm.X_Text_Lbl1.WIDTH + 220;
      CurrForm.X_Text_Lbl3.XPOS := CurrForm.X_Text_Lbl2.XPOS + CurrForm.X_Text_Lbl1.WIDTH + 220;
      CurrForm.X_Text_Lbl4.XPOS := CurrForm.X_Text_Lbl3.XPOS + CurrForm.X_Text_Lbl1.WIDTH + 220;
      CurrForm.X_Text_Lbl5.XPOS := CurrForm.X_Text_Lbl4.XPOS + CurrForm.X_Text_Lbl1.WIDTH + 220;
      CurrForm.X_Text_Lbl6.XPOS := CurrForm.X_Text_Lbl5.XPOS + CurrForm.X_Text_Lbl1.WIDTH + 220;
      CurrForm.X_Text_Lbl7.XPOS := CurrForm.X_Text_Lbl6.XPOS + CurrForm.X_Text_Lbl1.WIDTH + 220;
      CurrForm.X_Text_Lbl8.XPOS := CurrForm.X_Text_Lbl7.XPOS + CurrForm.X_Text_Lbl1.WIDTH + 220;
      CurrForm.X_Text_Lbl9.XPOS := CurrForm.X_Text_Lbl8.XPOS + CurrForm.X_Text_Lbl1.WIDTH + 220;
      CurrForm.X_Text_Lbl10.XPOS := CurrForm.X_Text_Lbl9.XPOS + CurrForm.X_Text_Lbl1.WIDTH + 220;
      CurrForm.X_Text_Lbl11.XPOS := CurrForm.X_Text_Lbl10.XPOS + CurrForm.X_Text_Lbl1.WIDTH + 220;
      CurrForm.X_Text_Lbl12.XPOS := CurrForm.X_Text_Lbl11.XPOS + CurrForm.X_Text_Lbl1.WIDTH + 220;

      CurrForm.Y_Text_Lbl5.YPOS := 440;
      CurrForm.Y_Text_Lbl4.YPOS := 440 + CurrForm.BackGrnd.HEIGHT DIV 4;
      CurrForm.Y_Text_Lbl3.YPOS := 440 + CurrForm.BackGrnd.HEIGHT DIV 2;
      CurrForm.Y_Text_Lbl2.YPOS := 440 + CurrForm.BackGrnd.HEIGHT * 3 DIV 4;
      CurrForm.Y_Text_Lbl1.YPOS := 440 + CurrForm.BackGrnd.HEIGHT;

      CurrForm.Horizon3.YPOS := CurrForm.Y_Text_Lbl4.YPOS - 55;
      CurrForm.Horizon2.YPOS := CurrForm.Y_Text_Lbl3.YPOS - 55;
      CurrForm.Horizon1.YPOS := CurrForm.Y_Text_Lbl2.YPOS - 55;

      CurrForm.Bar1.WIDTH := CurrForm.BackGrnd.WIDTH DIV NoOfColumns - 220;
      CurrForm.Bar2.WIDTH := CurrForm.Bar1.WIDTH;
      CurrForm.Bar3.WIDTH := CurrForm.Bar1.WIDTH;
      CurrForm.Bar4.WIDTH := CurrForm.Bar1.WIDTH;
      CurrForm.Bar5.WIDTH := CurrForm.Bar1.WIDTH;
      CurrForm.Bar6.WIDTH := CurrForm.Bar1.WIDTH;
      CurrForm.Bar7.WIDTH := CurrForm.Bar1.WIDTH;
      CurrForm.Bar8.WIDTH := CurrForm.Bar1.WIDTH;
      CurrForm.Bar9.WIDTH := CurrForm.Bar1.WIDTH;
      CurrForm.Bar10.WIDTH := CurrForm.Bar1.WIDTH;
      CurrForm.Bar11.WIDTH := CurrForm.Bar1.WIDTH;
      CurrForm.Bar12.WIDTH := CurrForm.Bar1.WIDTH;

      CurrForm.Bar2.XPOS := CurrForm.X_Text_Lbl2.XPOS;
      CurrForm.Bar3.XPOS := CurrForm.X_Text_Lbl3.XPOS;
      CurrForm.Bar4.XPOS := CurrForm.X_Text_Lbl4.XPOS;
      CurrForm.Bar5.XPOS := CurrForm.X_Text_Lbl5.XPOS;
      CurrForm.Bar6.XPOS := CurrForm.X_Text_Lbl6.XPOS;
      CurrForm.Bar7.XPOS := CurrForm.X_Text_Lbl7.XPOS;
      CurrForm.Bar8.XPOS := CurrForm.X_Text_Lbl8.XPOS;
      CurrForm.Bar9.XPOS := CurrForm.X_Text_Lbl9.XPOS;
      CurrForm.Bar10.XPOS := CurrForm.X_Text_Lbl10.XPOS;
      CurrForm.Bar11.XPOS := CurrForm.X_Text_Lbl11.XPOS;
      CurrForm.Bar12.XPOS := CurrForm.X_Text_Lbl12.XPOS;

      CurrForm.BarVal2.XPOS := CurrForm.Bar2.XPOS;
      CurrForm.BarVal3.XPOS := CurrForm.Bar3.XPOS;
      CurrForm.BarVal4.XPOS := CurrForm.Bar4.XPOS;
      CurrForm.BarVal5.XPOS := CurrForm.Bar5.XPOS;
      CurrForm.BarVal6.XPOS := CurrForm.Bar6.XPOS;
      CurrForm.BarVal7.XPOS := CurrForm.Bar7.XPOS;
      CurrForm.BarVal8.XPOS := CurrForm.Bar8.XPOS;
      CurrForm.BarVal9.XPOS := CurrForm.Bar9.XPOS;
      CurrForm.BarVal10.XPOS := CurrForm.Bar10.XPOS;
      CurrForm.BarVal11.XPOS := CurrForm.Bar11.XPOS;
      CurrForm.BarVal12.XPOS := CurrForm.Bar12.XPOS;

      CurrForm.BarVal1.WIDTH := CurrForm.Bar1.WIDTH;
      CurrForm.BarVal2.WIDTH := CurrForm.Bar1.WIDTH;
      CurrForm.BarVal3.WIDTH := CurrForm.Bar1.WIDTH;
      CurrForm.BarVal4.WIDTH := CurrForm.Bar1.WIDTH;
      CurrForm.BarVal5.WIDTH := CurrForm.Bar1.WIDTH;
      CurrForm.BarVal6.WIDTH := CurrForm.Bar1.WIDTH;
      CurrForm.BarVal7.WIDTH := CurrForm.Bar1.WIDTH;
      CurrForm.BarVal8.WIDTH := CurrForm.Bar1.WIDTH;
      CurrForm.BarVal9.WIDTH := CurrForm.Bar1.WIDTH;
      CurrForm.BarVal10.WIDTH := CurrForm.Bar1.WIDTH;
      CurrForm.BarVal11.WIDTH := CurrForm.Bar1.WIDTH;
      CurrForm.BarVal12.WIDTH := CurrForm.Bar1.WIDTH;

      UpdateView;
    END;

    BEGIN
    END.
  }
}
