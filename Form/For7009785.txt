OBJECT Form 7009785 Gathered Acc. Schedule Overv.
{
  OBJECT-PROPERTIES
  {
    Date=18/10/12;
    Time=11:55:17;
    Modified=Yes;
    Version List=AIC2009,DA;
  }
  PROPERTIES
  {
    Width=16500;
    Height=8910;
    CaptionML=[ENU=Gathered Acc. Schedule Overview;
               ESP=Panorama esq. cta. agrupado;
               FRA=Panorama sch. cpte. groupÇ];
    CaptionBar=Normal;
    SaveValues=Yes;
    SourceTable=Table85;
    DataCaptionExpr=MontarCaption;
    OnOpenForm=BEGIN
                 GLSetup.GET;
                 IF NewCurrentSchedName <> '' THEN
                   CurrentSchedName := NewCurrentSchedName;
                 IF CurrentSchedName = '' THEN
                   CurrentSchedName := Text000;
                 IF NewCurrentColumnName <> '' THEN
                   CurrentColumnName := NewCurrentColumnName;
                 IF CurrentColumnName = '' THEN
                   CurrentColumnName := Text000;
                 AccSchedManagement.CopyColumnsToTemp(CurrentColumnName,TempColumnLayout);
                 AccSchedManagement.OpenSchedule(CurrentSchedName,Rec);
                 AccSchedManagement.OpenColumns(CurrentColumnName,CurrForm.AccSchedMatrix.MatrixRec);

                 IF AccSchedName.GET(CurrentSchedName) THEN
                   IF AccSchedName."Analysis View Name" <> '' THEN
                     AnalysisView.GET(AccSchedName."Analysis View Name")
                   ELSE BEGIN
                     CLEAR(AnalysisView);
                     AnalysisView."Dimension 1 Code" := GLSetup."Global Dimension 1 Code";
                     AnalysisView."Dimension 2 Code" := GLSetup."Global Dimension 2 Code";
                   END;


                 FindPeriod('');
                 CurrForm.Dim1Filter.ENABLED := AnalysisView."Dimension 1 Code" <> '';
                 CurrForm.Dim2Filter.ENABLED := AnalysisView."Dimension 2 Code" <> '';
                 CurrForm.Dim3Filter.ENABLED := AnalysisView."Dimension 3 Code" <> '';
                 CurrForm.Dim4Filter.ENABLED := AnalysisView."Dimension 4 Code" <> '';
                 CurrForm.UPDATECONTROLS;
               END;

  }
  CONTROLS
  {
    { 1   ;MatrixBox    ;220  ;2420 ;16060;5500 ;Name=AccSchedMatrix;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Editable=No;
                                                 MatrixColumnWidth=2200;
                                                 MatrixSourceTable=Table334;
                                                 OnFindRecord=VAR
                                                                Found@1002 : Boolean;
                                                              BEGIN
                                                                Found := TempColumnLayout.FIND(Which);
                                                                IF Found THEN
                                                                  CurrForm.AccSchedMatrix.MatrixRec := TempColumnLayout;
                                                                EXIT(Found);
                                                              END;

                                                 OnNextRecord=VAR
                                                                ResultSteps@1002 : Integer;
                                                              BEGIN
                                                                ResultSteps := TempColumnLayout.NEXT(Steps);
                                                                IF ResultSteps <> 0 THEN
                                                                  CurrForm.AccSchedMatrix.MatrixRec := TempColumnLayout;
                                                                EXIT(ResultSteps);
                                                              END;

                                                 OnAfterGetRecord=BEGIN
                                                                    // IF Totaling = '' THEN // JPT 13/09/12
                                                                    IF (Totaling = '') AND ("Analytic data Code"='') AND ("Dim. 1 analytic data Filt."='')
                                                                        AND ("Dim. 2 analytic data Filt."= '') AND ("Dim. 3 analytic data Filt."='') AND ("Dim. 4 analytic data Filt."='')  THEN
                                                                      ColumnValue := 0
                                                                    ELSE
                                                                      ColumnValue :=
                                                                        AccSchedManagement.CalcCell(Rec,CurrForm.AccSchedMatrix.MatrixRec,UseAmtsInAddCurr);
                                                                  END;
                                                                   }
    { 2   ;TextBox      ;0    ;1100 ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Row No.";
                                                 OnFormat=BEGIN
                                                            IF Bold THEN
                                                              CurrForm."Row No.".UPDATEFONTBOLD := TRUE;
                                                          END;
                                                           }
    { 3   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=2;
                                                 InColumnHeading=Yes }
    { 4   ;TextBox      ;2514 ;1540 ;4400 ;440  ;HorzGlue=Both;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Description;
                                                 OnFormat=BEGIN
                                                            IF Bold THEN
                                                              CurrForm.Description.UPDATEFONTBOLD := TRUE;
                                                          END;
                                                           }
    { 5   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=4;
                                                 InColumnHeading=Yes }
    { 6   ;TextBox      ;9350 ;2200 ;8800 ;440  ;Name=ColumnValue;
                                                 ParentControl=1;
                                                 InMatrix=Yes;
                                                 DrillDown=Yes;
                                                 CaptionML=[ENU=Value;
                                                            ESP=Valor;
                                                            FRA=Valeur;
                                                            ITA=Valore;
                                                            PTG=Valor];
                                                 SourceExpr=ColumnValue;
                                                 AutoFormatType=1;
                                                 OnFormat=VAR
                                                            Value@1002 : Decimal;
                                                          BEGIN
                                                            EVALUATE(Value, Text);
                                                            IF Value = 0 THEN
                                                              Text := '';
                                                            IF Bold THEN
                                                              CurrForm.ColumnValue.UPDATEFONTBOLD := TRUE;
                                                            IF AccSchedManagement.GetDivisionError THEN
                                                              IF ShowError IN [ShowError::"Division by Zero",ShowError::Both] THEN BEGIN
                                                                Text := Text001;
                                                                CurrForm.ColumnValue.UPDATEFONTBOLD := TRUE;
                                                              END ELSE
                                                                Text := '';
                                                            IF AccSchedManagement.GetPeriodError THEN
                                                              IF ShowError IN [ShowError::"Period Error",ShowError::Both] THEN BEGIN
                                                                Text := Text004;
                                                                CurrForm.ColumnValue.UPDATEFONTBOLD := TRUE;
                                                              END ELSE
                                                                Text := '';

                                                            //+001
                                                            CASE Color OF
                                                              Color::red: CurrForm.ColumnValue.UPDATEFORECOLOR(255);
                                                              Color::blue: CurrForm.ColumnValue.UPDATEFORECOLOR(16711680);
                                                              Color::pink: CurrForm.ColumnValue.UPDATEFORECOLOR(8388736);
                                                            END;
                                                            //-001
                                                          END;

                                                 OnDrillDown=VAR
                                                               GLAcc@1001 : Record 15;
                                                               GLAccAnalysisView@1002 : Record 376;
                                                               ColumnLayout@1003 : Record 334;
                                                               ChartofAccAnalysisView@1004 : Form 569;
                                                               rPlantillaCelda@1103355001 : Record 7009728;
                                                               TempAccSchedLine@1103355002 : TEMPORARY Record 85;
                                                               rAnalyticDataEntry@1103355003 : Record 7009914;
                                                               wFiltroPax@1103350001 : Text[250];
                                                               wFiltroHot@1103350002 : Text[250];
                                                               wFiltroHab@1103350003 : Text[250];
                                                               wFiltroReg@1103350004 : Text[250];
                                                             BEGIN
                                                               // PLB 18/05/2006
                                                               // Pod°a dar un error del estilo "En este formulario no se puede modificar..."
                                                               //
                                                               TempAccSchedLine.COPY(Rec);
                                                               WITH TempAccSchedLine DO BEGIN

                                                               // PLB 28/02/2005
                                                               TempColumnLayout := CurrForm.AccSchedMatrix.MatrixRec;

                                                               // PLB 26/01/2006
                                                               // SGI-118
                                                               // eliminado codigo antiguo
                                                               //
                                                               IF rPlantillaCelda.GET("Schedule Name", TempColumnLayout."Column Layout Name",
                                                                    "Line No.", TempColumnLayout."Line No.") THEN BEGIN
                                                                 TempColumnLayout."Ledger Entry Type" := rPlantillaCelda."Tipo mov. cont.";
                                                                 TempColumnLayout.Formula := '';

                                                                 IF rPlantillaCelda.Formula <> '' THEN
                                                                   Totaling := rPlantillaCelda.Formula
                                                                 ELSE IF Totaling = '' THEN
                                                                   Totaling := '0';

                                                                 "Reverse Sign" := "Reverse Sign" XOR rPlantillaCelda."Muestra signo opuesto";
                                                                 IF rPlantillaCelda."Tipo celda" = rPlantillaCelda."Tipo celda"::Formula THEN BEGIN
                                                                   "Totaling Type" := "Totaling Type"::Formula;
                                                                   IF TempColumnLayout."Column Type" = TempColumnLayout."Column Type"::Formula THEN
                                                                     TempColumnLayout."Column Type" := TempColumnLayout."Column Type"::"Net Change";
                                                                 END
                                                                 ELSE
                                                                   TempColumnLayout."Column Type" := rPlantillaCelda."Tipo celda";

                                                                 IF TempColumnLayout."Ledger Entry Type" = TempColumnLayout."Ledger Entry Type"::"Analytic Data" THEN BEGIN
                                                                   "Analytic data Code" := rPlantillaCelda."Analytic data Code";
                                                                   "Dim. 1 analytic data Tot." := rPlantillaCelda."Dim. 1 analytic data Tot.";
                                                                   "Dim. 2 analytic data Tot." := rPlantillaCelda."Dim. 2 analytic data Tot.";
                                                                   "Dim. 3 analytic data Tot." := rPlantillaCelda."Dim. 3 analytic data Tot.";
                                                                   "Dim. 4 analytic data Tot." := rPlantillaCelda."Dim. 4 analytic data Tot.";
                                                                 END;
                                                               END;

                                                               IF "Analytic data Code" = '' THEN
                                                                 "Analytic data Code" := AccSchedName."Analytic data Code";

                                                               IF TempColumnLayout."Column Type" = ColumnLayout."Column Type"::Formula THEN
                                                                 MESSAGE(Text002,TempColumnLayout.Formula)
                                                               ELSE
                                                                 IF "Totaling Type" = "Totaling Type"::Formula THEN
                                                                   MESSAGE(Text003,Totaling)

                                                                 // PLB 26/01/2007
                                                                 ELSE IF TempColumnLayout."Ledger Entry Type" = TempColumnLayout."Ledger Entry Type"::"Analytic Data" THEN BEGIN
                                                                   IF "Analytic data Code" <> '' THEN
                                                                     WITH rAnalyticDataEntry DO BEGIN
                                                                       RESET;
                                                                       SETCURRENTKEY(Fecha);
                                                                       SETRANGE("Cod. dato analitico", "Analytic data Code");
                                                                       AccSchedManagement.SetGLAccRowFilters(GLAcc,TempAccSchedLine); //+999
                                                                       AccSchedManagement.SetGLAccColumnFilters(GLAcc,TempAccSchedLine,TempColumnLayout); //+999
                                                                       GLAcc.COPYFILTER("Date Filter", Fecha);
                                                                       IF "Analytic data Code" = AccSchedName."Analytic data Code" THEN BEGIN
                                                                         TempAccSchedLine.COPYFILTER("Dim. 1 analytic data Filt.", "Cod. dimension 1");
                                                                         TempAccSchedLine.COPYFILTER("Dim. 2 analytic data Filt.", "Cod. dimension 2");
                                                                         TempAccSchedLine.COPYFILTER("Dim. 3 analytic data Filt.", "Cod. dimension 3");
                                                                         TempAccSchedLine.COPYFILTER("Dim. 4 analytic data Filt.", "Cod. dimension 4");
                                                                         FILTERGROUP(2);
                                                                       END;
                                                                       SETFILTER("Cod. dimension 1", "Dim. 1 analytic data Tot.");
                                                                       SETFILTER("Cod. dimension 2", "Dim. 2 analytic data Tot.");
                                                                       SETFILTER("Cod. dimension 3", "Dim. 3 analytic data Tot.");
                                                                       SETFILTER("Cod. dimension 4", "Dim. 4 analytic data Tot.");
                                                                       IF "Analytic data Code" = AccSchedName."Analytic data Code" THEN
                                                                         FILTERGROUP(0);
                                                                       FORM.RUNMODAL(0, rAnalyticDataEntry);
                                                                     END;
                                                                 END
                                                                 // fin PLB

                                                                 ELSE

                                                                   IF Totaling <> '' THEN BEGIN
                                                                     COPYFILTER("Business Unit Filter",GLAcc."Business Unit Filter");
                                                                     COPYFILTER("Budget Filter",GLAcc."Budget Filter");

                                                                     // PLB 18/05/2006
                                                                     // AccSchedManagement.SetGLAccRowFilters(GLAcc,Rec);
                                                                     AccSchedManagement.SetGLAccRowFilters(GLAcc,TempAccSchedLine);

                                                                     AccSchedManagement.SetGLAccColumnFilters(GLAcc,TempAccSchedLine,TempColumnLayout);
                                                                     AccSchedName.GET(CurrentSchedName);
                                                                     IF AccSchedName."Analysis View Name" = '' THEN BEGIN
                                                                       COPYFILTER("Dimension 1 Filter",GLAcc."Global Dimension 1 Filter");
                                                                       COPYFILTER("Dimension 2 Filter",GLAcc."Global Dimension 2 Filter");
                                                                       GLAcc.FILTERGROUP(2);
                                                                       GLAcc.SETFILTER("Global Dimension 1 Filter",AccSchedManagement.GetDimTotalingFilter(1,"Dimension 1 Totaling"));
                                                                       GLAcc.SETFILTER("Global Dimension 2 Filter",AccSchedManagement.GetDimTotalingFilter(2,"Dimension 2 Totaling"));
                                                                       GLAcc.FILTERGROUP(0);

                                                                       // PLB 30/04/2004
                                                                       IF Company <> '' THEN
                                                                         GLAcc.CHANGECOMPANY(Company);

                                                                       FORM.RUN(FORM::"Chart of Accounts (G/L)",GLAcc);

                                                                       // PLB 30/04/2004
                                                                       IF Company <> '' THEN
                                                                         GLAcc.CHANGECOMPANY(COMPANYNAME);

                                                                     END ELSE BEGIN
                                                                       GLAcc.COPYFILTER("Date Filter",GLAccAnalysisView."Date Filter");
                                                                       GLAcc.COPYFILTER("Budget Filter",GLAccAnalysisView."Budget Filter");
                                                                       GLAcc.COPYFILTER("Business Unit Filter",GLAccAnalysisView."Business Unit Filter");
                                                                       GLAccAnalysisView.SETRANGE("Analysis View Filter",AccSchedName."Analysis View Name");
                                                                       COPYFILTER("Dimension 1 Filter",GLAccAnalysisView."Dimension 1 Filter");
                                                                       COPYFILTER("Dimension 2 Filter",GLAccAnalysisView."Dimension 2 Filter");
                                                                       COPYFILTER("Dimension 3 Filter",GLAccAnalysisView."Dimension 3 Filter");
                                                                       COPYFILTER("Dimension 4 Filter",GLAccAnalysisView."Dimension 4 Filter");
                                                                       GLAccAnalysisView.FILTERGROUP(2);
                                                                       GLAccAnalysisView.SETFILTER("Dimension 1 Filter",AccSchedManagement.GetDimTotalingFilter(1,"Dimension 1 Totaling"));
                                                                       GLAccAnalysisView.SETFILTER("Dimension 2 Filter",AccSchedManagement.GetDimTotalingFilter(2,"Dimension 2 Totaling"));
                                                                       GLAccAnalysisView.SETFILTER("Dimension 3 Filter",AccSchedManagement.GetDimTotalingFilter(3,"Dimension 3 Totaling"));
                                                                       GLAccAnalysisView.SETFILTER("Dimension 4 Filter",AccSchedManagement.GetDimTotalingFilter(4,"Dimension 4 Totaling"));
                                                                       GLAccAnalysisView.FILTERGROUP(0);

                                                                       // PLB 30/04/2004
                                                                       IF Company <> '' THEN
                                                                         GLAccAnalysisView.CHANGECOMPANY(Company);

                                                                       CLEAR(ChartofAccAnalysisView);
                                                                       ChartofAccAnalysisView.InsertTempGLAccAnalysisViews(GLAcc);
                                                                       ChartofAccAnalysisView.SETTABLEVIEW(GLAccAnalysisView);
                                                                       ChartofAccAnalysisView.RUN;

                                                                       // PLB 30/04/2004
                                                                       IF Company <> '' THEN
                                                                         GLAccAnalysisView.CHANGECOMPANY(COMPANYNAME);

                                                                     END;
                                                                   END;

                                                               // PLB 18/05/2006
                                                               END;
                                                             END;
                                                              }
    { 7   ;TextBox      ;12650;1540 ;1650 ;440  ;ParentControl=6;
                                                 InMatrixHeading=Yes;
                                                 HorzAlign=Right;
                                                 CaptionML=[ENU=Column Header;
                                                            ESP=Cabecera columna;
                                                            FRA=Column Header;
                                                            ITA=Testata colonna];
                                                 SourceExpr=CurrForm.AccSchedMatrix.MatrixRec."Column Header" }
    { 8   ;TabControl   ;220  ;220  ;16060;1980 ;HorzGlue=Both;
                                                 PageNamesML=[ENU=General,Dimension Filters,Options,analytical data;
                                                              ESP=General,Fitros dimensi¢n,Opciones,Filtros dato anal°tico;
                                                              FRA=" "] }
    { 10  ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=8;
                                                 InPage=0;
                                                 Lookup=Yes;
                                                 CaptionML=[ENU=Account Schedule Name;
                                                            ESP=Nombre esquema cuenta;
                                                            FRA=Nom schÇma compte;
                                                            ITA=Nome situaz. contabile];
                                                 SourceExpr=CurrentSchedName;
                                                 LookupFormID=Account Schedule Names;
                                                 OnValidate=BEGIN
                                                              AccSchedManagement.CheckName(CurrentSchedName);
                                                            END;

                                                 OnLookup=BEGIN
                                                            EXIT(AccSchedManagement.LookupName(CurrentSchedName,Text));
                                                          END;

                                                 OnAfterValidate=VAR
                                                                   AccSchedName@1001 : Record 84;
                                                                   PrevAnalysisView@1002 : Record 363;
                                                                 BEGIN
                                                                   CurrForm.SAVERECORD;
                                                                   AccSchedManagement.SetName(CurrentSchedName,Rec);
                                                                   IF AccSchedName.GET(CurrentSchedName) THEN
                                                                     IF (AccSchedName."Default Column Layout" <> '') AND
                                                                        (CurrentColumnName <> AccSchedName."Default Column Layout")
                                                                     THEN BEGIN
                                                                       CurrentColumnName := AccSchedName."Default Column Layout";
                                                                       AccSchedManagement.CopyColumnsToTemp(CurrentColumnName,TempColumnLayout);
                                                                       AccSchedManagement.SetColumnName(CurrentColumnName,CurrForm.AccSchedMatrix.MatrixRec);
                                                                     END;

                                                                   IF AccSchedName."Analysis View Name" <> AnalysisView.Code THEN BEGIN
                                                                     PrevAnalysisView := AnalysisView;
                                                                     IF AccSchedName."Analysis View Name" <> '' THEN
                                                                       AnalysisView.GET(AccSchedName."Analysis View Name")
                                                                     ELSE BEGIN
                                                                       CLEAR(AnalysisView);
                                                                       AnalysisView."Dimension 1 Code" := GLSetup."Global Dimension 1 Code";
                                                                       AnalysisView."Dimension 2 Code" := GLSetup."Global Dimension 2 Code";
                                                                     END;
                                                                     IF PrevAnalysisView."Dimension 1 Code" <> AnalysisView."Dimension 1 Code" THEN
                                                                       SETRANGE("Dimension 1 Filter");
                                                                     IF PrevAnalysisView."Dimension 2 Code" <> AnalysisView."Dimension 2 Code" THEN
                                                                       SETRANGE("Dimension 2 Filter");
                                                                     IF PrevAnalysisView."Dimension 3 Code" <> AnalysisView."Dimension 3 Code" THEN
                                                                       SETRANGE("Dimension 3 Filter");
                                                                     IF PrevAnalysisView."Dimension 4 Code" <> AnalysisView."Dimension 4 Code" THEN
                                                                       SETRANGE("Dimension 4 Filter");
                                                                   END;

                                                                   CurrForm.Dim1Filter.ENABLED := AnalysisView."Dimension 1 Code" <> '';
                                                                   CurrForm.Dim2Filter.ENABLED := AnalysisView."Dimension 2 Code" <> '';
                                                                   CurrForm.Dim3Filter.ENABLED := AnalysisView."Dimension 3 Code" <> '';
                                                                   CurrForm.Dim4Filter.ENABLED := AnalysisView."Dimension 4 Code" <> '';

                                                                   CurrForm.UPDATE(FALSE);
                                                                   CurrForm.UPDATECONTROLS;
                                                                 END;
                                                                  }
    { 9   ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=10 }
    { 12  ;TextBox      ;3850 ;1540 ;2750 ;440  ;ParentControl=8;
                                                 InPage=0;
                                                 Lookup=Yes;
                                                 CaptionML=[ENU=Column Layout Name;
                                                            ESP=Nombre plantilla columna;
                                                            FRA=Nom modäle colonne;
                                                            ITA=Nome layout colonna];
                                                 SourceExpr=CurrentColumnName;
                                                 TableRelation="Column Layout Name".Name;
                                                 OnValidate=BEGIN
                                                              AccSchedManagement.CheckColumnName(CurrentColumnName);

                                                              // PLB 19/05/2004
                                                              NewCurrentColumnName := CurrentColumnName;
                                                            END;

                                                 OnLookup=BEGIN
                                                            EXIT(AccSchedManagement.LookupColumnName(CurrentColumnName,Text));
                                                          END;

                                                 OnAfterValidate=BEGIN
                                                                   AccSchedManagement.CopyColumnsToTemp(CurrentColumnName,TempColumnLayout);
                                                                   AccSchedManagement.SetColumnName(CurrentColumnName,CurrForm.AccSchedMatrix.MatrixRec);
                                                                   CurrForm.UPDATE(FALSE);
                                                                 END;
                                                                  }
    { 11  ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=12 }
    { 16  ;TextBox      ;12980;990  ;2750 ;440  ;ParentControl=8;
                                                 InPage=0;
                                                 NextControl=10;
                                                 SourceExpr="Date Filter";
                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 15  ;Label        ;9570 ;990  ;3300 ;440  ;ParentControl=16 }
    { 30  ;TextBox      ;12980;1540 ;2750 ;440  ;ParentControl=8;
                                                 InPage=0;
                                                 SourceExpr="Budget Filter" }
    { 31  ;Label        ;9570 ;1540 ;3300 ;440  ;ParentControl=30 }
    { 36  ;TextBox      ;3850 ;1540 ;2750 ;440  ;Name=Dim2Filter;
                                                 ParentControl=8;
                                                 InPage=1;
                                                 CaptionML=[ENU=Dimension 2 Filter;
                                                            ESP=Filtro dimensi¢n 2;
                                                            FRA=Filtre dimension 2;
                                                            ITA=Filtro dimensione 2];
                                                 ClearOnLookup=No;
                                                 SourceExpr="Dimension 2 Filter";
                                                 CaptionClass=FormGetCaptionClass(2);
                                                 OnLookup=BEGIN
                                                            EXIT(FormLookUpDimFilter(AnalysisView."Dimension 2 Code",Text));
                                                          END;

                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 33  ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=36 }
    { 37  ;TextBox      ;3850 ;990  ;2750 ;440  ;Name=Dim1Filter;
                                                 ParentControl=8;
                                                 InPage=1;
                                                 CaptionML=[ENU=Dimension 1 Filter;
                                                            ESP=Filtro dimensi¢n 1;
                                                            FRA=Filtre dimension 1;
                                                            ITA=Filtro dimensione 1];
                                                 ClearOnLookup=No;
                                                 SourceExpr="Dimension 1 Filter";
                                                 CaptionClass=FormGetCaptionClass(1);
                                                 OnLookup=BEGIN
                                                            EXIT(FormLookUpDimFilter(AnalysisView."Dimension 1 Code",Text));
                                                          END;

                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 41  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=37;
                                                 CaptionClass=FormGetCaptionClass(1) }
    { 38  ;TextBox      ;12980;1540 ;2750 ;440  ;Name=Dim4Filter;
                                                 ParentControl=8;
                                                 InPage=1;
                                                 CaptionML=[ENU=Dimension 4 Filter;
                                                            ESP=Filtro dimensi¢n 4;
                                                            FRA=Filtre dimension 4;
                                                            ITA=Filtro dimensione 4];
                                                 ClearOnLookup=No;
                                                 SourceExpr="Dimension 4 Filter";
                                                 CaptionClass=FormGetCaptionClass(4);
                                                 OnLookup=BEGIN
                                                            EXIT(FormLookUpDimFilter(AnalysisView."Dimension 4 Code",Text));
                                                          END;

                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 35  ;Label        ;9570 ;1540 ;3300 ;440  ;ParentControl=38 }
    { 39  ;TextBox      ;12980;990  ;2750 ;440  ;Name=Dim3Filter;
                                                 ParentControl=8;
                                                 InPage=1;
                                                 CaptionML=[ENU=Dimension 3 Filter;
                                                            ESP=Filtro dimensi¢n 3;
                                                            FRA=Filtre dimension 3;
                                                            ITA=Filtro dimensione 3];
                                                 ClearOnLookup=No;
                                                 SourceExpr="Dimension 3 Filter";
                                                 CaptionClass=FormGetCaptionClass(3);
                                                 OnLookup=BEGIN
                                                            EXIT(FormLookUpDimFilter(AnalysisView."Dimension 3 Code",Text));
                                                          END;

                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 34  ;Label        ;9570 ;990  ;3300 ;440  ;ParentControl=39 }
    { 24  ;CheckBox     ;3850 ;1540 ;440  ;440  ;ParentControl=8;
                                                 InPage=2;
                                                 ShowCaption=No;
                                                 CaptionML=[ENU=Show Amounts in Add. Reporting Currency;
                                                            ESP=Muestra importes en div.-adic.;
                                                            FRA=êchantillon montants en dev.-supp.;
                                                            ITA=Mostra importi in valuta contabile addizionale];
                                                 SourceExpr=UseAmtsInAddCurr;
                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 25  ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=24;
                                                 MultiLine=Yes }
    { 32  ;TextBox      ;3850 ;990  ;1650 ;440  ;ParentControl=8;
                                                 InPage=2;
                                                 CaptionML=[ENU=Show Error;
                                                            ESP=Mostrar error;
                                                            FRA=Afficher erreur;
                                                            ITA=Mostra errore];
                                                 OptionCaptionML=[ENU=None,Division by Zero,Period Error,Both;
                                                                  ESP=Ninguno,Divisi¢n entre cero,Error Periodo,Ambos;
                                                                  FRA=Aucun,Division entre zÇro,Erreur PÇriode,Les deux;
                                                                  ITA=Nessuno,Divisione per zero,Errore periodo,Entrambi];
                                                 SourceExpr=ShowError }
    { 18  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=32 }
    { 1100217000;TextBox;3850 ;990  ;2750 ;440  ;ParentControl=8;
                                                 InPage=3;
                                                 SourceExpr="Dim. 1 analytic data Filt.";
                                                 OnLookup=BEGIN
                                                            EXIT(FormLookUpDimADataFilter(1,Text));
                                                          END;

                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 1100217002;Label  ;440  ;990  ;3300 ;440  ;ParentControl=1100217000 }
    { 1100217001;TextBox;3850 ;1540 ;2750 ;440  ;ParentControl=8;
                                                 InPage=3;
                                                 SourceExpr="Dim. 2 analytic data Filt.";
                                                 OnLookup=BEGIN
                                                            EXIT(FormLookUpDimADataFilter(2,Text));
                                                          END;

                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 1100217003;Label  ;440  ;1540 ;3300 ;440  ;ParentControl=1100217001 }
    { 1100217006;TextBox;13310;990  ;2750 ;440  ;ParentControl=8;
                                                 InPage=3;
                                                 SourceExpr="Dim. 3 analytic data Filt.";
                                                 OnLookup=BEGIN
                                                            EXIT(FormLookUpDimADataFilter(3,Text));
                                                          END;

                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 1100217004;Label  ;9900 ;990  ;3300 ;440  ;ParentControl=1100217006 }
    { 1100217007;TextBox;13310;1540 ;2750 ;440  ;ParentControl=8;
                                                 InPage=3;
                                                 SourceExpr="Dim. 4 analytic data Filt.";
                                                 OnLookup=BEGIN
                                                            EXIT(FormLookUpDimADataFilter(4,Text));
                                                          END;

                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 1100217005;Label  ;9900 ;1540 ;3300 ;440  ;ParentControl=1100217007 }
    { 13  ;CommandButton;14080;8140 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 14  ;OptionButton ;2420 ;8140 ;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 Border=Yes;
                                                 BitmapPos=Center;
                                                 Bitmap=13;
                                                 ToolTipML=[ENU=Year;
                                                            ESP=A§o;
                                                            FRA=AnnÇe;
                                                            ITA=Anno;
                                                            PTG=ANO];
                                                 SourceExpr=PeriodType;
                                                 OptionValue=Year;
                                                 OnPush=BEGIN
                                                          FindPeriod('');
                                                        END;
                                                         }
    { 19  ;OptionButton ;1870 ;8140 ;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 Border=Yes;
                                                 BitmapPos=Center;
                                                 Bitmap=12;
                                                 ToolTipML=[ENU=Quarter;
                                                            ESP=Trimestre;
                                                            FRA=Trimestre;
                                                            ITA=Trimestre;
                                                            PTG=Trimestre];
                                                 SourceExpr=PeriodType;
                                                 OptionValue=Quarter;
                                                 OnPush=BEGIN
                                                          FindPeriod('');
                                                        END;
                                                         }
    { 20  ;OptionButton ;1320 ;8140 ;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 Border=Yes;
                                                 BitmapPos=Center;
                                                 Bitmap=11;
                                                 ToolTipML=[ENU=Month;
                                                            ESP=Mes;
                                                            FRA=Mois;
                                                            ITA=Mese;
                                                            PTG=Màs];
                                                 SourceExpr=PeriodType;
                                                 OptionValue=Month;
                                                 OnPush=BEGIN
                                                          FindPeriod('');
                                                        END;
                                                         }
    { 21  ;OptionButton ;770  ;8140 ;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 Border=Yes;
                                                 BitmapPos=Center;
                                                 Bitmap=10;
                                                 ToolTipML=[ENU=Week;
                                                            ESP=Semana;
                                                            FRA=Semaine;
                                                            ITA=Settimana;
                                                            PTG=Semana];
                                                 SourceExpr=PeriodType;
                                                 OptionValue=Week;
                                                 OnPush=BEGIN
                                                          FindPeriod('');
                                                        END;
                                                         }
    { 22  ;OptionButton ;220  ;8140 ;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 Border=Yes;
                                                 BitmapPos=Center;
                                                 Bitmap=9;
                                                 ToolTipML=[ENU=Day;
                                                            ESP=D°a;
                                                            FRA=Jour;
                                                            ITA=Giorno;
                                                            PTG=Dia];
                                                 SourceExpr=PeriodType;
                                                 OptionValue=Day;
                                                 OnPush=BEGIN
                                                          FindPeriod('');
                                                        END;
                                                         }
    { 23  ;OptionButton ;2970 ;8140 ;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 Border=Yes;
                                                 BitmapPos=Center;
                                                 Bitmap=14;
                                                 ToolTipML=[ENU=Accounting Period;
                                                            ESP=Periodo contable;
                                                            FRA=PÇriode comptable;
                                                            ITA=Periodo contabile;
                                                            PTG=Per°odo Contabil°stico];
                                                 SourceExpr=PeriodType;
                                                 OptionValue=Accounting Period;
                                                 OnPush=BEGIN
                                                          FindPeriod('');
                                                        END;
                                                         }
    { 26  ;CommandButton;3740 ;8140 ;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 BitmapPos=Center;
                                                 AutoRepeat=Yes;
                                                 Bitmap=15;
                                                 ToolTipML=[ENU=Previous Period;
                                                            ESP=Periodo anterior;
                                                            FRA=PÇriode prÇcÇdente;
                                                            ITA=Periodo precedente];
                                                 OnPush=BEGIN
                                                          FindPeriod('<=');
                                                        END;
                                                         }
    { 27  ;CommandButton;4290 ;8140 ;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 BitmapPos=Center;
                                                 AutoRepeat=Yes;
                                                 Bitmap=16;
                                                 ToolTipML=[ENU=Next Period;
                                                            ESP=Periodo siguiente;
                                                            FRA=PÇriode suivante;
                                                            ITA=Periodo successivo];
                                                 OnPush=BEGIN
                                                          FindPeriod('>=');
                                                        END;
                                                         }
    { 28  ;MenuButton   ;11660;8140 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=Functions;
                                                            ESP=Acci&ones;
                                                            FRA=Acci&ones;
                                                            ITA=F&unzioni];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=29;
                                                     Ellipsis=Yes;
                                                     CaptionML=[ENU=Export to Excel;
                                                                ESP=Exportar a Excel;
                                                                FRA=Exporter Ö Excel;
                                                                ITA=Esporta in Excel];
                                                     OnPush=VAR
                                                              ExportAccSchedToExcel@1001 : Report 29;
                                                            BEGIN
                                                              ExportAccSchedToExcel.SetOptions(Rec,CurrentColumnName,UseAmtsInAddCurr);
                                                              ExportAccSchedToExcel.RUN;
                                                            END;
                                                             }
                                                   { ID=40;
                                                     Ellipsis=Yes;
                                                     CaptionML=[ENU=Print;
                                                                ESP=Imprimir;
                                                                FRA=Imprimez;
                                                                ITA=Stampa;
                                                                PTG=Imprimir];
                                                     OnPush=VAR
                                                              AccSched@1000 : Report 25;
                                                              DateFilter@1002 : Text[30];
                                                              BudgetFilter@1003 : Text[30];
                                                              BusUnitFilter@1004 : Text[30];
                                                              Dim1Filter@1005 : Text[250];
                                                              Dim2Filter@1006 : Text[250];
                                                              Dim3Filter@1007 : Text[250];
                                                              Dim4Filter@1008 : Text[250];
                                                            BEGIN
                                                              AccSched.SetAccSchedName(CurrentSchedName);
                                                              AccSched.SetColumnLayoutName(CurrentColumnName);
                                                              DateFilter := GETFILTER("Date Filter");
                                                              BudgetFilter := GETFILTER("Budget Filter");
                                                              BusUnitFilter := GETFILTER("Business Unit Filter");
                                                              Dim1Filter := GETFILTER("Dimension 1 Filter");
                                                              Dim2Filter := GETFILTER("Dimension 2 Filter");
                                                              Dim3Filter := GETFILTER("Dimension 3 Filter");
                                                              Dim4Filter := GETFILTER("Dimension 4 Filter");
                                                              AccSched.SetFilters(DateFilter,BudgetFilter,BusUnitFilter,Dim1Filter,Dim2Filter,Dim3Filter,Dim4Filter);
                                                              {
                                                              AccSched.SetFilter(
                                                                GETFILTER("Date Filter"),GETFILTER("Budget Filter"),GETFILTER("Business Unit Filter"),
                                                                GETFILTER("Dimension 1 Filter"),GETFILTER("Dimension 2 Filter"),
                                                                GETFILTER("Dimension 3 Filter"),GETFILTER("Dimension 4 Filter"));
                                                              }
                                                              AccSched.RUN;
                                                            END;
                                                             }
                                                   { ID=1170000000;
                                                     MenuItemType=Separator }
                                                   { ID=1170000001;
                                                     PushAction=RunObject;
                                                     CaptionML=[ENU=Export Schedules to ASC format;
                                                                ESP=Exp. esq. ctas. a formato ASC;
                                                                FRA=Etendre sch. ctes. Ö format ASC];
                                                     RunObject=Report 10720 }
                                                   { ID=1103355000;
                                                     MenuItemType=Separator }
                                                   { ID=1103355001;
                                                     Ellipsis=Yes;
                                                     CaptionML=[ENU=Cells picture;
                                                                ESP=Panorama celdas];
                                                     OnPush=VAR
                                                              PanoramaCeldas@1103355000 : Form 7009823;
                                                            BEGIN
                                                              PanoramaCeldas.SetAccSchedName(CurrentSchedName);
                                                              PanoramaCeldas.SetColumnName(CurrentColumnName);
                                                              PanoramaCeldas.RUN;
                                                            END;
                                                             }
                                                 }
                                                  }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=DEFAULT;ESP=GENERICO;FRA=GêNêRIQUE;ITA=DEFAULT';
      Text001@1001 : TextConst 'ENU=* ERROR *;ESP=* ERROR *;FRA=* ERREUR *;ITA=* ERRORE *';
      Text002@1002 : TextConst 'ENU=Column formula: %1;ESP=F¢rmula columna: %1;FRA=Formule colonne: %1;ITA=Formula colonna: %1';
      Text003@1003 : TextConst 'ENU=Row formula: %1;ESP=F¢rmula fila: %1;FRA=Formule rangÇe: %1;ITA=Formula riga: %1';
      TempColumnLayout@1004 : TEMPORARY Record 334;
      AccSchedName@1005 : Record 84;
      AnalysisView@1020 : Record 363;
      GLSetup@1016 : Record 98;
      AccSchedManagement@1006 : Codeunit 8;
      CurrentSchedName@1007 : Code[10];
      CurrentColumnName@1008 : Code[10];
      NewCurrentSchedName@1009 : Code[10];
      NewCurrentColumnName@1010 : Code[10];
      ShowError@1011 : 'None,Division by Zero,Period Error,Both';
      ColumnValue@1012 : Decimal;
      PeriodType@1013 : 'Day,Week,Month,Quarter,Year,Accounting Period';
      UseAmtsInAddCurr@1014 : Boolean;
      Text004@1015 : TextConst 'ENU=Not Available;ESP=No disponible;FRA=Pas disponible;ITA=Non disponibile';
      Text005@1021 : TextConst 'ENU=1,6,,Dimension %1 Filter;ESP=1,6,,Dimensi¢n %1 Filtro;FRA=1,6,,Dimension %1 Filtre';
      Text006@1100244005 : TextConst 'ENU=Unable to access to the data of other companys through the company;ESP=No se puede acceder a los datos de otras empresas a traves de la empresa';
      Text007@1100217005 : TextConst 'ENU=of;ESP=" de";FRA=" di";ITA=" di"';
      Text008@1100217003 : TextConst 'ENU=" in";ESP=" en ";FRA=" sur"';
      Text010@1103355000 : TextConst 'ENU=%1\ \FILTERS:\ \;ESP=%1\ \FILTROS:\ \';

    PROCEDURE SetAccSchedName@6(NewAccSchedName@1000 : Code[10]);
    VAR
      AccSchedName@1001 : Record 84;
    BEGIN
      NewCurrentSchedName := NewAccSchedName;
      IF AccSchedName.GET(NewCurrentSchedName) THEN
        IF AccSchedName."Default Column Layout" <> '' THEN
          NewCurrentColumnName := AccSchedName."Default Column Layout";
    END;

    LOCAL PROCEDURE FindPeriod@2(SearchText@1000 : Code[10]);
    VAR
      Calendar@1001 : Record 2000000007;
      PeriodFormMgt@1002 : Codeunit 359;
    BEGIN
      IF GETFILTER("Date Filter") <> '' THEN BEGIN
        Calendar.SETFILTER("Period Start",GETFILTER("Date Filter"));
        IF NOT PeriodFormMgt.FindDate('+',Calendar,PeriodType) THEN
          PeriodFormMgt.FindDate('+',Calendar,PeriodType::Day);
        Calendar.SETRANGE("Period Start");
      END;
      PeriodFormMgt.FindDate(SearchText,Calendar,PeriodType);
      SETRANGE("Date Filter",Calendar."Period Start",Calendar."Period End");
      IF GETRANGEMIN("Date Filter") = GETRANGEMAX("Date Filter") THEN
        SETRANGE("Date Filter",GETRANGEMIN("Date Filter"));
    END;

    LOCAL PROCEDURE FormLookUpDimFilter@57(Dim@1000 : Code[20];VAR Text@1001 : Text[1024]) : Boolean;
    VAR
      DimVal@1002 : Record 349;
      DimValList@1003 : Form 560;
    BEGIN
      IF Dim = '' THEN
        EXIT(FALSE);
      DimValList.LOOKUPMODE(TRUE);
      DimVal.SETRANGE("Dimension Code",Dim);
      DimValList.SETTABLEVIEW(DimVal);
      IF DimValList.RUNMODAL = ACTION::LookupOK THEN BEGIN
        DimValList.GETRECORD(DimVal);
        Text := DimValList.GetSelectionFilter;
        EXIT(TRUE);
      END ELSE
        EXIT(FALSE)
    END;

    LOCAL PROCEDURE FormGetCaptionClass@12(DimNo@1000 : Integer) : Text[250];
    BEGIN
      CASE DimNo OF
        1:
          BEGIN
            IF AnalysisView."Dimension 1 Code" <> '' THEN
              EXIT('1,6,' + AnalysisView."Dimension 1 Code")
            ELSE
              EXIT(STRSUBSTNO(Text005,DimNo));
          END;
        2:
          BEGIN
            IF AnalysisView."Dimension 2 Code" <> '' THEN
              EXIT('1,6,' + AnalysisView."Dimension 2 Code")
            ELSE
              EXIT(STRSUBSTNO(Text005,DimNo));
          END;
        3:
          BEGIN
            IF AnalysisView."Dimension 3 Code" <> '' THEN
              EXIT('1,6,' + AnalysisView."Dimension 3 Code")
            ELSE
              EXIT(STRSUBSTNO(Text005,DimNo));
          END;
        4:
          BEGIN
            IF AnalysisView."Dimension 4 Code" <> '' THEN
              EXIT('1,6,' + AnalysisView."Dimension 4 Code")
            ELSE
              EXIT(STRSUBSTNO(Text005,DimNo));
          END;
      END;
    END;

    PROCEDURE MontarCaption@1100217001() : Text[100];
    BEGIN
      // MontarCaption
      //
      IF NewCurrentSchedName <> '' THEN
        CurrentSchedName := NewCurrentSchedName;
      IF CurrentSchedName = '' THEN
        CurrentSchedName := Text000;
      IF NewCurrentColumnName <> '' THEN
        CurrentColumnName := NewCurrentColumnName;
      IF CurrentColumnName = '' THEN
        CurrentColumnName := Text000;
    END;

    LOCAL PROCEDURE FormLookUpDimADataFilter@1103355002(DimNo@1000 : Integer;VAR Text@1001 : Text[1024]) : Boolean;
    VAR
      DimVal@1002 : Record 7009913;
      DimValList@1003 : Form 7009761;
    BEGIN
      IF AccSchedName."Analytic data Code" = '' THEN
        EXIT(FALSE);
      DimValList.LOOKUPMODE(TRUE);
      DimVal.SETRANGE("Cod. dato analitico",AccSchedName."Analytic data Code");
      DimVal.SETRANGE(Dimension, DimNo-1);
      DimValList.SETTABLEVIEW(DimVal);
      IF DimValList.RUNMODAL = ACTION::LookupOK THEN BEGIN
        DimValList.GETRECORD(DimVal);
        Text := DimValList.GetSelectionFilter;
        EXIT(TRUE);
      END ELSE
        EXIT(FALSE)
    END;

    PROCEDURE MontarFiltro@1103350003(par_Filtro1@1103350000 : Text[250];par_Filtro2@1103350001 : Text[250]) : Text[250];
    BEGIN
      IF par_Filtro1 = '' THEN BEGIN
        IF par_Filtro2 = '' THEN
          EXIT('')
        ELSE
          EXIT(par_Filtro2);
      END
      ELSE IF par_Filtro2 = '' THEN
        EXIT(par_Filtro1)
      ELSE
        EXIT(COPYSTR('('+par_Filtro1 + ')&('+par_Filtro2+')',1, 250));
    END;

    BEGIN
    {
      // PLB 28/04/2004
      Traspasar datos de agrupaci¢n antes de llamar a la exportaci¢n EXCEL

      // PLB 30/04/2004
      Poder visualizar datos de otras empresas

      BRM 07/07/04
      A§adir filtros: Filtro Hotel, Filtro Tipo Persona, Filtro Tipo Habitacion, Filtro Regimen
      Funci¢n FormLookUpEstanciasFilter para gestionar tratamientos de filtros

      001 02/04/12 PLB: INC-59892. Recuperado del est†ndar para que pinte de colores seg£n el campo "Color" de la
                        l°neas del esquema de cuentas.
    }
    END.
  }
}
