OBJECT Form 7009856 Booking Trans. Compra/Venta
{
  OBJECT-PROPERTIES
  {
    Date=02/10/12;
    Time=12:00:00;
    Modified=Yes;
    Version List=AIC2009;
  }
  PROPERTIES
  {
    Width=20460;
    Height=11000;
    CaptionML=[ENU=Sale/Purchase Trans. Booking;
               ESP=Booking Trans. Compra/Venta];
    SaveValues=Yes;
    TableBoxID=77;
    SourceTable=Table7009777;
    DataCaptionExpr=NombreHotel();
    OnInit=BEGIN
             DiaInicial := WORKDATE;
             TourOperadorInicial := 0;
           END;

    OnOpenForm=VAR
                 ok@1103355000 : Boolean;
               BEGIN
                 ok := rHot.GET(Hotel);

                 TTOO();
               END;

  }
  CONTROLS
  {
    { 65  ;PictureBox   ;7590 ;9460 ;550  ;550  ;Name=pict_1;
                                                 VertGlue=Bottom;
                                                 Border=No;
                                                 BitmapList=15,16;
                                                 CaptionML=[ENU=pict_1;
                                                            ESP=pict_1];
                                                 SourceExpr=PrimeraPantalla }
    { 66  ;CommandButton;7590 ;9460 ;550  ;550  ;Name=boton_1;
                                                 VertGlue=Bottom;
                                                 ShowCaption=No;
                                                 BackTransparent=Yes;
                                                 CaptionML=[ENU=RunObject;
                                                            ESP=RunObject];
                                                 OnPush=BEGIN
                                                          IF TourOperadorInicial = 0 THEN
                                                            TourOperadorInicial := 18
                                                          ELSE
                                                            TourOperadorInicial := 0;
                                                          TTOO();
                                                          CurrForm.UPDATE;
                                                        END;
                                                         }
    { 14  ;TabControl   ;110  ;220  ;20130;3850 ;HorzGlue=Both }
    { 17  ;Label        ;330  ;1540 ;2750 ;440  ;ParentControl=14;
                                                 InPage=0;
                                                 CaptionML=[ENU=Room type;
                                                            ESP=Tipo de habitaci¢n] }
    { 8   ;TextBox      ;3190 ;1540 ;2420 ;440  ;ValidateTableRelation=No;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 ClearOnLookup=No;
                                                 SourceExpr=FiltTipHab;
                                                 OnLookup=VAR
                                                            FiltroCont@1103355002 : Text[250];
                                                          BEGIN

                                                            IF TipoHab = TipoHab::Basica THEN BEGIN
                                                              rTipHabBas.RESET;
                                                              IF FORM.RUNMODAL(0,rTipHabBas) = ACTION::LookupOK THEN
                                                                FiltTipHab := Text + rTipHabBas."Codigo Habitacion";
                                                            END
                                                            ELSE BEGIN
                                                              rConVen.RESET;
                                                              rConVen.SETCURRENTKEY(Hotel);
                                                              rConVen.SETRANGE(Hotel,Hotel);
                                                              CLEAR(FiltroCont);
                                                              IF rConVen.FIND('-') THEN BEGIN
                                                                REPEAT
                                                                  IF FiltroCont <> '' THEN
                                                                    FiltroCont := FiltroCont + '|' + rConVen."N§ Contrato venta"
                                                                  ELSE
                                                                    FiltroCont := rConVen."N§ Contrato venta";
                                                                UNTIL rConVen.NEXT = 0;
                                                                rTipHabCup.RESET;
                                                                rTipHabCup.SETFILTER("N§ Contrato"  , FiltroCont);
                                                                rTipHabCup.SETRANGE ("Tipo contrato", rTipHabCup."Tipo contrato"::Venta);
                                                                IF FORM.RUNMODAL(0,rTipHabCup) = ACTION::LookupOK THEN
                                                                  FiltTipHab := Text + rTipHabCup."Habitacion cupo";
                                                              END;
                                                            END;
                                                          END;
                                                           }
    { 77  ;Label        ;13200;1870 ;1430 ;330  ;Visible=No;
                                                 ParentControl=14;
                                                 InPage=0 }
    { 1   ;Label        ;14740;1540 ;2750 ;440  ;HorzGlue=Right;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 CaptionML=[ENU=Day;
                                                            ESP=D¡a] }
    { 2   ;TextBox      ;17600;1540 ;2420 ;440  ;HorzGlue=Right;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 SourceExpr=DiaInicial;
                                                 OnValidate=BEGIN

                                                              CurrForm.Matriz.MatrixRec."Period Start" := DiaInicial;
                                                            END;
                                                             }
    { 35  ;TextBox      ;6820 ;3410 ;2200 ;440  ;Name=tex09;
                                                 Visible=No;
                                                 Editable=No;
                                                 Focusable=No;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 Border=No;
                                                 CaptionML=[ENU=tex09;
                                                            ESP=tex09];
                                                 SourceExpr=tex09 }
    { 37  ;CheckBox     ;6270 ;3410 ;440  ;440  ;Name=ch09;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 CaptionML=[ENU=ch09;
                                                            ESP=ch09];
                                                 SourceExpr=ch09;
                                                 OnValidate=BEGIN

                                                              Filtros_TipHab();
                                                            END;
                                                             }
    { 18  ;TextBox      ;6820 ;2310 ;2200 ;440  ;Name=tex07;
                                                 Visible=No;
                                                 Editable=No;
                                                 Focusable=No;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 Border=No;
                                                 CaptionML=[ENU=tex07;
                                                            ESP=tex07];
                                                 SourceExpr=tex07 }
    { 25  ;CheckBox     ;6270 ;2310 ;440  ;440  ;Name=ch07;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 CaptionML=[ENU=ch07;
                                                            ESP=ch07];
                                                 SourceExpr=ch07;
                                                 OnValidate=BEGIN

                                                              Filtros_TipHab();
                                                            END;
                                                             }
    { 27  ;TextBox      ;3850 ;2860 ;2200 ;440  ;Name=tex05;
                                                 Visible=No;
                                                 Editable=No;
                                                 Focusable=No;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 Border=No;
                                                 CaptionML=[ENU=tex05;
                                                            ESP=tex05];
                                                 SourceExpr=tex05 }
    { 29  ;TextBox      ;3850 ;3410 ;2200 ;440  ;Name=tex06;
                                                 Visible=No;
                                                 Editable=No;
                                                 Focusable=No;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 Border=No;
                                                 CaptionML=[ENU=tex06;
                                                            ESP=tex06];
                                                 SourceExpr=tex06 }
    { 33  ;TextBox      ;6820 ;2860 ;2200 ;440  ;Name=tex08;
                                                 Visible=No;
                                                 Editable=No;
                                                 Focusable=No;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 Border=No;
                                                 CaptionML=[ENU=tex08;
                                                            ESP=tex08];
                                                 SourceExpr=tex08 }
    { 34  ;CheckBox     ;6270 ;2860 ;440  ;440  ;Name=ch08;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 CaptionML=[ENU=ch08;
                                                            ESP=ch08];
                                                 SourceExpr=ch08;
                                                 OnValidate=BEGIN

                                                              Filtros_TipHab();
                                                            END;
                                                             }
    { 36  ;TextBox      ;9790 ;2310 ;2200 ;440  ;Name=tex10;
                                                 Visible=No;
                                                 Editable=No;
                                                 Focusable=No;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 Border=No;
                                                 CaptionML=[ENU=tex10;
                                                            ESP=tex10];
                                                 SourceExpr=tex10 }
    { 38  ;CheckBox     ;9240 ;2310 ;440  ;440  ;Name=ch10;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 CaptionML=[ENU=ch10;
                                                            ESP=ch10];
                                                 SourceExpr=ch10;
                                                 OnValidate=BEGIN

                                                              Filtros_TipHab();
                                                            END;
                                                             }
    { 28  ;CheckBox     ;3300 ;2860 ;440  ;440  ;Name=ch05;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 CaptionML=[ENU=ch05;
                                                            ESP=ch05];
                                                 SourceExpr=ch05;
                                                 OnValidate=BEGIN

                                                              Filtros_TipHab();
                                                            END;
                                                             }
    { 30  ;CheckBox     ;3300 ;3410 ;440  ;440  ;Name=ch06;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 CaptionML=[ENU=ch06;
                                                            ESP=ch06];
                                                 SourceExpr=ch06;
                                                 OnValidate=BEGIN

                                                              Filtros_TipHab();
                                                            END;
                                                             }
    { 12  ;TextBox      ;880  ;3410 ;2200 ;440  ;Name=Tex03;
                                                 Visible=No;
                                                 Editable=No;
                                                 Focusable=No;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 Border=No;
                                                 CaptionML=[ENU=Tex03;
                                                            ESP=Tex03];
                                                 SourceExpr=tex03 }
    { 13  ;TextBox      ;3850 ;2310 ;2200 ;440  ;Name=tex04;
                                                 Visible=No;
                                                 Editable=No;
                                                 Focusable=No;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 Border=No;
                                                 CaptionML=[ENU=tex04;
                                                            ESP=tex04];
                                                 SourceExpr=tex04 }
    { 15  ;CheckBox     ;330  ;3410 ;440  ;440  ;Name=ch03;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 CaptionML=[ENU=ch03;
                                                            ESP=ch03];
                                                 SourceExpr=ch01;
                                                 OnValidate=BEGIN

                                                              Filtros_TipHab();
                                                            END;
                                                             }
    { 16  ;CheckBox     ;3300 ;2310 ;440  ;440  ;Name=ch04;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 CaptionML=[ENU=ch04;
                                                            ESP=ch04];
                                                 SourceExpr=ch02;
                                                 OnValidate=BEGIN

                                                              Filtros_TipHab();
                                                            END;
                                                             }
    { 7   ;TextBox      ;880  ;2310 ;2200 ;440  ;Name=tex01;
                                                 Visible=No;
                                                 Editable=No;
                                                 Focusable=No;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 Border=No;
                                                 CaptionML=[ENU=tex01;
                                                            ESP=tex01];
                                                 SourceExpr=tex01 }
    { 10  ;TextBox      ;880  ;2860 ;2200 ;440  ;Name=Tex02;
                                                 Visible=No;
                                                 Editable=No;
                                                 Focusable=No;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 Border=No;
                                                 CaptionML=[ENU=Tex02;
                                                            ESP=Tex02];
                                                 SourceExpr=tex02 }
    { 6   ;CheckBox     ;330  ;2310 ;440  ;440  ;Name=ch01;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 CaptionML=[ENU=ch01;
                                                            ESP=ch01];
                                                 SourceExpr=ch01;
                                                 OnValidate=BEGIN

                                                              Filtros_TipHab();
                                                            END;
                                                             }
    { 11  ;CheckBox     ;330  ;2860 ;440  ;440  ;Name=ch02;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 CaptionML=[ENU=ch02;
                                                            ESP=ch02];
                                                 SourceExpr=ch02;
                                                 OnValidate=BEGIN

                                                              Filtros_TipHab();
                                                            END;
                                                             }
    { 44  ;TextBox      ;3190 ;990  ;5060 ;440  ;Editable=No;
                                                 Focusable=No;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 SourceExpr=Hotel + ' - ' + cNoms.nom_hotel(Hotel) }
    { 45  ;Label        ;330  ;990  ;2750 ;440  ;ParentControl=44;
                                                 CaptionML=[ENU=Hotel;
                                                            ESP=Hotel] }
    { 59  ;CheckBox     ;9240 ;2860 ;440  ;440  ;Name=ch11;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 CaptionML=[ENU=ch11;
                                                            ESP=ch11];
                                                 SourceExpr=ch11;
                                                 OnValidate=BEGIN

                                                              Filtros_TipHab();
                                                            END;
                                                             }
    { 60  ;TextBox      ;9790 ;2860 ;2200 ;440  ;Name=tex11;
                                                 Visible=No;
                                                 Editable=No;
                                                 Focusable=No;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 Border=No;
                                                 CaptionML=[ENU=tex11;
                                                            ESP=tex11];
                                                 SourceExpr=tex11 }
    { 61  ;TextBox      ;9790 ;3410 ;2200 ;440  ;Name=tex12;
                                                 Visible=No;
                                                 Editable=No;
                                                 Focusable=No;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 Border=No;
                                                 CaptionML=[ENU=Tex12;
                                                            ESP=Tex12];
                                                 SourceExpr=tex12 }
    { 62  ;CheckBox     ;9240 ;3410 ;440  ;440  ;Name=ch12;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 CaptionML=[ENU=ch12;
                                                            ESP=ch12];
                                                 SourceExpr=ch12;
                                                 OnValidate=BEGIN

                                                              Filtros_TipHab();
                                                            END;
                                                             }
    { 49  ;TextBox      ;12760;2310 ;2200 ;440  ;Name=tex13;
                                                 Visible=No;
                                                 Editable=No;
                                                 Focusable=No;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 Border=No;
                                                 CaptionML=[ENU=Tex13;
                                                            ESP=Tex13];
                                                 SourceExpr=tex13 }
    { 50  ;CheckBox     ;12210;2310 ;440  ;440  ;Name=ch13;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 CaptionML=[ENU=ch13;
                                                            ESP=ch13];
                                                 SourceExpr=ch13;
                                                 OnValidate=BEGIN

                                                              Filtros_TipHab();
                                                            END;
                                                             }
    { 51  ;CheckBox     ;12210;2860 ;440  ;440  ;Name=ch14;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 CaptionML=[ENU=ch14;
                                                            ESP=ch14];
                                                 SourceExpr=ch14;
                                                 OnValidate=BEGIN

                                                              Filtros_TipHab();
                                                            END;
                                                             }
    { 52  ;TextBox      ;12760;2860 ;2200 ;440  ;Name=tex14;
                                                 Visible=No;
                                                 Editable=No;
                                                 Focusable=No;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 Border=No;
                                                 CaptionML=[ENU=tex14;
                                                            ESP=tex14];
                                                 SourceExpr=tex14 }
    { 53  ;TextBox      ;12760;3410 ;2200 ;440  ;Name=tex15;
                                                 Visible=No;
                                                 Editable=No;
                                                 Focusable=No;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 Border=No;
                                                 CaptionML=[ENU=tex15;
                                                            ESP=tex15];
                                                 SourceExpr=tex15 }
    { 54  ;CheckBox     ;12210;3410 ;440  ;440  ;Name=ch15;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 CaptionML=[ENU=ch15;
                                                            ESP=ch15];
                                                 SourceExpr=ch15;
                                                 OnValidate=BEGIN

                                                              Filtros_TipHab();
                                                            END;
                                                             }
    { 55  ;CheckBox     ;15180;2310 ;440  ;440  ;Name=ch16;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 CaptionML=[ENU=ch16;
                                                            ESP=ch16];
                                                 SourceExpr=ch16;
                                                 OnValidate=BEGIN

                                                              Filtros_TipHab();
                                                            END;
                                                             }
    { 56  ;TextBox      ;15730;2310 ;2200 ;440  ;Name=tex16;
                                                 Visible=No;
                                                 Editable=No;
                                                 Focusable=No;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 Border=No;
                                                 CaptionML=[ENU=tex16;
                                                            ESP=tex16];
                                                 SourceExpr=tex16 }
    { 57  ;CheckBox     ;15180;2860 ;440  ;440  ;Name=ch17;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 CaptionML=[ENU=ch17;
                                                            ESP=ch17];
                                                 SourceExpr=ch17;
                                                 OnValidate=BEGIN

                                                              Filtros_TipHab();
                                                            END;
                                                             }
    { 58  ;TextBox      ;15730;2860 ;2200 ;440  ;Name=tex17;
                                                 Visible=No;
                                                 Editable=No;
                                                 Focusable=No;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 Border=No;
                                                 CaptionML=[ENU=tex17;
                                                            ESP=tex17];
                                                 SourceExpr=tex17 }
    { 63  ;CheckBox     ;15180;3410 ;440  ;440  ;Name=ch18;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 CaptionML=[ENU=ch18;
                                                            ESP=ch18];
                                                 SourceExpr=ch18;
                                                 OnValidate=BEGIN

                                                              Filtros_TipHab();
                                                            END;
                                                             }
    { 64  ;TextBox      ;15730;3410 ;2200 ;440  ;Name=tex18;
                                                 Visible=No;
                                                 Editable=No;
                                                 Focusable=No;
                                                 ParentControl=14;
                                                 InPage=0;
                                                 Border=No;
                                                 CaptionML=[ENU=tex18;
                                                            ESP=tex18];
                                                 SourceExpr=tex18 }
    { 9   ;CommandButton;18040;9460 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 19  ;OptionButton ;2860 ;9460 ;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 Border=Yes;
                                                 BitmapPos=Center;
                                                 Bitmap=14;
                                                 ToolTipML=[ENU=Accounting term;
                                                            ESP=Periodo contable];
                                                 SourceExpr=TipoPeriodo;
                                                 OptionValue=Periodo contable }
    { 20  ;OptionButton ;2310 ;9460 ;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 Border=Yes;
                                                 BitmapPos=Center;
                                                 Bitmap=13;
                                                 ToolTipML=[ENU=Year;
                                                            ESP=A¤o];
                                                 SourceExpr=TipoPeriodo;
                                                 OptionValue=A¤o }
    { 21  ;OptionButton ;1760 ;9460 ;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 Border=Yes;
                                                 BitmapPos=Center;
                                                 Bitmap=12;
                                                 ToolTipML=[ENU=Three-month;
                                                            ESP=Trimestre];
                                                 SourceExpr=TipoPeriodo;
                                                 OptionValue=Trimestre }
    { 22  ;OptionButton ;1210 ;9460 ;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 Border=Yes;
                                                 BitmapPos=Center;
                                                 Bitmap=11;
                                                 ToolTipML=[ENU=Month;
                                                            ESP=Mes];
                                                 SourceExpr=TipoPeriodo;
                                                 OptionValue=Mes }
    { 23  ;OptionButton ;660  ;9460 ;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 Border=Yes;
                                                 BitmapPos=Center;
                                                 Bitmap=10;
                                                 ToolTipML=[ENU=Week;
                                                            ESP=Semana];
                                                 SourceExpr=TipoPeriodo;
                                                 OptionValue=Semana }
    { 24  ;OptionButton ;110  ;9460 ;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 Border=Yes;
                                                 BitmapPos=Center;
                                                 Bitmap=9;
                                                 ToolTipML=[ENU=Day;
                                                            ESP=D¡a];
                                                 SourceExpr=TipoPeriodo;
                                                 OptionValue=D¡a }
    { 26  ;MatrixBox    ;110  ;4180 ;20130;5060 ;Name=Matriz;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Editable=No;
                                                 MatrixSourceTable=Table2000000007;
                                                 OnFindRecord=BEGIN

                                                                IF CurrForm.Matriz.MatrixRec."Period Start" = 0D THEN
                                                                  CurrForm.Matriz.MatrixRec."Period Start" := DiaInicial;

                                                                EXIT(GestionFormPeriodo.FindDate(Which,CurrForm.Matriz.MatrixRec,TipoPeriodo));
                                                              END;

                                                 OnNextRecord=BEGIN

                                                                EXIT(GestionFormPeriodo.NextDate(Steps,CurrForm.Matriz.MatrixRec,TipoPeriodo));
                                                              END;

                                                 OnAfterGetRecord=BEGIN

                                                                    // AsigFiltFecha;

                                                                    IF TipoHab = TipoHab::Basica THEN
                                                                      Importe := CalculaImporteBas(Rec)
                                                                    ELSE
                                                                      Importe := CalculaImporteCup(Rec);
                                                                  END;
                                                                   }
    { 3   ;TextBox      ;0    ;2090 ;5113 ;440  ;Name=Texto;
                                                 ParentControl=26;
                                                 InColumn=Yes;
                                                 CaptionML=[ENU=Text;
                                                            ESP=Texto];
                                                 SourceExpr=Texto;
                                                 OnFormat=BEGIN

                                                            CurrForm.Texto.UPDATEFONTBOLD := FALSE;
                                                            CurrForm.Texto.UPDATEINDENT(0);

                                                            IF "Tipo de Registro" = "Tipo de Registro"::T¡tulo THEN
                                                              CurrForm.Texto.UPDATEFONTBOLD := TRUE
                                                            ELSE
                                                              CurrForm.Texto.UPDATEINDENT(440);
                                                          END;
                                                           }
    { 4   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=3;
                                                 InColumnHeading=Yes }
    { 31  ;TextBox      ;5684 ;2530 ;13090;440  ;Name=Importe;
                                                 ParentControl=26;
                                                 InMatrix=Yes;
                                                 CaptionML=[ENU=Amount;
                                                            ESP=Importe];
                                                 BlankZero=Yes;
                                                 SourceExpr=Importe;
                                                 OnActivate=BEGIN
                                                              // AsigFiltFecha;
                                                            END;

                                                 OnFormat=BEGIN

                                                            IF Importe > 0 THEN
                                                              CurrForm.Importe.UPDATEFORECOLOR(16711680)
                                                            ELSE
                                                              IF Importe < 0 THEN
                                                                CurrForm.Importe.UPDATEFORECOLOR(255)
                                                              ELSE
                                                                CurrForm.Importe.UPDATEFORECOLOR(0);
                                                          END;

                                                 OnDrillDown=VAR
                                                               ok@1103355001 : Boolean;
                                                             BEGIN
                                                               IF TipoHab = TipoHab::Basica THEN BEGIN
                                                                 IF TourOperador = '' THEN BEGIN
                                                                   IF ("Tipo de Total" = "Tipo de Total"::Compra) THEN BEGIN
                                                                     IF ("Tipo de Registro" = "Tipo de Registro"::Contrato) THEN BEGIN
                                                                       rCupCom.RESET;
                                                                       rCupCom.SETCURRENTKEY(Dia,Hotel,TourOperador);
                                                                       rCupCom.SETRANGE(Hotel,Hotel);
                                                                       rCupCom.SETRANGE(Dia,CurrForm.Matriz.MatrixRec."Period Start",CurrForm.Matriz.MatrixRec."Period End");
                                                                       IF Rec.TourOperador = '' THEN
                                                                         rCupCom.SETRANGE(rCupCom.TourOperador)
                                                                       ELSE
                                                                         rCupCom.SETRANGE(rCupCom.TourOperador,Rec.TourOperador);
                                                                       FORM.RUN(0,rCupCom);
                                                                     END;

                                                                     IF ("Tipo de Registro" = "Tipo de Registro"::Cupo) THEN BEGIN
                                                                       rCupCom.RESET;
                                                                       rCupCom.SETCURRENTKEY(Dia,Hotel,TourOperador);
                                                                       rCupCom.SETRANGE(Hotel,Hotel);
                                                                       IF FiltTipHab = '' THEN
                                                                         rCupCom.SETRANGE(rCupCom."Habitacion basica")
                                                                       ELSE
                                                                         rCupCom.SETFILTER("Habitacion basica",FiltTipHab);
                                                                       IF TourOperador = '' THEN
                                                                         rCupCom.SETRANGE(TourOperador)
                                                                       ELSE
                                                                         rCupCom.SETRANGE(rCupCom.TourOperador,TourOperador);
                                                                       rCupCom.SETRANGE(Dia,CurrForm.Matriz.MatrixRec."Period Start",CurrForm.Matriz.MatrixRec."Period End");
                                                                       FORM.RUN(0,rCupCom);
                                                                     END;

                                                                     IF ("Tipo de Registro" = "Tipo de Registro"::Prevision) THEN BEGIN
                                                                       rPre.RESET;
                                                                       rPre.SETCURRENTKEY("Tipo Contrato",
                                                                                          Hotel,
                                                                                          TourOperador,
                                                                                          Dia,
                                                                                          "Habitacion basica");
                                                                       rPre.SETRANGE("Tipo Contrato", rPre."Tipo Contrato"::Compra);
                                                                       rPre.SETRANGE(Hotel          , Hotel);
                                                                       IF FiltTipHab = '' THEN
                                                                         rPre.SETRANGE("Habitacion basica")
                                                                       ELSE
                                                                         rPre.SETFILTER("Habitacion basica", FiltTipHab);
                                                                       IF TourOperador = '' THEN
                                                                         rPre.SETRANGE(TourOperador)
                                                                       ELSE
                                                                         rPre.SETRANGE(TourOperador, TourOperador);
                                                                       rPre.SETRANGE(Dia,CurrForm.Matriz.MatrixRec."Period Start",CurrForm.Matriz.MatrixRec."Period End");
                                                                       FORM.RUN(0, rPre);
                                                                     END;

                                                                     IF ("Tipo de Registro" = "Tipo de Registro"::Ocupado) OR ("Tipo de Registro" = "Tipo de Registro"::Asignado) THEN BEGIN
                                                                       // si el hotel es de oferta, tenemos que filtrar por "Hotel reservado"
                                                                       //
                                                                       IF ("Tipo de Registro" = "Tipo de Registro"::Ocupado) AND rHot.NoName THEN BEGIN
                                                                         rRsv.RESET;
                                                                         rRsv.SETCURRENTKEY("Hotel reservado", TourOperador, Dia, Habitacion);
                                                                         rRsv.SETRANGE(rRsv."Hotel reservado",Hotel);
                                                                         IF FiltTipHab = '' THEN
                                                                           rRsv.SETRANGE(Habitacion)
                                                                         ELSE
                                                                           rRsv.SETFILTER(Habitacion,FiltTipHab);
                                                                         rRsv.SETRANGE(Dia, CurrForm.Matriz.MatrixRec."Period Start", CurrForm.Matriz.MatrixRec."Period End");
                                                                         IF TourOperador = '' THEN
                                                                           rRsv.SETRANGE(TourOperador)
                                                                         ELSE
                                                                           rRsv.SETRANGE(TourOperador,TourOperador);
                                                                         rRsv.SETRANGE("Cantidad booking");
                                                                         rRsv.SETRANGE(Asignado);
                                                                         rRsv.SETFILTER("Cantidad reservado", '>%1', 0);
                                                                         FORM.RUN(0,rRsv);
                                                                       END
                                                                       ELSE BEGIN
                                                                         rRsv.RESET;
                                                                         rRsv.SETCURRENTKEY("Hotel booking", TourOperador, Dia, Habitacion);
                                                                         rRsv.SETRANGE(rRsv."Hotel booking",Hotel);
                                                                         IF FiltTipHab = '' THEN
                                                                           rRsv.SETRANGE(Habitacion)
                                                                         ELSE
                                                                           rRsv.SETFILTER(Habitacion,FiltTipHab);
                                                                         rRsv.SETRANGE(Dia, CurrForm.Matriz.MatrixRec."Period Start", CurrForm.Matriz.MatrixRec."Period End");
                                                                         IF TourOperador = '' THEN
                                                                           rRsv.SETRANGE(TourOperador)
                                                                         ELSE
                                                                           rRsv.SETRANGE(TourOperador,TourOperador);
                                                                         rRsv.SETRANGE("Cantidad booking");
                                                                         rRsv.SETRANGE(Asignado);
                                                                         IF ("Tipo de Registro" = "Tipo de Registro"::Ocupado) THEN
                                                                           rRsv.SETFILTER("Cantidad booking",'>%1',0);
                                                                         IF ("Tipo de Registro" = "Tipo de Registro"::Asignado) THEN
                                                                           rRsv.SETFILTER(Asignado,'>%1',0);
                                                                         FORM.RUN(0,rRsv);
                                                                       END;
                                                                     END;
                                                                   END
                                                                   ELSE BEGIN
                                                                     IF ("Tipo de Registro" = "Tipo de Registro"::Contrato) THEN BEGIN
                                                                       rCupVen.RESET;
                                                                       rCupVen.SETCURRENTKEY(Dia,Hotel,TourOperador);
                                                                       rCupVen.SETRANGE(Hotel,Hotel);
                                                                       rCupVen.SETRANGE(Dia,CurrForm.Matriz.MatrixRec."Period Start",CurrForm.Matriz.MatrixRec."Period End");
                                                                       IF Rec.TourOperador = '' THEN
                                                                         rCupVen.SETRANGE(rCupVen.TourOperador)
                                                                       ELSE
                                                                         rCupVen.SETRANGE(rCupVen.TourOperador,Rec.TourOperador);
                                                                       FORM.RUN(0,rCupVen);
                                                                     END;

                                                                     IF ("Tipo de Registro" = "Tipo de Registro"::Cupo) THEN BEGIN
                                                                       rCupVen.RESET;
                                                                       rCupVen.SETCURRENTKEY(Dia,Hotel,TourOperador);
                                                                       rCupVen.SETRANGE(Hotel,Hotel);
                                                                       IF FiltTipHab = '' THEN
                                                                         rCupVen.SETRANGE(rCupVen."Habitacion basica")
                                                                       ELSE
                                                                         rCupVen.SETFILTER("Habitacion basica",FiltTipHab);
                                                                       IF TourOperador = '' THEN
                                                                         rCupVen.SETRANGE(TourOperador)
                                                                       ELSE
                                                                         rCupVen.SETRANGE(rCupVen.TourOperador,TourOperador);
                                                                       rCupVen.SETRANGE(Dia,CurrForm.Matriz.MatrixRec."Period Start",CurrForm.Matriz.MatrixRec."Period End");
                                                                       FORM.RUN(0,rCupVen);
                                                                     END;

                                                                     IF ("Tipo de Registro" = "Tipo de Registro"::Prevision) THEN BEGIN
                                                                       rPre.RESET;
                                                                       rPre.SETCURRENTKEY("Tipo Contrato",
                                                                                          Hotel,
                                                                                          TourOperador,
                                                                                          Dia,
                                                                                          "Habitacion basica");
                                                                       rPre.SETRANGE("Tipo Contrato", rPre."Tipo Contrato"::Venta);
                                                                       rPre.SETRANGE(Hotel          , Hotel);
                                                                       IF FiltTipHab = '' THEN
                                                                         rPre.SETRANGE("Habitacion basica")
                                                                       ELSE
                                                                         rPre.SETFILTER("Habitacion basica", FiltTipHab);
                                                                       IF TourOperador = '' THEN
                                                                         rPre.SETRANGE(TourOperador)
                                                                       ELSE
                                                                         rPre.SETRANGE(TourOperador, TourOperador);
                                                                       rPre.SETRANGE(Dia,CurrForm.Matriz.MatrixRec."Period Start",CurrForm.Matriz.MatrixRec."Period End");
                                                                       FORM.RUN(0, rPre);
                                                                     END;

                                                                     IF ("Tipo de Registro" = "Tipo de Registro"::Ocupado) OR ("Tipo de Registro" = "Tipo de Registro"::Asignado) THEN BEGIN
                                                                       IF ("Tipo de Registro" = "Tipo de Registro"::Ocupado) AND rHot.NoName THEN BEGIN
                                                                         rRsvVen.RESET;
                                                                         rRsvVen.SETCURRENTKEY("Hotel Reservado", TourOperador, Dia, Habitacion);
                                                                         rRsvVen.SETRANGE(rRsvVen."Hotel Reservado",Hotel);
                                                                         IF FiltTipHab = '' THEN
                                                                           rRsvVen.SETRANGE(Habitacion)
                                                                         ELSE
                                                                           rRsvVen.SETFILTER(Habitacion,FiltTipHab);
                                                                         rRsvVen.SETRANGE(Dia, CurrForm.Matriz.MatrixRec."Period Start", CurrForm.Matriz.MatrixRec."Period End");
                                                                         IF TourOperador = '' THEN
                                                                           rRsvVen.SETRANGE(TourOperador)
                                                                         ELSE
                                                                           rRsvVen.SETRANGE(TourOperador,TourOperador);
                                                                         rRsvVen.SETRANGE("Cantidad booking");
                                                                         rRsvVen.SETRANGE(Asignado);
                                                                         rRsvVen.SETFILTER("Cantidad reservado",'>%1',0);
                                                                         FORM.RUN(0,rRsvVen);
                                                                       END
                                                                       ELSE BEGIN
                                                                         rRsvVen.RESET;
                                                                         rRsvVen.SETCURRENTKEY("Hotel Booking",TourOperador,Dia,Habitacion);
                                                                         rRsvVen.SETRANGE(rRsvVen."Hotel Booking",Hotel);
                                                                         IF FiltTipHab = '' THEN
                                                                           rRsvVen.SETRANGE(Habitacion)
                                                                         ELSE
                                                                           rRsvVen.SETFILTER(Habitacion,FiltTipHab);
                                                                         rRsvVen.SETRANGE(Dia,CurrForm.Matriz.MatrixRec."Period Start",CurrForm.Matriz.MatrixRec."Period End");
                                                                         IF TourOperador = '' THEN
                                                                           rRsvVen.SETRANGE(TourOperador)
                                                                         ELSE
                                                                           rRsvVen.SETRANGE(TourOperador,TourOperador);
                                                                        rRsvVen.SETRANGE("Cantidad booking");
                                                                        rRsvVen.SETRANGE(Asignado);
                                                                        IF ("Tipo de Registro" = "Tipo de Registro"::Ocupado) THEN
                                                                          rRsvVen.SETFILTER("Cantidad booking",'>%1',0);
                                                                        IF ("Tipo de Registro" = "Tipo de Registro"::Asignado) THEN
                                                                          rRsvVen.SETFILTER(Asignado,'>%1',0);
                                                                        FORM.RUN(0,rRsvVen);
                                                                      END;
                                                                     END;
                                                                   END;
                                                                 END;

                                                                 IF TourOperador <> '' THEN BEGIN
                                                                   IF ("Tipo de Registro" = "Tipo de Registro"::Contrato) THEN BEGIN
                                                                     rCupVen.RESET;
                                                                     rCupVen.SETCURRENTKEY(Dia,
                                                                                           Hotel,
                                                                                           TourOperador);
                                                                     rCupVen.SETRANGE(Hotel, Hotel);
                                                                     rCupVen.SETRANGE(Dia  , CurrForm.Matriz.MatrixRec."Period Start",CurrForm.Matriz.MatrixRec."Period End");
                                                                     {* AJS
                                                                     IF TourOperador = '' THEN
                                                                       rCupVen.SETRANGE(rCupVen.TourOperador)
                                                                     ELSE
                                                                       rCupVen.SETRANGE(rCupVen.TourOperador,TourOperador);
                                                                     *}
                                                                     FORM.RUN(0, rCupVen);
                                                                   END;
                                                                   IF ("Tipo de Registro" = "Tipo de Registro"::Cupo) THEN BEGIN
                                                                     rCupVen.RESET;
                                                                     rCupVen.SETCURRENTKEY(Dia,
                                                                                           Hotel,
                                                                                           TourOperador);
                                                                     rCupVen.SETRANGE(Hotel, Hotel);
                                                                     IF FiltTipHab = '' THEN
                                                                       rCupVen.SETRANGE(rCupVen."Habitacion basica")
                                                                     ELSE
                                                                       rCupVen.SETFILTER("Habitacion basica",FiltTipHab);
                                                                     IF TourOperador = '' THEN
                                                                       rCupVen.SETRANGE(TourOperador)
                                                                     ELSE
                                                                       rCupVen.SETRANGE(rCupVen.TourOperador,TourOperador);
                                                                     rCupVen.SETRANGE(Dia,CurrForm.Matriz.MatrixRec."Period Start",CurrForm.Matriz.MatrixRec."Period End");
                                                                     FORM.RUN(0,rCupVen);
                                                                   END;

                                                                   IF ("Tipo de Registro" = "Tipo de Registro"::Prevision) THEN BEGIN
                                                                     rPre.RESET;
                                                                     rPre.SETCURRENTKEY("Tipo Contrato",
                                                                                        Hotel,
                                                                                        TourOperador,
                                                                                        Dia,
                                                                                        "Habitacion basica");
                                                                     rPre.SETRANGE("Tipo Contrato", rPre."Tipo Contrato"::Venta);
                                                                     rPre.SETRANGE(Hotel          , Hotel);
                                                                     IF FiltTipHab = '' THEN
                                                                       rPre.SETRANGE("Habitacion basica")
                                                                     ELSE
                                                                       rPre.SETFILTER("Habitacion basica", FiltTipHab);
                                                                     IF TourOperador = '' THEN
                                                                       rPre.SETRANGE(TourOperador)
                                                                     ELSE
                                                                       rPre.SETRANGE(TourOperador, TourOperador);
                                                                     rPre.SETRANGE(Dia,CurrForm.Matriz.MatrixRec."Period Start",CurrForm.Matriz.MatrixRec."Period End");
                                                                     FORM.RUN(0, rPre);
                                                                   END;

                                                                   IF ("Tipo de Registro" = "Tipo de Registro"::Ocupado) OR ("Tipo de Registro" = "Tipo de Registro"::Asignado) THEN BEGIN
                                                                     IF ("Tipo de Registro" = "Tipo de Registro"::Ocupado) AND rHot.NoName THEN BEGIN
                                                                       rRsvVen.RESET;
                                                                       rRsvVen.SETCURRENTKEY("Hotel Reservado", TourOperador, Dia, Habitacion);
                                                                       rRsvVen.SETRANGE(rRsvVen."Hotel Reservado", Hotel);
                                                                       IF FiltTipHab = '' THEN
                                                                         rRsvVen.SETRANGE(Habitacion)
                                                                       ELSE
                                                                         rRsvVen.SETFILTER(Habitacion,FiltTipHab);
                                                                       rRsvVen.SETRANGE(Dia, CurrForm.Matriz.MatrixRec."Period Start", CurrForm.Matriz.MatrixRec."Period End");
                                                                       IF TourOperador = '' THEN
                                                                         rRsvVen.SETRANGE(TourOperador)
                                                                       ELSE
                                                                         rRsvVen.SETRANGE(TourOperador,TourOperador);
                                                                       rRsvVen.SETRANGE("Cantidad booking");
                                                                       rRsvVen.SETRANGE(Asignado);
                                                                       rRsvVen.SETFILTER("Cantidad reservado",'>%1',0);
                                                                       FORM.RUN(0,rRsvVen);
                                                                     END
                                                                     ELSE BEGIN
                                                                       rRsvVen.RESET;
                                                                       rRsvVen.SETCURRENTKEY("Hotel Booking",TourOperador,Dia,Habitacion);
                                                                       rRsvVen.SETRANGE(rRsvVen."Hotel Booking",Hotel);
                                                                       IF FiltTipHab = '' THEN
                                                                         rRsvVen.SETRANGE(Habitacion)
                                                                       ELSE
                                                                         rRsvVen.SETFILTER(Habitacion,FiltTipHab);
                                                                       rRsvVen.SETRANGE(Dia,CurrForm.Matriz.MatrixRec."Period Start",CurrForm.Matriz.MatrixRec."Period End");
                                                                       IF TourOperador = '' THEN
                                                                         rRsvVen.SETRANGE(TourOperador)
                                                                       ELSE
                                                                         rRsvVen.SETRANGE(TourOperador,TourOperador);
                                                                       rRsvVen.SETRANGE("Cantidad booking");
                                                                       rRsvVen.SETRANGE(Asignado);
                                                                       IF ("Tipo de Registro" = "Tipo de Registro"::Ocupado) THEN
                                                                         rRsvVen.SETFILTER("Cantidad booking",'>%1',0);
                                                                       IF ("Tipo de Registro" = "Tipo de Registro"::Asignado) THEN
                                                                         rRsvVen.SETFILTER(Asignado,'>%1',0);
                                                                       FORM.RUN(0,rRsvVen);
                                                                     END
                                                                   END;
                                                                 END;
                                                               END
                                                               ELSE BEGIN
                                                                 IF TourOperador = '' THEN BEGIN
                                                                   IF ("Tipo de Total" = "Tipo de Total"::Venta) THEN BEGIN
                                                                     IF ("Tipo de Registro" = "Tipo de Registro"::Contrato) THEN BEGIN
                                                                       rCupCom.RESET;
                                                                       rCupCom.SETCURRENTKEY(Dia,
                                                                                             Hotel,
                                                                                             TourOperador);
                                                                       rCupCom.SETRANGE(Hotel, Hotel);
                                                                       rCupCom.SETRANGE(Dia  , CurrForm.Matriz.MatrixRec."Period Start",CurrForm.Matriz.MatrixRec."Period End");
                                                                       IF TourOperador = '' THEN
                                                                         rCupCom.SETRANGE(rCupCom.TourOperador)
                                                                       ELSE
                                                                         rCupCom.SETRANGE(rCupCom.TourOperador, TourOperador);
                                                                       FORM.RUN(0, rCupCom);
                                                                     END;

                                                                     IF ("Tipo de Registro" = "Tipo de Registro"::Cupo) THEN BEGIN
                                                                       rCupCom.RESET;
                                                                       rCupCom.SETCURRENTKEY(Dia,
                                                                                             Hotel,
                                                                                             TourOperador);
                                                                       rCupCom.SETRANGE(Hotel,Hotel);
                                                                       IF FiltTipHab = '' THEN
                                                                         rCupCom.SETRANGE(Habitacion)
                                                                       ELSE
                                                                         rCupCom.SETFILTER(Habitacion, FiltTipHab);
                                                                       IF TourOperador = '' THEN
                                                                         rCupCom.SETRANGE(TourOperador)
                                                                       ELSE
                                                                         rCupCom.SETRANGE(rCupCom.TourOperador,TourOperador);
                                                                       rCupCom.SETRANGE(Dia,CurrForm.Matriz.MatrixRec."Period Start",CurrForm.Matriz.MatrixRec."Period End");
                                                                       FORM.RUN(0, rCupCom);
                                                                     END;

                                                                     IF ("Tipo de Registro" = "Tipo de Registro"::Prevision) THEN BEGIN
                                                                       rPre.RESET;
                                                                       rPre.SETCURRENTKEY("Tipo Contrato",
                                                                                          Hotel,
                                                                                          TourOperador,
                                                                                          Dia,
                                                                                          "Habitacion cupo");
                                                                       rPre.SETRANGE("Tipo Contrato", rPre."Tipo Contrato"::Compra);
                                                                       rPre.SETRANGE(Hotel          , Hotel);
                                                                       IF FiltTipHab = '' THEN
                                                                         rPre.SETRANGE("Habitacion cupo")
                                                                       ELSE
                                                                         rPre.SETFILTER("Habitacion cupo", FiltTipHab);
                                                                       IF TourOperador = '' THEN
                                                                         rPre.SETRANGE(TourOperador)
                                                                       ELSE
                                                                         rPre.SETRANGE(TourOperador, TourOperador);
                                                                       rPre.SETRANGE(Dia,CurrForm.Matriz.MatrixRec."Period Start",CurrForm.Matriz.MatrixRec."Period End");
                                                                       FORM.RUN(0, rPre);
                                                                     END;

                                                                     IF ("Tipo de Registro" = "Tipo de Registro"::Ocupado) OR ("Tipo de Registro" = "Tipo de Registro"::Asignado) THEN BEGIN
                                                                       IF ("Tipo de Registro" = "Tipo de Registro"::Ocupado) AND rHot.NoName THEN BEGIN
                                                                         rRsv.RESET;
                                                                         rRsv.SETCURRENTKEY("Hotel reservado", TourOperador, Dia, "Habitacion cupo");
                                                                         rRsv.SETRANGE(rRsv."Hotel reservado", Hotel);
                                                                         IF FiltTipHab = '' THEN
                                                                           rRsv.SETRANGE("Habitacion cupo")
                                                                         ELSE
                                                                           rRsv.SETFILTER("Habitacion cupo",FiltTipHab);
                                                                         rRsv.SETRANGE(Dia, CurrForm.Matriz.MatrixRec."Period Start", CurrForm.Matriz.MatrixRec."Period End");
                                                                         IF TourOperador = '' THEN
                                                                           rRsv.SETRANGE(TourOperador)
                                                                         ELSE
                                                                           rRsv.SETRANGE(TourOperador,TourOperador);
                                                                         rRsv.SETRANGE("Cantidad booking");
                                                                         rRsv.SETRANGE(Asignado);
                                                                         rRsv.SETFILTER("Cantidad reservado",'>%1',0);
                                                                         FORM.RUN(0,rRsv);
                                                                       END
                                                                       ELSE BEGIN
                                                                         rRsv.RESET;
                                                                         rRsv.SETCURRENTKEY(rRsv."Hotel booking",rRsv.TourOperador,rRsv.Dia,rRsv."Habitacion cupo");
                                                                         rRsv.SETRANGE(rRsv."Hotel booking",Hotel);
                                                                         IF FiltTipHab = '' THEN
                                                                           rRsv.SETRANGE("Habitacion cupo")
                                                                         ELSE
                                                                           rRsv.SETFILTER("Habitacion cupo",FiltTipHab);
                                                                         rRsv.SETRANGE(Dia,CurrForm.Matriz.MatrixRec."Period Start",CurrForm.Matriz.MatrixRec."Period End");
                                                                         IF TourOperador = '' THEN
                                                                           rRsv.SETRANGE(TourOperador)
                                                                         ELSE
                                                                           rRsv.SETRANGE(TourOperador,TourOperador);
                                                                         rRsv.SETRANGE("Cantidad booking");
                                                                         rRsv.SETRANGE(Asignado);
                                                                         IF ("Tipo de Registro" = "Tipo de Registro"::Ocupado) THEN
                                                                           rRsv.SETFILTER("Cantidad booking",'>%1',0);
                                                                         IF ("Tipo de Registro" = "Tipo de Registro"::Asignado) THEN
                                                                           rRsv.SETFILTER(Asignado,'>%1',0);
                                                                         FORM.RUN(0,rRsv);
                                                                       END
                                                                     END;
                                                                   END
                                                                   ELSE BEGIN
                                                                     IF ("Tipo de Registro" = "Tipo de Registro"::Contrato) THEN BEGIN
                                                                       rCupVen.RESET;
                                                                       rCupVen.SETCURRENTKEY(Dia,Hotel,TourOperador);
                                                                       rCupVen.SETRANGE(Hotel,Hotel);
                                                                       rCupVen.SETRANGE(Dia,CurrForm.Matriz.MatrixRec."Period Start",CurrForm.Matriz.MatrixRec."Period End");
                                                                       IF TourOperador = '' THEN
                                                                         rCupVen.SETRANGE(rCupVen.TourOperador)
                                                                       ELSE
                                                                         rCupVen.SETRANGE(rCupVen.TourOperador,TourOperador);
                                                                       FORM.RUN(0,rCupVen);
                                                                     END;

                                                                     IF ("Tipo de Registro" = "Tipo de Registro"::Cupo) THEN BEGIN
                                                                       rCupVen.RESET;
                                                                       rCupVen.SETCURRENTKEY(Dia,Hotel,TourOperador);
                                                                       rCupVen.SETRANGE(Hotel,Hotel);
                                                                       IF FiltTipHab = '' THEN
                                                                         rCupVen.SETRANGE(rCupVen.Habitacion)
                                                                       ELSE
                                                                         rCupVen.SETFILTER(Habitacion,FiltTipHab);
                                                                       IF TourOperador = '' THEN
                                                                         rCupVen.SETRANGE(TourOperador)
                                                                       ELSE
                                                                         rCupVen.SETRANGE(rCupVen.TourOperador,TourOperador);
                                                                       rCupVen.SETRANGE(Dia,CurrForm.Matriz.MatrixRec."Period Start",CurrForm.Matriz.MatrixRec."Period End");
                                                                       FORM.RUN(0,rCupVen);
                                                                     END;

                                                                     IF ("Tipo de Registro" = "Tipo de Registro"::Prevision) THEN BEGIN
                                                                       rPre.RESET;
                                                                       rPre.SETCURRENTKEY("Tipo Contrato",
                                                                                          Hotel,
                                                                                          TourOperador,
                                                                                          Dia,
                                                                                          "Habitacion cupo");
                                                                       rPre.SETRANGE("Tipo Contrato", rPre."Tipo Contrato"::Venta);
                                                                       rPre.SETRANGE(Hotel          , Hotel);
                                                                       IF FiltTipHab = '' THEN
                                                                         rPre.SETRANGE("Habitacion cupo")
                                                                       ELSE
                                                                         rPre.SETFILTER("Habitacion cupo", FiltTipHab);
                                                                       IF TourOperador = '' THEN
                                                                         rPre.SETRANGE(TourOperador)
                                                                       ELSE
                                                                         rPre.SETRANGE(TourOperador, TourOperador);
                                                                       rPre.SETRANGE(Dia,CurrForm.Matriz.MatrixRec."Period Start",CurrForm.Matriz.MatrixRec."Period End");
                                                                       FORM.RUN(0, rPre);
                                                                     END;

                                                                     IF ("Tipo de Registro" = "Tipo de Registro"::Ocupado) OR ("Tipo de Registro" = "Tipo de Registro"::Asignado) THEN BEGIN
                                                                       IF ("Tipo de Registro" = "Tipo de Registro"::Ocupado) AND rHot.NoName THEN BEGIN
                                                                         rRsvVen.RESET;
                                                                         rRsvVen.SETCURRENTKEY("Hotel Reservado", TourOperador, Dia, "Habitacion cupo");
                                                                         rRsvVen.SETRANGE(rRsvVen."Hotel Reservado", Hotel);
                                                                         IF FiltTipHab = '' THEN
                                                                           rRsvVen.SETRANGE("Habitacion cupo")
                                                                         ELSE
                                                                           rRsvVen.SETFILTER("Habitacion cupo",FiltTipHab);
                                                                         rRsvVen.SETRANGE(Dia,CurrForm.Matriz.MatrixRec."Period Start",CurrForm.Matriz.MatrixRec."Period End");
                                                                         IF TourOperador = '' THEN
                                                                           rRsvVen.SETRANGE(TourOperador)
                                                                         ELSE
                                                                           rRsvVen.SETRANGE(TourOperador,TourOperador);
                                                                         rRsvVen.SETRANGE("Cantidad booking");
                                                                         rRsvVen.SETRANGE(Asignado);
                                                                         rRsvVen.SETFILTER("Cantidad reservado",'>%1',0);
                                                                         FORM.RUN(0,rRsvVen);
                                                                       END
                                                                       ELSE BEGIN
                                                                         rRsvVen.RESET;
                                                                         rRsvVen.SETCURRENTKEY("Hotel Booking",TourOperador,Dia,"Habitacion cupo");
                                                                         rRsvVen.SETRANGE(rRsvVen."Hotel Booking",Hotel);
                                                                         IF FiltTipHab = '' THEN
                                                                           rRsvVen.SETRANGE("Habitacion cupo")
                                                                         ELSE
                                                                           rRsvVen.SETFILTER("Habitacion cupo",FiltTipHab);
                                                                         rRsvVen.SETRANGE(Dia,CurrForm.Matriz.MatrixRec."Period Start",CurrForm.Matriz.MatrixRec."Period End");
                                                                         IF TourOperador = '' THEN
                                                                           rRsvVen.SETRANGE(TourOperador)
                                                                         ELSE
                                                                           rRsvVen.SETRANGE(TourOperador,TourOperador);
                                                                         rRsvVen.SETRANGE("Cantidad booking");
                                                                         rRsvVen.SETRANGE(Asignado);
                                                                         IF ("Tipo de Registro" = "Tipo de Registro"::Ocupado) THEN
                                                                           rRsvVen.SETFILTER("Cantidad booking",'>%1',0);
                                                                         IF ("Tipo de Registro" = "Tipo de Registro"::Asignado) THEN
                                                                           rRsvVen.SETFILTER(Asignado,'>%1',0);
                                                                         FORM.RUN(0,rRsvVen);
                                                                       END;
                                                                     END;
                                                                   END;
                                                                 END;
                                                                 IF TourOperador <> '' THEN BEGIN
                                                                   IF ("Tipo de Registro" = "Tipo de Registro"::Contrato) THEN BEGIN
                                                                     rCupVen.RESET;
                                                                     rCupVen.SETCURRENTKEY(Dia,
                                                                                           Hotel,
                                                                                           TourOperador);
                                                                     rCupVen.SETRANGE(Hotel, Hotel);
                                                                     rCupVen.SETRANGE(Dia  , CurrForm.Matriz.MatrixRec."Period Start",CurrForm.Matriz.MatrixRec."Period End");
                                                                     {* AJS
                                                                     IF TourOperador = '' THEN
                                                                       rCupVen.SETRANGE(rCupVen.TourOperador)
                                                                     ELSE
                                                                       rCupVen.SETRANGE(rCupVen.TourOperador,TourOperador);
                                                                     *}
                                                                     FORM.RUN(0, rCupVen);
                                                                   END;

                                                                   IF ("Tipo de Registro" = "Tipo de Registro"::Cupo) THEN BEGIN
                                                                     rCupVen.RESET;
                                                                     rCupVen.SETCURRENTKEY(Dia,Hotel,TourOperador);
                                                                     rCupVen.SETRANGE(Hotel,Hotel);
                                                                     IF FiltTipHab = '' THEN
                                                                       rCupVen.SETRANGE(rCupVen.Habitacion)
                                                                     ELSE
                                                                       rCupVen.SETFILTER(Habitacion,FiltTipHab);
                                                                     IF TourOperador = '' THEN
                                                                       rCupVen.SETRANGE(TourOperador)
                                                                     ELSE
                                                                       rCupVen.SETRANGE(rCupVen.TourOperador,TourOperador);
                                                                     rCupVen.SETRANGE(Dia,CurrForm.Matriz.MatrixRec."Period Start",CurrForm.Matriz.MatrixRec."Period End");
                                                                     FORM.RUN(0,rCupVen);
                                                                   END;

                                                                   IF ("Tipo de Registro" = "Tipo de Registro"::Prevision) THEN BEGIN
                                                                     rPre.RESET;
                                                                     rPre.SETCURRENTKEY("Tipo Contrato",
                                                                                        Hotel,
                                                                                        TourOperador,
                                                                                        Dia,
                                                                                        "Habitacion cupo");
                                                                     rPre.SETRANGE("Tipo Contrato", rPre."Tipo Contrato"::Venta);
                                                                     rPre.SETRANGE(Hotel          , Hotel);
                                                                     IF FiltTipHab = '' THEN
                                                                       rPre.SETRANGE("Habitacion cupo")
                                                                     ELSE
                                                                       rPre.SETFILTER("Habitacion cupo", FiltTipHab);
                                                                     IF TourOperador = '' THEN
                                                                       rPre.SETRANGE(TourOperador)
                                                                     ELSE
                                                                       rPre.SETRANGE(TourOperador, TourOperador);
                                                                     rPre.SETRANGE(Dia,CurrForm.Matriz.MatrixRec."Period Start",CurrForm.Matriz.MatrixRec."Period End");
                                                                     FORM.RUN(0, rPre);
                                                                   END;

                                                                   IF ("Tipo de Registro" = "Tipo de Registro"::Ocupado) OR ("Tipo de Registro" = "Tipo de Registro"::Asignado) THEN BEGIN
                                                                     IF ("Tipo de Registro" = "Tipo de Registro"::Ocupado) AND rHot.NoName THEN BEGIN
                                                                       rRsvVen.RESET;
                                                                       rRsvVen.SETCURRENTKEY("Hotel Reservado", TourOperador, Dia, "Habitacion cupo");
                                                                       rRsvVen.SETRANGE(rRsvVen."Hotel Reservado", Hotel);
                                                                       IF FiltTipHab = '' THEN
                                                                         rRsvVen.SETRANGE("Habitacion cupo")
                                                                       ELSE
                                                                         rRsvVen.SETFILTER("Habitacion cupo",FiltTipHab);
                                                                       rRsvVen.SETRANGE(Dia,CurrForm.Matriz.MatrixRec."Period Start",CurrForm.Matriz.MatrixRec."Period End");
                                                                       IF TourOperador = '' THEN
                                                                         rRsvVen.SETRANGE(TourOperador)
                                                                       ELSE
                                                                         rRsvVen.SETRANGE(TourOperador,TourOperador);
                                                                       rRsvVen.SETRANGE("Cantidad booking");
                                                                       rRsvVen.SETRANGE(Asignado);
                                                                       rRsvVen.SETFILTER("Cantidad reservado",'>%1',0);
                                                                       FORM.RUN(0,rRsvVen);
                                                                     END
                                                                     ELSE BEGIN
                                                                       rRsvVen.RESET;
                                                                       rRsvVen.SETCURRENTKEY("Hotel Booking",TourOperador,Dia,"Habitacion cupo");
                                                                       rRsvVen.SETRANGE(rRsvVen."Hotel Booking",Hotel);
                                                                       IF FiltTipHab = '' THEN
                                                                         rRsvVen.SETRANGE("Habitacion cupo")
                                                                       ELSE
                                                                         rRsvVen.SETFILTER("Habitacion cupo",FiltTipHab);
                                                                       rRsvVen.SETRANGE(Dia,CurrForm.Matriz.MatrixRec."Period Start",CurrForm.Matriz.MatrixRec."Period End");
                                                                       IF TourOperador = '' THEN
                                                                         rRsvVen.SETRANGE(TourOperador)
                                                                       ELSE
                                                                         rRsvVen.SETRANGE(TourOperador,TourOperador);
                                                                       rRsvVen.SETRANGE("Cantidad booking");
                                                                       rRsvVen.SETRANGE(Asignado);
                                                                       IF ("Tipo de Registro" = "Tipo de Registro"::Ocupado) THEN
                                                                         rRsvVen.SETFILTER("Cantidad booking",'>%1',0);
                                                                       IF ("Tipo de Registro" = "Tipo de Registro"::Asignado) THEN
                                                                         rRsvVen.SETFILTER(Asignado,'>%1',0);
                                                                       FORM.RUN(0,rRsvVen);
                                                                     END;
                                                                   END;
                                                                 END;
                                                               END;
                                                             END;
                                                              }
    { 32  ;TextBox      ;9570 ;3300 ;2200 ;440  ;Name=Cab;
                                                 ParentControl=31;
                                                 InMatrixHeading=Yes;
                                                 CaptionML=[ENU=Term;
                                                            ESP=Periodo];
                                                 SourceExpr=GestionFormPeriodo.CreatePeriodFormat(TipoPeriodo,CurrForm.Matriz.MatrixRec."Period Start");
                                                 OnFormat=BEGIN
                                                            IF Ovbk() = '*' THEN BEGIN
                                                              IF Paro() = '*' THEN BEGIN
                                                                CurrForm.Cab.UPDATEFORECOLOR(65280);  // Verde
                                                                CurrForm.Cab.UPDATEFONTBOLD(TRUE);
                                                              END
                                                              ELSE BEGIN
                                                                CurrForm.Cab.UPDATEFORECOLOR(255);  // Rojo
                                                                CurrForm.Cab.UPDATEFONTBOLD(TRUE);
                                                              END;
                                                            END
                                                            ELSE BEGIN
                                                              IF Paro() = '*' THEN BEGIN
                                                                CurrForm.Cab.UPDATEFORECOLOR(65535);  // Amarillo
                                                                CurrForm.Cab.UPDATEFONTBOLD(TRUE);
                                                              END
                                                              ELSE BEGIN
                                                                CurrForm.Cab.UPDATEFORECOLOR(0);  // Negro
                                                                CurrForm.Cab.UPDATEFONTBOLD(TRUE);
                                                              END;
                                                            END;
                                                          END;
                                                           }
    { 5   ;MenuButton   ;15620;9460 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=&Hotel;
                                                            ESP=Hote&l];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=46;
                                                     CaptionML=[ENU=&Windows;
                                                                ESP=&Ventanas] }
                                                   { ID=39;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Ctrl+F5;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=&Card;
                                                                ESP=&Ficha];
                                                     RunObject=Form 7009730;
                                                     RunFormLink=Hotel=FIELD(Hotel) }
                                                   { ID=47;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=&Purchase contracts;
                                                                ESP=Contratos &compra];
                                                     OnPush=VAR
                                                              rConCom@1103355001 : Record 7009723;
                                                            BEGIN
                                                              rConCom.RESET;
                                                              rConCom.SETCURRENTKEY(Delegacion, TourOperador, Hotel, "Fecha inicio contrato", "Fecha final contrato");
                                                              IF Filtto <> '' THEN
                                                                rConCom.SETFILTER(TourOperador, Filtto);

                                                              rConCom.SETRANGE (Hotel, Hotel);
                                                              rConCom.SETFILTER("Fecha inicio contrato", '<=%1', CurrForm.Matriz.MatrixRec."Period Start");
                                                              rConCom.SETFILTER("Fecha final contrato" , '>=%1', CurrForm.Matriz.MatrixRec."Period Start");
                                                              FORM.RUNMODAL(FORM::"Tabla Contrato compra hotel", rConCom);
                                                              rConCom.RESET;
                                                            END;
                                                             }
                                                   { ID=48;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=&Sale contracts;
                                                                ESP=Contratos &venta];
                                                     OnPush=VAR
                                                              rConVen@1103355001 : Record 7009727;
                                                            BEGIN
                                                              rConVen.RESET;
                                                              rConVen.SETCURRENTKEY(Delegacion, TourOperador, Hotel, "Fecha inicio contrato", "Fecha final contrato");
                                                              IF Filtto <> '' THEN
                                                                rConVen.SETFILTER(TourOperador, Filtto);

                                                              rConVen.SETRANGE (Hotel, Hotel);
                                                              rConVen.SETFILTER("Fecha inicio contrato", '<=%1', CurrForm.Matriz.MatrixRec."Period Start");
                                                              rConVen.SETFILTER("Fecha final contrato" , '>=%1', CurrForm.Matriz.MatrixRec."Period Start");
                                                              FORM.RUNMODAL(FORM::"Tabla Contrato venta hotel", rConVen);
                                                              rConVen.RESET;
                                                            END;
                                                             }
                                                   { ID=67;
                                                     CaptionML=[ENU=Listed;
                                                                ESP=Listados] }
                                                   { ID=42;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=&Print;
                                                                ESP=&Impresion];
                                                     OnPush=VAR
                                                              repBooking@1103355001 : Report 7009721;
                                                            BEGIN
                                                              CLEAR(repBooking);
                                                              repBooking.SETTABLEVIEW(Rec);
                                                              repBooking.Parametros(FiltTipHab,
                                                                                      CurrForm.Matriz.MatrixRec."Period Start",
                                                                                      CurrForm.Matriz.MatrixRec."Period End",
                                                                                      TipoPeriodo, TipoHab);
                                                              repBooking.RUNMODAL;
                                                              //REPORT.RUNMODAL(7009721, TRUE, FALSE, Rec);
                                                            END;
                                                             }
                                                   { ID=68;
                                                     PushAction=RunObject;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Rooming List;
                                                                ESP=Rooming List];
                                                     RunObject=Report 7009701 }
                                                   { ID=69;
                                                     Visible=No;
                                                     CaptionML=[ENU=Caption;
                                                                ESP=Leyenda];
                                                     OnPush=BEGIN
                                                              MESSAGE(Text000 +
                                                                      '\' +
                                                                      Text001 +
                                                                      Text002 +
                                                                      Text003 +
                                                                      Text004);
                                                            END;
                                                             }
                                                 }
                                                  }
    { 40  ;OptionButton ;3740 ;9460 ;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 HorzAlign=Center;
                                                 Border=Yes;
                                                 FontBold=Yes;
                                                 BitmapPos=None;
                                                 CaptionML=[ENU=B;
                                                            ESP=B];
                                                 ToolTipML=[ENU=Basic;
                                                            ESP=Basica];
                                                 SourceExpr=TipoHab;
                                                 OptionValue=Basica }
    { 41  ;OptionButton ;4290 ;9460 ;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 HorzAlign=Center;
                                                 Border=Yes;
                                                 FontBold=Yes;
                                                 BitmapPos=None;
                                                 CaptionML=[ENU=C;
                                                            ESP=C];
                                                 ToolTipML=[ENU=Allotment;
                                                            ESP=Cupo];
                                                 SourceExpr=TipoHab;
                                                 OptionValue=Cupo }
    { 43  ;TextBox      ;4950 ;9460 ;2420 ;550  ;VertGlue=Bottom;
                                                 Editable=No;
                                                 Focusable=No;
                                                 SourceExpr=TipoHab }
    { 70  ;Shape        ;110  ;10120;20130;660  ;HorzGlue=Both;
                                                 VertGlue=Bottom }
    { 71  ;Shape        ;330  ;10230;440  ;440  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 BackColor=65280;
                                                 BackTransparent=No }
    { 72  ;Label        ;880  ;10230;4070 ;440  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 LeaderDots=No;
                                                 CaptionML=[ENU=Sales stop + Overbooking;
                                                            ESP=Paro de ventas + Overbooking] }
    { 73  ;Shape        ;6380 ;10230;440  ;440  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 BackColor=255;
                                                 BackTransparent=No }
    { 74  ;Label        ;6930 ;10230;1760 ;440  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 LeaderDots=No;
                                                 CaptionML=[ENU=Overbooking;
                                                            ESP=Overbooking] }
    { 75  ;Shape        ;9900 ;10230;440  ;440  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 BackColor=65535;
                                                 BackTransparent=No }
    { 76  ;Label        ;10450;10230;2090 ;440  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 LeaderDots=No;
                                                 CaptionML=[ENU=Sales stop;
                                                            ESP=Paro de ventas] }
    { 78  ;Shape        ;13750;10230;440  ;440  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 BackColor=0;
                                                 BackTransparent=No }
    { 79  ;Label        ;14300;10230;1870 ;440  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 LeaderDots=No;
                                                 CaptionML=[ENU=Normal date;
                                                            ESP=Fecha normal] }
  }
  CODE
  {
    VAR
      Text000@1103355074 : TextConst 'ENU=CAPTION OF COLORS\;ESP=LEYENDA DE COLORES\';
      Text001@1103355077 : TextConst 'ENU=Green    --> Sales Stop + Overbooking\;ESP=Verde    --> Paro Ventas + Overbooking\';
      Text002@1103355078 : TextConst 'ENU=Red     --> Overbooking\;ESP=Rojo     --> Overbooking\';
      Text003@1103355079 : TextConst 'ENU=Yellow --> Sales Stop\;ESP=Amarillo --> Paro ventas\';
      Text004@1103355080 : TextConst 'ENU=Black   --> Normal;ESP=Negro    --> Normal';
      rRsv@1103355000 : Record 7009755;
      rRsvVen@1103355001 : Record 7009756;
      rTTOO@1103355002 : Record 7009717;
      PeriodoContable@1103355003 : Record 50;
      rTipHabBas@1103355004 : Record 7009711;
      rTipHabCup@1103355005 : Record 7009731;
      GestionFormPeriodo@1103355006 : Codeunit 359;
      rCupCom@1103355007 : Record 7009757;
      rCupVen@1103355008 : Record 7009758;
      rPre@1103355009 : Record 7009783;
      rTra@1103355010 : Record 7009777;
      rConVen@1103355011 : Record 7009727;
      rHot@1103355012 : Record 7009724;
      rHotOvk@1103355013 : Record 7009780;
      TipoPeriodo@1103355014 : 'D¡a,Semana,Mes,Trimestre,A¤o,Periodo contable';
      TipoImporte@1103355015 : 'Ocupaci¢n,Estancias,Porcentaje,Libres';
      Importe@1103355016 : Decimal;
      FactorRedondeo@1103355017 : 'No,1,1000,1000000';
      FiltTipHab@1103355018 : Code[30];
      UltGra@1103355019 : Integer;
      wOrden@1103355020 : Integer;
      wFecha@1103355021 : Date;
      EspacioEntreFechas@1103355022 : Text[10];
      PrimeraFecha@1103355023 : Text[10];
      UltimaFecha@1103355024 : Text[10];
      wFechaInicio@1103355025 : Date;
      wFechaFin@1103355026 : Date;
      Numhabi@1103355027 : Integer;
      DiaInicial@1103355028 : Date;
      ch01@1103355029 : Boolean;
      ch02@1103355030 : Boolean;
      ch03@1103355031 : Boolean;
      ch04@1103355032 : Boolean;
      ch05@1103355033 : Boolean;
      ch06@1103355034 : Boolean;
      ch07@1103355035 : Boolean;
      ch08@1103355036 : Boolean;
      ch09@1103355037 : Boolean;
      ch10@1103355038 : Boolean;
      ch11@1103355039 : Boolean;
      ch12@1103355040 : Boolean;
      ch13@1103355041 : Boolean;
      ch14@1103355042 : Boolean;
      ch15@1103355043 : Boolean;
      ch16@1103355044 : Boolean;
      ch17@1103355045 : Boolean;
      ch18@1103355046 : Boolean;
      ch19@1103355047 : Boolean;
      ch20@1103355048 : Boolean;
      ch21@1103355049 : Boolean;
      tex01@1103355050 : Text[30];
      tex02@1103355051 : Text[30];
      tex03@1103355052 : Text[30];
      tex04@1103355053 : Text[30];
      tex05@1103355054 : Text[30];
      tex06@1103355055 : Text[30];
      tex07@1103355056 : Text[30];
      tex08@1103355057 : Text[30];
      tex09@1103355058 : Text[30];
      tex10@1103355059 : Text[30];
      tex11@1103355060 : Text[30];
      tex12@1103355061 : Text[30];
      tex13@1103355062 : Text[30];
      tex14@1103355063 : Text[30];
      tex15@1103355064 : Text[30];
      tex16@1103355065 : Text[30];
      tex17@1103355066 : Text[30];
      tex18@1103355067 : Text[30];
      tex19@1103355068 : Text[30];
      tex20@1103355069 : Text[30];
      ind@1103355070 : Integer;
      Filtto@1103355071 : Text[197];
      PrimerFiltro@1103355072 : Boolean;
      TipoHab@1103355073 : 'Basica,Cupo';
      cNoms@1103355075 : Codeunit 7009702;
      TourOperadorInicial@1103355076 : Integer;

    LOCAL PROCEDURE AsigFiltFecha@1();
    BEGIN
      Rec.SETRANGE(Hotel, Hotel);
      IF FiltTipHab = '' THEN
        SETRANGE("Habitacion Rango")
      ELSE
        SETFILTER("Habitacion Rango", FiltTipHab);
      SETRANGE("Dia Rango", CurrForm.Matriz.MatrixRec."Period Start", CurrForm.Matriz.MatrixRec."Period End");
    END;

    PROCEDURE CalculaImporteBas@2(Rec@1103355000 : Record 7009777) imp : Decimal;
    BEGIN
      // CalculaImporteBas
      //
      Rec.SETRANGE(Hotel, Hotel);
      IF FiltTipHab = '' THEN
        Rec.SETRANGE("Habitacion Rango")
      ELSE
        Rec.SETFILTER("Habitacion Rango", FiltTipHab);
      Rec.SETRANGE("Dia Rango", CurrForm.Matriz.MatrixRec."Period Start",CurrForm.Matriz.MatrixRec."Period End");
      IF Rec.TourOperador = '' THEN
        Rec.SETRANGE("TourOperador Rango")
      ELSE
        Rec.SETRANGE("TourOperador Rango", Rec.TourOperador);

      IF Rec.TourOperador= '' THEN BEGIN
        IF "Tipo de Registro" = "Tipo de Registro"::T¡tulo THEN BEGIN
            imp := 0;
          END;

        IF Rec."Tipo de Total" = Rec."Tipo de Total"::Compra THEN BEGIN
          IF "Tipo de Registro" = "Tipo de Registro"::Contrato THEN BEGIN
            Rec.CALCFIELDS("Cupo hotel compra");
            imp := Rec."Cupo hotel compra";
          END;

          IF "Tipo de Registro" = "Tipo de Registro"::Cupo THEN BEGIN
            Rec.CALCFIELDS("Cupo contratado compra");
            imp := Rec."Cupo contratado compra";
          END;

          IF "Tipo de Registro" = "Tipo de Registro"::Release THEN BEGIN
            Rec.CALCFIELDS("Release Maximo");
            imp := Rec."Release Maximo";
          END;

          IF "Tipo de Registro" = "Tipo de Registro"::Prevision THEN BEGIN
            IF rHot.NoName THEN BEGIN
              Rec.CALCFIELDS("Reservado compra");
              Rec.CALCFIELDS("Asignado compra");
              Rec.CALCFIELDS("Prevision ocupacion compra");
              IF Rec."Prevision ocupacion compra" <> 0 THEN
                imp := Rec."Prevision ocupacion compra" - Rec."Reservado compra" - Rec."Asignado compra"
              ELSE
                imp := Rec."Prevision ocupacion compra";
            END
            ELSE BEGIN
              Rec.CALCFIELDS("Ocupado compra");
              Rec.CALCFIELDS("Asignado compra");
              Rec.CALCFIELDS("Prevision ocupacion compra");
              IF Rec."Prevision ocupacion compra" <> 0 THEN
                imp := Rec."Prevision ocupacion compra" - Rec."Ocupado compra" - Rec."Asignado compra"
              ELSE
                imp := Rec."Prevision ocupacion compra";
            END;
          END;

          IF "Tipo de Registro" = "Tipo de Registro"::Ocupado THEN BEGIN
            IF rHot.NoName THEN BEGIN
              Rec.CALCFIELDS("Reservado compra");
              imp := Rec."Reservado compra";
            END
            ELSE BEGIN
              Rec.CALCFIELDS("Ocupado compra");
              imp := Rec."Ocupado compra";
            END;
          END;

          IF "Tipo de Registro" = "Tipo de Registro"::Asignado THEN BEGIN
            Rec.CALCFIELDS("Asignado compra");
            imp := Rec."Asignado compra";
          END;

          IF "Tipo de Registro" = "Tipo de Registro"::Libre THEN BEGIN
            IF rHot.NoName THEN BEGIN
              Rec.CALCFIELDS("Cupo contratado compra");
              Rec.CALCFIELDS("Reservado compra");
              Rec.CALCFIELDS("Asignado compra");
              imp := Rec."Cupo contratado compra" - Rec."Reservado compra" - Rec."Asignado compra";
            END
            ELSE BEGIN
              Rec.CALCFIELDS("Cupo contratado compra");
              Rec.CALCFIELDS("Ocupado compra");
              Rec.CALCFIELDS("Asignado compra");
              imp := Rec."Cupo contratado compra" - Rec."Ocupado compra" - Rec."Asignado compra";
            END;
          END;

          IF "Tipo de Registro" = "Tipo de Registro"::Porcentaje THEN BEGIN
            IF rHot.NoName THEN BEGIN
              Rec.CALCFIELDS("Cupo contratado compra");
              Rec.CALCFIELDS("Reservado compra");
              Rec.CALCFIELDS("Asignado compra");
              IF Rec."Cupo contratado compra" = 0 THEN
                imp := 0
              ELSE
                imp := ROUND(((Rec."Reservado compra" + Rec."Asignado compra") * 100) / Rec."Cupo contratado compra");
            END
            ELSE BEGIN
              Rec.CALCFIELDS("Cupo contratado compra");
              Rec.CALCFIELDS("Ocupado compra");
              Rec.CALCFIELDS("Asignado compra");
              IF Rec."Cupo contratado compra" = 0 THEN
                imp := 0
              ELSE
                imp := ROUND(((Rec."Ocupado compra" + Rec."Asignado compra") * 100) / Rec."Cupo contratado compra");
            END;
          END;
          // AJS 12-07-99
          //
          IF "Tipo de Registro" = "Tipo de Registro"::"Porcentaje Prevision" THEN BEGIN
            IF rHot.NoName THEN BEGIN
              Rec.CALCFIELDS("Cupo contratado compra");
              Rec.CALCFIELDS("Reservado compra");
              Rec.CALCFIELDS("Asignado compra");
              Rec.CALCFIELDS("Prevision ocupacion compra");
              IF Rec."Cupo contratado compra" = 0 THEN
                imp := 0
              ELSE BEGIN
                IF Rec."Prevision ocupacion compra" > (Rec."Reservado compra" + Rec."Asignado compra") THEN
                  imp := ROUND((Rec."Prevision ocupacion compra" * 100) / Rec."Cupo contratado compra")
                ELSE
                imp := ROUND(((Rec."Reservado compra" + Rec."Asignado compra") * 100) / Rec."Cupo contratado compra");
              END;
            END
            ELSE BEGIN
              Rec.CALCFIELDS("Cupo contratado compra");
              Rec.CALCFIELDS("Ocupado compra");
              Rec.CALCFIELDS("Asignado compra");
              Rec.CALCFIELDS("Prevision ocupacion compra");
              IF Rec."Cupo contratado compra" = 0 THEN
                imp := 0
              ELSE BEGIN
                IF Rec."Prevision ocupacion compra" > (Rec."Ocupado compra" + Rec."Asignado compra") THEN
                  imp := ROUND((Rec."Prevision ocupacion compra" * 100) / Rec."Cupo contratado compra")
                ELSE
                  imp := ROUND(((Rec."Ocupado compra" + Rec."Asignado compra") * 100) / Rec."Cupo contratado compra");
              END;
            END;
          END;
          // FIN AJS 12-07-99
          //
        END
        ELSE BEGIN
          IF "Tipo de Registro" = "Tipo de Registro"::Contrato THEN BEGIN
            Rec.CALCFIELDS("Cupo hotel venta");
            imp := Rec."Cupo hotel venta";
          END;

          IF "Tipo de Registro" = "Tipo de Registro"::Cupo THEN BEGIN
            Rec.CALCFIELDS("Cupo contratado venta");
            imp := Rec."Cupo contratado venta";
          END;

          IF "Tipo de Registro" = "Tipo de Registro"::Prevision THEN BEGIN
            IF rHot.NoName THEN BEGIN
              Rec.CALCFIELDS("Reservado venta");
              Rec.CALCFIELDS("Asignado venta");
              Rec.CALCFIELDS("Prevision ocupacion venta");
              IF Rec."Prevision ocupacion venta" <> 0 THEN
                imp := Rec."Prevision ocupacion venta" - "Reservado venta" - "Asignado venta"
              ELSE
                imp := Rec."Prevision ocupacion venta";
            END
            ELSE BEGIN
              Rec.CALCFIELDS("Ocupado venta");
              Rec.CALCFIELDS("Asignado venta");
              Rec.CALCFIELDS("Prevision ocupacion venta");
              IF Rec."Prevision ocupacion venta" <> 0 THEN
                imp := Rec."Prevision ocupacion venta" - "Ocupado venta" - "Asignado venta"
              ELSE
                imp := Rec."Prevision ocupacion venta";
            END;
          END;

          IF "Tipo de Registro" = "Tipo de Registro"::Ocupado THEN BEGIN
            IF rHot.NoName THEN BEGIN
              Rec.CALCFIELDS("Reservado venta");
              imp := Rec."Reservado venta";
            END
            ELSE BEGIN
              Rec.CALCFIELDS("Ocupado venta");
              imp := Rec."Ocupado venta";
            END;
          END;

          IF "Tipo de Registro" = "Tipo de Registro"::Asignado THEN BEGIN
            Rec.CALCFIELDS("Asignado venta");
            imp := Rec."Asignado venta";
          END;

          IF "Tipo de Registro" = "Tipo de Registro"::Libre THEN BEGIN
            IF rHot.NoName THEN BEGIN
              Rec.CALCFIELDS("Cupo contratado venta");
              Rec.CALCFIELDS("Reservado venta");
              Rec.CALCFIELDS("Asignado venta");
              imp := Rec."Cupo contratado venta" - Rec."Reservado venta" - Rec."Asignado venta";
            END
            ELSE BEGIN
              Rec.CALCFIELDS("Cupo contratado venta");
              Rec.CALCFIELDS("Ocupado venta");
              Rec.CALCFIELDS("Asignado venta");
              imp := Rec."Cupo contratado venta" - Rec."Ocupado venta" - Rec."Asignado venta";
            END;
          END;

          IF "Tipo de Registro" = "Tipo de Registro"::Porcentaje THEN BEGIN
            IF rHot.NoName THEN BEGIN
              Rec.CALCFIELDS("Cupo contratado venta");
              Rec.CALCFIELDS("Reservado venta");
              Rec.CALCFIELDS("Asignado venta");
              IF Rec."Cupo contratado venta" = 0 THEN
                imp := 0
              ELSE
               imp := ROUND(((Rec."Reservado venta" + Rec."Asignado venta") * 100) / Rec."Cupo contratado venta");
            END
            ELSE BEGIN
              Rec.CALCFIELDS("Cupo contratado venta");
              Rec.CALCFIELDS("Ocupado venta");
              Rec.CALCFIELDS("Asignado venta");
              IF Rec."Cupo contratado venta" = 0 THEN
                imp := 0
              ELSE
               imp := ROUND(((Rec."Ocupado venta" + Rec."Asignado venta") * 100) / Rec."Cupo contratado venta");
            END;
          END;
          // AJS 12-07-99
          //
          IF "Tipo de Registro" = "Tipo de Registro"::"Porcentaje Prevision" THEN BEGIN
            IF rHot.NoName THEN BEGIN
              Rec.CALCFIELDS("Cupo contratado venta");
              Rec.CALCFIELDS("Reservado venta");
              Rec.CALCFIELDS("Asignado venta");
              Rec.CALCFIELDS("Prevision ocupacion venta");
              IF Rec."Cupo contratado venta" = 0 THEN
                imp := 0
              ELSE BEGIN
                IF Rec."Prevision ocupacion venta" > (Rec."Reservado venta" + Rec."Asignado venta") THEN
                  imp := ROUND((Rec."Prevision ocupacion venta" * 100) / Rec."Cupo contratado venta")
                ELSE
                  imp := ROUND(((Rec."Reservado venta" + Rec."Asignado venta") * 100) / Rec."Cupo contratado venta");
              END;
            END
            ELSE BEGIN
              Rec.CALCFIELDS("Cupo contratado venta");
              Rec.CALCFIELDS("Ocupado venta");
              Rec.CALCFIELDS("Asignado venta");
              Rec.CALCFIELDS("Prevision ocupacion venta");
              IF Rec."Cupo contratado venta" = 0 THEN
                imp := 0
              ELSE BEGIN
                IF Rec."Prevision ocupacion venta" > (Rec."Ocupado venta" + Rec."Asignado venta") THEN
                  imp := ROUND((Rec."Prevision ocupacion venta" * 100) / Rec."Cupo contratado venta")
                ELSE
                  imp := ROUND(((Rec."Ocupado venta" + Rec."Asignado venta") * 100) / Rec."Cupo contratado venta");
              END;
            END;
          END;
          // FIN AJS 12-07-99
          //
        END;

      END;

      IF Rec.TourOperador <> '' THEN BEGIN
        IF "Tipo de Registro" = "Tipo de Registro"::T¡tulo THEN BEGIN
          imp := 0;
        END;
        IF "Tipo de Registro" = "Tipo de Registro"::Contrato THEN BEGIN
          Rec.CALCFIELDS("Cupo hotel venta");
          imp := Rec."Cupo hotel venta";
        END;

        IF "Tipo de Registro" = "Tipo de Registro"::Cupo THEN BEGIN
          Rec.CALCFIELDS("Cupo contratado venta");
          imp := Rec."Cupo contratado venta";
        END;

        IF "Tipo de Registro" = "Tipo de Registro"::Prevision THEN BEGIN
          IF rHot.NoName THEN BEGIN
            Rec.CALCFIELDS("Reservado venta");
            Rec.CALCFIELDS("Asignado venta");
            Rec.CALCFIELDS("Prevision ocupacion venta");
            IF Rec."Prevision ocupacion venta" <> 0 THEN
              imp := Rec."Prevision ocupacion venta" - Rec."Reservado venta" - Rec."Asignado venta"
            ELSE
              imp := Rec."Prevision ocupacion venta";
          END
          ELSE BEGIN
            Rec.CALCFIELDS("Ocupado venta");
            Rec.CALCFIELDS("Asignado venta");
            Rec.CALCFIELDS("Prevision ocupacion venta");
            IF Rec."Prevision ocupacion venta" <> 0 THEN
              imp := Rec."Prevision ocupacion venta" - Rec."Ocupado venta" - Rec."Asignado venta"
            ELSE
              imp := Rec."Prevision ocupacion venta";
          END
        END;

        IF "Tipo de Registro" = "Tipo de Registro"::Ocupado THEN BEGIN
          IF rHot.NoName THEN BEGIN
            Rec.CALCFIELDS("Reservado venta");
            imp := Rec."Reservado venta";
          END
          ELSE BEGIN
            Rec.CALCFIELDS("Ocupado venta");
            imp := Rec."Ocupado venta";
          END
        END;

        IF "Tipo de Registro" = "Tipo de Registro"::Asignado THEN BEGIN
          Rec.CALCFIELDS("Asignado venta");
          imp := Rec."Asignado venta";
        END;

        IF "Tipo de Registro" = "Tipo de Registro"::Libre THEN BEGIN
          IF rHot.NoName THEN BEGIN
            Rec.CALCFIELDS("Cupo contratado venta");
            Rec.CALCFIELDS("Reservado venta");
            Rec.CALCFIELDS("Asignado venta");
            imp := Rec."Cupo contratado venta" - Rec."Reservado venta" - Rec."Asignado venta";
          END
          ELSE BEGIN
            Rec.CALCFIELDS("Cupo contratado venta");
            Rec.CALCFIELDS("Ocupado venta");
            Rec.CALCFIELDS("Asignado venta");
            imp := Rec."Cupo contratado venta" - Rec."Ocupado venta" - Rec."Asignado venta";
          END;
        END;

        IF "Tipo de Registro" = "Tipo de Registro"::Porcentaje THEN BEGIN
          IF rHot.NoName THEN BEGIN
            Rec.CALCFIELDS("Cupo contratado venta");
            Rec.CALCFIELDS("Reservado venta");
            Rec.CALCFIELDS("Asignado venta");
            IF Rec."Cupo contratado venta" = 0 THEN
              imp := 0
            ELSE
             imp := ROUND(((Rec."Reservado venta" + Rec."Asignado venta") * 100) / Rec."Cupo contratado venta");
          END
          ELSE BEGIN
            Rec.CALCFIELDS("Cupo contratado venta");
            Rec.CALCFIELDS("Ocupado venta");
            Rec.CALCFIELDS("Asignado venta");
            IF Rec."Cupo contratado venta" = 0 THEN
              imp := 0
            ELSE
             imp := ROUND(((Rec."Ocupado venta" + Rec."Asignado venta") * 100) / Rec."Cupo contratado venta");
          END;
        END;
        // AJS 12-07-99
        //
        IF "Tipo de Registro" = "Tipo de Registro"::"Porcentaje Prevision" THEN BEGIN
          IF rHot.NoName THEN BEGIN
            Rec.CALCFIELDS("Cupo contratado venta");
            Rec.CALCFIELDS("Reservado venta");
            Rec.CALCFIELDS("Asignado venta");
            Rec.CALCFIELDS("Prevision ocupacion venta");
            IF Rec."Cupo contratado venta" = 0 THEN
              imp := 0
            ELSE BEGIN
              IF Rec."Prevision ocupacion venta" > (Rec."Reservado venta" + Rec."Asignado venta") THEN
                imp := ROUND((Rec."Prevision ocupacion venta" * 100) / Rec."Cupo contratado venta")
              ELSE
                imp := ROUND(((Rec."Reservado venta" + Rec."Asignado venta") * 100) / Rec."Cupo contratado venta");
            END;
          END
          ELSE BEGIN
            Rec.CALCFIELDS("Cupo contratado venta");
            Rec.CALCFIELDS("Ocupado venta");
            Rec.CALCFIELDS("Asignado venta");
            Rec.CALCFIELDS("Prevision ocupacion venta");
            IF Rec."Cupo contratado venta" = 0 THEN
              imp := 0
            ELSE BEGIN
              IF Rec."Prevision ocupacion venta" > (Rec."Ocupado venta" + Rec."Asignado venta") THEN
                imp := ROUND((Rec."Prevision ocupacion venta" * 100) / Rec."Cupo contratado venta")
              ELSE
                imp := ROUND(((Rec."Ocupado venta" + Rec."Asignado venta") * 100) / Rec."Cupo contratado venta");
            END;
          END;
        END;
        // FIN AJS 12-07-99
        //
      END;
    END;

    PROCEDURE CalculaImporteCup@4(Rec@1103355000 : Record 7009777) imp : Decimal;
    BEGIN
      // CalculaImporteCup
      //
      Rec.SETRANGE(Hotel,Hotel);

      IF FiltTipHab = '' THEN
        Rec.SETRANGE("Habitacion cupo Rango")
      ELSE
        Rec.SETFILTER("Habitacion cupo Rango", FiltTipHab);

      Rec.SETRANGE("Dia Rango", CurrForm.Matriz.MatrixRec."Period Start", CurrForm.Matriz.MatrixRec."Period End");

      IF Rec.TourOperador = '' THEN
        Rec.SETRANGE("TourOperador Rango")
      ELSE
        Rec.SETRANGE("TourOperador Rango", Rec.TourOperador);

      IF Rec.TourOperador= '' THEN BEGIN
        IF "Tipo de Registro" = "Tipo de Registro"::T¡tulo THEN BEGIN
          imp := 0;
        END;

        IF Rec."Tipo de Total" = Rec."Tipo de Total"::Compra THEN BEGIN

          IF "Tipo de Registro" = "Tipo de Registro"::Contrato THEN BEGIN
            Rec.CALCFIELDS("Cupo hotel compra 2");
            imp := Rec."Cupo hotel compra 2";
          END;

          IF "Tipo de Registro" = "Tipo de Registro"::Cupo THEN BEGIN
            Rec.CALCFIELDS("Cupo contratado compra 2");
            imp := Rec."Cupo contratado compra 2";
          END;

          IF "Tipo de Registro" = "Tipo de Registro"::Prevision THEN BEGIN
            IF rHot.NoName THEN BEGIN
              Rec.CALCFIELDS("Reservado compra 2");
              Rec.CALCFIELDS("Asignado compra 2");
              Rec.CALCFIELDS("Prevision ocupacion compra 2");
              IF Rec."Prevision ocupacion compra 2" <> 0 THEN
                imp := Rec."Prevision ocupacion compra 2" - Rec."Reservado compra 2" - Rec."Asignado compra 2"
              ELSE
                imp := Rec."Prevision ocupacion compra 2";
            END
            ELSE BEGIN
              Rec.CALCFIELDS("Ocupado compra 2");
              Rec.CALCFIELDS("Asignado compra 2");
              Rec.CALCFIELDS("Prevision ocupacion compra 2");
              IF Rec."Prevision ocupacion compra 2" <> 0 THEN
                imp := Rec."Prevision ocupacion compra 2" - Rec."Ocupado compra 2" - Rec."Asignado compra 2"
              ELSE
                imp := Rec."Prevision ocupacion compra 2";
            END
          END;

          IF "Tipo de Registro" = "Tipo de Registro"::Ocupado THEN BEGIN
            IF rHot.NoName THEN BEGIN
              Rec.CALCFIELDS("Reservado compra 2");
              imp := Rec."Reservado compra 2";
            END
            ELSE BEGIN
              Rec.CALCFIELDS("Ocupado compra 2");
              imp := Rec."Ocupado compra 2";
            END
          END;

          IF "Tipo de Registro" = "Tipo de Registro"::Asignado THEN BEGIN
            Rec.CALCFIELDS("Asignado compra 2");
            imp := Rec."Asignado compra 2";
          END;

          IF "Tipo de Registro" = "Tipo de Registro"::Libre THEN BEGIN
            IF rHot.NoName THEN BEGIN
              Rec.CALCFIELDS("Cupo contratado compra 2");
              Rec.CALCFIELDS("Reservado compra 2");
              Rec.CALCFIELDS("Asignado compra 2");
              imp := Rec."Cupo contratado compra 2" - Rec."Reservado compra 2" - Rec."Asignado compra 2";
            END
            ELSE BEGIN
              Rec.CALCFIELDS("Cupo contratado compra 2");
              Rec.CALCFIELDS("Ocupado compra 2");
              Rec.CALCFIELDS("Asignado compra 2");
              imp := Rec."Cupo contratado compra 2" - Rec."Ocupado compra 2" - Rec."Asignado compra 2";
            END;
          END;

          IF "Tipo de Registro" = "Tipo de Registro"::Porcentaje THEN BEGIN
            IF rHot.NoName THEN BEGIN
              Rec.CALCFIELDS("Cupo contratado compra 2");
              Rec.CALCFIELDS("Reservado compra 2");
              Rec.CALCFIELDS("Asignado compra 2");
              IF Rec."Cupo contratado compra 2" = 0 THEN
                imp := 0
              ELSE
                imp := ROUND(((Rec."Reservado compra 2" + Rec."Asignado compra 2") * 100) / Rec."Cupo contratado compra 2");
            END
            ELSE BEGIN
              Rec.CALCFIELDS("Cupo contratado compra 2");
              Rec.CALCFIELDS("Ocupado compra 2");
              Rec.CALCFIELDS("Asignado compra 2");
              IF Rec."Cupo contratado compra 2" = 0 THEN
                imp := 0
              ELSE
                imp := ROUND(((Rec."Ocupado compra 2" + Rec."Asignado compra 2") * 100) / Rec."Cupo contratado compra 2");
            END;
          END;
          // AJS 12-07-99
          //
          IF "Tipo de Registro" = "Tipo de Registro"::"Porcentaje Prevision" THEN BEGIN
            IF rHot.NoName THEN BEGIN
              Rec.CALCFIELDS("Cupo contratado compra 2");
              Rec.CALCFIELDS("Reservado compra 2");
              Rec.CALCFIELDS("Asignado compra 2");
              Rec.CALCFIELDS("Prevision ocupacion compra 2");
              IF Rec."Cupo contratado compra 2" = 0 THEN
                imp := 0
              ELSE BEGIN
                IF Rec."Prevision ocupacion compra 2" > (Rec."Reservado compra 2" + Rec."Asignado compra 2") THEN
                  imp := ROUND((Rec."Prevision ocupacion compra 2" * 100) / Rec."Cupo contratado compra 2")
                ELSE
                  imp := ROUND(((Rec."Reservado compra 2" + Rec."Asignado compra 2") * 100) / Rec."Cupo contratado compra 2");
              END;
            END
            ELSE BEGIN
              Rec.CALCFIELDS("Cupo contratado compra 2");
              Rec.CALCFIELDS("Ocupado compra 2");
              Rec.CALCFIELDS("Asignado compra 2");
              Rec.CALCFIELDS("Prevision ocupacion compra 2");
              IF Rec."Cupo contratado compra 2" = 0 THEN
                imp := 0
              ELSE BEGIN
                IF Rec."Prevision ocupacion compra 2" > (Rec."Ocupado compra 2" + Rec."Asignado compra 2") THEN
                  imp := ROUND((Rec."Prevision ocupacion compra 2" * 100) / Rec."Cupo contratado compra 2")
                ELSE
                  imp := ROUND(((Rec."Ocupado compra 2" + Rec."Asignado compra 2") * 100) / Rec."Cupo contratado compra 2");
              END;
            END;
          END;
          // FIN AJS 12-07-99
          //
        END
        ELSE BEGIN
          IF "Tipo de Registro" = "Tipo de Registro"::Contrato THEN BEGIN
            Rec.CALCFIELDS("Cupo hotel venta 2");
            imp := Rec."Cupo hotel venta 2";
          END;

          IF "Tipo de Registro" = "Tipo de Registro"::Cupo THEN BEGIN
            Rec.CALCFIELDS("Cupo contratado venta 2");
            imp := Rec."Cupo contratado venta 2";
          END;

          IF "Tipo de Registro" = "Tipo de Registro"::Prevision THEN BEGIN
            IF rHot.NoName THEN BEGIN
              Rec.CALCFIELDS("Reservado venta 2");
              Rec.CALCFIELDS("Asignado venta 2");
              Rec.CALCFIELDS("Prevision ocupacion venta 2");
              IF Rec."Prevision ocupacion venta 2" <> 0 THEN
                imp := Rec."Prevision ocupacion venta 2" - Rec."Reservado venta 2" - Rec."Asignado venta 2"
              ELSE
                imp := Rec."Prevision ocupacion venta 2";
            END
            ELSE BEGIN
              Rec.CALCFIELDS("Ocupado venta 2");
              Rec.CALCFIELDS("Asignado venta 2");
              Rec.CALCFIELDS("Prevision ocupacion venta 2");
              IF Rec."Prevision ocupacion venta 2" <> 0 THEN
                imp := Rec."Prevision ocupacion venta 2" - Rec."Ocupado venta 2" - Rec."Asignado venta 2"
              ELSE
                imp := Rec."Prevision ocupacion venta 2";
            END
          END;

          IF "Tipo de Registro" = "Tipo de Registro"::Ocupado THEN BEGIN
            IF rHot.NoName THEN BEGIN
              Rec.CALCFIELDS("Reservado venta 2");
              imp := Rec."Reservado venta 2";
            END
            ELSE BEGIN
              Rec.CALCFIELDS("Ocupado venta 2");
              imp := Rec."Ocupado venta 2";
            END
          END;
          IF "Tipo de Registro" = "Tipo de Registro"::Asignado THEN BEGIN
            Rec.CALCFIELDS("Asignado venta 2");
            imp := Rec."Asignado venta 2";
          END;
          IF "Tipo de Registro" = "Tipo de Registro"::Libre THEN BEGIN
            IF rHot.NoName THEN BEGIN
              Rec.CALCFIELDS("Cupo contratado venta 2");
              Rec.CALCFIELDS("Reservado venta 2");
              Rec.CALCFIELDS("Asignado venta 2");
              imp := Rec."Cupo contratado venta 2" - Rec."Reservado venta 2" - Rec."Asignado venta 2";
            END
            ELSE BEGIN
              Rec.CALCFIELDS("Cupo contratado venta 2");
              Rec.CALCFIELDS("Ocupado venta 2");
              Rec.CALCFIELDS("Asignado venta 2");
              imp := Rec."Cupo contratado venta 2" - Rec."Ocupado venta 2" - Rec."Asignado venta 2";
            END
          END;

          IF "Tipo de Registro" = "Tipo de Registro"::Porcentaje THEN BEGIN
            IF rHot.NoName THEN BEGIN
              Rec.CALCFIELDS("Cupo contratado venta 2");
              Rec.CALCFIELDS("Reservado venta 2");
              Rec.CALCFIELDS("Asignado venta 2");
              IF Rec."Cupo contratado venta 2" = 0 THEN
                imp := 0
              ELSE
                imp := ROUND(((Rec."Reservado venta 2" + Rec."Asignado venta 2") * 100) / Rec."Cupo contratado venta 2");
            END
            ELSE BEGIN
              Rec.CALCFIELDS("Cupo contratado venta 2");
              Rec.CALCFIELDS("Ocupado venta 2");
              Rec.CALCFIELDS("Asignado venta 2");
              IF Rec."Cupo contratado venta 2" = 0 THEN
                imp := 0
              ELSE
                imp := ROUND(((Rec."Ocupado venta 2" + Rec."Asignado venta 2") * 100) / Rec."Cupo contratado venta 2");
            END;
          END;
          // AJS 12-07-99
          //
          IF "Tipo de Registro" = "Tipo de Registro"::"Porcentaje Prevision" THEN BEGIN
            IF rHot.NoName THEN BEGIN
              Rec.CALCFIELDS("Cupo contratado venta 2");
              Rec.CALCFIELDS("Reservado venta 2");
              Rec.CALCFIELDS("Asignado venta 2");
              Rec.CALCFIELDS("Prevision ocupacion venta 2");
              IF Rec."Cupo contratado venta 2" = 0 THEN
                imp := 0
              ELSE BEGIN
                IF Rec."Prevision ocupacion venta 2" > (Rec."Reservado venta 2" + Rec."Asignado venta 2") THEN
                  imp := ROUND((Rec."Prevision ocupacion venta 2" * 100) / Rec."Cupo contratado venta 2")
                ELSE
                  imp := ROUND(((Rec."Reservado venta 2" + Rec."Asignado venta 2") * 100) / Rec."Cupo contratado venta 2");
              END;
            END
            ELSE BEGIN
              Rec.CALCFIELDS("Cupo contratado venta 2");
              Rec.CALCFIELDS("Ocupado venta 2");
              Rec.CALCFIELDS("Asignado venta 2");
              Rec.CALCFIELDS("Prevision ocupacion venta 2");
              IF Rec."Cupo contratado venta 2" = 0 THEN
                imp := 0
              ELSE BEGIN
                IF Rec."Prevision ocupacion venta 2" > (Rec."Ocupado venta 2" + Rec."Asignado venta 2") THEN
                  imp := ROUND((Rec."Prevision ocupacion venta 2" * 100) / Rec."Cupo contratado venta 2")
                ELSE
                  imp := ROUND(((Rec."Ocupado venta 2" + Rec."Asignado venta 2") * 100) / Rec."Cupo contratado venta 2");
              END;
            END;
          END;
          // FIN AJS 12-07-99
          //
        END;
      END;

      IF Rec.TourOperador <> '' THEN BEGIN
        IF "Tipo de Registro" = "Tipo de Registro"::T¡tulo THEN BEGIN
            imp := 0;
          END;

        IF "Tipo de Registro" = "Tipo de Registro"::Contrato THEN BEGIN
          Rec.CALCFIELDS("Cupo hotel venta 2");
          imp := Rec."Cupo hotel venta 2";
        END;

        IF "Tipo de Registro" = "Tipo de Registro"::Cupo THEN BEGIN
          Rec.CALCFIELDS("Cupo contratado venta 2");
          imp := Rec."Cupo contratado venta 2";
        END;

        IF "Tipo de Registro" = "Tipo de Registro"::Prevision THEN BEGIN
          IF rHot.NoName THEN BEGIN
            Rec.CALCFIELDS("Reservado venta 2");
            Rec.CALCFIELDS("Asignado venta 2");
            Rec.CALCFIELDS("Prevision ocupacion venta 2");
            IF Rec."Prevision ocupacion venta 2" <> 0 THEN
              imp := Rec."Prevision ocupacion venta 2" - Rec."Reservado venta 2" - Rec."Asignado venta 2"
            ELSE
              imp := Rec."Prevision ocupacion venta 2";
          END
          ELSE BEGIN
            Rec.CALCFIELDS("Ocupado venta 2");
            Rec.CALCFIELDS("Asignado venta 2");
            Rec.CALCFIELDS("Prevision ocupacion venta 2");
            IF Rec."Prevision ocupacion venta 2" <> 0 THEN
              imp := Rec."Prevision ocupacion venta 2" - Rec."Ocupado venta 2" - Rec."Asignado venta 2"
            ELSE
              imp := Rec."Prevision ocupacion venta 2";
          END
        END;

        IF "Tipo de Registro" = "Tipo de Registro"::Ocupado THEN BEGIN
          IF rHot.NoName THEN BEGIN
            Rec.CALCFIELDS("Reservado venta 2");
            imp := Rec."Reservado venta 2";
          END
          ELSE BEGIN
            Rec.CALCFIELDS("Ocupado venta 2");
            imp := Rec."Ocupado venta 2";
          END
        END;

        IF "Tipo de Registro" = "Tipo de Registro"::Asignado THEN BEGIN
          Rec.CALCFIELDS("Asignado venta 2");
          imp := Rec."Asignado venta 2";
        END;

        IF "Tipo de Registro" = "Tipo de Registro"::Libre THEN BEGIN
          IF rHot.NoName THEN BEGIN
            Rec.CALCFIELDS("Cupo contratado venta 2");
            Rec.CALCFIELDS("Reservado venta 2");
            Rec.CALCFIELDS("Asignado venta 2");
            imp := Rec."Cupo contratado venta 2" - Rec."Reservado venta 2" - Rec."Asignado venta 2";
          END
          ELSE BEGIN
            Rec.CALCFIELDS("Cupo contratado venta 2");
            Rec.CALCFIELDS("Ocupado venta 2");
            Rec.CALCFIELDS("Asignado venta 2");
            imp := Rec."Cupo contratado venta 2" - Rec."Ocupado venta 2" - Rec."Asignado venta 2";
          END
        END;

        IF "Tipo de Registro" = "Tipo de Registro"::Porcentaje THEN BEGIN
          IF rHot.NoName THEN BEGIN
            Rec.CALCFIELDS("Cupo contratado venta 2");
            Rec.CALCFIELDS("Reservado venta 2");
            Rec.CALCFIELDS("Asignado venta 2");
            IF Rec."Cupo contratado venta 2" = 0 THEN
              imp := 0
            ELSE
              imp := ROUND(((Rec."Reservado venta 2" + Rec."Asignado venta 2") * 100) / Rec."Cupo contratado venta 2");
          END
          ELSE BEGIN
            Rec.CALCFIELDS("Cupo contratado venta 2");
            Rec.CALCFIELDS("Ocupado venta 2");
            Rec.CALCFIELDS("Asignado venta 2");
            IF Rec."Cupo contratado venta 2" = 0 THEN
              imp := 0
            ELSE
              imp := ROUND(((Rec."Ocupado venta 2" + Rec."Asignado venta 2") * 100) / Rec."Cupo contratado venta 2");
          END;
        END;
        // AJS 12-07-99
        //
        IF "Tipo de Registro" = "Tipo de Registro"::"Porcentaje Prevision" THEN BEGIN
          IF rHot.NoName THEN BEGIN
            Rec.CALCFIELDS("Cupo contratado venta 2");
            Rec.CALCFIELDS("Reservado venta 2");
            Rec.CALCFIELDS("Asignado venta 2");
            Rec.CALCFIELDS("Prevision ocupacion venta 2");
            IF Rec."Cupo contratado venta 2" = 0 THEN
              imp := 0
            ELSE BEGIN
              IF Rec."Prevision ocupacion venta 2" > (Rec."Reservado venta 2" + Rec."Asignado venta 2") THEN
                imp := ROUND((Rec."Prevision ocupacion venta 2" * 100) / Rec."Cupo contratado venta 2")
              ELSE
                imp := ROUND(((Rec."Reservado venta 2" + Rec."Asignado venta 2") * 100) / Rec."Cupo contratado venta 2");
            END;
          END
          ELSE BEGIN
            Rec.CALCFIELDS("Cupo contratado venta 2");
            Rec.CALCFIELDS("Ocupado venta 2");
            Rec.CALCFIELDS("Asignado venta 2");
            Rec.CALCFIELDS("Prevision ocupacion venta 2");
            IF Rec."Cupo contratado venta 2" = 0 THEN
              imp := 0
            ELSE BEGIN
              IF Rec."Prevision ocupacion venta 2" > (Rec."Ocupado venta 2" + Rec."Asignado venta 2") THEN
                imp := ROUND((Rec."Prevision ocupacion venta 2" * 100) / Rec."Cupo contratado venta 2")
              ELSE
                imp := ROUND(((Rec."Ocupado venta 2" + Rec."Asignado venta 2") * 100) / Rec."Cupo contratado venta 2");
            END;
          END;
        END;
        // FIN AJS 12-07-99
        //
      END;
    END;

    PROCEDURE TTOO@3();
    VAR
      subindice@1103355000 : Integer;
    BEGIN
      // TTOO
      //
      CurrForm.ch01.VISIBLE := FALSE;
      CurrForm.ch02.VISIBLE := FALSE;
      CurrForm.ch03.VISIBLE := FALSE;
      CurrForm.ch04.VISIBLE := FALSE;
      CurrForm.ch05.VISIBLE := FALSE;
      CurrForm.ch06.VISIBLE := FALSE;
      CurrForm.ch07.VISIBLE := FALSE;
      CurrForm.ch08.VISIBLE := FALSE;
      CurrForm.ch09.VISIBLE := FALSE;
      CurrForm.ch10.VISIBLE := FALSE;
      CurrForm.ch11.VISIBLE := FALSE;
      CurrForm.ch12.VISIBLE := FALSE;
      CurrForm.ch13.VISIBLE := FALSE;
      CurrForm.ch14.VISIBLE := FALSE;
      CurrForm.ch15.VISIBLE := FALSE;
      CurrForm.ch16.VISIBLE := FALSE;
      CurrForm.ch17.VISIBLE := FALSE;
      CurrForm.ch18.VISIBLE := FALSE;

      CurrForm.tex01.VISIBLE := FALSE;
      CurrForm.Tex02.VISIBLE := FALSE;
      CurrForm.Tex03.VISIBLE := FALSE;
      CurrForm.tex04.VISIBLE := FALSE;
      CurrForm.tex05.VISIBLE := FALSE;
      CurrForm.tex06.VISIBLE := FALSE;
      CurrForm.tex07.VISIBLE := FALSE;
      CurrForm.tex08.VISIBLE := FALSE;
      CurrForm.tex09.VISIBLE := FALSE;
      CurrForm.tex10.VISIBLE := FALSE;
      CurrForm.tex11.VISIBLE := FALSE;
      CurrForm.tex12.VISIBLE := FALSE;
      CurrForm.tex13.VISIBLE := FALSE;
      CurrForm.tex14.VISIBLE := FALSE;
      CurrForm.tex15.VISIBLE := FALSE;
      CurrForm.tex16.VISIBLE := FALSE;
      CurrForm.tex17.VISIBLE := FALSE;
      CurrForm.tex18.VISIBLE := FALSE;

      limpia_variables;

      ind := 0;
      subindice := 0;
      rTra.RESET;
      rTra.SETRANGE(Usuario           , USERID());
      rTra.SETRANGE(Hotel             , Hotel);
      rTra.SETRANGE("Tipo de Registro", "Tipo de Registro"::T¡tulo);
      IF rTra.COUNT < 19 THEN BEGIN
        CurrForm.pict_1.VISIBLE := FALSE;
        CurrForm.boton_1.VISIBLE := FALSE;
      END
      ELSE BEGIN
        CurrForm.pict_1.VISIBLE := TRUE;
        CurrForm.boton_1.VISIBLE := TRUE;
      END;
      IF rTra.FIND('-') THEN REPEAT
        IF rTra.TourOperador <> '' THEN BEGIN
          subindice := subindice + 1;
          IF subindice > TourOperadorInicial THEN BEGIN
            ind := ind + 1;
            IF ind > 18 THEN
              ind := 19;
            IF ind = 1 THEN BEGIN
              ch01 := TRUE;
              tex01 := rTra.TourOperador;
              CurrForm.ch01.VISIBLE := TRUE;
              CurrForm.tex01.VISIBLE := TRUE;
            END;
            IF ind = 2 THEN BEGIN
              ch02 := TRUE;
              tex02 := rTra.TourOperador;
              CurrForm.ch02.VISIBLE := TRUE;
              CurrForm.Tex02.VISIBLE := TRUE;
            END;
            IF ind = 3 THEN BEGIN
              ch03 := TRUE;
              tex03 := rTra.TourOperador;
              CurrForm.ch03.VISIBLE := TRUE;
              CurrForm.Tex03.VISIBLE := TRUE;
            END;
            IF ind = 4 THEN BEGIN
              ch04 := TRUE;
              tex04 := rTra.TourOperador;
              CurrForm.ch04.VISIBLE := TRUE;
              CurrForm.tex04.VISIBLE := TRUE;
            END;
            IF ind = 5 THEN BEGIN
              ch05 := TRUE;
              tex05 := rTra.TourOperador;
              CurrForm.ch05.VISIBLE := TRUE;
              CurrForm.tex05.VISIBLE := TRUE;
            END;
            IF ind = 6 THEN BEGIN
              ch06 := TRUE;
              tex06 := rTra.TourOperador;
              CurrForm.ch06.VISIBLE := TRUE;
              CurrForm.tex06.VISIBLE := TRUE;
            END;
            IF ind = 7 THEN BEGIN
              ch07 := TRUE;
              tex07 := rTra.TourOperador;
              CurrForm.ch07.VISIBLE := TRUE;
              CurrForm.tex07.VISIBLE := TRUE;
            END;
            IF ind = 8 THEN BEGIN
              ch08 := TRUE;
              tex08 := rTra.TourOperador;
              CurrForm.ch08.VISIBLE := TRUE;
              CurrForm.tex08.VISIBLE := TRUE;
            END;
            IF ind = 9 THEN BEGIN
              ch09 := TRUE;
              tex09 := rTra.TourOperador;
              CurrForm.ch09.VISIBLE := TRUE;
              CurrForm.tex09.VISIBLE := TRUE;
            END;
            IF ind = 10 THEN BEGIN
              ch10 := TRUE;
              tex10 := rTra.TourOperador;
              CurrForm.ch10.VISIBLE := TRUE;
              CurrForm.tex10.VISIBLE := TRUE;
            END;
            IF ind = 11 THEN BEGIN
              ch11 := TRUE;
              tex11 := rTra.TourOperador;
              CurrForm.ch11.VISIBLE := TRUE;
              CurrForm.tex11.VISIBLE := TRUE;
            END;
            IF ind = 12 THEN BEGIN
              ch12 := TRUE;
              tex12 := rTra.TourOperador;
              CurrForm.ch12.VISIBLE := TRUE;
              CurrForm.tex12.VISIBLE := TRUE;
            END;
            IF ind = 13 THEN BEGIN
              ch13 := TRUE;
              tex13 := rTra.TourOperador;
              CurrForm.ch13.VISIBLE := TRUE;
              CurrForm.tex13.VISIBLE := TRUE;
            END;
            IF ind = 14 THEN BEGIN
              ch14 := TRUE;
              tex14 := rTra.TourOperador;
              CurrForm.ch14.VISIBLE := TRUE;
              CurrForm.tex14.VISIBLE := TRUE;
            END;
            IF ind = 15 THEN BEGIN
              ch15 := TRUE;
              tex15 := rTra.TourOperador;
              CurrForm.ch15.VISIBLE := TRUE;
              CurrForm.tex15.VISIBLE := TRUE;
            END;
            IF ind = 16 THEN BEGIN
              ch16 := TRUE;
              tex16 := rTra.TourOperador;
              CurrForm.ch16.VISIBLE := TRUE;
              CurrForm.tex16.VISIBLE := TRUE;
            END;
            IF ind = 17 THEN BEGIN
              ch17 := TRUE;
              tex17 := rTra.TourOperador;
              CurrForm.ch17.VISIBLE := TRUE;
              CurrForm.tex17.VISIBLE := TRUE;
            END;
            IF ind = 18 THEN BEGIN
              ch18 := TRUE;
              tex18 := rTra.TourOperador;
              CurrForm.ch18.VISIBLE := TRUE;
              CurrForm.tex18.VISIBLE := TRUE;
            END;
          END;
        END;
      UNTIL rTra.NEXT = 0;
    END;

    PROCEDURE Filtros_TipHab@5();
    BEGIN
      Filtto := '';
      PrimerFiltro := FALSE;

      IF (NOT ch01) AND (tex01 <> '') THEN BEGIN
        PrimerFiltro := TRUE;
        Filtto := Filtto + '<>' + tex01;
      END;

      IF (NOT ch02) AND (tex02 <> '') THEN BEGIN
        IF PrimerFiltro THEN
          Filtto := Filtto + '&';
        PrimerFiltro := TRUE;
        Filtto := Filtto + '<>' + tex02;
      END;

      IF (NOT ch03) AND (tex03 <> '') THEN BEGIN
        IF PrimerFiltro THEN
          Filtto := Filtto + '&';
        PrimerFiltro := TRUE;
        Filtto := Filtto + '<>' + tex03;
      END;

      IF (NOT ch04) AND (tex04 <> '') THEN BEGIN
        IF PrimerFiltro THEN
          Filtto := Filtto + '&';
        PrimerFiltro := TRUE;
        Filtto := Filtto + '<>' + tex04;
      END;

      IF (NOT ch05) AND (tex05 <> '') THEN BEGIN
        IF PrimerFiltro THEN
          Filtto := Filtto + '&';
        PrimerFiltro := TRUE;
        Filtto := Filtto + '<>' + tex05;
      END;

      IF (NOT ch06) AND (tex06 <> '') THEN BEGIN
        IF PrimerFiltro THEN
          Filtto := Filtto + '&';
        PrimerFiltro := TRUE;
        Filtto := Filtto + '<>' + tex06;
      END;

      IF (NOT ch07) AND (tex07 <> '') THEN BEGIN
        IF PrimerFiltro THEN
          Filtto := Filtto + '&';
        PrimerFiltro := TRUE;
        Filtto := Filtto + '<>' + tex07;
      END;

      IF (NOT ch08) AND (tex08 <> '') THEN BEGIN
        IF PrimerFiltro THEN
          Filtto := Filtto + '&';
        PrimerFiltro := TRUE;
        Filtto := Filtto + '<>' + tex08;
      END;

      IF (NOT ch09) AND (tex09 <> '') THEN BEGIN
        IF PrimerFiltro THEN
          Filtto := Filtto + '&';
        PrimerFiltro := TRUE;
        Filtto := Filtto + '<>' + tex09;
      END;

      IF (NOT ch10) AND (tex10 <> '') THEN BEGIN
        IF PrimerFiltro THEN
          Filtto := Filtto + '&';
        PrimerFiltro := TRUE;
        Filtto := Filtto + '<>' + tex10;
      END;

      IF (NOT ch11) AND (tex11 <> '') THEN BEGIN
        IF PrimerFiltro THEN
          Filtto := Filtto + '&';
        PrimerFiltro := TRUE;
        Filtto := Filtto + '<>' + tex11;
      END;

      IF (NOT ch12) AND (tex12 <> '') THEN BEGIN
        IF PrimerFiltro THEN
          Filtto := Filtto + '&';
        PrimerFiltro := TRUE;
        Filtto := Filtto + '<>' + tex12;
      END;

      IF (NOT ch13) AND (tex13 <> '') THEN BEGIN
        IF PrimerFiltro THEN
          Filtto := Filtto + '&';
        PrimerFiltro := TRUE;
        Filtto := Filtto + '<>' + tex13;
      END;

      IF (NOT ch14) AND (tex14 <> '') THEN BEGIN
        IF PrimerFiltro THEN
          Filtto := Filtto + '&';
        PrimerFiltro := TRUE;
        Filtto := Filtto + '<>' + tex14;
      END;

      IF (NOT ch15) AND (tex15 <> '') THEN BEGIN
        IF PrimerFiltro THEN
          Filtto := Filtto + '&';
        PrimerFiltro := TRUE;
        Filtto := Filtto + '<>' + tex15;
      END;

      IF (NOT ch16) AND (tex16 <> '') THEN BEGIN
        IF PrimerFiltro THEN
          Filtto := Filtto + '&';
        PrimerFiltro := TRUE;
        Filtto := Filtto + '<>' + tex16;
      END;

      IF (NOT ch17) AND (tex17 <> '') THEN BEGIN
        IF PrimerFiltro THEN
          Filtto := Filtto + '&';
        PrimerFiltro := TRUE;
        Filtto := Filtto + '<>' + tex17;
      END;

      IF (NOT ch18) AND (tex18 <> '') THEN BEGIN
        IF PrimerFiltro THEN
          Filtto := Filtto + '&';
        PrimerFiltro := TRUE;
        Filtto := Filtto + '<>' + tex18;
      END;

      SETFILTER(TourOperador, Filtto);
    END;

    PROCEDURE NombreHotel@6() Nombre : Text[50];
    BEGIN
      // NombreHotel
      //
      IF rHot.GET(Hotel) THEN
        EXIT(rHot.Hotel+ '-' +rHot.Nombre)
      ELSE
        EXIT('');
    END;

    PROCEDURE Ovbk@7() O : Text[1];
    BEGIN
      // Ovbk
      //
      rHotOvk.RESET;
      rHotOvk.SETRANGE(Hotel,Hotel);

      IF rHotOvk.FIND('-') THEN
        REPEAT
          IF  (rHotOvk.Desde <= CurrForm.Matriz.MatrixRec."Period End") AND
              (rHotOvk.Hasta >= CurrForm.Matriz.MatrixRec."Period Start") THEN
            EXIT('*');
        UNTIL rHotOvk.NEXT = 0;
      EXIT('');
    END;

    PROCEDURE PrimeraPantalla@8() : Boolean;
    BEGIN
      EXIT(TourOperadorInicial = 0)
    END;

    PROCEDURE limpia_variables@10();
    BEGIN
      ch01 := FALSE;
      tex01 := '';

      ch02 := FALSE;
      tex02 := '';

      ch03 := FALSE;
      tex03 := '';

      ch04 := FALSE;
      tex04 := '';

      ch05 := FALSE;
      tex05 := '';

      ch06 := FALSE;
      tex06 := '';

      ch07 := FALSE;
      tex07 := '';

      ch08 := FALSE;
      tex08 := '';

      ch09 := FALSE;
      tex09 := '';

      ch10 := FALSE;
      tex10 := '';

      ch11 := FALSE;
      tex11 := '';

      ch12 := FALSE;
      tex12 := '';

      ch13 := FALSE;
      tex13 := '';

      ch14 := FALSE;
      tex14 := '';

      ch15 := FALSE;
      tex15 := '';

      ch16 := FALSE;
      tex16 := '';

      ch17 := FALSE;
      tex17 := '';

      ch18 := FALSE;
      tex18 := '';
    END;

    PROCEDURE Paro@9() : Char;
    VAR
      rParo@1103355000 : Record 7009781;
    BEGIN
      // Paro
      //
      CLEAR(rParo);
      rParo.SETRANGE (Hotel        , Hotel);
      rParo.SETFILTER("Fecha desde", '<=%1', CurrForm.Matriz.MatrixRec."Period End");
      rParo.SETFILTER("Fecha hasta", '>=%1', CurrForm.Matriz.MatrixRec."Period Start");
      IF rParo.FIND('-') THEN
        EXIT('*')
      ELSE
        EXIT(' ');
    END;

    BEGIN
    {
      $001 AJS 14122011 Incluyo una nueva linea para mostrar el release del contrato de compra
    }
    END.
  }
}
