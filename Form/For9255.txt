OBJECT Form 9255 To-dos Matrix
{
  OBJECT-PROPERTIES
  {
    Date=14/08/09;
    Time=12:00:00;
    Version List=NAVW16.00.01;
  }
  PROPERTIES
  {
    Width=20790;
    Height=6820;
    Editable=No;
    CaptionML=ENU=To-dos Matrix;
    LinksAllowed=No;
    SourceTable=Table5102;
    DataCaptionExpr=FORMAT(SELECTSTR(OutputOption+1,Text001));
    OnOpenForm=BEGIN
                 MATRIX_NoOfMatrixColumns := ARRAYLEN(MATRIX_CellData);
                 IF IncludeClosed THEN
                   SETRANGE("To-do Closed Filter")
                 ELSE
                   SETRANGE("To-do Closed Filter",FALSE);

                 IF StatusFilter <> StatusFilter::" " THEN
                   SETRANGE("To-do Status Filter",StatusFilter-1)
                 ELSE
                   SETRANGE("To-do Status Filter");

                 IF PriorityFilter <> PriorityFilter::" " THEN
                   SETRANGE("Priority Filter",PriorityFilter-1)
                 ELSE
                   SETRANGE("Priority Filter");

                 ValidateFilter;
                 ValidateTableOption;
               END;

    OnFindRecord=BEGIN
                   EXIT(FindRec(TableOption,Rec,Which));
                 END;

    OnNextRecord=BEGIN
                   EXIT(NextRec(TableOption,Rec,Steps));
                 END;

    OnAfterGetRecord=VAR
                       MATRIX_CurrentColumnOrdinal@1000 : Integer;
                     BEGIN
                       MATRIX_CurrentColumnOrdinal := 0;

                       WHILE MATRIX_CurrentColumnOrdinal < MATRIX_NoOfMatrixColumns DO BEGIN
                         MATRIX_CurrentColumnOrdinal := MATRIX_CurrentColumnOrdinal + 1;
                         MATRIX_OnAfterGetRecord(MATRIX_CurrentColumnOrdinal);
                       END;
                     END;

  }
  CONTROLS
  {
    { 1   ;TableBox     ;220  ;220  ;20350;5610 ;HorzGlue=Both;
                                                 VertGlue=Both }
    { 2   ;TextBox      ;3493 ;3080 ;2420 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="No.";
                                                 OnFormat=BEGIN
                                                            CurrForm."No.".UPDATEFONTBOLD(Type = Type::Company);
                                                          END;

                                                 OnLookup=VAR
                                                            Campaign@1040 : Record 5071;
                                                            SalesPurchPerson@1041 : Record 13;
                                                            Contact@1042 : Record 5050;
                                                            Team@1043 : Record 5083;
                                                          BEGIN
                                                                                                                 CASE TableOption OF
                                                                                                                   TableOption::Salesperson:
                                                                                                                     BEGIN
                                                                                                                       SalesPurchPerson.GET("No.");
                                                                                                                       FORM.RUNMODAL(0,SalesPurchPerson);
                                                                                                                     END;
                                                                                                                   TableOption::Team:
                                                                                                                     BEGIN
                                                                                                                       Team.GET("No.");
                                                                                                                       FORM.RUNMODAL(0,Team);
                                                                                                                     END;
                                                                                                                   TableOption::Campaign:
                                                                                                                     BEGIN
                                                                                                                       Campaign.GET("No.");
                                                                                                                       FORM.RUNMODAL(0,Campaign);
                                                                                                                     END;
                                                                                                                   TableOption::Contact:
                                                                                                                     BEGIN
                                                                                                                       Contact.GET("No.");
                                                                                                                       FORM.RUNMODAL(0,Contact);
                                                                                                                     END;
                                                                                                                 END;
                                                          END;
                                                           }
    { 1044;Label        ;0    ;0    ;0    ;0    ;ParentControl=2;
                                                 InColumnHeading=Yes }
    { 4   ;TextBox      ;3493 ;3080 ;2420 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Name;
                                                 OnFormat=BEGIN
                                                                                                                 CurrForm.Name.UPDATEFONTBOLD(Type = Type::Company);
                                                                                                                 IF (Type = Type::Person) AND (TableOption = TableOption::Contact) THEN
                                                                                                                   CurrForm.Name.UPDATEINDENT(220);
                                                          END;
                                                           }
    { 1045;Label        ;0    ;0    ;0    ;0    ;ParentControl=4;
                                                 InColumnHeading=Yes }
    { 1008;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field1;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[1];
                                                 CaptionClass='3,' + ColumnCaptions[1];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(1);
                                                             END;
                                                              }
    { 1046;Label        ;0    ;0    ;0    ;0    ;ParentControl=1008;
                                                 InColumnHeading=Yes }
    { 1009;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field2;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[2];
                                                 CaptionClass='3,' + ColumnCaptions[2];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(2);
                                                             END;
                                                              }
    { 1047;Label        ;0    ;0    ;0    ;0    ;ParentControl=1009;
                                                 InColumnHeading=Yes }
    { 1010;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field3;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[3];
                                                 CaptionClass='3,' + ColumnCaptions[3];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(3);
                                                             END;
                                                              }
    { 1048;Label        ;0    ;0    ;0    ;0    ;ParentControl=1010;
                                                 InColumnHeading=Yes }
    { 1011;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field4;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[4];
                                                 CaptionClass='3,' + ColumnCaptions[4];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(4);
                                                             END;
                                                              }
    { 1049;Label        ;0    ;0    ;0    ;0    ;ParentControl=1011;
                                                 InColumnHeading=Yes }
    { 1012;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field5;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[5];
                                                 CaptionClass='3,' + ColumnCaptions[5];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(5);
                                                             END;
                                                              }
    { 1050;Label        ;0    ;0    ;0    ;0    ;ParentControl=1012;
                                                 InColumnHeading=Yes }
    { 1013;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field6;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[6];
                                                 CaptionClass='3,' + ColumnCaptions[6];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(6);
                                                             END;
                                                              }
    { 1051;Label        ;0    ;0    ;0    ;0    ;ParentControl=1013;
                                                 InColumnHeading=Yes }
    { 1014;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field7;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[7];
                                                 CaptionClass='3,' + ColumnCaptions[7];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(7);
                                                             END;
                                                              }
    { 1052;Label        ;0    ;0    ;0    ;0    ;ParentControl=1014;
                                                 InColumnHeading=Yes }
    { 1015;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field8;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[8];
                                                 CaptionClass='3,' + ColumnCaptions[8];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(8);
                                                             END;
                                                              }
    { 1053;Label        ;0    ;0    ;0    ;0    ;ParentControl=1015;
                                                 InColumnHeading=Yes }
    { 1016;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field9;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[9];
                                                 CaptionClass='3,' + ColumnCaptions[9];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(9);
                                                             END;
                                                              }
    { 1054;Label        ;0    ;0    ;0    ;0    ;ParentControl=1016;
                                                 InColumnHeading=Yes }
    { 1017;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field10;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[10];
                                                 CaptionClass='3,' + ColumnCaptions[10];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(10);
                                                             END;
                                                              }
    { 1055;Label        ;0    ;0    ;0    ;0    ;ParentControl=1017;
                                                 InColumnHeading=Yes }
    { 1018;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field11;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[11];
                                                 CaptionClass='3,' + ColumnCaptions[11];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(11);
                                                             END;
                                                              }
    { 1056;Label        ;0    ;0    ;0    ;0    ;ParentControl=1018;
                                                 InColumnHeading=Yes }
    { 1019;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field12;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[12];
                                                 CaptionClass='3,' + ColumnCaptions[12];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(12);
                                                             END;
                                                              }
    { 1057;Label        ;0    ;0    ;0    ;0    ;ParentControl=1019;
                                                 InColumnHeading=Yes }
    { 1020;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field13;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[13];
                                                 CaptionClass='3,' + ColumnCaptions[13];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(13);
                                                             END;
                                                              }
    { 1058;Label        ;0    ;0    ;0    ;0    ;ParentControl=1020;
                                                 InColumnHeading=Yes }
    { 1021;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field14;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[14];
                                                 CaptionClass='3,' + ColumnCaptions[14];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(14);
                                                             END;
                                                              }
    { 1059;Label        ;0    ;0    ;0    ;0    ;ParentControl=1021;
                                                 InColumnHeading=Yes }
    { 1022;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field15;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[15];
                                                 CaptionClass='3,' + ColumnCaptions[15];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(15);
                                                             END;
                                                              }
    { 1060;Label        ;0    ;0    ;0    ;0    ;ParentControl=1022;
                                                 InColumnHeading=Yes }
    { 1023;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field16;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[16];
                                                 CaptionClass='3,' + ColumnCaptions[16];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(16);
                                                             END;
                                                              }
    { 1061;Label        ;0    ;0    ;0    ;0    ;ParentControl=1023;
                                                 InColumnHeading=Yes }
    { 1024;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field17;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[17];
                                                 CaptionClass='3,' + ColumnCaptions[17];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(17);
                                                             END;
                                                              }
    { 1062;Label        ;0    ;0    ;0    ;0    ;ParentControl=1024;
                                                 InColumnHeading=Yes }
    { 1025;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field18;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[18];
                                                 CaptionClass='3,' + ColumnCaptions[18];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(18);
                                                             END;
                                                              }
    { 1063;Label        ;0    ;0    ;0    ;0    ;ParentControl=1025;
                                                 InColumnHeading=Yes }
    { 1026;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field19;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[19];
                                                 CaptionClass='3,' + ColumnCaptions[19];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(19);
                                                             END;
                                                              }
    { 1064;Label        ;0    ;0    ;0    ;0    ;ParentControl=1026;
                                                 InColumnHeading=Yes }
    { 1027;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field20;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[20];
                                                 CaptionClass='3,' + ColumnCaptions[20];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(20);
                                                             END;
                                                              }
    { 1065;Label        ;0    ;0    ;0    ;0    ;ParentControl=1027;
                                                 InColumnHeading=Yes }
    { 1028;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field21;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[21];
                                                 CaptionClass='3,' + ColumnCaptions[21];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(21);
                                                             END;
                                                              }
    { 1066;Label        ;0    ;0    ;0    ;0    ;ParentControl=1028;
                                                 InColumnHeading=Yes }
    { 1029;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field22;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[22];
                                                 CaptionClass='3,' + ColumnCaptions[22];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(22);
                                                             END;
                                                              }
    { 1067;Label        ;0    ;0    ;0    ;0    ;ParentControl=1029;
                                                 InColumnHeading=Yes }
    { 1030;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field23;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[23];
                                                 CaptionClass='3,' + ColumnCaptions[23];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(23);
                                                             END;
                                                              }
    { 1068;Label        ;0    ;0    ;0    ;0    ;ParentControl=1030;
                                                 InColumnHeading=Yes }
    { 1031;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field24;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[24];
                                                 CaptionClass='3,' + ColumnCaptions[24];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(24);
                                                             END;
                                                              }
    { 1069;Label        ;0    ;0    ;0    ;0    ;ParentControl=1031;
                                                 InColumnHeading=Yes }
    { 1032;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field25;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[25];
                                                 CaptionClass='3,' + ColumnCaptions[25];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(25);
                                                             END;
                                                              }
    { 1070;Label        ;0    ;0    ;0    ;0    ;ParentControl=1032;
                                                 InColumnHeading=Yes }
    { 1033;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field26;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[26];
                                                 CaptionClass='3,' + ColumnCaptions[26];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(26);
                                                             END;
                                                              }
    { 1071;Label        ;0    ;0    ;0    ;0    ;ParentControl=1033;
                                                 InColumnHeading=Yes }
    { 1034;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field27;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[27];
                                                 CaptionClass='3,' + ColumnCaptions[27];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(27);
                                                             END;
                                                              }
    { 1072;Label        ;0    ;0    ;0    ;0    ;ParentControl=1034;
                                                 InColumnHeading=Yes }
    { 1035;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field28;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[28];
                                                 CaptionClass='3,' + ColumnCaptions[28];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(28);
                                                             END;
                                                              }
    { 1073;Label        ;0    ;0    ;0    ;0    ;ParentControl=1035;
                                                 InColumnHeading=Yes }
    { 1036;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field29;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[29];
                                                 CaptionClass='3,' + ColumnCaptions[29];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(29);
                                                             END;
                                                              }
    { 1074;Label        ;0    ;0    ;0    ;0    ;ParentControl=1036;
                                                 InColumnHeading=Yes }
    { 1037;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field30;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[30];
                                                 CaptionClass='3,' + ColumnCaptions[30];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(30);
                                                             END;
                                                              }
    { 1075;Label        ;0    ;0    ;0    ;0    ;ParentControl=1037;
                                                 InColumnHeading=Yes }
    { 1038;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field31;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[31];
                                                 CaptionClass='3,' + ColumnCaptions[31];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(31);
                                                             END;
                                                              }
    { 1076;Label        ;0    ;0    ;0    ;0    ;ParentControl=1038;
                                                 InColumnHeading=Yes }
    { 1039;TextBox      ;3493 ;3080 ;2420 ;440  ;Name=Field32;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=MATRIX_CellData[32];
                                                 CaptionClass='3,' + ColumnCaptions[32];
                                                 OnDrillDown=BEGIN
                                                               SetFilters;
                                                               MatrixOnDrillDown(32);
                                                             END;
                                                              }
    { 1077;Label        ;0    ;0    ;0    ;0    ;ParentControl=1039;
                                                 InColumnHeading=Yes }
    { 3   ;CommandButton;18370;6050 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
  }
  CODE
  {
    VAR
      ToDos@1003 : Record 5080;
      MatrixRecords@1002 : ARRAY [32] OF Record 2000000007;
      "Salesperson/Purchaser"@1000 : Record 13;
      Cont@1079 : Record 5050;
      Team@1080 : Record 5083;
      Campaign@1081 : Record 5071;
      PeriodFormMgt@1082 : Codeunit 359;
      PeriodType@1083 : 'Day,Week,Month,Quarter,Year,Accounting Period';
      OutputOption@1084 : 'No. of To-dos,Contact No.';
      TableOption@1085 : 'Salesperson,Team,Campaign,Contact';
      StatusFilter@1086 : ' ,Not Started,In Progress,Completed,Waiting,Postponed';
      PriorityFilter@1087 : ' ,Low,Normal,High';
      IncludeClosed@1088 : Boolean;
      FilterSalesPerson@1089 : Code[250];
      FilterTeam@1090 : Code[250];
      FilterCampaign@1091 : Code[250];
      FilterContact@1092 : Code[250];
      Text001@1093 : TextConst 'ENU=No. of To-dos,Contact No.';
      MATRIX_NoOfMatrixColumns@1095 : Integer;
      MATRIX_CellData@1096 : ARRAY [32] OF Text[1024];
      ColumnCaptions@1097 : ARRAY [32] OF Text[1024];
      ColumnDateFilters@1001 : ARRAY [32] OF Text[50];

    LOCAL PROCEDURE SetFilters@1098();
    BEGIN
      IF StatusFilter <> StatusFilter::" " THEN BEGIN
        SETRANGE("To-do Status Filter",StatusFilter-1);
        ToDos.SETRANGE(Status,StatusFilter-1);
      END ELSE BEGIN
        SETRANGE("To-do Status Filter");
        ToDos.SETRANGE(Status);
      END;

      ToDos.SETFILTER("System To-do Type",'%1|%2',"System To-do Type Filter"::Organizer,
        "System To-do Type Filter"::"Salesperson Attendee");

      IF IncludeClosed THEN
        ToDos.SETRANGE(Closed)
      ELSE
        ToDos.SETRANGE(Closed,FALSE);

      IF PriorityFilter <> PriorityFilter::" " THEN BEGIN
        SETRANGE("Priority Filter",PriorityFilter-1);
        ToDos.SETRANGE(Priority,PriorityFilter-1);
      END ELSE BEGIN
        SETRANGE("Priority Filter");
        ToDos.SETRANGE(Priority);
      END;

      CASE TableOption OF
        TableOption::Salesperson:
          BEGIN
            SETRANGE("Salesperson Filter","No.");
            SETFILTER(
              "System To-do Type Filter",'%1|%2',
              "System To-do Type Filter"::Organizer,
              "System To-do Type Filter"::"Salesperson Attendee");
          END;
        TableOption::Team:
          BEGIN
            SETRANGE("Team Filter","No.");
            SETRANGE("System To-do Type Filter","System To-do Type Filter"::Team);
          END;
        TableOption::Campaign:
          BEGIN
            SETRANGE("Campaign Filter","No.");
            SETRANGE("System To-do Type Filter","System To-do Type Filter"::Organizer);
          END;
        TableOption::Contact:
          BEGIN
            IF Type = Type::Company THEN BEGIN
              SETRANGE("Contact Filter");
              SETRANGE("Contact Company Filter","Company No.");
              SETRANGE(
                "System To-do Type Filter","System To-do Type Filter"::"Contact Attendee");
            END ELSE BEGIN
              SETRANGE("Contact Filter","No.");
              SETRANGE("Contact Company Filter");
              SETRANGE(
                "System To-do Type Filter","System To-do Type Filter"::"Contact Attendee");
            END;
          END;
      END;
    END;

    LOCAL PROCEDURE FindRec@1099(TableOpt@1000 : 'Salesperson,Teams,Campaign,Contact';VAR RMMatrixMgt@1001 : Record 5102;Which@1002 : Text[250]) : Boolean;
    VAR
      Found@1100 : Boolean;
    BEGIN
      CASE TableOpt OF
        TableOpt::Salesperson:
          BEGIN
            RMMatrixMgt."No." := COPYSTR(RMMatrixMgt."No.",1,MAXSTRLEN("Salesperson/Purchaser".Code));
            "Salesperson/Purchaser".Code := RMMatrixMgt."No.";
            Found := "Salesperson/Purchaser".FIND(Which);
              IF Found THEN
                CopySalesPersonToBuf("Salesperson/Purchaser",RMMatrixMgt);
          END;
        TableOpt::Teams:
          BEGIN
            RMMatrixMgt."No." := COPYSTR(RMMatrixMgt."No.",1,MAXSTRLEN(Team.Code));
            Team.Code := RMMatrixMgt."No.";
            Found := Team.FIND(Which);
            IF Found THEN
              CopyTeamToBuf(Team,RMMatrixMgt);
          END;
        TableOpt::Campaign:
          BEGIN
            Campaign."No." := RMMatrixMgt."No.";
            Found := Campaign.FIND(Which);
            IF Found THEN
              CopyCampaignToBuf(Campaign,RMMatrixMgt);
          END;
        TableOpt::Contact:
          BEGIN
            Cont."Company Name" := RMMatrixMgt."Company Name";
            Cont.Type := RMMatrixMgt.Type;
            Cont.Name := COPYSTR(RMMatrixMgt.Name,1,MAXSTRLEN(Cont.Name));
            Cont."No." := RMMatrixMgt."No.";
            Cont."Company No." := RMMatrixMgt."Company No.";
            Found := Cont.FIND(Which);
            IF Found THEN
              CopyContactToBuf(Cont,RMMatrixMgt);
          END;
      END;
      EXIT(Found);
    END;

    LOCAL PROCEDURE NextRec@1101(TableOpt@1000 : 'Salesperson,Teams,Campaign,Contact';VAR RMMatrixMgt@1001 : Record 5102;Steps@1002 : Integer) : Integer;
    VAR
      ResultSteps@1102 : Integer;
    BEGIN
      CASE TableOpt OF
        TableOpt::Salesperson:
          BEGIN
            RMMatrixMgt."No." := COPYSTR(RMMatrixMgt."No.",1,MAXSTRLEN("Salesperson/Purchaser".Code));
            "Salesperson/Purchaser".Code := RMMatrixMgt."No.";
            ResultSteps := "Salesperson/Purchaser".NEXT(Steps);
            IF ResultSteps <> 0 THEN
              CopySalesPersonToBuf("Salesperson/Purchaser",RMMatrixMgt);
          END;
        TableOpt::Teams:
          BEGIN
            RMMatrixMgt."No." := COPYSTR(RMMatrixMgt."No.",1,MAXSTRLEN(Team.Code));
            Team.Code := RMMatrixMgt."No.";
            ResultSteps := Team.NEXT(Steps);
            IF ResultSteps <> 0 THEN
              CopyTeamToBuf(Team,RMMatrixMgt);
          END;
        TableOpt::Campaign:
          BEGIN
            Campaign."No." := RMMatrixMgt."No.";
            ResultSteps := Campaign.NEXT(Steps);
            IF ResultSteps <> 0 THEN
              CopyCampaignToBuf(Campaign,RMMatrixMgt);
          END;
        TableOpt::Contact:
          BEGIN
            Cont."Company Name" := RMMatrixMgt."Company Name";
            Cont.Type := RMMatrixMgt.Type;
            Cont.Name := COPYSTR(RMMatrixMgt.Name,1,MAXSTRLEN(Cont.Name));
            Cont."No." := RMMatrixMgt."No.";
            Cont."Company No." := RMMatrixMgt."Company No.";
            ResultSteps := Cont.NEXT(Steps);
            IF ResultSteps <> 0 THEN
              CopyContactToBuf(Cont,RMMatrixMgt);
          END;
      END;
      EXIT(ResultSteps);
    END;

    LOCAL PROCEDURE CopySalesPersonToBuf@1103(VAR SalesPurchPerson@1000 : Record 13;VAR RMMatrixMgt@1001 : Record 5102);
    BEGIN
      WITH RMMatrixMgt DO BEGIN
        INIT;
        "Company Name" := SalesPurchPerson.Code;
        Type := Type::Person;
        Name := SalesPurchPerson.Name;
        "No." := SalesPurchPerson.Code;
        "Company No." := '';
      END;
    END;

    LOCAL PROCEDURE CopyCampaignToBuf@1104(VAR TheCampaign@1000 : Record 5071;VAR RMMatrixMgt@1001 : Record 5102);
    BEGIN
      WITH RMMatrixMgt DO BEGIN
        INIT;
        "Company Name" := TheCampaign."No.";
        Type := Type::Person;
        Name := TheCampaign.Description;
        "No." := TheCampaign."No.";
        "Company No." := '';
      END;
    END;

    LOCAL PROCEDURE CopyContactToBuf@1105(VAR TheCont@1000 : Record 5050;VAR RMMatrixMgt@1001 : Record 5102);
    BEGIN
      WITH RMMatrixMgt DO BEGIN
        INIT;
        "Company Name" := TheCont."Company Name";
        Type := TheCont.Type;
        Name := TheCont.Name;
        "No." := TheCont."No.";
        "Company No." := TheCont."Company No.";
      END;
    END;

    LOCAL PROCEDURE CopyTeamToBuf@1106(VAR TheTeam@1000 : Record 5083;VAR RMMatrixMgt@1001 : Record 5102);
    BEGIN
      WITH RMMatrixMgt DO BEGIN
        INIT;
        "Company Name" := TheTeam.Code;
        Type := Type::Person;
        Name := TheTeam.Name;
        "No." := TheTeam.Code;
        "Company No." := '';
      END;
    END;

    PROCEDURE ValidateTableOption@1116();
    BEGIN
      SETRANGE("Contact Company Filter");
      CASE TableOption OF
        TableOption::Salesperson:
          BEGIN
            SETFILTER("Team Filter",FilterTeam);
            SETFILTER("Campaign Filter",FilterCampaign);
            SETFILTER("Contact Filter",FilterContact);
            ValidateFilter;
          END;
        TableOption::Team:
          BEGIN
            SETFILTER("Salesperson Filter",FilterSalesPerson);
            SETFILTER("Campaign Filter",FilterCampaign);
            SETFILTER("Contact Filter",FilterContact);
            ValidateFilter;
          END;
        TableOption::Campaign:
          BEGIN
            SETFILTER("Salesperson Filter",FilterSalesPerson);
            SETFILTER("Team Filter",FilterTeam);
            SETFILTER("Contact Filter",FilterContact);
            ValidateFilter;
          END;
        TableOption::Contact:
          BEGIN
            SETFILTER("Salesperson Filter",FilterSalesPerson);
            SETFILTER("Team Filter",FilterTeam);
            SETFILTER("Campaign Filter",FilterCampaign);
            ValidateFilter;
          END;
      END;
    END;

    PROCEDURE ValidateFilter@1117();
    BEGIN
      CASE TableOption OF
        TableOption::Salesperson:
          UpdateSalesPersonFilter;
        TableOption::Team:
          UpdateTeamFilter;
        TableOption::Campaign:
          UpdateCampaignFilter;
        TableOption::Contact:
          UpdateContactFilter;
      END;
      CurrForm.UPDATE(FALSE);
    END;

    PROCEDURE UpdateSalesPersonFilter@1118();
    BEGIN
      "Salesperson/Purchaser".RESET;
      "Salesperson/Purchaser".SETFILTER(Code,FilterSalesPerson);
      "Salesperson/Purchaser".SETFILTER("Team Filter",FilterTeam);
      "Salesperson/Purchaser".SETFILTER("Campaign Filter",FilterCampaign);
      "Salesperson/Purchaser".SETFILTER("Contact Company Filter",FilterContact);
      "Salesperson/Purchaser".SETFILTER("To-do Status Filter",GETFILTER("To-do Status Filter"));
      "Salesperson/Purchaser".SETFILTER("Closed To-do Filter",GETFILTER("To-do Closed Filter"));
      "Salesperson/Purchaser".SETFILTER("Priority Filter",GETFILTER("Priority Filter"));
      "Salesperson/Purchaser".SETRANGE("To-do Entry Exists",TRUE);
    END;

    PROCEDURE UpdateCampaignFilter@1119();
    BEGIN
      Campaign.RESET;
      Campaign.SETFILTER("No.",FilterCampaign);
      Campaign.SETFILTER("Salesperson Filter",FilterSalesPerson);
      Campaign.SETFILTER("Team Filter",FilterTeam);
      Campaign.SETFILTER("Contact Company Filter",FilterContact);
      Campaign.SETFILTER("To-do Status Filter",GETFILTER("To-do Status Filter"));
      Campaign.SETFILTER("To-do Closed Filter",GETFILTER("To-do Closed Filter"));
      Campaign.SETFILTER("Priority Filter",GETFILTER("Priority Filter"));
      Campaign.SETRANGE("To-do Entry Exists",TRUE);
    END;

    PROCEDURE UpdateContactFilter@1120();
    BEGIN
      Cont.RESET;
      Cont.SETCURRENTKEY("Company Name","Company No.",Type,Name);
      Cont.SETFILTER("Company No.",FilterContact);
      Cont.SETFILTER("Campaign Filter",FilterCampaign);
      Cont.SETFILTER("Salesperson Filter",FilterSalesPerson);
      Cont.SETFILTER("Team Filter",FilterTeam);
      Cont.SETFILTER("To-do Status Filter",GETFILTER("To-do Status Filter"));
      Cont.SETFILTER("To-do Closed Filter",GETFILTER("To-do Closed Filter"));
      Cont.SETFILTER("Priority Filter",GETFILTER("Priority Filter"));
      Cont.SETRANGE("To-do Entry Exists",TRUE);
    END;

    PROCEDURE UpdateTeamFilter@1121();
    BEGIN
      Team.RESET;
      Team.SETFILTER(Code,FilterTeam);
      Team.SETFILTER("Campaign Filter",FilterCampaign);
      Team.SETFILTER("Salesperson Filter",FilterSalesPerson);
      Team.SETFILTER("Contact Company Filter",FilterContact);
      Team.SETFILTER("To-do Status Filter",GETFILTER("To-do Status Filter"));
      Team.SETFILTER("To-do Closed Filter",GETFILTER("To-do Closed Filter"));
      Team.SETFILTER("Priority Filter",GETFILTER("Priority Filter"));
      Team.SETRANGE("To-do Entry Exists",TRUE);
    END;

    PROCEDURE Load@1122(VAR MatrixColumns1@1005 : ARRAY [32] OF Text[1024];VAR MatrixRecords1@1006 : ARRAY [32] OF Record 2000000007;VAR TableOptionLocal@1001 : 'Salesperson,Team,Campaign,Contact';VAR ColumnDateFilter@1000 : ARRAY [32] OF Text[50];OutputOptionLocal@1011 : 'No. of To-dos,Contact No.';FilterSalesPersonLocal@1007 : Code[250];FilterTeamLocal@1004 : Code[250];FilterCampaignLocal@1003 : Code[250];FilterContactLocal@1002 : Code[250];StatusFilterLocal@1010 : ' ,Not Started,In Progress,Completed,Waiting,Postponed';IncludeClosedLocal@1008 : Boolean;PriorityFilterLocal@1009 : ' ,Low,Normal,High');
    VAR
      i@1013 : Integer;
    BEGIN
      COPYARRAY(ColumnCaptions,MatrixColumns1,1);
      FOR i := 1 TO 32 DO
        MatrixRecords[i].COPY(MatrixRecords1[i]);
      TableOption := TableOptionLocal;
      COPYARRAY(ColumnDateFilters,ColumnDateFilter,1);
      OutputOption := OutputOptionLocal;
      FilterSalesPerson := FilterSalesPersonLocal;
      FilterTeam := FilterTeamLocal;
      FilterCampaign := FilterCampaignLocal;
      FilterContact := FilterContactLocal;
      StatusFilter := StatusFilterLocal;
      IncludeClosed := IncludeClosedLocal;
      PriorityFilter := PriorityFilterLocal;
      SetFilters;
    END;

    LOCAL PROCEDURE MatrixOnDrillDown@1123(ColumnID@1007 : Integer);
    VAR
      DrilDownForm@1000 : Form 5096;
    BEGIN
      ToDos.SETRANGE(Date,MatrixRecords[ColumnID]."Period Start",MatrixRecords[ColumnID]."Period End");
      CASE TableOption OF
        TableOption::Salesperson : ToDos.SETFILTER("Salesperson Code","No.");
        TableOption::Team : ToDos.SETFILTER("Team Code","No.");
        TableOption::Campaign : ToDos.SETFILTER("Campaign No.","No.");
        TableOption::Contact : ToDos.SETFILTER("Contact No.","No.");
      END;
      ToDos.SETFILTER("Salesperson Code",GETFILTER("Salesperson Filter"));
      ToDos.SETFILTER("Team Code",GETFILTER("Team Filter"));
      ToDos.SETFILTER("Contact Company No.",GETFILTER("Contact Company Filter"));
      ToDos.SETFILTER(Status,GETFILTER("To-do Status Filter"));
      ToDos.SETFILTER(Closed,GETFILTER("To-do Closed Filter"));
      ToDos.SETFILTER(Priority,GETFILTER("Priority Filter"));
      ToDos.SETFILTER("System To-do Type",GETFILTER("System To-do Type Filter"));

      DrilDownForm.SETTABLEVIEW(ToDos);
      DrilDownForm.RUNMODAL;
    END;

    PROCEDURE MATRIX_OnAfterGetRecord@1(Matrix_ColumnOrdinal@1000 : Integer);
    BEGIN
      SetFilters;
      SETRANGE("Date Filter",MatrixRecords[Matrix_ColumnOrdinal]."Period Start",MatrixRecords[Matrix_ColumnOrdinal]."Period End");
      CALCFIELDS("No. of To-dos");
      IF "No. of To-dos" = 0 THEN
        MATRIX_CellData[Matrix_ColumnOrdinal] := ''
      ELSE
        MATRIX_CellData[Matrix_ColumnOrdinal] := FORMAT("No. of To-dos");
    END;

    BEGIN
    END.
  }
}
