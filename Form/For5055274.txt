OBJECT Form 5055274 Liq. Account Schedule Overview
{
  OBJECT-PROPERTIES
  {
    Date=13/02/07;
    Time=12:00:00;
    Version List=LIQEM5.00;
  }
  PROPERTIES
  {
    Width=16500;
    Height=8470;
    CaptionML=[ENU=Liq. Account Schedule Overview;
               ESP=Panorama esquema ctas. liq.];
    CaptionBar=Normal;
    SaveValues=Yes;
    SourceTable=Table5055262;
    DataCaptionExpr=CurrentSchedName + ' - ' + CurrentColumnName;
    OnOpenForm=BEGIN
                 GLSetup.GET;
                 IF NewCurrentSchedName <> '' THEN
                   CurrentSchedName := NewCurrentSchedName;
                 IF CurrentSchedName = '' THEN
                   CurrentSchedName := Text1140000;
                 IF NewCurrentColumnName <> '' THEN
                   CurrentColumnName := NewCurrentColumnName;
                 IF CurrentColumnName = '' THEN
                   CurrentColumnName := Text1140000;
                 LiqAccSchedManagement.CopyColumnsToTemp(CurrentColumnName,TmpLiqAccSchedColumn);
                 LiqAccSchedManagement.OpenSchedule(CurrentSchedName,Rec);
                 LiqAccSchedManagement.OpenColumns(CurrentColumnName,CurrForm.LiqAccSchedOverview.MatrixRec);
                 LiqAccSchedManagement.CheckAnalysisView(CurrentSchedName,CurrentColumnName,TRUE);

                 IF LiqAccSchedName.GET(CurrentSchedName) THEN
                   IF LiqAccSchedName."Liq. Analysis View Name" <> '' THEN
                     LiquidityAnalysisView.GET(LiqAccSchedName."Liq. Analysis View Name")
                   ELSE BEGIN
                     CLEAR(LiquidityAnalysisView);
                     LiquidityAnalysisView."Dimension 1 Code" := GLSetup."Global Dimension 1 Code";
                     LiquidityAnalysisView."Dimension 2 Code" := GLSetup."Global Dimension 2 Code";
                   END;
                 FindPeriod('');
                 CurrForm.Dim1Filter.ENABLED := LiquidityAnalysisView."Dimension 1 Code" <> '';
                 CurrForm.Dim2Filter.ENABLED := LiquidityAnalysisView."Dimension 2 Code" <> '';
                 CurrForm.Dim3Filter.ENABLED := LiquidityAnalysisView."Dimension 3 Code" <> '';
                 CurrForm.Dim4Filter.ENABLED := LiquidityAnalysisView."Dimension 4 Code" <> '';
                 CurrForm.UPDATECONTROLS;
               END;

  }
  CONTROLS
  {
    { 1140000;MatrixBox ;220  ;2420 ;16060;5060 ;Name=LiqAccSchedOverview;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Editable=No;
                                                 MatrixColumnWidth=2200;
                                                 MatrixSourceTable=Table5055264;
                                                 OnFindRecord=VAR
                                                                Found@1140000 : Boolean;
                                                              BEGIN
                                                                Found := TmpLiqAccSchedColumn.FIND(Which);
                                                                IF Found THEN
                                                                  CurrForm.LiqAccSchedOverview.MatrixRec := TmpLiqAccSchedColumn;
                                                                EXIT(Found);
                                                              END;

                                                 OnNextRecord=VAR
                                                                ResultSteps@1140000 : Integer;
                                                              BEGIN
                                                                ResultSteps := TmpLiqAccSchedColumn.NEXT(Steps);
                                                                IF ResultSteps <> 0 THEN
                                                                  CurrForm.LiqAccSchedOverview.MatrixRec := TmpLiqAccSchedColumn;
                                                                EXIT(ResultSteps);
                                                              END;

                                                 OnAfterGetRecord=BEGIN
                                                                    IF Totaling = '' THEN
                                                                      ColumnValue := 0
                                                                    ELSE
                                                                      ColumnValue := LiqAccSchedManagement.CalcCell(Rec,CurrForm.LiqAccSchedOverview.MatrixRec);
                                                                  END;
                                                                   }
    { 1140001;TextBox   ;0    ;1100 ;1650 ;440  ;ParentControl=1140000;
                                                 InColumn=Yes;
                                                 SourceExpr="Row No.";
                                                 OnFormat=BEGIN
                                                            IF Bold THEN
                                                              CurrForm."Row No.".UPDATEFONTBOLD := TRUE;
                                                          END;
                                                           }
    { 1140002;Label     ;0    ;0    ;0    ;0    ;ParentControl=1140001;
                                                 InColumnHeading=Yes }
    { 1140003;TextBox   ;2514 ;1540 ;4400 ;440  ;HorzGlue=Both;
                                                 ParentControl=1140000;
                                                 InColumn=Yes;
                                                 SourceExpr=Description;
                                                 OnFormat=BEGIN
                                                            IF Bold THEN
                                                              CurrForm.Description.UPDATEFONTBOLD := TRUE;
                                                          END;
                                                           }
    { 1140004;Label     ;0    ;0    ;0    ;0    ;ParentControl=1140003;
                                                 InColumnHeading=Yes }
    { 1140005;TextBox   ;9350 ;2200 ;9790 ;440  ;Name=ColumnValue;
                                                 ParentControl=1140000;
                                                 InMatrix=Yes;
                                                 DrillDown=Yes;
                                                 CaptionML=[ENU=Value;
                                                            ESP=Valor];
                                                 SourceExpr=ColumnValue;
                                                 AutoFormatType=1;
                                                 OnFormat=VAR
                                                            Value@1140000 : Decimal;
                                                          BEGIN
                                                            EVALUATE(Value, Text);
                                                            IF Value = 0 THEN
                                                              Text := '';
                                                            IF Bold THEN
                                                              CurrForm.ColumnValue.UPDATEFONTBOLD := TRUE;
                                                            IF LiqAccSchedManagement.GetDivisionError THEN
                                                              IF ShowError IN [ShowError::"Division by Zero",ShowError::Both] THEN BEGIN
                                                                Text := Text1140001;
                                                                CurrForm.ColumnValue.UPDATEFONTBOLD := TRUE;
                                                              END ELSE
                                                                Text := '';
                                                            IF LiqAccSchedManagement.GetPeriodError THEN
                                                              IF ShowError IN [ShowError::"Period Error",ShowError::Both] THEN BEGIN
                                                                Text := Text1140004;
                                                                CurrForm.ColumnValue.UPDATEFONTBOLD := TRUE;
                                                              END ELSE
                                                                Text := '';
                                                          END;

                                                 OnDrillDown=VAR
                                                               LiqAcc@1140000 : Record 5055251;
                                                               ChartOfAcc@1140002 : Form 5055261;
                                                               LiqAccAnalysisView@1140003 : Record 5055272;
                                                               ChartofAccAnalysisView@1140004 : Form 5055290;
                                                               FromDate@1140005 : Date;
                                                               ToDate@1140006 : Date;
                                                               FiscalStartDate@1140007 : Date;
                                                             BEGIN
                                                               IF CurrForm.LiqAccSchedOverview.MatrixRec."Column Type" = TmpLiqAccSchedColumn."Column Type"::Formula THEN
                                                                 MESSAGE(Text1140002,CurrForm.LiqAccSchedOverview.MatrixRec.Formula)
                                                               ELSE
                                                                 IF "Totaling Type" IN ["Totaling Type"::Formula,"Totaling Type"::"Set Base For Percent"] THEN
                                                                   MESSAGE(Text1140003,Totaling)
                                                                 ELSE
                                                                   IF Totaling <> '' THEN BEGIN
                                                                     COPYFILTER("Liquidity Filter",LiqAcc."Liquidity Filter");
                                                                     LiqAccSchedManagement.SetLiqAccRowFilter(LiqAcc,Rec);
                                                                     LiqAccSchedManagement.SetLiqAccColumnFilter(LiqAcc,Rec,CurrForm.LiqAccSchedOverview.MatrixRec);
                                                                     LiqAccSchedName.GET(CurrentSchedName);
                                                                     IF LiqAccSchedName."Liq. Analysis View Name" = '' THEN BEGIN
                                                                       COPYFILTER("Dimension 1 Filter",LiqAcc."Global Dimension 1 Filter");
                                                                       COPYFILTER("Dimension 2 Filter",LiqAcc."Global Dimension 2 Filter");
                                                                       LiqAcc.FILTERGROUP(2);
                                                                       LiqAcc.SETFILTER("Global Dimension 1 Filter","Dimension 1 Totaling");
                                                                       LiqAcc.SETFILTER("Global Dimension 2 Filter","Dimension 2 Totaling");
                                                                       LiqAcc.FILTERGROUP(6);
                                                                       LiqAcc.SETFILTER(
                                                                         "Global Dimension 1 Filter",
                                                                         LiqAccSchedManagement.GetDimTotalingFilter(1,CurrForm.LiqAccSchedOverview.MatrixRec."Dimension 1 Totaling"));
                                                                       LiqAcc.SETFILTER(
                                                                         "Global Dimension 2 Filter",
                                                                         LiqAccSchedManagement.GetDimTotalingFilter(2,CurrForm.LiqAccSchedOverview.MatrixRec."Dimension 2 Totaling"));
                                                                       LiqAcc.FILTERGROUP(0);
                                                                       FORM.RUN(FORM::"Chart of Liquidity Accounts",LiqAcc)
                                                                     END ELSE BEGIN
                                                                       LiqAcc.COPYFILTER("Date Filter",LiqAccAnalysisView."Date Filter");
                                                                       LiqAcc.COPYFILTER("Liquidity Filter",LiqAccAnalysisView."Liquidity Filter");
                                                                       LiqAccAnalysisView.SETRANGE("Analysis View Filter",LiqAccSchedName."Liq. Analysis View Name");
                                                                       COPYFILTER("Dimension 1 Filter",LiqAccAnalysisView."Dimension 1 Filter");
                                                                       COPYFILTER("Dimension 2 Filter",LiqAccAnalysisView."Dimension 2 Filter");
                                                                       COPYFILTER("Dimension 3 Filter",LiqAccAnalysisView."Dimension 3 Filter");
                                                                       COPYFILTER("Dimension 4 Filter",LiqAccAnalysisView."Dimension 4 Filter");
                                                                       LiqAccAnalysisView.FILTERGROUP(2);
                                                                       LiqAccAnalysisView.SETFILTER("Dimension 1 Filter",LiqAccSchedManagement.GetDimTotalingFilter(1,"Dimension 1 Totaling"));
                                                                       LiqAccAnalysisView.SETFILTER("Dimension 2 Filter",LiqAccSchedManagement.GetDimTotalingFilter(2,"Dimension 2 Totaling"));
                                                                       LiqAccAnalysisView.SETFILTER("Dimension 3 Filter",LiqAccSchedManagement.GetDimTotalingFilter(3,"Dimension 3 Totaling"));
                                                                       LiqAccAnalysisView.SETFILTER("Dimension 4 Filter",LiqAccSchedManagement.GetDimTotalingFilter(4,"Dimension 4 Totaling"));
                                                                       LiqAccAnalysisView.FILTERGROUP(6);
                                                                       LiqAccAnalysisView.SETFILTER(
                                                                         "Dimension 1 Filter",
                                                                         LiqAccSchedManagement.GetDimTotalingFilter(1,CurrForm.LiqAccSchedOverview.MatrixRec."Dimension 1 Totaling"));
                                                                       LiqAccAnalysisView.SETFILTER(
                                                                         "Dimension 2 Filter",
                                                                         LiqAccSchedManagement.GetDimTotalingFilter(2,CurrForm.LiqAccSchedOverview.MatrixRec."Dimension 2 Totaling"));
                                                                       LiqAccAnalysisView.SETFILTER(
                                                                         "Dimension 3 Filter",
                                                                         LiqAccSchedManagement.GetDimTotalingFilter(3,CurrForm.LiqAccSchedOverview.MatrixRec."Dimension 3 Totaling"));
                                                                       LiqAccAnalysisView.SETFILTER(
                                                                         "Dimension 4 Filter",
                                                                         LiqAccSchedManagement.GetDimTotalingFilter(4,CurrForm.LiqAccSchedOverview.MatrixRec."Dimension 4 Totaling"));
                                                                       LiqAccAnalysisView.FILTERGROUP(0);
                                                                       CLEAR(ChartofAccAnalysisView);
                                                                       ChartofAccAnalysisView.InsertTempLiqAccAnalysisViews(LiqAcc);
                                                                       ChartofAccAnalysisView.SETTABLEVIEW(LiqAccAnalysisView);
                                                                       ChartofAccAnalysisView.RUN;
                                                                     END;
                                                                   END;
                                                             END;
                                                              }
    { 1140006;TextBox   ;12650;1540 ;1650 ;440  ;ParentControl=1140005;
                                                 InMatrixHeading=Yes;
                                                 HorzAlign=Right;
                                                 CaptionML=[ENU=Column Header;
                                                            ESP=Cabecera columna];
                                                 SourceExpr=CurrForm.LiqAccSchedOverview.MatrixRec."Column Header" }
    { 1140007;TabControl;220  ;220  ;16060;1980 ;HorzGlue=Both;
                                                 PageNamesML=[ENU=General,Dimension Filters,Options;
                                                              ESP=General,Fitros dimensi¢n,Opciones] }
    { 1140008;TextBox   ;3850 ;990  ;2750 ;440  ;ParentControl=1140007;
                                                 InPage=0;
                                                 Lookup=Yes;
                                                 CaptionML=[ENU=Liq. Account Schedule Name;
                                                            ESP=Nombre esq. cuentas liq.];
                                                 SourceExpr=CurrentSchedName;
                                                 LookupFormID=Liq. Account Schedule Names;
                                                 OnValidate=BEGIN
                                                              LiqAccSchedManagement.CheckName(CurrentSchedName);
                                                            END;

                                                 OnLookup=BEGIN
                                                            EXIT(LiqAccSchedManagement.LookupName(CurrentSchedName,Text));
                                                          END;

                                                 OnAfterValidate=VAR
                                                                   LiqAccSchedName@1140000 : Record 5055261;
                                                                   PrevAnalysisView@1140001 : Record 5055269;
                                                                 BEGIN
                                                                   CurrForm.SAVERECORD;
                                                                   LiqAccSchedManagement.SetName(CurrentSchedName,Rec);
                                                                   IF LiqAccSchedName.GET(CurrentSchedName) THEN
                                                                     IF (LiqAccSchedName."Default Column Layout" <> '') AND
                                                                        (CurrentColumnName <> LiqAccSchedName."Default Column Layout")
                                                                     THEN BEGIN
                                                                       CurrentColumnName := LiqAccSchedName."Default Column Layout";
                                                                       LiqAccSchedManagement.CopyColumnsToTemp(CurrentColumnName,TmpLiqAccSchedColumn);
                                                                       LiqAccSchedManagement.SetColumnName(CurrentColumnName,CurrForm.LiqAccSchedOverview.MatrixRec);
                                                                     END;
                                                                   LiqAccSchedManagement.CheckAnalysisView(CurrentSchedName,CurrentColumnName,TRUE);

                                                                   IF LiqAccSchedName."Liq. Analysis View Name" <> LiquidityAnalysisView.Code THEN BEGIN
                                                                     PrevAnalysisView := LiquidityAnalysisView;
                                                                     IF LiqAccSchedName."Liq. Analysis View Name" <> '' THEN
                                                                       LiquidityAnalysisView.GET(LiqAccSchedName."Liq. Analysis View Name")
                                                                     ELSE BEGIN
                                                                       CLEAR(LiquidityAnalysisView);
                                                                       LiquidityAnalysisView."Dimension 1 Code" := GLSetup."Global Dimension 1 Code";
                                                                       LiquidityAnalysisView."Dimension 2 Code" := GLSetup."Global Dimension 2 Code";
                                                                     END;
                                                                     IF PrevAnalysisView."Dimension 1 Code" <> LiquidityAnalysisView."Dimension 1 Code" THEN
                                                                       SETRANGE("Dimension 1 Filter");
                                                                     IF PrevAnalysisView."Dimension 2 Code" <> LiquidityAnalysisView."Dimension 2 Code" THEN
                                                                       SETRANGE("Dimension 2 Filter");
                                                                     IF PrevAnalysisView."Dimension 3 Code" <> LiquidityAnalysisView."Dimension 3 Code" THEN
                                                                       SETRANGE("Dimension 3 Filter");
                                                                     IF PrevAnalysisView."Dimension 4 Code" <> LiquidityAnalysisView."Dimension 4 Code" THEN
                                                                       SETRANGE("Dimension 4 Filter");
                                                                   END;

                                                                   CurrForm.Dim1Filter.ENABLED := LiquidityAnalysisView."Dimension 1 Code" <> '';
                                                                   CurrForm.Dim2Filter.ENABLED := LiquidityAnalysisView."Dimension 2 Code" <> '';
                                                                   CurrForm.Dim3Filter.ENABLED := LiquidityAnalysisView."Dimension 3 Code" <> '';
                                                                   CurrForm.Dim4Filter.ENABLED := LiquidityAnalysisView."Dimension 4 Code" <> '';

                                                                   CurrForm.UPDATE(FALSE);
                                                                   CurrForm.UPDATECONTROLS;
                                                                 END;
                                                                  }
    { 1140009;Label     ;440  ;990  ;3300 ;440  ;ParentControl=1140008 }
    { 1140010;TextBox   ;3850 ;1540 ;2750 ;440  ;ParentControl=1140007;
                                                 InPage=0;
                                                 Lookup=Yes;
                                                 CaptionML=[ENU=Column Layout Name;
                                                            ESP=Nombre plantilla columna];
                                                 SourceExpr=CurrentColumnName;
                                                 TableRelation="Liq. Acc. Schedule Layout Name".Name;
                                                 OnValidate=BEGIN
                                                              LiqAccSchedManagement.CheckColumnName(CurrentColumnName);
                                                            END;

                                                 OnLookup=BEGIN
                                                            EXIT(LiqAccSchedManagement.LookupColumnName(CurrentColumnName,Text));
                                                          END;

                                                 OnAfterValidate=BEGIN
                                                                   LiqAccSchedManagement.CopyColumnsToTemp(CurrentColumnName,TmpLiqAccSchedColumn);
                                                                   LiqAccSchedManagement.SetColumnName(CurrentColumnName,CurrForm.LiqAccSchedOverview.MatrixRec);
                                                                   LiqAccSchedManagement.CheckAnalysisView(CurrentSchedName,CurrentColumnName,TRUE);

                                                                   CurrForm.UPDATE(FALSE);
                                                                 END;
                                                                  }
    { 1140011;Label     ;440  ;1540 ;3300 ;440  ;ParentControl=1140010 }
    { 1140012;TextBox   ;12980;990  ;2750 ;440  ;ParentControl=1140007;
                                                 InPage=0;
                                                 NextControl=1140008;
                                                 SourceExpr="Date Filter";
                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 1140013;Label     ;9570 ;990  ;3300 ;440  ;ParentControl=1140012 }
    { 1140014;TextBox   ;12980;1540 ;2750 ;440  ;ParentControl=1140007;
                                                 InPage=0;
                                                 SourceExpr="Liquidity Filter" }
    { 1140015;Label     ;9570 ;1540 ;3300 ;440  ;ParentControl=1140014 }
    { 1140016;TextBox   ;3850 ;1540 ;2750 ;440  ;Name=Dim2Filter;
                                                 ParentControl=1140007;
                                                 InPage=1;
                                                 CaptionML=[ENU=Dimension 2 Filter;
                                                            ESP=Filtro dimensi¢n 2];
                                                 ClearOnLookup=No;
                                                 SourceExpr="Dimension 2 Filter";
                                                 CaptionClass=FormGetCaptionClass(2);
                                                 OnLookup=BEGIN
                                                            EXIT(FormLookUpDimFilter(LiquidityAnalysisView."Dimension 2 Code",Text));
                                                          END;

                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 1140017;Label     ;440  ;1540 ;3300 ;440  ;ParentControl=1140016 }
    { 1140018;TextBox   ;3850 ;990  ;2750 ;440  ;Name=Dim1Filter;
                                                 ParentControl=1140007;
                                                 InPage=1;
                                                 CaptionML=[ENU=Dimension 1 Filter;
                                                            ESP=Filtro dimensi¢n 1];
                                                 ClearOnLookup=No;
                                                 SourceExpr="Dimension 1 Filter";
                                                 CaptionClass=FormGetCaptionClass(1);
                                                 OnLookup=BEGIN
                                                            EXIT(FormLookUpDimFilter(LiquidityAnalysisView."Dimension 1 Code",Text));
                                                          END;

                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 1140019;Label     ;440  ;990  ;3300 ;440  ;ParentControl=1140018;
                                                 CaptionClass=FormGetCaptionClass(1) }
    { 1140020;TextBox   ;12980;1540 ;2750 ;440  ;Name=Dim4Filter;
                                                 ParentControl=1140007;
                                                 InPage=1;
                                                 CaptionML=[ENU=Dimension 4 Filter;
                                                            ESP=Filtro dimensi¢n 4];
                                                 ClearOnLookup=No;
                                                 SourceExpr="Dimension 4 Filter";
                                                 CaptionClass=FormGetCaptionClass(4);
                                                 OnLookup=BEGIN
                                                            EXIT(FormLookUpDimFilter(LiquidityAnalysisView."Dimension 4 Code",Text));
                                                          END;

                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 1140021;Label     ;9570 ;1540 ;3300 ;440  ;ParentControl=1140020 }
    { 1140022;TextBox   ;12980;990  ;2750 ;440  ;Name=Dim3Filter;
                                                 ParentControl=1140007;
                                                 InPage=1;
                                                 CaptionML=[ENU=Dimension 3 Filter;
                                                            ESP=Filtro dimensi¢n 3];
                                                 ClearOnLookup=No;
                                                 SourceExpr="Dimension 3 Filter";
                                                 CaptionClass=FormGetCaptionClass(3);
                                                 OnLookup=BEGIN
                                                            EXIT(FormLookUpDimFilter(LiquidityAnalysisView."Dimension 3 Code",Text));
                                                          END;

                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 1140023;Label     ;9570 ;990  ;3300 ;440  ;ParentControl=1140022;
                                                 InPage=1 }
    { 1140024;TextBox   ;3850 ;990  ;1650 ;440  ;ParentControl=1140007;
                                                 InPage=2;
                                                 CaptionML=[ENU=Show Error;
                                                            ESP=Mostrar error];
                                                 OptionCaptionML=[ENU=None,Division by Zero,Period Error,Both;
                                                                  ESP=Ninguno,Divisi¢n entre cero,Error Periodo,Ambos];
                                                 OptionString=None,Division by Zero,Period Error,Both;
                                                 SourceExpr=ShowError }
    { 1140025;Label     ;440  ;990  ;3300 ;440  ;ParentControl=1140024 }
    { 1140026;CommandButton;14080;7700;2200;550 ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 1140027;OptionButton;2420;7700;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 Border=Yes;
                                                 BitmapPos=Center;
                                                 Bitmap=13;
                                                 ToolTipML=[ENU=Year;
                                                            ESP=A¤o];
                                                 SourceExpr=PeriodType;
                                                 OptionValue=Year;
                                                 OnPush=BEGIN
                                                          FindPeriod('');
                                                        END;
                                                         }
    { 1140028;OptionButton;1870;7700;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 Border=Yes;
                                                 BitmapPos=Center;
                                                 Bitmap=12;
                                                 ToolTipML=[ENU=Quarter;
                                                            ESP=Trimestre];
                                                 SourceExpr=PeriodType;
                                                 OptionValue=Quarter;
                                                 OnPush=BEGIN
                                                          FindPeriod('');
                                                        END;
                                                         }
    { 1140029;OptionButton;1320;7700;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 Border=Yes;
                                                 BitmapPos=Center;
                                                 Bitmap=11;
                                                 ToolTipML=[ENU=Month;
                                                            ESP=Mes];
                                                 SourceExpr=PeriodType;
                                                 OptionValue=Month;
                                                 OnPush=BEGIN
                                                          FindPeriod('');
                                                        END;
                                                         }
    { 1140030;OptionButton;770;7700 ;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 Border=Yes;
                                                 BitmapPos=Center;
                                                 Bitmap=10;
                                                 ToolTipML=[ENU=Week;
                                                            ESP=Semana];
                                                 SourceExpr=PeriodType;
                                                 OptionValue=Week;
                                                 OnPush=BEGIN
                                                          FindPeriod('');
                                                        END;
                                                         }
    { 1140031;OptionButton;220;7700 ;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 Border=Yes;
                                                 BitmapPos=Center;
                                                 Bitmap=9;
                                                 ToolTipML=[ENU=Day;
                                                            ESP=D¡a];
                                                 SourceExpr=PeriodType;
                                                 OptionValue=Day;
                                                 OnPush=BEGIN
                                                          FindPeriod('');
                                                        END;
                                                         }
    { 1140032;OptionButton;2970;7700;550  ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 Border=Yes;
                                                 BitmapPos=Center;
                                                 Bitmap=14;
                                                 ToolTipML=[ENU=Accounting Period;
                                                            ESP=Periodo contable];
                                                 SourceExpr=PeriodType;
                                                 OptionValue=Accounting Period;
                                                 OnPush=BEGIN
                                                          FindPeriod('');
                                                        END;
                                                         }
    { 1140033;CommandButton;3740;7700;550 ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 BitmapPos=Center;
                                                 AutoRepeat=Yes;
                                                 Bitmap=15;
                                                 ToolTipML=[ENU=Previous Period;
                                                            ESP=Periodo anterior];
                                                 OnPush=BEGIN
                                                          FindPeriod('<=');
                                                        END;
                                                         }
    { 1140034;CommandButton;4290;7700;550 ;550  ;VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 ShowCaption=No;
                                                 BitmapPos=Center;
                                                 AutoRepeat=Yes;
                                                 Bitmap=16;
                                                 ToolTipML=[ENU=Next Period;
                                                            ESP=Periodo siguiente];
                                                 OnPush=BEGIN
                                                          FindPeriod('>=');
                                                        END;
                                                         }
    { 1140035;MenuButton;11660;7700 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=F&unctions;
                                                            ESP=Acci&ones];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=1140036;
                                                     Ellipsis=Yes;
                                                     CaptionML=[ENU=Export Liq. Acc. Schedule to Excel;
                                                                ESP=Exportar esq. ctas. liq. a Excel];
                                                     OnPush=VAR
                                                              ExportLiqAccSchedToExcel@1140000 : Report 5055258;
                                                            BEGIN
                                                              ExportLiqAccSchedToExcel.SetOptions(Rec,CurrentColumnName);
                                                              ExportLiqAccSchedToExcel.RUN;
                                                            END;
                                                             }
                                                   { ID=1140037;
                                                     Ellipsis=Yes;
                                                     CaptionML=[ENU=Print;
                                                                ESP=Imprimir];
                                                     OnPush=VAR
                                                              LiqAccSched@1140000 : Report 5055253;
                                                              DateFilter@1140001 : Text[30];
                                                              LiquidityFilter@1140002 : Text[30];
                                                              Dim1Filter@1140003 : Text[250];
                                                              Dim2Filter@1140004 : Text[250];
                                                              Dim3Filter@1140005 : Text[250];
                                                              Dim4Filter@1140006 : Text[250];
                                                            BEGIN
                                                              LiqAccSched.SetAccSchedName(CurrentSchedName);
                                                              LiqAccSched.SetColumnLayoutName(CurrentColumnName);
                                                              DateFilter := GETFILTER("Date Filter");
                                                              LiquidityFilter := GETFILTER("Liquidity Filter");
                                                              Dim1Filter := GETFILTER("Dimension 1 Filter");
                                                              Dim2Filter := GETFILTER("Dimension 2 Filter");
                                                              Dim3Filter := GETFILTER("Dimension 3 Filter");
                                                              Dim4Filter := GETFILTER("Dimension 4 Filter");
                                                              LiqAccSched.SetFilters(DateFilter,LiquidityFilter,Dim1Filter,Dim2Filter,Dim3Filter,Dim4Filter);
                                                              LiqAccSched.RUN;
                                                            END;
                                                             }
                                                 }
                                                  }
  }
  CODE
  {
    VAR
      Text1140000@1140000 : TextConst 'ENU=DEFAULT;ESP=GENERICO';
      Text1140001@1140001 : TextConst 'ENU=* ERROR *;ESP=* ERROR *';
      Text1140002@1140002 : TextConst 'ENU=Column formula: %1;ESP=F¢rmula columna: %1';
      Text1140003@1140003 : TextConst 'ENU=Row formula: %1;ESP=F¢rmula fila: %1';
      Text1140004@1140004 : TextConst 'ENU=Not available;ESP=No disponible';
      Text1140005@1140005 : TextConst 'ENU=1,6,,Dimension %1 Filter;ESP=1,6,,Filtro dimensi¢n %1';
      TmpLiqAccSchedColumn@1140006 : TEMPORARY Record 5055264;
      LiqAccSchedName@1140007 : Record 5055261;
      LiquidityAnalysisView@1140008 : Record 5055269;
      GLSetup@1140009 : Record 98;
      LiqAccSchedManagement@1140010 : Codeunit 5055260;
      CurrentSchedName@1140011 : Code[10];
      CurrentColumnName@1140012 : Code[10];
      NewCurrentSchedName@1140013 : Code[10];
      NewCurrentColumnName@1140014 : Code[10];
      ShowError@1140015 : 'None,Division by Zero,Period Error,Both';
      PeriodType@1140016 : 'Day,Week,Month,Quarter,Year,Accounting Period';
      ColumnValue@1140017 : Decimal;

    PROCEDURE SetAccSchedName@1140000(NewAccSchedName@1140000 : Code[10]);
    VAR
      LiqAccSchedName@1140001 : Record 5055261;
    BEGIN
      NewCurrentSchedName := NewAccSchedName;
      IF LiqAccSchedName.GET(NewCurrentSchedName) THEN
        IF LiqAccSchedName."Default Column Layout" <> '' THEN
          NewCurrentColumnName := LiqAccSchedName."Default Column Layout";
    END;

    LOCAL PROCEDURE FindPeriod@1140001(SearchText@1140000 : Code[10]);
    VAR
      Calendar@1140001 : Record 2000000007;
      PeriodFormManagement@1140002 : Codeunit 359;
    BEGIN
      IF GETFILTER("Date Filter") <> '' THEN BEGIN
        Calendar.SETFILTER("Period Start",GETFILTER("Date Filter"));
        IF NOT PeriodFormManagement.FindDate('+',Calendar,PeriodType) THEN
          PeriodFormManagement.FindDate('+',Calendar,PeriodType::Day);
        Calendar.SETRANGE("Period Start");
      END;
      PeriodFormManagement.FindDate(SearchText,Calendar,PeriodType);
      SETRANGE("Date Filter",Calendar."Period Start",Calendar."Period End");
      IF GETRANGEMIN("Date Filter") = GETRANGEMAX("Date Filter") THEN
        SETRANGE("Date Filter",GETRANGEMIN("Date Filter"));
    END;

    LOCAL PROCEDURE FormLookUpDimFilter@1140002(Dim@1140000 : Code[20];VAR Text@1140001 : Text[1024]) : Boolean;
    VAR
      DimVal@1140002 : Record 349;
      DimValList@1140003 : Form 560;
    BEGIN
      IF Dim = '' THEN
        EXIT(FALSE);
      DimValList.LOOKUPMODE(TRUE);
      DimVal.SETRANGE("Dimension Code",Dim);
      DimValList.SETTABLEVIEW(DimVal);
      IF DimValList.RUNMODAL = ACTION::LookupOK THEN BEGIN
        DimValList.GETRECORD(DimVal);
        Text := DimValList.GetSelectionFilter;
        EXIT(TRUE);
      END ELSE
        EXIT(FALSE)
    END;

    LOCAL PROCEDURE FormGetCaptionClass@1140003(DimNo@1140000 : Integer) : Text[250];
    BEGIN
      CASE DimNo OF
        1:
          BEGIN
            IF LiquidityAnalysisView."Dimension 1 Code" <> '' THEN
              EXIT('1,6,' + LiquidityAnalysisView."Dimension 1 Code")
            ELSE
              EXIT(STRSUBSTNO(Text1140005,DimNo));
          END;
        2:
          BEGIN
            IF LiquidityAnalysisView."Dimension 2 Code" <> '' THEN
              EXIT('1,6,' + LiquidityAnalysisView."Dimension 2 Code")
            ELSE
              EXIT(STRSUBSTNO(Text1140005,DimNo));
          END;
        3:
          BEGIN
            IF LiquidityAnalysisView."Dimension 3 Code" <> '' THEN
              EXIT('1,6,' + LiquidityAnalysisView."Dimension 3 Code")
            ELSE
              EXIT(STRSUBSTNO(Text1140005,DimNo));
          END;
        4:
          BEGIN
            IF LiquidityAnalysisView."Dimension 4 Code" <> '' THEN
              EXIT('1,6,' + LiquidityAnalysisView."Dimension 4 Code")
            ELSE
              EXIT(STRSUBSTNO(Text1140005,DimNo));
          END;
      END;
    END;

    BEGIN
    END.
  }
}
