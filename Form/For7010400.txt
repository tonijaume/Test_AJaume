OBJECT Form 7010400 Ficha Parte
{
  OBJECT-PROPERTIES
  {
    Date=18/05/15;
    Time=13:30:25;
    Modified=Yes;
    Version List=TRANSFER;
  }
  PROPERTIES
  {
    Width=18810;
    Height=13200;
    CaptionML=ESP=Ficha Parte;
    ActiveControlOnOpen=2;
    InsertAllowed=No;
    SourceTable=Table7010360;
    DataCaptionExpr=[ "N§ Parte" + '  -  ' + STRSUBSTNO('%1', Fecha) + '  -  ' + "Codigo Servicio"];
    UpdateOnActivate=Yes;
    PopulateAllFields=No;
    OnInit=BEGIN
             rPar.FINDFIRST;
           END;

    OnOpenForm=VAR
                 rPara@1100244000 : Record 7010311;
               BEGIN

                 // AJF 25/09/08 - Migracion 501
                 // Paso el filtro de garaje del bot¢n del men£ al form.
                 FiltrarGarajeUsuario;

                 // JPT - Seg£n la opci¢n "Campo Entrada Fichas Partes" de la tabla de parametros, la ficha de
                 //       Partes al abrirse se pondr  el foco en un campo u otro.
                 IF rPara.FINDFIRST THEN BEGIN
                   IF wActivarCampo=0 THEN
                     CASE rPara."Pesta¤a Activa Partes" OF
                       rPara."Pesta¤a Activa Partes"::General : CurrForm.Referencia.ACTIVATE;
                       rPara."Pesta¤a Activa Partes"::Operativa : CurrForm.Letreros.ACTIVATE;
                       rPara."Pesta¤a Activa Partes"::Facturaci¢n : CurrForm.Proveedor.ACTIVATE;
                     END;
                   CurrForm."Paxes Previstos".VISIBLE(rPara."Control Paxes Previstos");
                   CurrForm."Calcular Otros Gastos".VISIBLE(rPara."Empresa Real"=rPara."Empresa Real"::TER);
                 END;

                 CASE wActivarCampo OF
                   1: CurrForm.Vehiculo.ACTIVATE;
                 END;

                 // Establece las propiedades editable y visible de la ventana
                 SetEditable;
               END;

    OnActivateForm=BEGIN
                     SetEditable;
                   END;

    OnAfterGetRecord=BEGIN
                       rPar.FINDFIRST;
                       // Establece las propiedades editable y visible de la ventana



                       // ----  AJS 20.03.2002  ----
                       // ----  Controlar la propiedad editable del campo Gratuito en funcion del campo Facturable  ----
                       // JPR 30/09/04 TRN pude facturar a 0

                       IF NOT (rPar."Empresa Real" IN [rPar."Empresa Real"::TRN]) THEN BEGIN
                         CurrForm.Gratuito.EDITABLE := NOT Facturable;
                       END;

                       // AJF 07/10/08
                       // No exportar no tiene que ser editable para los partes de recogida.
                       CurrForm."No Exportar".EDITABLE := ("Origen creacion" <> "Origen creacion"::"Recogida Automatica");

                       // ----  AJS 22.07.2002  ----
                       // ----  Controlar la propiedad "Busca precio pasaje x zona" en funcion de precios por  ----

                       IF "Ingreso Precios por" = "Ingreso Precios por"::"Cada zona" THEN
                         CurrForm."Busca precio pasaje x zona ing".EDITABLE := TRUE
                       ELSE
                         CurrForm."Busca precio pasaje x zona ing".EDITABLE := FALSE;

                       // AJF 01/08/08

                       IF "Coste Precios por" = "Coste Precios por"::"Cada zona" THEN
                         CurrForm."Busca precio pasaje x zona cos".EDITABLE := TRUE
                       ELSE
                         CurrForm."Busca precio pasaje x zona cos".EDITABLE := FALSE;


                       // AJF 25/03/08
                       // Mostramos label de recogida generada seg£n bool recogida generada.

                       IF "Recogida Generada" <> '' THEN
                         CurrForm.texto_recogida_generada.VISIBLE := TRUE
                       ELSE
                         CurrForm.texto_recogida_generada.VISIBLE := FALSE;

                       // AJS 10.03.2004
                       // El numero de parte no sera editable

                       IF "N§ Parte" <> '' THEN
                         CurrForm."N§ Parte".EDITABLE := FALSE;

                       SetEditable;

                       // Gestiona el bloqueo al campo fecha
                       GestCFecha;
                     END;

  }
  CONTROLS
  {
    { 1100253004;TextBox;6270 ;12430;2640 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 ForeColor=8388608;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 FontSize=9;
                                                 FontBold=Yes;
                                                 SourceExpr="Tiene Anotaciones";
                                                 OnFormat=VAR
                                                            lText00001@1100253001 : TextConst 'ESP=Anotaciones';
                                                          BEGIN
                                                            IF "Tiene Anotaciones" THEN
                                                              Text:= lText00001
                                                            ELSE
                                                              CLEAR(Text);
                                                          END;
                                                           }
    { 1100253002;CommandButton;6270;12430;2640;550;
                                                 HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 ShowCaption=No;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=ESP='';
                                                 OnPush=BEGIN
                                                          IF "Tiene Anotaciones" THEN
                                                            ShowAnotaciones;
                                                        END;
                                                         }
    { 1   ;TabControl   ;220  ;220  ;18370;6490 ;HorzGlue=Both;
                                                 VertGlue=Top;
                                                 PageNamesML=ESP=General,Operativa,Facturacion,LOGISPLAN }
    { 2   ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 CaptionML=;
                                                 SourceExpr="N§ Parte" }
    { 3   ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=2 }
    { 4   ;TextBox      ;3850 ;1650 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr=Garaje }
    { 5   ;Label        ;440  ;1650 ;3300 ;440  ;ParentControl=4 }
    { 6   ;TextBox      ;3850 ;2200 ;2090 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr=Fecha;
                                                 OnAfterValidate=BEGIN
                                                                   GestCFecha;
                                                                 END;
                                                                  }
    { 7   ;Label        ;440  ;2200 ;3300 ;440  ;ParentControl=6 }
    { 8   ;TextBox      ;3850 ;2750 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr=Cliente }
    { 9   ;Label        ;440  ;2750 ;3300 ;440  ;ParentControl=8 }
    { 10  ;TextBox      ;3850 ;3300 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Codigo Servicio" }
    { 11  ;Label        ;440  ;3300 ;3300 ;440  ;ParentControl=10 }
    { 12  ;TextBox      ;3850 ;3850 ;2750 ;440  ;Focusable=No;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Tipo Servicio" }
    { 13  ;Label        ;440  ;3850 ;3300 ;440  ;ParentControl=12 }
    { 33  ;TextBox      ;6710 ;1650 ;5170 ;440  ;Focusable=No;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr=nom_garaje }
    { 34  ;TextBox      ;6710 ;2750 ;5170 ;440  ;Focusable=No;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr=nom_cliente }
    { 35  ;TextBox      ;6710 ;3300 ;5170 ;440  ;Focusable=No;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr=nom_codigo_servicio }
    { 44  ;CheckBox     ;16060;2090 ;440  ;440  ;HorzGlue=Right;
                                                 Editable=No;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 SourceExpr=Confirmado }
    { 45  ;Label        ;12980;2090 ;2970 ;440  ;HorzGlue=Right;
                                                 ParentControl=44 }
    { 22  ;TextBox      ;3850 ;4400 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr=Referencia }
    { 23  ;Label        ;440  ;4400 ;3300 ;440  ;ParentControl=22 }
    { 59  ;TextBox      ;16060;990  ;1100 ;440  ;HorzGlue=Right;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Paxes Previstos" }
    { 60  ;Label        ;12980;990  ;2970 ;440  ;HorzGlue=Right;
                                                 ParentControl=59 }
    { 103 ;CheckBox     ;16060;1540 ;440  ;440  ;HorzGlue=Right;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 SourceExpr=Impreso }
    { 104 ;Label        ;12980;1540 ;2970 ;440  ;HorzGlue=Right;
                                                 ParentControl=103;
                                                 InPage=0;
                                                 CaptionML=ESP=Impreso }
    { 107 ;TextBox      ;16060;2640 ;2310 ;440  ;HorzGlue=Right;
                                                 Enabled=Yes;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 HorzAlign=Right;
                                                 SourceExpr=Agrupacion }
    { 108 ;Label        ;12980;2640 ;2970 ;440  ;HorzGlue=Right;
                                                 ParentControl=107;
                                                 HorzAlign=Left }
    { 1100244005;CommandButton;6050;2200;550;440;Name=Boton1;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 CaptionML=ESP=...;
                                                 OnPush=VAR
                                                          lrRangoPl@1100244000 : Record 7010430;
                                                        BEGIN
                                                          CLEAR(fCalendar);
                                                          fCalendar.RUNMODAL;

                                                          wFecha := fCalendar.GetChosenDate;
                                                          IF wFecha <> 0D THEN BEGIN
                                                            VALIDATE(Fecha, wFecha);
                                                            MODIFY;
                                                          END;
                                                          CurrForm.UPDATECONTROLS;
                                                        END;
                                                         }
    { 1100244006;TextBox;16060;3190 ;2310 ;440  ;ValidateTableRelation=Yes;
                                                 HorzGlue=Right;
                                                 Visible=Yes;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Cod Grupo";
                                                 TableRelation=Grupos."Codigo Grupo" WHERE (Cliente=FIELD(Cliente),
                                                                                            TTOO=FIELD(Touroperador principal),
                                                                                            Confirmado=CONST(Yes),
                                                                                            Facturado=CONST(No)) }
    { 1100244007;Label  ;12980;3190 ;2970 ;440  ;HorzGlue=Right;
                                                 ParentControl=1100244006 }
    { 1103350004;TextBox;16060;3740 ;2310 ;440  ;HorzGlue=Right;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="No Servicio Regular" }
    { 1103350005;Label  ;12980;3740 ;2970 ;440  ;HorzGlue=Right;
                                                 ParentControl=1103350004 }
    { 1100253000;TextBox;6710 ;990  ;5170 ;440  ;Focusable=No;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 HorzAlign=Left;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 SourceExpr=TextoImp }
    { 1100253008;TextBox;3850 ;4950 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Peticion Servicio Cliente";
                                                 OnAssistEdit=BEGIN
                                                                IF "Peticion Servicio Cliente" <> '' THEN
                                                                  cFunBas.Ense¤aDocumento("Peticion Servicio Cliente");
                                                              END;
                                                               }
    { 1100253009;Label  ;440  ;4950 ;3300 ;440  ;ParentControl=1100253008 }
    { 1100253010;TextBox;8690 ;2200 ;3190 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 HorzAlign=Center;
                                                 BackTransparent=No;
                                                 FontBold=Yes;
                                                 SourceExpr="Origen creacion" }
    { 1100253011;CheckBox;16060;4290;440  ;440  ;HorzGlue=Right;
                                                 ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 SourceExpr="Tiene Anotaciones" }
    { 1100253012;Label  ;12980;4290 ;2970 ;440  ;HorzGlue=Right;
                                                 ParentControl=1100253011 }
    { 1100253013;TextBox;3850 ;5500 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 HorzAlign=Center;
                                                 FontBold=Yes;
                                                 SourceExpr=Usuario }
    { 1100253014;Label  ;440  ;5500 ;3300 ;440  ;ParentControl=1100253013;
                                                 CaptionML=ESP=Datos creacion }
    { 1100253015;TextBox;6710 ;5500 ;1700 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 HorzAlign=Center;
                                                 FontBold=Yes;
                                                 SourceExpr="Fecha creacion" }
    { 1103355022;TextBox;6710 ;2200 ;1870 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 FontBold=No;
                                                 SourceExpr="Fecha Real";
                                                 OnFormat=BEGIN
                                                            CurrForm."Fecha Real".UPDATEFONTBOLD(Fecha <> "Fecha Real");
                                                          END;
                                                           }
    { 14  ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr=Vehiculo }
    { 15  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=14 }
    { 18  ;TextBox      ;15840;990  ;1100 ;440  ;HorzGlue=Right;
                                                 ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Hora inicio";
                                                 Format=<Hours24,2>:<Minutes,2> }
    { 19  ;Label        ;12540;990  ;3190 ;440  ;HorzGlue=Right;
                                                 ParentControl=18;
                                                 CaptionML=ESP=Horario }
    { 36  ;TextBox      ;6710 ;990  ;1760 ;440  ;Editable=No;
                                                 Focusable=Yes;
                                                 ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="N§ Vehiculo" }
    { 24  ;TextBox      ;3850 ;3190 ;8030 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr=Observaciones }
    { 25  ;Label        ;440  ;3190 ;3300 ;440  ;ParentControl=24 }
    { 20  ;TextBox      ;15840;3190 ;2530 ;440  ;HorzGlue=Right;
                                                 ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr=Guia }
    { 21  ;Label        ;12540;3190 ;3190 ;440  ;HorzGlue=Right;
                                                 ParentControl=20 }
    { 26  ;TextBox      ;3850 ;3740 ;7590 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr=Letreros }
    { 27  ;Label        ;440  ;3740 ;3300 ;440  ;ParentControl=26 }
    { 30  ;TextBox      ;8580 ;990  ;3300 ;440  ;Focusable=No;
                                                 ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Tipo Vehiculo";
                                                 OnFormat=BEGIN

                                                            IF "Vehiculo Agregado" THEN
                                                              Text += Text005;
                                                          END;
                                                           }
    { 74  ;TextBox      ;17050;990  ;1100 ;440  ;HorzGlue=Right;
                                                 ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Hora final";
                                                 Format=<Hours24,2>:<Minutes,2> }
    { 84  ;TextBox      ;3850 ;4290 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Origen/Destino" }
    { 85  ;Label        ;440  ;4290 ;3300 ;440  ;ParentControl=84 }
    { 53  ;TextBox      ;3850 ;2640 ;8030 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr=Vuelos }
    { 54  ;Label        ;440  ;2640 ;3300 ;440  ;ParentControl=53 }
    { 105 ;TextBox      ;15840;2640 ;1100 ;440  ;HorzGlue=Right;
                                                 ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Hora 1er Vuelo";
                                                 Format=<Hours24,2>:<Minutes,2> }
    { 106 ;Label        ;12540;2640 ;3190 ;440  ;HorzGlue=Right;
                                                 ParentControl=105 }
    { 37  ;TextBox      ;6710 ;1540 ;5170 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr=Conductor }
    { 16  ;TextBox      ;3850 ;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Cod Conductor" }
    { 17  ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=16 }
    { 31  ;TextBox      ;3850 ;2090 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr=Proveedor }
    { 62  ;Label        ;440  ;2090 ;3300 ;440  ;ParentControl=31 }
    { 67  ;TextBox      ;6710 ;2090 ;5170 ;440  ;Editable=No;
                                                 Focusable=No;
                                                 ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr=nom_proveedor }
    { 117 ;TextBox      ;15840;4290 ;2530 ;440  ;Name=Fecha2;
                                                 HorzGlue=Right;
                                                 ParentControl=1;
                                                 InPage=1;
                                                 HorzAlign=General;
                                                 FontSize=8;
                                                 FontBold=No;
                                                 CaptionML=ESP=Fecha;
                                                 SourceExpr=Fecha }
    { 1100244000;TextBox;6710 ;4290 ;5170 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr=Presentacion }
    { 1100244001;TextBox;15840;1540 ;2530 ;440  ;HorzGlue=Right;
                                                 ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Touroperador principal";
                                                 OnValidate=BEGIN
                                                              //BRM Actualizar CodTPR
                                                              IF rCliTo.GET(Cliente,"Touroperador principal") THEN
                                                                Actualiza_CodTPR(rCliTo);
                                                            END;
                                                             }
    { 1100244002;Label  ;12540;1540 ;3190 ;440  ;HorzGlue=Right;
                                                 ParentControl=1100244001 }
    { 1100244010;CheckBox;15840;4840;440  ;440  ;HorzGlue=Right;
                                                 ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 SourceExpr="Dia siguiente" }
    { 1100244011;Label  ;12540;4840 ;3190 ;440  ;HorzGlue=Right;
                                                 ParentControl=1100244010 }
    { 1103350008;TextBox;3850 ;4840 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="N§ viajes" }
    { 1103350009;Label  ;440  ;4840 ;3300 ;440  ;ParentControl=1103350008 }
    { 1103350007;Label  ;12540;4290 ;3190 ;440  ;HorzGlue=Right;
                                                 ParentControl=117;
                                                 InPage=1 }
    { 1103350011;TextBox;15840;2090 ;2530 ;440  ;HorzGlue=Right;
                                                 Editable=No;
                                                 ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr=Gestor }
    { 1103350012;Label  ;12540;2090 ;3190 ;440  ;HorzGlue=Right;
                                                 ParentControl=1103350011 }
    { 1103350013;TextBox;8030 ;4840 ;1650 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr=Kms }
    { 1103350014;Label  ;6710 ;4840 ;1210 ;440  ;ParentControl=1103350013 }
    { 1100253006;CheckBox;11550;3740;550  ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 Border=No;
                                                 ToolTipML=ESP=Imprimir Letreros;
                                                 SourceExpr="Imprimir Letreros" }
    { 1103355000;CheckBox;3850;5940 ;440  ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 SourceExpr="Vehiculo Escolar" }
    { 1103355001;Label  ;440  ;5940 ;3300 ;440  ;ParentControl=1103355000 }
    { 1103355002;CheckBox;7920;5940 ;440  ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 SourceExpr="Vehiculo Minusvalidos" }
    { 1103355003;Label  ;4510 ;5940 ;3300 ;440  ;ParentControl=1103355002 }
    { 1103355008;CheckBox;15840;5390;440  ;440  ;HorzGlue=Right;
                                                 ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 SourceExpr=Privado }
    { 1103355009;Label  ;12540;5390 ;3190 ;440  ;HorzGlue=Right;
                                                 ParentControl=1103355008 }
    { 1103355007;TextBox;15840;3740 ;2530 ;440  ;HorzGlue=Right;
                                                 ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr=Finalizacion }
    { 1103355010;Label  ;12540;3740 ;3190 ;440  ;HorzGlue=Right;
                                                 ParentControl=1103355007 }
    { 1103355011;TextBox;3850 ;5390 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Plaza Parking" }
    { 1103355012;Label  ;440  ;5390 ;3300 ;440  ;ParentControl=1103355011 }
    { 1103355013;CheckBox;11550;5940;440  ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 SourceExpr="Vehiculo especial" }
    { 1103355014;Label  ;8580 ;5940 ;2860 ;440  ;ParentControl=1103355013 }
    { 1103355020;TextBox;10120;5390 ;1700 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Shuttle Time";
                                                 Format=<Hours24,2>:<Minutes,2> }
    { 1103355021;Label  ;6710 ;5390 ;3300 ;440  ;ParentControl=1103355020 }
    { 1000000000;CheckBox;15620;5940;440  ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 ShowCaption=No;
                                                 SourceExpr="Vehiculo Microbus" }
    { 1000000001;Label  ;12210;5940 ;3300 ;440  ;ParentControl=1000000000 }
    { 63  ;TextBox      ;4180 ;1540 ;1650 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Fecha facturacion" }
    { 64  ;Label        ;440  ;1540 ;3630 ;440  ;ParentControl=63 }
    { 65  ;TextBox      ;4180 ;2090 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Tipo Vehiculo facturacion" }
    { 66  ;Label        ;440  ;2090 ;3630 ;440  ;ParentControl=65 }
    { 55  ;CheckBox     ;4180 ;4840 ;440  ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 ShowCaption=No;
                                                 SourceExpr=Errores }
    { 56  ;Label        ;440  ;4840 ;3630 ;440  ;ParentControl=55 }
    { 61  ;CheckBox     ;4180 ;3190 ;440  ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 ShowCaption=No;
                                                 SourceExpr="Calcular maletas" }
    { 87  ;Label        ;440  ;3190 ;3630 ;440  ;ParentControl=61 }
    { 88  ;CheckBox     ;4180 ;3740 ;440  ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 ShowCaption=No;
                                                 SourceExpr=Facturable;
                                                 OnAfterValidate=BEGIN
                                                                   // ----  AJS 20.03.2002  ----
                                                                   // ----  Controlar la propiedad editable del campo Gratuito en funcion del campo Facturable  ----
                                                                   rPar.FINDFIRST;
                                                                   IF NOT (rPar."Empresa Real" IN [rPar."Empresa Real"::TRN]) THEN BEGIN
                                                                     CurrForm.Gratuito.EDITABLE := NOT Facturable;
                                                                   END;
                                                                 END;
                                                                  }
    { 89  ;Label        ;440  ;3740 ;3630 ;440  ;ParentControl=88 }
    { 92  ;CheckBox     ;15620;2640 ;440  ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 ShowCaption=No;
                                                 SourceExpr="Busca precio pasaje x zona ing" }
    { 93  ;Label        ;11330;2640 ;4180 ;440  ;ParentControl=92 }
    { 90  ;TextBox      ;15620;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Ingreso Precios por";
                                                 OnValidate=BEGIN

                                                              // ----  AJS 22.07.2002  ----
                                                              // ----  Controlar la propiedad "Busca precio pasaje x zona" en funcion de precios por  ----

                                                              IF "Ingreso Precios por" = "Ingreso Precios por"::"Cada zona" THEN
                                                                CurrForm."Busca precio pasaje x zona ing".EDITABLE := TRUE
                                                              ELSE
                                                                CurrForm."Busca precio pasaje x zona ing".EDITABLE := FALSE;
                                                            END;
                                                             }
    { 91  ;Label        ;12430;1540 ;3080 ;440  ;ParentControl=90 }
    { 113 ;TextBox      ;4180 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr=Proveedor }
    { 115 ;Label        ;440  ;990  ;3630 ;440  ;ParentControl=113 }
    { 114 ;TextBox      ;7040 ;990  ;4950 ;440  ;Editable=No;
                                                 Focusable=No;
                                                 ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr=nom_proveedor }
    { 116 ;CheckBox     ;4180 ;4290 ;440  ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 ShowCaption=No;
                                                 SourceExpr=Gratuito }
    { 119 ;Label        ;440  ;4290 ;3630 ;440  ;ParentControl=116 }
    { 95  ;TextBox      ;15620;3190 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Tipo calculo coste" }
    { 96  ;Label        ;12430;3190 ;3080 ;440  ;ParentControl=95 }
    { 46  ;TextBox      ;15620;2090 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Busca precio ingreso" }
    { 47  ;Label        ;12430;2090 ;3080 ;440  ;ParentControl=46 }
    { 1100244008;TextBox;4180 ;2640 ;2750 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Zona trabajo" }
    { 1100244009;Label  ;440  ;2640 ;3630 ;440  ;ParentControl=1100244008 }
    { 1103350000;TextBox;15620;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Tipo Calculo Ingresos" }
    { 1103350001;Label  ;12430;990  ;3080 ;440  ;ParentControl=1103350000 }
    { 1103350006;TextBox;15620;3740 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Coste Precios por";
                                                 OnValidate=BEGIN
                                                              // AJF 01/08/08

                                                              IF "Coste Precios por" = "Coste Precios por"::"Cada zona" THEN
                                                                CurrForm."Busca precio pasaje x zona cos".EDITABLE := TRUE
                                                              ELSE
                                                                CurrForm."Busca precio pasaje x zona cos".EDITABLE := FALSE;
                                                            END;
                                                             }
    { 1103350010;Label  ;12430;3740 ;3080 ;440  ;ParentControl=1103350006 }
    { 1103355005;CheckBox;15620;4840;440  ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 ShowCaption=No;
                                                 ToolTipML=ESP=Calculo de Agua y Toallas;
                                                 SourceExpr="Calcular Otros Gastos" }
    { 1103355006;Label  ;12430;4840 ;3080 ;440  ;ParentControl=1103355005 }
    { 1103355019;CheckBox;15620;4290;440  ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 ShowCaption=No;
                                                 SourceExpr="Busca precio pasaje x zona cos" }
    { 1103355018;Label  ;11330;4290 ;4180 ;440  ;ParentControl=1103355019 }
    { 1100244013;CheckBox;3850;990  ;440  ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 ShowCaption=No;
                                                 SourceExpr="No Exportar" }
    { 1100244014;Label  ;440  ;990  ;3300 ;440  ;ParentControl=1100244013 }
    { 32  ;CommandButton;16390;12430;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 39  ;SubForm      ;220  ;6930 ;18370;5280 ;Name=SubHotPar;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Border=No;
                                                 SubFormID=Form7010402;
                                                 SubFormView=SORTING(N§ Parte,N§ Linea)
                                                             ORDER(Ascending);
                                                 SubFormLink=N§ Parte=FIELD(N§ Parte) }
    { 72  ;MenuButton   ;11550;12430;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=ESP=&Lineas;
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=73;
                                                     CaptionML=ESP=Historia;
                                                     OnPush=VAR
                                                              rSerPar@1100244001 : Record 7010359;
                                                              rHist@1100244002 : Record 7010361;
                                                              fTabHisSerPar@1100244003 : Form 7010403;
                                                            BEGIN
                                                              rSerPar.RESET; rSerPar.INIT;
                                                              CurrForm.SubHotPar.FORM.pasa_registro(rSerPar);
                                                              rHist.RESET; rHist.INIT;
                                                              rHist.SETRANGE("Tipo Fichero", rHist."Tipo Fichero"::Linea);
                                                              rHist.SETRANGE("N§"          , rSerPar."N§ Servicio");
                                                              rHist.SETRANGE("N§ Linea"    , rSerPar."N§ Linea");
                                                              CLEAR(fTabHisSerPar);
                                                              fTabHisSerPar.SETTABLEVIEW(rHist);
                                                              fTabHisSerPar.RUNMODAL;
                                                            END;
                                                             }
                                                   { ID=38;
                                                     ShortCutKey=Ctrl+S;
                                                     CaptionML=ESP=Suplementos;
                                                     OnPush=VAR
                                                              rSerPar@1100244001 : Record 7010359;
                                                              rSuplLin@1100244002 : Record 7010363;
                                                              fTabSupl@1100244003 : Form 7010408;
                                                            BEGIN
                                                              rSerPar.RESET; rSerPar.INIT;
                                                              CurrForm.SubHotPar.FORM.pasa_registro(rSerPar);
                                                              CLEAR(fTabSupl);

                                                              // No mostramos nada si a£n no se ha creado la linea
                                                              IF rSerPar."N§ Linea"=0 THEN
                                                                EXIT;

                                                              rSuplLin.RESET; rSuplLin.INIT;
                                                              rSuplLin.FILTERGROUP(2);
                                                              rSuplLin.SETRANGE("N§ Servicio", rSerPar."N§ Servicio");
                                                              rSuplLin.SETRANGE("N§ Linea"   , rSerPar."N§ Linea");
                                                              rSuplLin.SETRANGE("N§ Parte"   , rSerPar."N§ Parte");
                                                              rSuplLin.FILTERGROUP(0);

                                                              fTabSupl.SETTABLEVIEW(rSuplLin);
                                                              fTabSupl.RUNMODAL;
                                                            END;
                                                             }
                                                   { ID=1103355004;
                                                     CaptionML=ESP=Vuelos;
                                                     OnPush=VAR
                                                              lrVuelLin@1103355000 : Record 7035397;
                                                            BEGIN
                                                              CLEAR(rSerPar);
                                                              CurrForm.SubHotPar.FORM.pasa_registro(rSerPar);
                                                              CLEAR(lrVuelLin);
                                                              lrVuelLin.SETCURRENTKEY("N§ Servicio", "N§ Linea");
                                                              lrVuelLin.FILTERGROUP(2);
                                                              lrVuelLin.SETRANGE(Tipo, lrVuelLin.Tipo::Servicio);
                                                              lrVuelLin.SETRANGE("N§ Servicio", rSerPar."N§ Servicio");
                                                              lrVuelLin.SETRANGE("N§ Linea"   , rSerPar."N§ Linea");
                                                              lrVuelLin.FILTERGROUP(0);
                                                              FORM.RUN(0,lrVuelLin);
                                                            END;
                                                             }
                                                   { ID=52;
                                                     CaptionML=ESP=Servicio asociado;
                                                     OnPush=VAR
                                                              rSerPar@1100244001 : Record 7010359;
                                                              rSer@1100244002 : Record 7010358;
                                                              fFicSer@1100244003 : Form 7010397;
                                                            BEGIN
                                                              rSerPar.RESET; rSerPar.INIT;
                                                              CurrForm.SubHotPar.FORM.pasa_registro(rSerPar);

                                                              rSer.RESET; rSer.INIT;
                                                              rSer.GET(rSerPar."N§ Servicio");

                                                              rSer.SETRECFILTER;
                                                              CLEAR(fFicSer);
                                                              fFicSer.SETTABLEVIEW(rSer);
                                                              fFicSer.RUNMODAL;
                                                            END;
                                                             }
                                                   { ID=1100253003;
                                                     CaptionML=ESP=Documento Descriptivo;
                                                     OnPush=VAR
                                                              lrPunt@1100253000 : Record 7010315;
                                                            BEGIN
                                                              rSerPar.RESET; rSerPar.INIT;
                                                              CurrForm.SubHotPar.FORM.pasa_registro(rSerPar);
                                                              IF lrPunt.GET(rSerPar."Punto recogida") THEN
                                                                lrPunt.Ense¤aDocumentoDescriptivo;
                                                            END;
                                                             }
                                                   { ID=1100253005;
                                                     CaptionML=ESP=Imprimir Documento Descriptivo;
                                                     OnPush=VAR
                                                              lrPunt@1100253000 : Record 7010315;
                                                              lwText@1100253002 : ARRAY [5] OF Text[250];
                                                            BEGIN
                                                              rSerPar.RESET; rSerPar.INIT;
                                                              CurrForm.SubHotPar.FORM.pasa_registro(rSerPar);
                                                              IF lrPunt.GET(rSerPar."Punto recogida") THEN BEGIN
                                                                lwText[1] := STRSUBSTNO(Text009, rSerPar."N§ Parte");
                                                                lrPunt.ImprimeDocumentoDescriptivo(lwText);
                                                              END;
                                                            END;
                                                             }
                                                   { ID=121;
                                                     MenuItemType=Separator;
                                                     CaptionML=ESP="" }
                                                   { ID=122;
                                                     ShortCutKey=Ctrl+K;
                                                     CaptionML=ESP=Bloquear;
                                                     OnPush=VAR
                                                              lrSerPar@1100244001 : Record 7010359;
                                                            BEGIN
                                                              lrSerPar.RESET; lrSerPar.INIT;
                                                              CurrForm.SubHotPar.FORM.pasa_Sel(lrSerPar);
                                                              IF lrSerPar.FINDSET(TRUE) THEN BEGIN
                                                                REPEAT
                                                                  lrSerPar.VALIDATE("Linea Manual", NOT(lrSerPar."Linea Manual"));
                                                                  lrSerPar.VALIDATE("Adultos invitados ingreso", lrSerPar."Adultos transportados");
                                                                  lrSerPar.VALIDATE("Ni¤os invitados ingreso"  , lrSerPar."Ni¤os transportados");
                                                                  lrSerPar.MODIFY(TRUE);
                                                                UNTIL lrSerPar.NEXT =0;

                                                                lrSerPar.CompruebaBloqueados(lrSerPar);

                                                                // AJS 14.12.2004
                                                                // Tambien marcamos Busca precio ingreso como "Pasaje independiente"

                                                                "Busca precio ingreso" := "Busca precio ingreso"::"Pasaje independiente";
                                                                MODIFY;
                                                              END;
                                                            END;
                                                             }
                                                 }
                                                  }
    { 28  ;MenuButton   ;13970;12430;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=ESP=&Partes;
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=48;
                                                     ShortCutKey=F5;
                                                     CaptionML=ESP=Lista;
                                                     OnPush=BEGIN
                                                              rParte.COPY(Rec);

                                                              CLEAR(fListaParte);
                                                              fListaParte.LlamadaAsignacion(FALSE);
                                                              fListaParte.SETTABLEVIEW(rParte);
                                                              fListaParte.LOOKUPMODE(TRUE);
                                                              fListaParte.EDITABLE(FALSE);
                                                              IF fListaParte.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                fListaParte.RetornaRegistro(rParte);
                                                                Rec.COPY(rParte);
                                                              END;
                                                            END;
                                                             }
                                                   { ID=49;
                                                     PushAction=RunObject;
                                                     CaptionML=ESP=Historia;
                                                     RunObject=Form 7010403;
                                                     RunFormView=SORTING(Tipo Fichero,N§,N§ Linea);
                                                     RunFormLink=Tipo Fichero=CONST(Parte),
                                                                 N§=FIELD(N§ Parte) }
                                                   { ID=51;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Ctrl+T;
                                                     CaptionML=ESP=Touroperadores;
                                                     RunObject=Form 7010410;
                                                     RunFormLink=N§ Parte=FIELD(N§ Parte) }
                                                   { ID=68;
                                                     PushAction=RunObject;
                                                     CaptionML=ESP=Extras;
                                                     RunObject=Form 7010405;
                                                     RunFormView=SORTING(N§ Parte,N§ Extra);
                                                     RunFormLink=N§ Parte=FIELD(N§ Parte);
                                                     OnPush=VAR
                                                              lrExtas@1100244001 : Record 7010362;
                                                              lFTablaExtras@1100244002 : Form 7010405;
                                                            BEGIN
                                                            END;
                                                             }
                                                   { ID=29;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Ctrl+V;
                                                     CaptionML=ESP=Vuelos x Parte;
                                                     RunObject=Form 7035352;
                                                     RunFormLink=N§Parte=FIELD(N§ Parte),
                                                                 Codigo Planing=FIELD(Agrupacion) }
                                                   { ID=1100253001;
                                                     ShortCutKey=Ctrl+N;
                                                     CaptionML=ESP=Anotaciones;
                                                     OnPush=BEGIN
                                                              ShowAnotaciones;
                                                            END;
                                                             }
                                                   { ID=69;
                                                     MenuItemType=Separator;
                                                     CaptionML=ESP="" }
                                                   { ID=70;
                                                     Visible=No;
                                                     CaptionML=ESP=Buscar vehiculo;
                                                     OnPush=VAR
                                                              rVeh@1100244001 : Record 7010346;
                                                              rParte@1100244002 : Record 7010360;
                                                              ventana@1100244003 : Dialog;
                                                              fTabVeh@1100244004 : Form 7010382;
                                                            BEGIN
                                                              rVeh.RESET; rVeh.INIT;
                                                              rParte.RESET; rParte.INIT;
                                                              rParte.SETCURRENTKEY(Fecha,
                                                                                   Vehiculo,
                                                                                   "Hora inicio");
                                                              rParte.SETRANGE(Fecha , Fecha);
                                                              rParte.SETRANGE(Garaje, Garaje);
                                                              IF rVeh.FINDSET THEN BEGIN
                                                                ventana.OPEN(text1 + '\' +
                                                                             '\' +
                                                                             text2 + ' #1########');
                                                                REPEAT
                                                                  ventana.UPDATE(1, rVeh.Matricula);
                                                                  rParte.SETRANGE (Vehiculo     , rVeh.Matricula);
                                                                  rParte.SETFILTER("Hora inicio", '<=%1', "Hora inicio");
                                                                  rParte.SETFILTER("Hora final" , Text50000, "Hora inicio");
                                                                  IF NOT rParte.FINDFIRST THEN
                                                                    rVeh.MARK(TRUE);
                                                                UNTIL rVeh.NEXT = 0;
                                                                ventana.CLOSE;
                                                              END;
                                                              rVeh.MARKEDONLY(TRUE);
                                                              IF rVeh.FINDFIRST THEN BEGIN
                                                               CLEAR(fTabVeh);
                                                               fTabVeh.SETTABLEVIEW(rVeh);
                                                               fTabVeh.LOOKUPMODE(TRUE);
                                                               fTabVeh.RUNMODAL;
                                                              END
                                                              ELSE
                                                                ERROR(err1);
                                                            END;
                                                             }
                                                   { ID=71;
                                                     Visible=No;
                                                     CaptionML=ESP=Buscar conductor;
                                                     OnPush=VAR
                                                              rCond@1100244001 : Record 7010327;
                                                              rParte@1100244002 : Record 7010360;
                                                              ventana@1100244003 : Dialog;
                                                              fTabCond@1100244004 : Form 7010341;
                                                            BEGIN
                                                              rCond.RESET; rCond.INIT;
                                                              rParte.RESET; rParte.INIT;
                                                              rParte.SETCURRENTKEY(Fecha,
                                                                                   Vehiculo,
                                                                                   "Hora inicio");
                                                              rParte.SETRANGE(Fecha , Fecha);
                                                              rParte.SETRANGE(Garaje, Garaje);
                                                              IF rCond.FINDSET THEN BEGIN
                                                                ventana.OPEN(text1 + '\' +
                                                                             '\' +
                                                                             text2 + ' #1########');
                                                                REPEAT
                                                                  ventana.UPDATE(1, rCond.Conductor);
                                                                  rParte.SETRANGE ("Cod Conductor"    , rCond.Conductor);
                                                                  rParte.SETFILTER("Hora inicio", '<=%1', "Hora inicio");
                                                                  rParte.SETFILTER("Hora final" , Text50000, "Hora inicio");
                                                                  IF NOT rParte.FINDFIRST THEN
                                                                    rCond.MARK(TRUE);
                                                                UNTIL rCond.NEXT = 0;
                                                                ventana.CLOSE;
                                                              END;
                                                              rCond.MARKEDONLY(TRUE);
                                                              IF rCond.FINDFIRST THEN BEGIN
                                                               CLEAR(fTabCond);
                                                               fTabCond.SETTABLEVIEW(rCond);
                                                               fTabCond.LOOKUPMODE(TRUE);
                                                               fTabCond.RUNMODAL;
                                                              END
                                                              ELSE
                                                                ERROR(err1);
                                                            END;
                                                             }
                                                   { ID=76;
                                                     ShortCutKey=Ctrl+O;
                                                     CaptionML=ESP=T&otalizar por Letras;
                                                     OnPush=VAR
                                                              rSP@1100244001 : Record 7010359;
                                                              rT@1100244002 : Record 7010367;
                                                              vTotAD@1100244003 : Decimal;
                                                              vTotNI@1100244004 : Decimal;
                                                            BEGIN
                                                              // Totalizar por Letras
                                                              rT.RESET;
                                                              rT.SETCURRENTKEY(Usuario,Orden,"Hora Vuelo",Vuelo,Letra);
                                                              rT.SETRANGE(Usuario,USERID);
                                                              rT.DELETEALL;

                                                              vTotAD := 0;
                                                              vTotNI := 0;

                                                              rSP.RESET;
                                                              rSP.SETCURRENTKEY("N§ Parte");
                                                              rSP.SETRANGE("N§ Parte","N§ Parte");
                                                              IF rSP.FINDSET THEN REPEAT
                                                                rT.SETRANGE("Hora Vuelo",rSP."Hora Vuelo");
                                                                rT.SETRANGE(Vuelo,rSP.Vuelo);
                                                                rT.SETRANGE(Letra,rSP.Letra);
                                                                IF NOT rT.FINDFIRST THEN BEGIN
                                                                  rT.INIT;
                                                                  rT."Hora Vuelo" := rSP."Hora Vuelo";
                                                                  rT.Vuelo        := rSP.Vuelo;
                                                                  rT.Letra        := rSP.Letra;
                                                                  rT.Orden        := 1;
                                                                  rT.INSERT(TRUE);
                                                                END;

                                                                vTotAD += rSP."Adultos transportados";
                                                                vTotNI += rSP."Ni¤os transportados";

                                                                rT."Adultos Transportados" += rSP."Adultos transportados";
                                                                rT."Ni¤os Transportados"   += rSP."Ni¤os transportados";
                                                                rT.Transportados           := rT."Adultos Transportados" + rT."Ni¤os Transportados";
                                                                rT.MODIFY;

                                                              UNTIL rSP.NEXT=0;

                                                              rT.SETRANGE("Hora Vuelo");
                                                              rT.SETRANGE(Vuelo);
                                                              rT.SETRANGE(Letra);

                                                              //Grabamos el registro de TOTAL.
                                                              rT.INIT;
                                                              rT."Hora Vuelo" := 0T;
                                                              rT.Vuelo        := '';
                                                              rT.Letra        := Text000;
                                                              rT.Orden        := 2;
                                                              rT."Adultos Transportados" := vTotAD;
                                                              rT."Ni¤os Transportados"   := vTotNI;
                                                              rT.Transportados           := rT."Adultos Transportados" + rT."Ni¤os Transportados";
                                                              rT.INSERT(TRUE);

                                                              FORM.RUN(7010416,rT);
                                                            END;
                                                             }
                                                   { ID=50;
                                                     ShortCutKey=Ctrl+F;
                                                     CaptionML=ESP=Cambiar fecha parte;
                                                     OnPush=BEGIN
                                                              CambiarFechaParte;
                                                            END;
                                                             }
                                                   { ID=1100244012;
                                                     ShortCutKey=Ctrl+D;
                                                     CaptionML=ESP=Mostrar Productos;
                                                     OnPush=BEGIN

                                                              cFun.MostrarProductos(Rec);
                                                            END;
                                                             }
                                                   { ID=77;
                                                     MenuItemType=Separator;
                                                     CaptionML=ESP="" }
                                                   { ID=78;
                                                     ShortCutKey=F9;
                                                     CaptionML=ESP=Calcular Margenes;
                                                     OnPush=BEGIN
                                                              COMMIT;
                                                              cFun.calculo_margenes(Rec);
                                                            END;
                                                             }
                                                   { ID=79;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Ctrl+R;
                                                     CaptionML=ESP=Errores;
                                                     RunObject=Form 7010474;
                                                     RunFormLink=N§ Parte=FIELD(N§ Parte) }
                                                   { ID=80;
                                                     PushAction=RunObject;
                                                     CaptionML=ESP=Zonas precios;
                                                     RunObject=Form 7010409;
                                                     RunFormLink=N§ Parte=FIELD(N§ Parte) }
                                                   { ID=86;
                                                     Visible=No;
                                                     CaptionML=ESP=Consultar margenes;
                                                     OnPush=VAR
                                                              lrMar@1100244001 : Record 7010412;
                                                              fTabMar@1100244002 : Form 7010495;
                                                            BEGIN
                                                              lrMar.RESET;
                                                              lrMar.FILTERGROUP(2);
                                                              lrMar.SETRANGE(Usuario   , USERID);
                                                              lrMar.SETRANGE("N§ Parte", "N§ Parte");
                                                              lrMar.FILTERGROUP(0);

                                                              CLEAR(fTabMar);
                                                              fTabMar.SETTABLEVIEW(lrMar);
                                                              fTabMar.RUNMODAL;
                                                            END;
                                                             }
                                                   { ID=1103355016;
                                                     CaptionML=ESP=Parte de Recogida;
                                                     OnPush=VAR
                                                              lfFichaParte@1103355001 : Form 7010400;
                                                              lrParte@1103355000 : Record 7010360;
                                                            BEGIN
                                                              IF ("Recogida Generada" = '') THEN BEGIN
                                                                IF CONFIRM(cnf001, FALSE) THEN BEGIN
                                                                  GenerarParteRecogida;
                                                                END
                                                                ELSE
                                                                  EXIT;
                                                              END;

                                                              IF lrParte.GET("Recogida Generada") THEN BEGIN
                                                                lfFichaParte.SETRECORD(lrParte);
                                                                lfFichaParte.RUN;
                                                              END;
                                                            END;
                                                             }
                                                   { ID=1103350003;
                                                     ShortCutKey=Ctrl+Z;
                                                     CaptionML=ESP=Ver PDF;
                                                     OnPush=BEGIN
                                                              VerPDF;
                                                            END;
                                                             }
                                                   { ID=94;
                                                     MenuItemType=Separator;
                                                     CaptionML=ESP="" }
                                                   { ID=110;
                                                     ShortCutKey=Ctrl+P;
                                                     CaptionML=ESP=&Parte de Trabajo;
                                                     OnPush=VAR
                                                              rParte@1100244001 : Record 7010360;
                                                              rInf@1100244002 : Record 2000000001;
                                                              rPar@1100244003 : Record 7010311;
                                                              vIdInforme@1100244004 : Integer;
                                                            BEGIN
                                                              rParte.RESET;
                                                              rParte.SETRANGE(Fecha     , Fecha);
                                                              rParte.SETRANGE("N§ Parte", "N§ Parte");

                                                              vIdInforme := 7000198;

                                                              rPar.FINDFIRST;
                                                              IF rInf.GET(rInf.Type::Report, '', rPar."Informe partes trabajo") THEN
                                                                vIdInforme := rInf.ID;

                                                              //IF CONFIRM(Text001) THEN
                                                                REPORT.RUN(vIdInforme, TRUE, TRUE, rParte);
                                                            END;
                                                             }
                                                   { ID=120;
                                                     ShortCutKey=Ctrl+I;
                                                     CaptionML=ESP=Hoja de trabajo &IATA;
                                                     OnPush=VAR
                                                              rCT@1100244001 : Record 7010420;
                                                              rParte@1100244002 : Record 7010360;
                                                              rInf@1100244003 : Record 7035384;
                                                              rPar@1100244004 : Record 7010311;
                                                              vIdInforme@1100244005 : Integer;
                                                            BEGIN

                                                              vIdInforme := 7000191;
                                                              rPar.FINDFIRST;
                                                              IF rInf.GET(rPar."Informe Hoja IATA") THEN
                                                                vIdInforme := rInf."Id. Informe";

                                                              IF vIdInforme=7000193 THEN BEGIN
                                                                rCT.INIT;
                                                                IF NOT rCT.GET(USERID) THEN BEGIN
                                                                  rCT.Usuario := USERID;
                                                                  rCT.INSERT(TRUE);
                                                                END;
                                                                rCT."Fecha IATA" := Fecha;
                                                                rCT."Codigo Servicio IATA" := "Codigo Servicio";
                                                                rCT.MODIFY;
                                                                REPORT.RUN(7010327,TRUE)
                                                              END
                                                              ELSE BEGIN
                                                                rParte.RESET;
                                                                rParte.SETRANGE(Fecha,Fecha);
                                                                REPORT.RUN(vIdInforme,TRUE,FALSE,rParte)
                                                              END;
                                                            END;
                                                             }
                                                   { ID=1103350002;
                                                     ShortCutKey=Ctrl+W;
                                                     CaptionML=ESP=Impresi¢n Codigo Barras;
                                                     OnPush=VAR
                                                              lrParte@1103350000 : Record 7010360;
                                                            BEGIN
                                                              lrParte:= Rec;
                                                              lrParte.SETRECFILTER;
                                                              REPORT.RUNMODAL(7010412,FALSE,FALSE,lrParte);
                                                            END;
                                                             }
                                                   { ID=1100253007;
                                                     CaptionML=ESP=Impresi¢n Letreros;
                                                     OnPush=BEGIN
                                                              ImprimeLetrero(TRUE,TRUE);
                                                            END;
                                                             }
                                                 }
                                                  }
    { 1100244003;CommandButton;880;12430;550;550;VertGlue=Bottom;
                                                 ShowCaption=No;
                                                 BitmapPos=Center;
                                                 Bitmap=16;
                                                 OnPush=BEGIN
                                                          CurrForm.SubHotPar.FORM.pasa_registro(rSerPar);

                                                          rSerPar2.COPY(rSerPar);
                                                          IF rSerPar2.NEXT = 0 THEN
                                                            ERROR(Text004);

                                                          rSerPar3.COPY(rSerPar2);

                                                          IF rSerPar3.NEXT = 0 THEN
                                                            wNumLinea := ROUND( (rSerPar2."N§ Linea" + 9999999) / 2, 1)
                                                          ELSE
                                                            wNumLinea := ROUND( (rSerPar2."N§ Linea" + rSerPar3."N§ Linea") / 2, 1);

                                                          rSerPar2.SETRANGE("N§ Parte", rSerPar."N§ Parte");
                                                          rSerPar2.SETRANGE("N§ Linea", wNumLinea);
                                                          WHILE rSerPar2.GET(rSerPar."N§ Servicio", wNumLinea) DO BEGIN
                                                            wNumLinea := ROUND((rSerPar2."N§ Linea" + wNumLinea) / 2, 1);
                                                            rSerPar2.SETRANGE("N§ Linea", wNumLinea);
                                                          END;
                                                          rSerPar2.SETRANGE("N§ Linea");

                                                          rSerPar2 := rSerPar;
                                                          rSerPar2."N§ Linea" := wNumLinea;
                                                          rSerPar2.INSERT;

                                                          // Hay que tratar los suplementos que tambien se mueven de linea

                                                          rSupl.RESET;
                                                          rSupl.SETRANGE("N§ Servicio", rSerPar."N§ Servicio");
                                                          rSupl.SETRANGE("N§ Linea"   , rSerPar."N§ Linea");
                                                          IF rSupl.FINDSET(TRUE) THEN BEGIN
                                                            REPEAT
                                                              rSupl2 := rSupl;
                                                              rSupl2."N§ Linea" := wNumLinea;
                                                              rSupl2.INSERT;

                                                              rSupl3 := rSupl;
                                                              rSupl3.DELETE;
                                                            UNTIL rSupl.NEXT = 0;
                                                          END;


                                                          rSerPar.DELETE;

                                                          CurrForm.SubHotPar.FORM.registro_actual(rSerPar2);
                                                        END;
                                                         }
    { 1100244004;CommandButton;220;12430;550;550;VertGlue=Bottom;
                                                 ShowCaption=No;
                                                 BitmapPos=Center;
                                                 Bitmap=15;
                                                 OnPush=BEGIN
                                                          CurrForm.SubHotPar.FORM.pasa_registro(rSerPar);

                                                          rSerPar2.COPY(rSerPar);
                                                          IF rSerPar2.NEXT(-1) = 0 THEN
                                                            ERROR(Text003);


                                                          rSerPar3.COPY(rSerPar2);
                                                          IF rSerPar3.NEXT(-1) = 0 THEN
                                                            wNumLinea := ROUND( (rSerPar2."N§ Linea" + 0) / 2, 1)
                                                          ELSE
                                                            wNumLinea := ROUND( (rSerPar2."N§ Linea" + rSerPar3."N§ Linea") / 2, 1);

                                                          rSerPar2.SETRANGE("N§ Parte", rSerPar."N§ Parte");
                                                          rSerPar2.SETRANGE("N§ Linea", wNumLinea);
                                                          WHILE rSerPar2.FINDFIRST DO BEGIN
                                                            wNumLinea := ROUND((rSerPar2."N§ Linea" + wNumLinea) / 2, 1); ;
                                                            rSerPar2.SETRANGE("N§ Linea", wNumLinea);
                                                          END;
                                                          rSerPar2.SETRANGE("N§ Linea");

                                                          rSerPar2 := rSerPar;
                                                          rSerPar2."N§ Linea" := wNumLinea;
                                                          rSerPar2.INSERT;

                                                          // Hay que tratar los suplementos que tambien se mueven de linea

                                                          rSupl.RESET;
                                                          rSupl.SETRANGE("N§ Servicio", rSerPar."N§ Servicio");
                                                          rSupl.SETRANGE("N§ Linea"   , rSerPar."N§ Linea");
                                                          IF rSupl.FINDSET(TRUE) THEN BEGIN
                                                            REPEAT
                                                              rSupl2 := rSupl;
                                                              rSupl2."N§ Linea" := wNumLinea;
                                                              rSupl2.INSERT;

                                                              rSupl3 := rSupl;
                                                              rSupl3.DELETE;
                                                            UNTIL rSupl.NEXT = 0;
                                                          END;


                                                          rSerPar.DELETE;

                                                          CurrForm.SubHotPar.FORM.registro_actual(rSerPar2);
                                                        END;
                                                         }
    { 1103355015;Label  ;11220;220  ;3960 ;550  ;Name=texto_recogida_generada;
                                                 HorzGlue=Right;
                                                 Visible=No;
                                                 HorzAlign=Center;
                                                 ForeColor=32768;
                                                 FontSize=10;
                                                 FontBold=Yes;
                                                 LeaderDots=No;
                                                 CaptionML=ESP=RECOGIDA GENERADA }
    { 1103355017;CommandButton;9130;12430;2200;550;
                                                 HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=ESP=&Subtrayectos;
                                                 OnPush=VAR
                                                          lfSubtrayectos@1103355000 : Form 7035407;
                                                        BEGIN

                                                          IF ("Codigo Servicio" = '') THEN
                                                            ERROR(err2);

                                                          lfSubtrayectos.SetParte("N§ Parte");

                                                          CargarSubtrayectos;
                                                            COMMIT;
                                                            lfSubtrayectos.RUNMODAL;
                                                        END;
                                                         }
  }
  CODE
  {
    VAR
      Text50000@1103355003 : TextConst 'ESP=">=%1|0d"';
      Text000@1100244004 : TextConst 'ESP=TOTAL';
      Text001@1100244005 : TextConst 'ESP=¨Imprimir parte de trabajo?';
      err1@1100244000 : TextConst 'ESP=No hay ningun vehiculo disponible para la hora de inicio del servicio.';
      text1@1100244001 : TextConst 'ESP=BUSCANDO VEHICULOS LIBRES';
      text2@1100244002 : TextConst 'ESP=Matricula';
      rSerPar@1100244008 : Record 7010359;
      rSerPar2@1100244009 : Record 7010359;
      rSerPar3@1100244010 : Record 7010359;
      rSupl@1100244012 : Record 7010363;
      rSupl2@1100244013 : Record 7010363;
      rSupl3@1100244014 : Record 7010363;
      rParte@1100244021 : Record 7010360;
      rPar@1100244028 : Record 7010311;
      cFun@1100244003 : Codeunit 7010318;
      Text003@1100244007 : TextConst 'ESP=Este hotel ya es el primer hotel del servicio.';
      Text004@1100244006 : TextConst 'ESP=Este hotel ya es el ultimo hotel del servicio.';
      cFunBas@1100253002 : Codeunit 7010310;
      fCalendar@1100244018 : Form 7035306;
      fListaParte@1100244022 : Form 7010401;
      wNumLinea@1100244011 : Integer;
      wFecha@1100244019 : Date;
      Text005@1100244020 : TextConst 'ESP=" (Agregado)"';
      Text006@1100244023 : TextConst 'ESP=El Parte est  asignado a un grupo. ¨Desea modificarlo?';
      rGrupos@1100244024 : Record 7010373;
      fGrupos@1100244025 : Form 7010452;
      rCliTo@1100244026 : Record 7010313;
      wActivarCampo@1100244027 : ',Vehiculo';
      Text007@1103350000 : TextConst 'ESP=No se encuentra el archivo %1';
      Text008@1100253000 : TextConst 'ESP="Impresi¢n: Copias=%1 Versi¢n=%2"';
      Text009@1100253001 : TextConst 'ESP="Parte N§=%1"';
      Text010@1100253003 : TextConst 'ESP=*.DOC|*.DOC';
      cnf001@1103355000 : TextConst 'ESP=No existe un parte de recogida para el parte actual. ¨Desea crear un nuevo parte de recogida?';
      err2@1103355002 : TextConst 'ESP=Debe especificar un c¢digo de servicio antes de poder modificar los subtrayectos.';
      err3@1103355001 : TextConst 'ESP=No existe informaci¢n de subtrayectos para la excursion %1 con fecha %2 en la zona %3.';

    PROCEDURE ActivaCampo@1100244000(pwInt@1100244000 : Integer);
    BEGIN
      // ActivaVehiculo
      wActivarCampo := pwInt;
    END;

    PROCEDURE GestCFecha@1100244001();
    BEGIN
      // GestCFecha
      // Gestiona el bloqueo al camp fecha

      CurrForm.Fecha.EDITABLE((Fecha=0D) OR (NOT rPar."Bloquear Fecha Partes"));
      CurrForm.Fecha2.EDITABLE((Fecha=0D) OR (NOT rPar."Bloquear Fecha Partes"));
      CurrForm.Boton1.VISIBLE(CurrForm.Fecha.EDITABLE);
    END;

    PROCEDURE TextoImp@1100253000() : Text[250];
    VAR
      lwText@1100253000 : Text[250];
    BEGIN
      // TextoImp
      // Devuelve un texto indicando el numero de copias impresas, As¡ como la versi¢n de impresi¢n

      CLEAR(lwText);
      rPar.FINDFIRST;
      IF rPar."Empresa Real" IN [rPar."Empresa Real"::TRN, rPar."Empresa Real"::CNT] THEN
        lwText := STRSUBSTNO(Text008, "Copias Impresas", Version);
      EXIT(lwText);
    END;

    PROCEDURE SetEditable@1100253001();
    BEGIN
      // SetEditable
      // Establece las propiedades editable y visible de la ventana

      CurrForm.Vuelos.EDITABLE(rPar."Empresa Real" IN [rPar."Empresa Real"::TRN]);
      CurrForm.Impreso.EDITABLE := (NOT (rPar."Empresa Real" IN [rPar."Empresa Real"::TRN, rPar."Empresa Real"::CNT]));

      CurrForm."Cod Grupo".EDITABLE             := PuedeModificarCampo(FIELDNO("Cod Grupo"), FALSE);
      CurrForm."No Servicio Regular".EDITABLE   := PuedeModificarCampo(FIELDNO("No Servicio Regular"), FALSE);
      CurrForm."Vehiculo Escolar".EDITABLE      := PuedeModificarCampo(FIELDNO("Vehiculo Escolar"), FALSE);
      CurrForm."Vehiculo Minusvalidos".EDITABLE := PuedeModificarCampo(FIELDNO("Vehiculo Minusvalidos"), FALSE);
      CurrForm."Vehiculo especial".EDITABLE     := PuedeModificarCampo(FIELDNO("Vehiculo especial"), FALSE);
    END;

    BEGIN
    {
      $001 AJS 18052015 Elimino funcionalidad obsoleta de Buscar conductor, Buscar vehiculo
    }
    END.
  }
}
