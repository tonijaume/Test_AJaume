OBJECT Form 7171 Customer Sales History
{
  OBJECT-PROPERTIES
  {
    Date=14/08/09;
    Time=12:00:00;
    Version List=NAVW16.00.01;
  }
  PROPERTIES
  {
    Width=19030;
    Height=7810;
    CaptionML=[ENU=Customer Sales History;
               ESP=Historial de ventas del cliente];
    SaveValues=Yes;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    TableBoxID=1;
    SourceTable=Table18;
    OnOpenForm=BEGIN
                 IF ToSalesHeader."No." = '' THEN
                   CurrForm.CopyToDoc.ENABLED := FALSE;

                 ChangeSubMenu(CurrentMenuType);
                 CASE CurrentMenuType OF
                   0:
                     CurrForm.QuotesBtn.ACTIVATE;
                   1:
                     CurrForm.OrdersBtn.ACTIVATE;
                   2:
                     CurrForm.InvoicesBtn.ACTIVATE;
                   3:
                     CurrForm.CreditMemosBtn.ACTIVATE;
                   4:
                     CurrForm.BlanketOrdersBtn.ACTIVATE;
                   5:
                     CurrForm.ReturnOrdersBtn.ACTIVATE;
                   6:
                     CurrForm.PostedShipmentsBtn.ACTIVATE;
                   7:
                     CurrForm.PostedInvoicesBtn.ACTIVATE;
                   8:
                     CurrForm.PostedReturnReceiptsBtn.ACTIVATE;
                   9:
                     CurrForm.PostedCreditMemosBtn.ACTIVATE;
                   10:
                     CurrForm.ArchivedOrdersBtn.ACTIVATE;
                 END;
                 SETRANGE("No.","No.");
               END;

    OnAfterGetRecord=BEGIN
                       IF BillTo THEN BEGIN
                         SalesInfoPaneMgt.CalcNoOfBillToDocuments(Rec);
                         NoOfQuotes := "Bill-To No. of Quotes";
                         NoOfBlanketOrders := "Bill-To No. of Blanket Orders";
                         NoOfOrders := "Bill-To No. of Orders";
                         NoofInvoices := "Bill-To No. of Invoices";
                         NoOfReturnOrders := "Bill-To No. of Return Orders";
                         NoOfCreditMemos := "Bill-To No. of Credit Memos";
                         NoOfPstdShipments := "Bill-To No. of Pstd. Shipments";
                         NoOfPstdInvoices := "Bill-To No. of Pstd. Invoices";
                         NoOfPstdReturnReceipts := "Bill-To No. of Pstd. Return R.";
                         NoOfPstdCreditMemos := "Bill-To No. of Pstd. Cr. Memos";
                         NoOfArchivedOrders := "Bill-to No. Of Archived Doc."
                       END ELSE BEGIN
                         SalesInfoPaneMgt.CalcNoOfDocuments(Rec);
                         NoOfQuotes := "No. of Quotes";
                         NoOfBlanketOrders := "No. of Blanket Orders";
                         NoOfOrders := "No. of Orders";
                         NoofInvoices := "No. of Invoices";
                         NoOfReturnOrders := "No. of Return Orders";
                         NoOfCreditMemos := "No. of Credit Memos";
                         NoOfPstdShipments := "No. of Pstd. Shipments";
                         NoOfPstdInvoices := "No. of Pstd. Invoices";
                         NoOfPstdReturnReceipts := "No. of Pstd. Return Receipts";
                         NoOfPstdCreditMemos := "No. of Pstd. Credit Memos";
                         NoOfArchivedOrders := "Sell-to No. Of Archived Doc."
                       END;
                     END;

  }
  CONTROLS
  {
    { 54  ;SubForm      ;4290 ;220  ;14520;6600 ;Name=BillPostedReturnRcpts;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Visible=No;
                                                 Border=No;
                                                 SubFormID=Form7176;
                                                 SubFormView=SORTING(Bill-to Customer No.);
                                                 SubFormLink=Bill-to Customer No.=FIELD(No.) }
    { 50  ;SubForm      ;4290 ;220  ;14520;6600 ;Name=BillPostedInvoices;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Visible=No;
                                                 Border=No;
                                                 SubFormID=Form7174;
                                                 SubFormView=SORTING(Bill-to Customer No.);
                                                 SubFormLink=Bill-to Customer No.=FIELD(No.) }
    { 51  ;SubForm      ;4290 ;220  ;14520;6600 ;Name=BillPostedShpts;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Visible=No;
                                                 Border=No;
                                                 SubFormID=Form7173;
                                                 SubFormView=SORTING(Bill-to Customer No.);
                                                 SubFormLink=Bill-to Customer No.=FIELD(No.) }
    { 52  ;SubForm      ;4290 ;220  ;14520;6600 ;Name=BillSalesLines;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Visible=No;
                                                 Border=No;
                                                 SubFormID=Form7172;
                                                 SubFormView=SORTING(Document Type,Bill-to Customer No.,Currency Code);
                                                 SubFormLink=Bill-to Customer No.=FIELD(No.) }
    { 1   ;SubForm      ;4290 ;220  ;14520;6600 ;Name=PostedCrMemos;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Visible=No;
                                                 Border=No;
                                                 SubFormID=Form7175;
                                                 SubFormView=SORTING(Sell-to Customer No.);
                                                 SubFormLink=Sell-to Customer No.=FIELD(No.) }
    { 2   ;CommandButton;11770;7040 ;2200 ;550  ;Name=CopyToDoc;
                                                 HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 InvalidActionAppearance=Hide;
                                                 CaptionML=[ENU=Cop&y to Document;
                                                            ESP=Cop&iar al documento];
                                                 OnPush=BEGIN
                                                          CopyLineToDoc;
                                                          CurrForm.CLOSE;
                                                        END;
                                                         }
    { 4   ;CommandButton;16610;7040 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 5   ;SubForm      ;4290 ;220  ;14520;6600 ;Name=PostedReturnRcpts;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Visible=No;
                                                 Border=No;
                                                 SubFormID=Form7176;
                                                 SubFormView=SORTING(Sell-to Customer No.);
                                                 SubFormLink=Sell-to Customer No.=FIELD(No.) }
    { 6   ;SubForm      ;4290 ;220  ;14520;6600 ;Name=PostedInvoices;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Visible=No;
                                                 Border=No;
                                                 SubFormID=Form7174;
                                                 SubFormView=SORTING(Sell-to Customer No.);
                                                 SubFormLink=Sell-to Customer No.=FIELD(No.) }
    { 7   ;SubForm      ;4290 ;220  ;14520;6600 ;Name=PostedShpts;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Visible=No;
                                                 Border=No;
                                                 SubFormID=Form7173;
                                                 SubFormView=SORTING(Sell-to Customer No.);
                                                 SubFormLink=Sell-to Customer No.=FIELD(No.) }
    { 8   ;SubForm      ;4290 ;220  ;14520;6600 ;Name=SalesLines;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Visible=No;
                                                 Border=No;
                                                 SubFormID=Form7172;
                                                 SubFormView=SORTING(Document Type,Sell-to Customer No.);
                                                 SubFormLink=Sell-to Customer No.=FIELD(No.) }
    { 53  ;SubForm      ;4290 ;220  ;14520;6600 ;Name=BillPostedCrMemos;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Visible=No;
                                                 Border=No;
                                                 SubFormID=Form7175;
                                                 SubFormView=SORTING(Bill-to Customer No.);
                                                 SubFormLink=Bill-to Customer No.=FIELD(No.) }
    { 3   ;CommandButton;14190;7040 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=&Show;
                                                            ESP=&Mostrar];
                                                 OnPush=VAR
                                                          SalesHeader@1009 : Record 36;
                                                          SalesLine@1008 : Record 37;
                                                          SalesShptHeader@1007 : Record 110;
                                                          SalesShptLine@1006 : Record 111;
                                                          SalesInvHeader@1005 : Record 112;
                                                          SalesInvLine@1004 : Record 113;
                                                          SalesCrMemoHeader@1003 : Record 114;
                                                          SalesCrMemoLine@1002 : Record 115;
                                                          ReturnRcptHeader@1001 : Record 6660;
                                                          ReturnRcptLine@1000 : Record 6661;
                                                          SalesLineArchive@1012 : Record 5108;
                                                          SalesHeaderArchive@1013 : Record 5107;
                                                        BEGIN
                                                          CASE CurrentMenuType OF
                                                            0..5:
                                                              BEGIN
                                                                IF BillTo THEN
                                                                  CurrForm.BillSalesLines.FORM.GETRECORD(SalesLine)
                                                                ELSE
                                                                  CurrForm.SalesLines.FORM.GETRECORD(SalesLine);
                                                                IF NOT SalesHeader.GET(SalesLine."Document Type",SalesLine."Document No.") THEN
                                                                  EXIT;
                                                                CASE CurrentMenuType OF
                                                                  0:
                                                                    FORM.RUN(FORM::"Sales Quote",SalesHeader);
                                                                  1:
                                                                    FORM.RUN(FORM::"Sales Order",SalesHeader);
                                                                  2:
                                                                    FORM.RUN(FORM::"Sales Invoice",SalesHeader);
                                                                  3:
                                                                    FORM.RUN(FORM::"Sales Credit Memo",SalesHeader);
                                                                  4:
                                                                    FORM.RUN(FORM::"Blanket Sales Order",SalesHeader);
                                                                  5:
                                                                    FORM.RUN(FORM::"Sales Return Order",SalesHeader);
                                                                END;
                                                              END;
                                                            6:
                                                              BEGIN
                                                                IF BillTo THEN
                                                                  CurrForm.BillPostedShpts.FORM.GETRECORD(SalesShptLine)
                                                                ELSE
                                                                  CurrForm.PostedShpts.FORM.GETRECORD(SalesShptLine);
                                                                IF NOT SalesShptHeader.GET(SalesShptLine."Document No.") THEN
                                                                  EXIT;
                                                                FORM.RUN(FORM::"Posted Sales Shipment",SalesShptHeader);
                                                              END;
                                                            7:
                                                              BEGIN
                                                                IF BillTo THEN
                                                                  CurrForm.BillPostedInvoices.FORM.GETRECORD(SalesInvLine)
                                                                ELSE
                                                                  CurrForm.PostedInvoices.FORM.GETRECORD(SalesInvLine);
                                                                IF NOT SalesInvHeader.GET(SalesInvLine."Document No.") THEN
                                                                  EXIT;
                                                                FORM.RUN(FORM::"Posted Sales Invoice",SalesInvHeader);
                                                              END;
                                                            8:
                                                              BEGIN
                                                                IF BillTo THEN
                                                                  CurrForm.BillPostedReturnRcpts.FORM.GETRECORD(ReturnRcptLine)
                                                                ELSE
                                                                  CurrForm.PostedReturnRcpts.FORM.GETRECORD(ReturnRcptLine);
                                                                IF NOT ReturnRcptHeader.GET(ReturnRcptLine."Document No.") THEN
                                                                  EXIT;
                                                                FORM.RUN(FORM::"Posted Return Receipt",ReturnRcptHeader);
                                                              END;
                                                            9:
                                                              BEGIN
                                                                IF BillTo THEN
                                                                  CurrForm.BillPostedCrMemos.FORM.GETRECORD(SalesCrMemoLine)
                                                                ELSE
                                                                  CurrForm.PostedCrMemos.FORM.GETRECORD(SalesCrMemoLine);
                                                                IF NOT SalesCrMemoHeader.GET(SalesCrMemoLine."Document No.") THEN
                                                                  EXIT;
                                                                FORM.RUN(FORM::"Posted Sales Credit Memo",SalesCrMemoHeader);
                                                              END;
                                                            10:
                                                              BEGIN
                                                                IF BillTo THEN
                                                                  CurrForm.BillArchivedOrders.FORM.GETRECORD(SalesLineArchive)
                                                                ELSE
                                                                  CurrForm.ArchivedOrders.FORM.GETRECORD(SalesLineArchive);
                                                                IF NOT SalesHeaderArchive.GET(SalesLineArchive."Document Type",SalesLineArchive."Document No.",
                                                                    SalesLineArchive."Doc. No. Occurrence",SalesLineArchive."Version No.") THEN
                                                                  EXIT;
                                                                FORM.RUN(FORM::"Sales Order Archive",SalesHeaderArchive);
                                                              END;

                                                          END;
                                                        END;
                                                         }
    { 9   ;Frame        ;220  ;220  ;3850 ;6490 ;VertGlue=Both;
                                                 ShowCaption=No;
                                                 BackTransparent=Yes;
                                                 Border=No }
    { 10  ;CommandButton;880  ;5500 ;2200 ;550  ;Name=PostedCreditMemosBtn;
                                                 FocusOnClick=Yes;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 ForeColor=0;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=Posted Cr. &Memos;
                                                            ESP=&Abonos contabilizados];
                                                 OnPush=BEGIN
                                                          ChangeSubMenu(9);
                                                        END;
                                                         }
    { 11  ;TextBox      ;3080 ;5500 ;770  ;550  ;Editable=No;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',NoOfPstdCreditMemos) }
    { 12  ;CommandButton;880  ;4950 ;2200 ;550  ;Name=PostedReturnReceiptsBtn;
                                                 FocusOnClick=Yes;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 ForeColor=0;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=Posted Ret&urn Receipts;
                                                            ESP=&Devoluciones contabilizadas];
                                                 OnPush=BEGIN
                                                          ChangeSubMenu(8);
                                                        END;
                                                         }
    { 13  ;CommandButton;880  ;4400 ;2200 ;550  ;Name=PostedInvoicesBtn;
                                                 FocusOnClick=Yes;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 ForeColor=0;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=Posted I&nvoices;
                                                            ESP=&Facturas contabilizadas];
                                                 OnPush=BEGIN
                                                          ChangeSubMenu(7);
                                                        END;
                                                         }
    { 14  ;TextBox      ;3080 ;4400 ;770  ;550  ;Editable=No;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',NoOfPstdInvoices) }
    { 15  ;CommandButton;880  ;3850 ;2200 ;550  ;Name=PostedShipmentsBtn;
                                                 FocusOnClick=Yes;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 ForeColor=0;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=&Posted Shipments;
                                                            ESP=&Env¡os contabilizados];
                                                 OnPush=BEGIN
                                                          ChangeSubMenu(6);
                                                        END;
                                                         }
    { 16  ;TextBox      ;3080 ;3850 ;770  ;550  ;Editable=No;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',NoOfPstdShipments) }
    { 17  ;CommandButton;880  ;3190 ;2200 ;550  ;Name=CreditMemosBtn;
                                                 FocusOnClick=Yes;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 ForeColor=0;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=Cre&dit Memos;
                                                            ESP=A&bonos];
                                                 OnPush=BEGIN
                                                          ChangeSubMenu(3);
                                                        END;
                                                         }
    { 18  ;TextBox      ;3080 ;3190 ;770  ;550  ;Editable=No;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',NoOfCreditMemos) }
    { 19  ;CommandButton;880  ;2640 ;2200 ;550  ;Name=ReturnOrdersBtn;
                                                 FocusOnClick=Yes;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 ForeColor=0;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=&Return Orders;
                                                            ESP=De&voluciones];
                                                 OnPush=BEGIN
                                                          ChangeSubMenu(5);
                                                        END;
                                                         }
    { 20  ;TextBox      ;3080 ;2640 ;770  ;550  ;Editable=No;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',NoOfReturnOrders) }
    { 21  ;CommandButton;880  ;2090 ;2200 ;550  ;Name=InvoicesBtn;
                                                 FocusOnClick=Yes;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 ForeColor=0;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=&Invoices;
                                                            ESP=Fa&cturas];
                                                 OnPush=BEGIN
                                                          ChangeSubMenu(2);
                                                        END;
                                                         }
    { 22  ;TextBox      ;3080 ;2090 ;770  ;550  ;Editable=No;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',NoofInvoices) }
    { 23  ;CommandButton;880  ;1540 ;2200 ;550  ;Name=OrdersBtn;
                                                 FocusOnClick=Yes;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 ForeColor=0;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=&Orders;
                                                            ESP=&Pedidos];
                                                 OnPush=BEGIN
                                                          ChangeSubMenu(1);
                                                        END;
                                                         }
    { 24  ;TextBox      ;3080 ;1540 ;770  ;550  ;Editable=No;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',NoOfOrders) }
    { 25  ;CommandButton;880  ;990  ;2200 ;550  ;Name=BlanketOrdersBtn;
                                                 FocusOnClick=Yes;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 ForeColor=0;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=&Blanket Orders;
                                                            ESP=Pe&didos abiertos];
                                                 OnPush=BEGIN
                                                          ChangeSubMenu(4);
                                                        END;
                                                         }
    { 26  ;TextBox      ;3080 ;990  ;770  ;550  ;Editable=No;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',NoOfBlanketOrders) }
    { 27  ;CommandButton;880  ;440  ;2200 ;550  ;Name=QuotesBtn;
                                                 FocusOnClick=Yes;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 ForeColor=0;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=&Quotes;
                                                            ESP=&Ofertas];
                                                 OnPush=BEGIN
                                                          ChangeSubMenu(0);
                                                        END;
                                                         }
    { 28  ;TextBox      ;3080 ;440  ;770  ;550  ;Editable=No;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',NoOfQuotes) }
    { 29  ;PictureBox   ;440  ;440  ;440  ;550  ;Name=QuotesPic;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 Border=No;
                                                 BitmapList=35,39;
                                                 SourceExpr=0=CurrentMenuType }
    { 30  ;PictureBox   ;440  ;990  ;440  ;550  ;Name=BlanketOrdersPic;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 Border=No;
                                                 BitmapList=35,39;
                                                 SourceExpr=4=CurrentMenuType }
    { 31  ;PictureBox   ;440  ;1540 ;440  ;550  ;Name=OrdersPic;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 Border=No;
                                                 BitmapList=35,39;
                                                 SourceExpr=1=CurrentMenuType }
    { 32  ;PictureBox   ;440  ;2090 ;440  ;550  ;Name=PostedInvoicesPic;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 Border=No;
                                                 BitmapList=35,39;
                                                 SourceExpr=2=CurrentMenuType }
    { 34  ;PictureBox   ;440  ;2640 ;440  ;550  ;Name=ReturnOrdersPic;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 Border=No;
                                                 BitmapList=35,39;
                                                 SourceExpr=5=CurrentMenuType }
    { 36  ;PictureBox   ;440  ;3190 ;440  ;550  ;Name=CreditMemosPic;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 Border=No;
                                                 BitmapList=35,39;
                                                 SourceExpr=3=CurrentMenuType }
    { 37  ;PictureBox   ;440  ;3850 ;440  ;550  ;Name=PostedShipmentsPic;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 Border=No;
                                                 BitmapList=35,39;
                                                 SourceExpr=6=CurrentMenuType }
    { 38  ;PictureBox   ;440  ;4400 ;440  ;550  ;Name=PostedInvoicesPic;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 Border=No;
                                                 BitmapList=35,39;
                                                 SourceExpr=7=CurrentMenuType }
    { 39  ;PictureBox   ;440  ;4950 ;440  ;550  ;Name=PostedReturnReceiptsPic;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 Border=No;
                                                 BitmapList=35,39;
                                                 SourceExpr=8=CurrentMenuType }
    { 40  ;PictureBox   ;440  ;5500 ;440  ;550  ;Name=PostedCredit MemosPic;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 Border=No;
                                                 BitmapList=35,39;
                                                 SourceExpr=9=CurrentMenuType }
    { 41  ;TextBox      ;3080 ;4950 ;770  ;550  ;Editable=No;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',NoOfPstdReturnReceipts) }
    { 35  ;PictureBox   ;440  ;6050 ;440  ;550  ;Name=ArchivedOrderPic;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 Border=No;
                                                 BitmapList=35,39;
                                                 SourceExpr=10=CurrentMenuType }
    { 42  ;CommandButton;880  ;6050 ;2200 ;550  ;Name=ArchivedOrdersBtn;
                                                 FocusOnClick=Yes;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Left;
                                                 ForeColor=0;
                                                 BackColor=16777215;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=[ENU=Archived Orders;
                                                            ESP=Pedidos archivados];
                                                 OnPush=BEGIN
                                                          ChangeSubMenu(10);
                                                        END;
                                                         }
    { 43  ;TextBox      ;3080 ;6050 ;770  ;550  ;Editable=No;
                                                 Focusable=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 HorzAlign=Right;
                                                 Border=No;
                                                 SourceExpr=STRSUBSTNO('(%1)',NoOfArchivedOrders) }
    { 44  ;TextBox      ;880  ;0    ;2200 ;440  ;Name=CurrentMenuTypeValue;
                                                 Visible=No;
                                                 ParentControl=9;
                                                 InFrame=Yes;
                                                 SourceExpr=CurrentMenuType }
    { 45  ;SubForm      ;4290 ;220  ;14520;6600 ;Name=ArchivedOrders;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Visible=No;
                                                 Border=No;
                                                 SubFormID=Form7188;
                                                 SubFormView=SORTING(Sell-to Customer No.);
                                                 SubFormLink=Document Type=CONST(Order),
                                                             Sell-to Customer No.=FIELD(No.) }
    { 46  ;SubForm      ;4290 ;220  ;14520;6600 ;Name=BillArchivedOrders;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Visible=No;
                                                 Border=No;
                                                 SubFormID=Form7188;
                                                 SubFormLink=Document Type=CONST(Order),
                                                             Bill-to Customer No.=FIELD(No.) }
  }
  CODE
  {
    VAR
      ToSalesHeader@1002 : Record 36;
      SalesInfoPaneMgt@1004 : Codeunit 7171;
      SalesHistCopyLineMgt@1003 : Codeunit 7172;
      OldMenuType@1001 : Integer;
      CurrentMenuType@1000 : Integer;
      BillTo@1005 : Boolean;
      NoOfQuotes@1006 : Integer;
      NoOfBlanketOrders@1007 : Integer;
      NoOfOrders@1008 : Integer;
      NoofInvoices@1009 : Integer;
      NoOfReturnOrders@1010 : Integer;
      NoOfCreditMemos@1011 : Integer;
      NoOfPstdShipments@1012 : Integer;
      NoOfPstdInvoices@1013 : Integer;
      NoOfPstdReturnReceipts@1014 : Integer;
      NoOfPstdCreditMemos@1015 : Integer;
      NoOfArchivedOrders@1016 : Integer;

    LOCAL PROCEDURE CopyLineToDoc@5();
    VAR
      FromSalesLine@1008 : Record 37;
      FromSalesShptLine@1001 : Record 111;
      FromSalesInvLine@1002 : Record 113;
      FromSalesCrMemoLine@1003 : Record 115;
      FromReturnRcptLine@1004 : Record 6661;
      FromSalesArchLine@1000 : Record 5108;
    BEGIN
      CASE CurrentMenuType OF
        0..5:
          BEGIN
            IF BillTo THEN
              CurrForm.BillSalesLines.FORM.GetSelectedLine(FromSalesLine)
            ELSE
              CurrForm.SalesLines.FORM.GetSelectedLine(FromSalesLine);
            SalesHistCopyLineMgt.CopySalesLinesToDoc(ToSalesHeader,FromSalesLine,CurrentMenuType);
          END;
        6:
          BEGIN
            IF BillTo THEN
              CurrForm.BillPostedShpts.FORM.GetSelectedLine(FromSalesShptLine)
            ELSE
              CurrForm.PostedShpts.FORM.GetSelectedLine(FromSalesShptLine);
            SalesHistCopyLineMgt.CopySalesShptLineToDoc(ToSalesHeader,FromSalesShptLine,CurrentMenuType);
          END;
        7:
          BEGIN
            IF BillTo THEN
              CurrForm.BillPostedInvoices.FORM.GetSelectedLine(FromSalesInvLine)
            ELSE
              CurrForm.PostedInvoices.FORM.GetSelectedLine(FromSalesInvLine);
            SalesHistCopyLineMgt.CopySalesInvLineToDoc(ToSalesHeader,FromSalesInvLine,CurrentMenuType)
          END;
        8:
          BEGIN
            IF BillTo THEN
              CurrForm.BillPostedReturnRcpts.FORM.GetSelectedLine(FromReturnRcptLine)
            ELSE
              CurrForm.PostedReturnRcpts.FORM.GetSelectedLine(FromReturnRcptLine);
            SalesHistCopyLineMgt.CopyReturnRcptLineToDoc(ToSalesHeader,FromReturnRcptLine,CurrentMenuType)
          END;
        9:
          BEGIN
            IF BillTo THEN
              CurrForm.BillPostedCrMemos.FORM.GetSelectedLine(FromSalesCrMemoLine)
            ELSE
              CurrForm.PostedCrMemos.FORM.GetSelectedLine(FromSalesCrMemoLine);
            SalesHistCopyLineMgt.CopySalesCrMemoLineToDoc(ToSalesHeader,FromSalesCrMemoLine,CurrentMenuType)
          END;
        10:
          BEGIN
            IF BillTo THEN
              CurrForm.BillArchivedOrders.FORM.GetSelectedLine(FromSalesArchLine)
            ELSE
              CurrForm.ArchivedOrders.FORM.GetSelectedLine(FromSalesArchLine);
            SalesHistCopyLineMgt.CopySalesArchLineToDoc(ToSalesHeader,FromSalesArchLine,CurrentMenuType)
          END;

      END;
    END;

    LOCAL PROCEDURE ChangeSubMenu@1(NewMenuType@1000 : Integer);
    BEGIN
      IF OldMenuType <> NewMenuType THEN
        SetSubMenu(OldMenuType,FALSE);
      SetSubMenu(NewMenuType,TRUE);
      OldMenuType := NewMenuType;
      CurrentMenuType := NewMenuType;
    END;

    LOCAL PROCEDURE SetSubMenu@2(MenuType@1000 : Integer;Visible@1001 : Boolean);
    VAR
      SalesLine@1002 : Record 37;
    BEGIN
      CASE MenuType OF
        0..5:
          BEGIN
            IF Visible THEN BEGIN
              IF BillTo THEN BEGIN
                SalesLine.SETCURRENTKEY("Document Type","Bill-to Customer No.");
                SalesLine.SETRANGE("Document Type",MenuType);
                CurrForm.BillSalesLines.FORM.SETTABLEVIEW(SalesLine)
              END ELSE BEGIN
                SalesLine.SETCURRENTKEY("Document Type","Sell-to Customer No.");
                SalesLine.SETRANGE("Document Type",MenuType);
                CurrForm.SalesLines.FORM.SETTABLEVIEW(SalesLine);
              END;
            END;
            IF BillTo THEN
              CurrForm.BillSalesLines.VISIBLE := Visible
            ELSE
              CurrForm.SalesLines.VISIBLE := Visible;
          END;
        6:
          BEGIN
            IF BillTo THEN
              CurrForm.BillPostedShpts.VISIBLE := Visible
            ELSE
              CurrForm.PostedShpts.VISIBLE := Visible;
          END;
        7:
          BEGIN
            IF BillTo THEN
              CurrForm.BillPostedInvoices.VISIBLE := Visible
            ELSE
              CurrForm.PostedInvoices.VISIBLE := Visible;
          END;
        8:
          BEGIN
            IF BillTo THEN
              CurrForm.BillPostedReturnRcpts.VISIBLE := Visible
            ELSE
              CurrForm.PostedReturnRcpts.VISIBLE := Visible;
          END;
        9:
          BEGIN
            IF BillTo THEN
              CurrForm.PostedCrMemos.VISIBLE := Visible
            ELSE
              CurrForm.PostedCrMemos.VISIBLE := Visible;
          END;
        10:
          BEGIN
            IF BillTo THEN
              CurrForm.BillArchivedOrders.VISIBLE := Visible
            ELSE
              CurrForm.ArchivedOrders.VISIBLE := Visible;
          END;
      END;
    END;

    PROCEDURE SetToSalesHeader@4(NewToSalesHeader@1000 : Record 36;UseBillTo@1001 : Boolean);
    BEGIN
      ToSalesHeader := NewToSalesHeader;
      BillTo := UseBillTo;
    END;

    BEGIN
    END.
  }
}
