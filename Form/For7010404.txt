OBJECT Form 7010404 Tabla Control de operaciones
{
  OBJECT-PROPERTIES
  {
    Date=23/02/10;
    Time=12:49:11;
    Version List=TRANSFER;
  }
  PROPERTIES
  {
    Width=25190;
    Height=14630;
    Editable=Yes;
    CaptionML=ESP=Tabla Control de operaciones;
    MaximizedOnOpen=Yes;
    TableBoxID=1;
    SourceTable=Table7010360;
    UpdateOnActivate=Yes;
    TimerInterval=60000;
    SourceTableView=SORTING(Hora Inicio BI);
    OnOpenForm=VAR
                 lwTexto@1100244000 : Text[30];
               BEGIN

                 // AJF 25/09/08 - Migracion 501
                 // Paso el filtro de garaje del bot¢n del men£ al form.
                 FiltrarGarajeUsuario;

                 { JPT 08/05/04 Ahora fitramos por el nuevo campo Hora Inicio DT
                 FILTERGROUP(2);
                 SETRANGE(Fecha, TODAY);
                 FILTERGROUP(0);
                 }
                 Actualiza; // Filtra

                 lwTexto:= GETFILTER(Vehiculo);
                 IF lwTexto <> '' THEN
                   wVehiculo := lwTexto;

                 lwTexto:= GETFILTER("Cod Conductor");
                 IF lwTexto <> '' THEN
                   wConductor := lwTexto;

                 lwTexto:= GETFILTER("Tipo Servicio");
                 IF lwTexto<>'' THEN
                   wTipoServicio := lwTexto;
               END;

    OnTimer=BEGIN
              Actualiza;
              CurrForm.UPDATE;
            END;

  }
  CONTROLS
  {
    { 1   ;TableBox     ;220  ;1870 ;24750;11770;HorzGlue=Both;
                                                 VertGlue=Both;
                                                 Editable=No;
                                                 HeadingHeight=880 }
    { 2   ;TextBox      ;0    ;0    ;2033 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Garaje;
                                                 OnFormat=BEGIN
                                                            IF "Vehiculo cambiado" THEN
                                                              CurrForm.Garaje.UPDATEFORECOLOR := 16711680
                                                            ELSE BEGIN
                                                              CurrForm.Garaje.UPDATEFONTBOLD := TRUE;

                                                              // AJS 15.05.2006
                                                              // Las indicaciones de colores solo las haremos si el parte es de hoy para que el sistema no marque vehiculos de ma¤ana
                                                              // como si estuvieran en marcha

                                                              IF Fecha = TODAY THEN BEGIN
                                                                IF "Hora inicio" < TIME THEN BEGIN
                                                                  IF "Hora final" > TIME THEN
                                                                    CurrForm.Garaje.UPDATEFORECOLOR                  := 2646048
                                                                  ELSE
                                                                    CurrForm.Garaje.UPDATEFORECOLOR                  := 255; // Rojo
                                                                END;
                                                              END;
                                                            END;
                                                          END;
                                                           }
    { 3   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=2;
                                                 InColumnHeading=Yes }
    { 4   ;TextBox      ;0    ;0    ;2086 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="N§ Parte";
                                                 OnFormat=BEGIN
                                                            IF "Vehiculo cambiado" THEN
                                                              CurrForm."N§ Parte".UPDATEFORECOLOR := 16711680
                                                            ELSE BEGIN
                                                              CurrForm."N§ Parte".UPDATEFONTBOLD := TRUE;

                                                              // AJS 15.05.2006
                                                              // Las indicaciones de colores solo las haremos si el parte es de hoy para que el sistema no marque vehiculos de ma¤ana
                                                              // como si estuvieran en marcha

                                                              IF Fecha = TODAY THEN BEGIN
                                                                IF "Hora inicio" < TIME THEN BEGIN
                                                                  IF "Hora final" > TIME THEN
                                                                    CurrForm."N§ Parte".UPDATEFORECOLOR              := 2646048
                                                                  ELSE
                                                                    CurrForm."N§ Parte".UPDATEFORECOLOR              := 255;
                                                                END;
                                                              END;
                                                            END;
                                                          END;
                                                           }
    { 5   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=4;
                                                 InColumnHeading=Yes }
    { 6   ;TextBox      ;0    ;0    ;1640 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Fecha;
                                                 OnFormat=BEGIN
                                                            IF "Vehiculo cambiado" THEN
                                                              CurrForm.Fecha.UPDATEFORECOLOR := 16711680
                                                            ELSE BEGIN
                                                              CurrForm.Fecha.UPDATEFONTBOLD := TRUE;

                                                              // AJS 15.05.2006
                                                              // Las indicaciones de colores solo las haremos si el parte es de hoy para que el sistema no marque vehiculos de ma¤ana
                                                              // como si estuvieran en marcha

                                                              IF Fecha = TODAY THEN BEGIN
                                                                IF "Hora inicio" < TIME THEN BEGIN
                                                                  IF "Hora final" > TIME THEN
                                                                    CurrForm.Fecha.UPDATEFORECOLOR                   := 2646048
                                                                  ELSE
                                                                    CurrForm.Fecha.UPDATEFORECOLOR                   := 255;
                                                                END;
                                                              END;
                                                            END;
                                                          END;
                                                           }
    { 7   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=6;
                                                 InColumnHeading=Yes }
    { 8   ;TextBox      ;0    ;0    ;2063 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Cliente;
                                                 OnFormat=BEGIN
                                                            IF "Vehiculo cambiado" THEN
                                                              CurrForm.Cliente.UPDATEFORECOLOR := 16711680
                                                            ELSE BEGIN
                                                              CurrForm.Cliente.UPDATEFONTBOLD := TRUE;

                                                              // AJS 15.05.2006
                                                              // Las indicaciones de colores solo las haremos si el parte es de hoy para que el sistema no marque vehiculos de ma¤ana
                                                              // como si estuvieran en marcha

                                                              IF Fecha = TODAY THEN BEGIN
                                                                IF "Hora inicio" < TIME THEN BEGIN
                                                                  IF "Hora final" > TIME THEN
                                                                    CurrForm.Cliente.UPDATEFORECOLOR                 := 2646048
                                                                  ELSE
                                                                    CurrForm.Cliente.UPDATEFORECOLOR                 := 255;
                                                                END;
                                                              END;
                                                            END;
                                                          END;
                                                           }
    { 9   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=8;
                                                 InColumnHeading=Yes }
    { 1100244002;TextBox;7038 ;2310 ;2132 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Zona trabajo";
                                                 OnFormat=BEGIN
                                                            IF "Vehiculo cambiado" THEN
                                                              CurrForm."Zona trabajo".UPDATEFORECOLOR := 16711680
                                                            ELSE BEGIN
                                                              CurrForm."Zona trabajo".UPDATEFONTBOLD := TRUE;

                                                              // AJS 15.05.2006
                                                              // Las indicaciones de colores solo las haremos si el parte es de hoy para que el sistema no marque vehiculos de ma¤ana
                                                              // como si estuvieran en marcha

                                                              IF Fecha = TODAY THEN BEGIN
                                                                IF "Hora inicio" < TIME THEN BEGIN
                                                                  IF "Hora final" > TIME THEN
                                                                    CurrForm."Zona trabajo".UPDATEFORECOLOR := 2646048
                                                                  ELSE
                                                                    CurrForm."Zona trabajo".UPDATEFORECOLOR := 255;
                                                                END;
                                                              END;
                                                            END;
                                                          END;
                                                           }
    { 1100244003;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100244002;
                                                 InColumnHeading=Yes }
    { 1100244000;TextBox;6985 ;2200 ;1912 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Touroperador principal";
                                                 OnFormat=BEGIN
                                                            IF "Vehiculo cambiado" THEN
                                                              CurrForm."Touroperador principal".UPDATEFORECOLOR := 16711680
                                                            ELSE BEGIN
                                                              CurrForm."Touroperador principal".UPDATEFONTBOLD := TRUE;

                                                              // AJS 15.05.2006
                                                              // Las indicaciones de colores solo las haremos si el parte es de hoy para que el sistema no marque vehiculos de ma¤ana
                                                              // como si estuvieran en marcha

                                                              IF Fecha = TODAY THEN BEGIN
                                                                IF "Hora inicio" < TIME THEN BEGIN
                                                                  IF "Hora final" > TIME THEN
                                                                    CurrForm."Touroperador principal".UPDATEFORECOLOR := 2646048
                                                                  ELSE
                                                                    CurrForm."Touroperador principal".UPDATEFORECOLOR := 255;
                                                                END;
                                                              END;
                                                            END;
                                                          END;
                                                           }
    { 1100244001;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100244000;
                                                 InColumnHeading=Yes }
    { 34  ;TextBox      ;7276 ;1980 ;1640 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Tipo Servicio";
                                                 OnFormat=BEGIN
                                                            IF "Vehiculo cambiado" THEN
                                                              CurrForm."Tipo Servicio".UPDATEFORECOLOR := 16711680
                                                            ELSE BEGIN
                                                              CurrForm."Tipo Servicio".UPDATEFONTBOLD := TRUE;

                                                              // AJS 15.05.2006
                                                              // Las indicaciones de colores solo las haremos si el parte es de hoy para que el sistema no marque vehiculos de ma¤ana
                                                              // como si estuvieran en marcha

                                                              IF Fecha = TODAY THEN BEGIN
                                                                IF "Hora inicio" < TIME THEN BEGIN
                                                                  IF "Hora final" > TIME THEN
                                                                    CurrForm."Tipo Servicio".UPDATEFORECOLOR := 2646048
                                                                  ELSE
                                                                    CurrForm."Tipo Servicio".UPDATEFORECOLOR := 255;
                                                                END;
                                                              END;
                                                            END;
                                                          END;
                                                           }
    { 35  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=34;
                                                 InColumnHeading=Yes }
    { 10  ;TextBox      ;0    ;0    ;2090 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Codigo Servicio";
                                                 OnFormat=BEGIN
                                                            IF "Vehiculo cambiado" THEN
                                                              CurrForm."Codigo Servicio".UPDATEFORECOLOR := 16711680
                                                            ELSE BEGIN
                                                              CurrForm."Codigo Servicio".UPDATEFONTBOLD := TRUE;

                                                              // AJS 15.05.2006
                                                              // Las indicaciones de colores solo las haremos si el parte es de hoy para que el sistema no marque vehiculos de ma¤ana
                                                              // como si estuvieran en marcha

                                                              IF Fecha = TODAY THEN BEGIN
                                                                IF "Hora inicio" < TIME THEN BEGIN
                                                                  IF "Hora final" > TIME THEN
                                                                    CurrForm."Codigo Servicio".UPDATEFORECOLOR       := 2646048
                                                                  ELSE
                                                                    CurrForm."Codigo Servicio".UPDATEFORECOLOR       := 255;
                                                                END;
                                                              END;
                                                            END;
                                                          END;
                                                           }
    { 11  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=10;
                                                 InColumnHeading=Yes }
    { 12  ;TextBox      ;0    ;0    ;2420 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Origen/Destino";
                                                 OnFormat=BEGIN
                                                            IF "Vehiculo cambiado" THEN
                                                              CurrForm."Origen/Destino".UPDATEFORECOLOR := 16711680
                                                            ELSE BEGIN
                                                              CurrForm."Origen/Destino".UPDATEFONTBOLD := TRUE;

                                                              // AJS 15.05.2006
                                                              // Las indicaciones de colores solo las haremos si el parte es de hoy para que el sistema no marque vehiculos de ma¤ana
                                                              // como si estuvieran en marcha

                                                              IF Fecha = TODAY THEN BEGIN
                                                                IF "Hora inicio" < TIME THEN BEGIN
                                                                  IF "Hora final" > TIME THEN
                                                                    CurrForm."Origen/Destino".UPDATEFORECOLOR        := 2646048
                                                                  ELSE
                                                                    CurrForm."Origen/Destino".UPDATEFORECOLOR        := 255;
                                                                END;
                                                              END;
                                                            END;
                                                          END;
                                                           }
    { 13  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=12;
                                                 InColumnHeading=Yes }
    { 1100244013;TextBox;17912;2200 ;3820 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Presentacion;
                                                 OnFormat=BEGIN
                                                            IF "Vehiculo cambiado" THEN
                                                              CurrForm.Presentacion.UPDATEFORECOLOR := 16711680
                                                            ELSE BEGIN
                                                              CurrForm.Presentacion.UPDATEFONTBOLD := TRUE;

                                                              // AJS 15.05.2006
                                                              // Las indicaciones de colores solo las haremos si el parte es de hoy para que el sistema no marque vehiculos de ma¤ana
                                                              // como si estuvieran en marcha

                                                              IF Fecha = TODAY THEN BEGIN
                                                                IF "Hora inicio" < TIME THEN BEGIN
                                                                  IF "Hora final" > TIME THEN
                                                                    CurrForm.Presentacion.UPDATEFORECOLOR        := 2646048
                                                                  ELSE
                                                                    CurrForm.Presentacion.UPDATEFORECOLOR        := 255;
                                                                END;
                                                              END;
                                                            END;
                                                          END;
                                                           }
    { 1100244014;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100244013;
                                                 InColumnHeading=Yes }
    { 14  ;TextBox      ;0    ;0    ;1111 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Hora inicio";
                                                 Format=<Hours24,2>:<Minutes,2>;
                                                 OnFormat=BEGIN
                                                            IF "Vehiculo cambiado" THEN
                                                              CurrForm."Hora inicio".UPDATEFORECOLOR := 16711680
                                                            ELSE BEGIN
                                                              CurrForm."Hora inicio".UPDATEFONTBOLD := TRUE;

                                                              // AJS 15.05.2006
                                                              // Las indicaciones de colores solo las haremos si el parte es de hoy para que el sistema no marque vehiculos de ma¤ana
                                                              // como si estuvieran en marcha

                                                              IF Fecha = TODAY THEN BEGIN
                                                                IF "Hora inicio" < TIME THEN BEGIN
                                                                  IF "Hora final" > TIME THEN
                                                                    CurrForm."Hora inicio".UPDATEFORECOLOR := 2646048
                                                                  ELSE
                                                                    CurrForm."Hora inicio".UPDATEFORECOLOR := 255;
                                                                END;
                                                              END;
                                                            END;
                                                          END;
                                                           }
    { 15  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=14;
                                                 InColumnHeading=Yes }
    { 29  ;TextBox      ;12409;2420 ;1111 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Hora final";
                                                 Format=<Hours24,2>:<Minutes,2>;
                                                 OnFormat=BEGIN
                                                            IF "Vehiculo cambiado" THEN
                                                              CurrForm."Hora final".UPDATEFORECOLOR := 16711680
                                                            ELSE BEGIN
                                                              CurrForm."Hora final".UPDATEFONTBOLD := TRUE;

                                                              // AJS 15.05.2006
                                                              // Las indicaciones de colores solo las haremos si el parte es de hoy para que el sistema no marque vehiculos de ma¤ana
                                                              // como si estuvieran en marcha

                                                              IF Fecha = TODAY THEN BEGIN
                                                                IF "Hora inicio" < TIME THEN BEGIN
                                                                  IF "Hora final" > TIME THEN
                                                                    CurrForm."Hora final".UPDATEFORECOLOR := 2646048
                                                                  ELSE
                                                                    CurrForm."Hora final".UPDATEFORECOLOR := 255;
                                                                END;
                                                              END;
                                                            END;
                                                          END;
                                                           }
    { 30  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=29;
                                                 InColumnHeading=Yes }
    { 16  ;TextBox      ;0    ;0    ;1320 ;0    ;Name=Vehiculo;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 CaptionML=ESP=Vehiculo;
                                                 SourceExpr="N§ Vehiculo";
                                                 OnFormat=BEGIN
                                                            IF "Vehiculo cambiado" THEN
                                                              CurrForm.Vehiculo.UPDATEFORECOLOR := 16711680
                                                            ELSE BEGIN
                                                              CurrForm.Vehiculo.UPDATEFONTBOLD := TRUE;

                                                              // AJS 15.05.2006
                                                              // Las indicaciones de colores solo las haremos si el parte es de hoy para que el sistema no marque vehiculos de ma¤ana
                                                              // como si estuvieran en marcha

                                                              IF Fecha = TODAY THEN BEGIN
                                                                IF "Hora inicio" < TIME THEN BEGIN
                                                                  IF "Hora final" > TIME THEN
                                                                    CurrForm.Vehiculo.UPDATEFORECOLOR := 2646048
                                                                  ELSE
                                                                    CurrForm.Vehiculo.UPDATEFORECOLOR := 255;
                                                                END;
                                                              END;
                                                            END;
                                                          END;
                                                           }
    { 17  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=16;
                                                 InColumnHeading=Yes }
    { 18  ;TextBox      ;0    ;0    ;2310 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Conductor;
                                                 OnFormat=BEGIN
                                                            IF "Vehiculo cambiado" THEN
                                                              CurrForm.Conductor.UPDATEFORECOLOR := 16711680
                                                            ELSE BEGIN
                                                              CurrForm.Conductor.UPDATEFONTBOLD := TRUE;

                                                              // AJS 15.05.2006
                                                              // Las indicaciones de colores solo las haremos si el parte es de hoy para que el sistema no marque vehiculos de ma¤ana
                                                              // como si estuvieran en marcha

                                                              IF Fecha = TODAY THEN BEGIN
                                                                IF "Hora inicio" < TIME THEN BEGIN
                                                                  IF "Hora final" > TIME THEN
                                                                    CurrForm.Conductor.UPDATEFORECOLOR := 2646048
                                                                  ELSE
                                                                    CurrForm.Conductor.UPDATEFORECOLOR := 255;
                                                                END;
                                                              END;
                                                            END;
                                                          END;
                                                           }
    { 19  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=18;
                                                 InColumnHeading=Yes }
    { 20  ;TextBox      ;0    ;0    ;1120 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Adultos transportados";
                                                 OnFormat=BEGIN
                                                            IF "Vehiculo cambiado" THEN
                                                              CurrForm."Adultos transportados".UPDATEFORECOLOR := 16711680
                                                            ELSE BEGIN
                                                              CurrForm."Adultos transportados".UPDATEFONTBOLD := TRUE;

                                                              // AJS 15.05.2006
                                                              // Las indicaciones de colores solo las haremos si el parte es de hoy para que el sistema no marque vehiculos de ma¤ana
                                                              // como si estuvieran en marcha

                                                              IF Fecha = TODAY THEN BEGIN
                                                                IF "Hora inicio" < TIME THEN BEGIN
                                                                  IF "Hora final" > TIME THEN
                                                                    CurrForm."Adultos transportados".UPDATEFORECOLOR := 2646048
                                                                  ELSE
                                                                    CurrForm."Adultos transportados".UPDATEFORECOLOR := 255;
                                                                END;
                                                              END;
                                                            END;
                                                          END;
                                                           }
    { 21  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=20;
                                                 InColumnHeading=Yes }
    { 22  ;TextBox      ;0    ;0    ;880  ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Ni¤os transportados";
                                                 OnFormat=BEGIN
                                                            IF "Vehiculo cambiado" THEN
                                                              CurrForm."Ni¤os transportados".UPDATEFORECOLOR := 16711680
                                                            ELSE BEGIN
                                                              CurrForm."Ni¤os transportados".UPDATEFONTBOLD := TRUE;

                                                              // AJS 15.05.2006
                                                              // Las indicaciones de colores solo las haremos si el parte es de hoy para que el sistema no marque vehiculos de ma¤ana
                                                              // como si estuvieran en marcha

                                                              IF Fecha = TODAY THEN BEGIN
                                                                IF "Hora inicio" < TIME THEN BEGIN
                                                                  IF "Hora final" > TIME THEN
                                                                    CurrForm."Ni¤os transportados".UPDATEFORECOLOR   := 2646048
                                                                  ELSE
                                                                    CurrForm."Ni¤os transportados".UPDATEFORECOLOR   := 255;
                                                                END;
                                                              END;
                                                            END;
                                                          END;
                                                           }
    { 23  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=22;
                                                 InColumnHeading=Yes }
    { 36  ;TextBox      ;20638;2310 ;4400 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Vuelos;
                                                 OnFormat=BEGIN
                                                            IF "Vehiculo cambiado" THEN
                                                              CurrForm.Vuelos.UPDATEFORECOLOR := 16711680
                                                            ELSE BEGIN
                                                              CurrForm.Vuelos.UPDATEFONTBOLD := TRUE;

                                                              // AJS 15.05.2006
                                                              // Las indicaciones de colores solo las haremos si el parte es de hoy para que el sistema no marque vehiculos de ma¤ana
                                                              // como si estuvieran en marcha

                                                              IF Fecha = TODAY THEN BEGIN
                                                                IF "Hora inicio" < TIME THEN BEGIN
                                                                  IF "Hora final" > TIME THEN
                                                                    CurrForm.Vuelos.UPDATEFORECOLOR := 2646048
                                                                  ELSE
                                                                    CurrForm.Vuelos.UPDATEFORECOLOR := 255;
                                                                END;
                                                              END;
                                                            END;
                                                          END;
                                                           }
    { 37  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=36;
                                                 InColumnHeading=Yes }
    { 1103355004;TextBox;34050;2530 ;1980 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Plaza Parking";
                                                 OnFormat=BEGIN
                                                            IF "Vehiculo cambiado" THEN
                                                              CurrForm."Plaza Parking".UPDATEFORECOLOR := 16711680
                                                            ELSE BEGIN
                                                              CurrForm."Plaza Parking".UPDATEFONTBOLD := TRUE;

                                                              // AJS 15.05.2006
                                                              // Las indicaciones de colores solo las haremos si el parte es de hoy para que el sistema no marque vehiculos de ma¤ana
                                                              // como si estuvieran en marcha

                                                              IF Fecha = TODAY THEN BEGIN
                                                                IF "Hora inicio" < TIME THEN BEGIN
                                                                  IF "Hora final" > TIME THEN
                                                                    CurrForm."Plaza Parking".UPDATEFORECOLOR := 2646048
                                                                  ELSE
                                                                    CurrForm."Plaza Parking".UPDATEFORECOLOR := 255;
                                                                END;
                                                              END;
                                                            END;
                                                          END;
                                                           }
    { 1103355005;Label  ;0    ;0    ;0    ;0    ;ParentControl=1103355004;
                                                 InColumnHeading=Yes }
    { 1100253003;TextBox;33708;2420 ;2083 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 CaptionML=ESP=Usuario creacion;
                                                 SourceExpr=Usuario;
                                                 OnFormat=BEGIN
                                                            IF "Vehiculo cambiado" THEN
                                                              CurrForm.Usuario.UPDATEFORECOLOR := 16711680
                                                            ELSE BEGIN
                                                              CurrForm.Usuario.UPDATEFONTBOLD := TRUE;

                                                              // AJS 15.05.2006
                                                              // Las indicaciones de colores solo las haremos si el parte es de hoy para que el sistema no marque vehiculos de ma¤ana
                                                              // como si estuvieran en marcha

                                                              IF Fecha = TODAY THEN BEGIN
                                                                IF "Hora inicio" < TIME THEN BEGIN
                                                                  IF "Hora final" > TIME THEN
                                                                    CurrForm.Usuario.UPDATEFORECOLOR := 2646048
                                                                  ELSE
                                                                    CurrForm.Usuario.UPDATEFORECOLOR := 255;
                                                                END;
                                                              END;
                                                            END;
                                                          END;
                                                           }
    { 1100253004;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100253003;
                                                 InColumnHeading=Yes }
    { 1100244015;TextBox;23257;2310 ;1700 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Proveedor;
                                                 OnFormat=BEGIN
                                                            IF "Vehiculo cambiado" THEN
                                                              CurrForm.Proveedor.UPDATEFORECOLOR := 16711680
                                                            ELSE BEGIN
                                                              CurrForm.Proveedor.UPDATEFONTBOLD := TRUE;

                                                              // AJS 15.05.2006
                                                              // Las indicaciones de colores solo las haremos si el parte es de hoy para que el sistema no marque vehiculos de ma¤ana
                                                              // como si estuvieran en marcha

                                                              IF Fecha = TODAY THEN BEGIN
                                                                IF "Hora inicio" < TIME THEN BEGIN
                                                                  IF "Hora final" > TIME THEN
                                                                    CurrForm.Proveedor.UPDATEFORECOLOR := 2646048
                                                                  ELSE
                                                                    CurrForm.Proveedor.UPDATEFORECOLOR := 255;
                                                                END;
                                                              END;
                                                            END;
                                                          END;
                                                           }
    { 1100244016;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100244015;
                                                 InColumnHeading=Yes }
    { 1100244005;CheckBox;34793;2420;1380 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 ShowCaption=No;
                                                 SourceExpr="Vehiculo cambiado" }
    { 1100244017;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100244005;
                                                 InColumnHeading=Yes }
    { 1100244018;TextBox;29658;2310 ;2530 ;440  ;Name=VehiculoAnterior1;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 CaptionML=ESP=Vehiculo Anterior;
                                                 SourceExpr=VehiculoAnterior;
                                                 OnFormat=BEGIN
                                                            IF "Vehiculo cambiado" THEN
                                                              CurrForm.VehiculoAnterior1.UPDATEFORECOLOR := 16711680
                                                            ELSE BEGIN
                                                              CurrForm.VehiculoAnterior1.UPDATEFONTBOLD := TRUE;

                                                              // AJS 15.05.2006
                                                              // Las indicaciones de colores solo las haremos si el parte es de hoy para que el sistema no marque vehiculos de ma¤ana
                                                              // como si estuvieran en marcha

                                                              IF Fecha = TODAY THEN BEGIN
                                                                IF "Hora inicio" < TIME THEN BEGIN
                                                                  IF "Hora final" > TIME THEN
                                                                    CurrForm.VehiculoAnterior1.UPDATEFORECOLOR := 2646048
                                                                  ELSE
                                                                    CurrForm.VehiculoAnterior1.UPDATEFORECOLOR := 255;
                                                                END;
                                                              END;
                                                            END;
                                                          END;
                                                           }
    { 1100244019;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100244018;
                                                 InColumnHeading=Yes }
    { 1103355000;CheckBox;41540;2420;1210 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 ShowCaption=No;
                                                 SourceExpr="Vehiculo Escolar" }
    { 1103355001;Label  ;0    ;0    ;0    ;0    ;ParentControl=1103355000;
                                                 InColumnHeading=Yes }
    { 1103355002;CheckBox;43240;2420;1760 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 ShowCaption=No;
                                                 SourceExpr="Vehiculo Minusvalidos" }
    { 1103355003;Label  ;0    ;0    ;0    ;0    ;ParentControl=1103355002;
                                                 InColumnHeading=Yes }
    { 1100244020;TextBox;37201;2530 ;2147 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Referencia;
                                                 OnFormat=BEGIN
                                                            IF "Vehiculo cambiado" THEN
                                                              CurrForm.Referencia.UPDATEFORECOLOR := 16711680
                                                            ELSE BEGIN
                                                              CurrForm.Referencia.UPDATEFONTBOLD := TRUE;

                                                              // AJS 15.05.2006
                                                              // Las indicaciones de colores solo las haremos si el parte es de hoy para que el sistema no marque vehiculos de ma¤ana
                                                              // como si estuvieran en marcha

                                                              IF Fecha = TODAY THEN BEGIN
                                                                IF "Hora inicio" < TIME THEN BEGIN
                                                                  IF "Hora final" > TIME THEN
                                                                    CurrForm.Referencia.UPDATEFORECOLOR := 2646048
                                                                  ELSE
                                                                    CurrForm.Referencia.UPDATEFORECOLOR := 255;
                                                                END;
                                                              END;
                                                            END;
                                                          END;
                                                           }
    { 1100244021;Label  ;0    ;0    ;0    ;0    ;ParentControl=1100244020;
                                                 InColumnHeading=Yes }
    { 24  ;CommandButton;15510;13860;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Default=Yes;
                                                 PushAction=LookupOK;
                                                 InvalidActionAppearance=Hide }
    { 25  ;CommandButton;17930;13860;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Cancel=Yes;
                                                 PushAction=LookupCancel;
                                                 InvalidActionAppearance=Hide }
    { 26  ;CommandButton;22770;13860;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 27  ;MenuButton   ;20350;13860;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=ESP=&Partes;
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=28;
                                                     ShortCutKey=Ctrl+F5;
                                                     CaptionML=ESP=Ficha;
                                                     OnPush=VAR
                                                              lfFicha@1100244000 : Form 7010400;
                                                              lrParte@1100244002 : Record 7010360;
                                                            BEGIN
                                                              lrParte.RESET;
                                                              lrParte.COPY(Rec);
                                                              CLEAR(lfFicha);
                                                              lfFicha.SETTABLEVIEW(lrParte);
                                                              lfFicha.SETRECORD(lrParte);
                                                              lfFicha.ActivaCampo(1);
                                                              lfFicha.RUN;
                                                            END;
                                                             }
                                                   { ID=42;
                                                     PushAction=RunObject;
                                                     CaptionML=ESP=Touroperadores;
                                                     RunObject=Form 7010410;
                                                     RunFormLink=N§ Parte=FIELD(N§ Parte) }
                                                   { ID=45;
                                                     PushAction=RunObject;
                                                     CaptionML=ESP=Extras;
                                                     RunObject=Form 7010405;
                                                     RunFormLink=N§ Parte=FIELD(N§ Parte) }
                                                   { ID=1100253000;
                                                     ShortCutKey=Ctrl+N;
                                                     CaptionML=ESP=Anotaciones;
                                                     OnPush=BEGIN
                                                              ShowAnotaciones;
                                                            END;
                                                             }
                                                   { ID=46;
                                                     MenuItemType=Separator;
                                                     CaptionML=ESP="" }
                                                   { ID=31;
                                                     CaptionML=ESP=Localizar;
                                                     OnPush=VAR
                                                              cFun@1100244001 : Codeunit 7010318;
                                                            BEGIN
                                                              cFun.buscar_en_partes(Rec);
                                                            END;
                                                             }
                                                   { ID=47;
                                                     MenuItemType=Separator;
                                                     CaptionML=ESP="" }
                                                   { ID=32;
                                                     CaptionML=ESP=Parte de trabajo;
                                                     OnPush=BEGIN
                                                              rPar.FINDFIRST;
                                                              rPar.TESTFIELD("Informe partes trabajo");

                                                              rLista.RESET; rLista.INIT;
                                                              IF rLista.GET(50190, rPar."Informe partes trabajo") THEN
                                                                REPORT.RUNMODAL(rLista."Id. Informe", TRUE, TRUE, Rec);
                                                            END;
                                                             }
                                                 }
                                                  }
    { 33  ;TabControl   ;220  ;220  ;24750;1430 ;HorzGlue=Both;
                                                 PageNamesML=ESP=Filtros }
    { 38  ;TextBox      ;2310 ;990  ;2640 ;440  ;ParentControl=33;
                                                 InPage=0;
                                                 AutoEnter=Yes;
                                                 DrillDown=No;
                                                 ClearOnLookup=No;
                                                 SourceExpr=wVehiculo;
                                                 TableRelation=Vehiculo.Matricula;
                                                 OnValidate=BEGIN
                                                              IF wVehiculo <> '' THEN
                                                                SETFILTER(Vehiculo, wVehiculo)
                                                              ELSE
                                                                SETRANGE(Vehiculo);
                                                            END;

                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 39  ;Label        ;440  ;990  ;1760 ;440  ;ParentControl=38;
                                                 CaptionML=ESP=Vehiculo }
    { 41  ;TextBox      ;11770;990  ;2640 ;440  ;ParentControl=33;
                                                 InPage=0;
                                                 AutoEnter=Yes;
                                                 DrillDown=No;
                                                 ClearOnLookup=No;
                                                 SourceExpr=wConductor;
                                                 TableRelation=Conductor.Conductor;
                                                 OnValidate=BEGIN
                                                              IF wConductor <> '' THEN
                                                                SETFILTER("Cod Conductor", wConductor)
                                                              ELSE
                                                                SETRANGE("Cod Conductor");
                                                            END;

                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 40  ;Label        ;9900 ;990  ;1760 ;440  ;ParentControl=41;
                                                 CaptionML=ESP=Conductor }
    { 43  ;TextBox      ;7040 ;990  ;2640 ;440  ;ParentControl=33;
                                                 InPage=0;
                                                 AutoEnter=Yes;
                                                 DrillDown=No;
                                                 ClearOnLookup=No;
                                                 SourceExpr=wTipoServicio;
                                                 TableRelation="Tipo Servicio".Codigo;
                                                 OnValidate=BEGIN
                                                              IF wTipoServicio <> '' THEN
                                                                SETFILTER("Tipo Servicio", wTipoServicio)
                                                              ELSE
                                                                SETRANGE("Tipo Servicio");
                                                            END;

                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.UPDATE;
                                                                 END;
                                                                  }
    { 44  ;Label        ;5170 ;990  ;1760 ;440  ;ParentControl=43;
                                                 CaptionML=ESP=Tipo Servicio }
    { 1100244004;Shape  ;220  ;13860;550  ;550  ;VertGlue=Bottom;
                                                 BackColor=2646048;
                                                 BackTransparent=No }
    { 1100244006;Label  ;880  ;13860;1540 ;550  ;HorzGlue=Left;
                                                 VertGlue=Bottom;
                                                 LeaderDots=No;
                                                 CaptionML=ESP=Terminado }
    { 1100244007;Shape  ;2530 ;13860;550  ;550  ;VertGlue=Bottom;
                                                 BackColor=0;
                                                 BackTransparent=No }
    { 1100244008;Label  ;3190 ;13860;1870 ;550  ;VertGlue=Bottom;
                                                 LeaderDots=No;
                                                 CaptionML=ESP=Sin comenzar }
    { 1100244009;Label  ;5830 ;13860;1540 ;550  ;VertGlue=Bottom;
                                                 LeaderDots=No;
                                                 CaptionML=ESP=En marcha }
    { 1100244010;Shape  ;5170 ;13860;550  ;550  ;VertGlue=Bottom;
                                                 BackColor=255;
                                                 BackTransparent=No }
    { 1100244011;Label  ;8140 ;13860;2420 ;550  ;VertGlue=Bottom;
                                                 LeaderDots=No;
                                                 CaptionML=ESP=Cambio de coche }
    { 1100244012;Shape  ;7480 ;13860;550  ;550  ;VertGlue=Bottom;
                                                 BackColor=16711680;
                                                 BackTransparent=No }
    { 1100253001;TextBox;12650;13970;2640 ;440  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Focusable=No;
                                                 HorzAlign=Center;
                                                 ForeColor=8388608;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 FontSize=9;
                                                 FontBold=Yes;
                                                 SourceExpr="Tiene Anotaciones";
                                                 OnFormat=VAR
                                                            lText00001@1100253001 : TextConst 'ESP=Anotaciones';
                                                          BEGIN
                                                            IF "Tiene Anotaciones" THEN
                                                              Text:= lText00001
                                                            ELSE
                                                              CLEAR(Text);
                                                          END;
                                                           }
    { 1100253002;CommandButton;12650;13970;2640;440;
                                                 HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 ShowCaption=No;
                                                 BackTransparent=Yes;
                                                 Border=No;
                                                 CaptionML=ESP='';
                                                 OnPush=BEGIN
                                                          IF "Tiene Anotaciones" THEN
                                                            ShowAnotaciones;
                                                        END;
                                                         }
  }
  CODE
  {
    VAR
      rPar@1100244000 : Record 7010311;
      rLista@1100244001 : Record 7035384;
      cFunImpAuto@1103350000 : Codeunit 7010405;
      cFunBas@1103355000 : Codeunit 7010310;
      wVehiculo@1100244002 : Code[10];
      wConductor@1100244003 : Code[10];
      wTipoServicio@1100244004 : Code[10];

    PROCEDURE Actualiza@1100244000();
    VAR
      lwDTInicio@1100244000 : DateTime;
      lwDTFin@1100244001 : DateTime;
      lwHora@1100244002 : Integer;
    BEGIN
      // Actualiza
      // Filtrado de la ventana
      // Nos interesa buscar un rango que vaya desde 6h antes a 24 hs. despues

      lwHora:= 3600000; // Esto es una hora en milisegundos;

      lwDTInicio:= CURRENTDATETIME - (lwHora * 12);
      lwDTFin   := CURRENTDATETIME + (lwHora * 24);

      FILTERGROUP(2);
      // JPT 02/02/10 Datetime a Biginteger
      // SETRANGE("Hora Inicio DT",lwDTInicio,lwDTFin);
      SETRANGE("Hora Inicio BI", cFunBas.DTtoBIGINT(lwDTInicio), cFunBas.DTtoBIGINT(lwDTFin));
      FILTERGROUP(0);

      // JPT 20/07/05 Lanza la importaci¢n automatica de servicios.
      cFunImpAuto.InciaImp;
    END;

    BEGIN
    {
      JPT 02/02/10 Datetime a Biginteger
      La clave "Hora Inicio DT" ha sido sustituida por "Hora Inicio BI"
    }
    END.
  }
}
