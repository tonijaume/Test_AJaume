OBJECT Form 7009823 Cell layout Overview
{
  OBJECT-PROPERTIES
  {
    Date=18/10/12;
    Time=12:18:23;
    Modified=Yes;
    Version List=AIC2009;
  }
  PROPERTIES
  {
    Width=16500;
    Height=9460;
    CaptionML=[ENU=Cell layout Overview;
               ESP=Panorama plantilla celdas;
               FRA=Panorama modäle cases];
    CaptionBar=Normal;
    SaveValues=Yes;
    InsertAllowed=No;
    SourceTable=Table85;
    DataCaptionExpr=CurrentSchedName + ' - ' + CurrentColumnName;
    OnOpenForm=BEGIN
                 IF CurrForm.LOOKUPMODE THEN BEGIN
                   CurrForm.Acciones.VISIBLE := FALSE;
                   CurrForm.OpcioT.VISIBLE := FALSE;
                   CurrForm.OpcioM.VISIBLE := FALSE;
                   CurrForm.OpcioS.VISIBLE := FALSE;
                   CurrForm.OpcioV.VISIBLE := FALSE;
                   CurrForm.EDITABLE := FALSE;
                 END;

                 IF NewCurrentSchedName <> '' THEN
                   CurrentSchedName := NewCurrentSchedName;
                 IF CurrentSchedName = '' THEN
                   CurrentSchedName := Text000;
                 IF NewCurrentColumnName <> '' THEN
                   CurrentColumnName := NewCurrentColumnName;
                 IF CurrentColumnName = '' THEN
                   CurrentColumnName := Text000;

                 //AccSchedManagement.CopyColumnsToTemp(CurrentColumnName,TempColumnLayout);
                 AccSchedManagement.OpenSchedule(CurrentSchedName,Rec);
                 AccSchedManagement.OpenColumns(CurrentColumnName,CurrForm.AccSchedMatrix.MatrixRec);
                 CurrForm.UPDATECONTROLS;
               END;

  }
  CONTROLS
  {
    { 1   ;MatrixBox    ;220  ;2970 ;16060;5500 ;Name=AccSchedMatrix;
                                                 HorzGlue=Both;
                                                 VertGlue=Both;
                                                 MatrixColumnWidth=3190;
                                                 HeadingHeight=880;
                                                 MatrixSourceTable=Table334;
                                                 OnAfterGetRecord=BEGIN
                                                                    ActualizarValor;
                                                                  END;

                                                 OnAfterGetCurrRecord=BEGIN
                                                                        IF NOT rPlantillaCeldas.GET("Schedule Name", CurrForm.AccSchedMatrix.MatrixRec."Column Layout Name",
                                                                          "Line No.", CurrForm.AccSchedMatrix.MatrixRec."Line No.") THEN BEGIN
                                                                          CLEAR(rPlantillaCeldas);
                                                                          CellValue := '';
                                                                        END;
                                                                      END;
                                                                       }
    { 2   ;TextBox      ;0    ;1100 ;1650 ;440  ;Editable=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Row No.";
                                                 OnFormat=BEGIN
                                                            IF Bold THEN
                                                              CurrForm."Row No.".UPDATEFONTBOLD := TRUE;
                                                          END;
                                                           }
    { 3   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=2;
                                                 InColumnHeading=Yes }
    { 1103355000;TextBox;1640 ;4510 ;3630 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Description }
    { 1103355001;Label  ;0    ;0    ;0    ;0    ;ParentControl=1103355000;
                                                 InColumnHeading=Yes }
    { 6   ;TextBox      ;3696 ;2200 ;9680 ;440  ;Name=ColumnValue;
                                                 ParentControl=1;
                                                 InMatrix=Yes;
                                                 MultiLine=Yes;
                                                 CaptionML=[ENU=Value;
                                                            ESP=Valor;
                                                            FRA=Valeur;
                                                            ITA=Valore;
                                                            PTG=Valor];
                                                 SourceExpr=CellValue;
                                                 AutoFormatType=1;
                                                 OnFormat=BEGIN
                                                            CurrForm.ColumnValue.EDITABLE := TipoVisualizacion = TipoVisualizacion::Sumatorio;
                                                          END;

                                                 OnValidate=BEGIN
                                                              rPlantillaCeldas.Actualizar("Schedule Name", CurrForm.AccSchedMatrix.MatrixRec."Column Layout Name",
                                                                 "Line No.", CurrForm.AccSchedMatrix.MatrixRec."Line No.",
                                                                 TipoVisualizacion, CellValue);
                                                            END;

                                                 OnLookup=VAR
                                                            GLAccList@1103350002 : Form 18;
                                                            PanoramaCeldas@1103350001 : Form 7009823;
                                                            wOpcion@1103350000 : Integer;
                                                          BEGIN
                                                            IF NOT rPlantillaCeldas.GET("Schedule Name", CurrForm.AccSchedMatrix.MatrixRec."Column Layout Name",
                                                                   "Line No.", CurrForm.AccSchedMatrix.MatrixRec."Line No.") THEN
                                                              rPlantillaCeldas.INIT;
                                                            CASE TipoVisualizacion OF
                                                              TipoVisualizacion::"Tipo celda": BEGIN
                                                                wOpcion := STRMENU(Text010, rPlantillaCeldas."Tipo celda"+1);
                                                                IF wOpcion = 0 THEN
                                                                  EXIT(FALSE);

                                                                rPlantillaCeldas."Tipo celda" := wOpcion - 1;
                                                                CellValue := FORMAT(rPlantillaCeldas."Tipo celda");
                                                                rPlantillaCeldas.Actualizar("Schedule Name", CurrForm.AccSchedMatrix.MatrixRec."Column Layout Name",
                                                                  "Line No.", CurrForm.AccSchedMatrix.MatrixRec."Line No.",
                                                                  TipoVisualizacion, CellValue);
                                                              END;
                                                              TipoVisualizacion::"Tipo mov. cont.": BEGIN
                                                                IF rPlantillaCeldas."Tipo celda" = rPlantillaCeldas."Tipo celda"::Formula THEN
                                                                  ERROR(Text012, rPlantillaCeldas.FIELDCAPTION("Tipo celda"), rPlantillaCeldas."Tipo celda",
                                                                    rPlantillaCeldas.FIELDCAPTION("Tipo mov. cont."));
                                                                wOpcion := STRMENU(Text011, rPlantillaCeldas."Tipo mov. cont."+1);
                                                                IF wOpcion = 0 THEN
                                                                  EXIT(FALSE);

                                                                rPlantillaCeldas."Tipo mov. cont." := wOpcion - 1;
                                                                CellValue := FORMAT(rPlantillaCeldas."Tipo mov. cont.");
                                                                rPlantillaCeldas.Actualizar("Schedule Name", CurrForm.AccSchedMatrix.MatrixRec."Column Layout Name",
                                                                  "Line No.", CurrForm.AccSchedMatrix.MatrixRec."Line No.",
                                                                  TipoVisualizacion, CellValue);
                                                              END;
                                                              TipoVisualizacion::Sumatorio: BEGIN

                                                                WITH rPlantillaCeldas DO BEGIN
                                                                  IF "Tipo celda" = "Tipo celda"::Formula THEN BEGIN
                                                                    PanoramaCeldas.LOOKUPMODE := TRUE;
                                                                    //PanoramaCeldas.SETRECORD(rPlantillaCeldas); //-001
                                                                    PanoramaCeldas.SetAccSchedName(CurrentSchedName); //+001
                                                                    IF PanoramaCeldas.RUNMODAL <> ACTION::LookupOK THEN
                                                                      EXIT(FALSE);
                                                                    Text += PanoramaCeldas.CeldaSeleccionada;
                                                                  END
                                                                  ELSE CASE "Tipo mov. cont." OF
                                                                    "Tipo mov. cont."::"G/L Entries","Tipo mov. cont."::"G/L Budget Entries",
                                                                    "Tipo mov. cont."::"7","Tipo mov. cont."::"8": BEGIN
                                                                      GLAccList.LOOKUPMODE(TRUE);
                                                                      IF GLAccList.RUNMODAL <> ACTION::LookupOK THEN
                                                                        EXIT(FALSE);
                                                                      Text += GLAccList.GetSelectionFilter;
                                                                    END;
                                                                  END;
                                                                END;

                                                                CellValue := Text;
                                                                rPlantillaCeldas.Actualizar("Schedule Name", CurrForm.AccSchedMatrix.MatrixRec."Column Layout Name",
                                                                  "Line No.", CurrForm.AccSchedMatrix.MatrixRec."Line No.",
                                                                  TipoVisualizacion, CellValue);
                                                              END;
                                                              { Esta opci¢n se desactiva ya que desde el propio panorama de celdas se tiene acceso a toda la informacion
                                                              TipoVisualizacion::Visualizacion: BEGIN
                                                                rPlantillaCeldas."Nombre esq. cuentas" := "Schedule Name";
                                                                rPlantillaCeldas."Nombre plantilla columnas" := CurrForm.AccSchedMatrix.MatrixRec."Column Layout Name";
                                                                rPlantillaCeldas."Nß Fila" := "Line No.";
                                                                rPlantillaCeldas."Nß Columna" := CurrForm.AccSchedMatrix.MatrixRec."Line No.";
                                                                rPlantillaCeldas.FILTERGROUP := 2;
                                                                rPlantillaCeldas.SETRECFILTER;
                                                                rPlantillaCeldas.FILTERGROUP := 0;
                                                                FORM.RUNMODAL(FORM::"Ficha plantilla celda", rPlantillaCeldas);
                                                                IF rPlantillaCeldas.FIND('-') THEN
                                                                  CellValue := STRSUBSTNO('%1\%2\%3',
                                                                    FORMAT(rPlantillaCeldas."Tipo celda"),
                                                                    FORMAT(rPlantillaCeldas."Tipo mov. cont."),
                                                                    rPlantillaCeldas.Formula)
                                                                ELSE
                                                                  CellValue := '';
                                                                rPlantillaCeldas.FILTERGROUP := 2;
                                                                rPlantillaCeldas.RESET;
                                                                rPlantillaCeldas.FILTERGROUP := 0;
                                                              END;
                                                              }
                                                            END;
                                                            CurrForm.UPDATE(FALSE);
                                                            EXIT(TRUE);
                                                          END;
                                                           }
    { 7   ;TextBox      ;12650;1540 ;1650 ;440  ;ParentControl=6;
                                                 InMatrixHeading=Yes;
                                                 HorzAlign=Center;
                                                 CaptionML=[ENU=Column Header;
                                                            ESP=Cabecera columna;
                                                            FRA=Column Header;
                                                            ITA=Testata colonna];
                                                 SourceExpr=CurrForm.AccSchedMatrix.MatrixRec."Column No." + '\' + CurrForm.AccSchedMatrix.MatrixRec."Column Header" }
    { 8   ;TabControl   ;220  ;220  ;16060;2530 ;HorzGlue=Both;
                                                 PageNamesML=[ENU=General,Gestion,Dato anal°tico,Otros;
                                                              ESP=General,Gestion,Dato anal°tico,Otros;
                                                              FRA=GÇnÇral,Gestion,DonnÇe analytique,Autres] }
    { 1103350016;CheckBox;10560;1540;440  ;440  ;Name=Muestra signo opuesto;
                                                 ParentControl=8;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 CaptionML=[ENU=Shows opposite sign;
                                                            ESP=Muestra signo opuesto;
                                                            FRA=êchantillon signe opposÇ;
                                                            ITA=Mostra con segno opposto];
                                                 SourceExpr=rPlantillaCeldas."Muestra signo opuesto";
                                                 OnValidate=BEGIN
                                                              rPlantillaCeldas.Actualizar("Schedule Name", CurrForm.AccSchedMatrix.MatrixRec."Column Layout Name",
                                                                 "Line No.", CurrForm.AccSchedMatrix.MatrixRec."Line No.",
                                                                 TipoVisualizacion::Signo, FORMAT(rPlantillaCeldas."Muestra signo opuesto"));
                                                            END;
                                                             }
    { 1103350015;Label  ;7150 ;1540 ;3300 ;440  ;Name=CaptionSigno;
                                                 ParentControl=1103350016;
                                                 CaptionML=[ENU=CaptionSigno;
                                                            ESP=CaptionSigno] }
    { 1103350008;TextBox;3850 ;1540 ;2750 ;440  ;Name=TipoMovCont;
                                                 ParentControl=8;
                                                 InPage=0;
                                                 CaptionML=[ENU=Acc. Mov. Type;
                                                            ESP=Tipo mov. cont.;
                                                            FRA=Type mvt. suit.;
                                                            ITA=Tipo mov. contabile];
                                                 OptionCaptionML=[ENU=G/L Entries,G/L Budget Entries,,,,,Analytic data;
                                                                  ESP=Movs. contabilidad,Movs. ppto. contabilidad,,,,,Dato anal°tico];
                                                 OptionString=Movs. contabilidad,Movs. ppto. contabilidad,,,,,Dato analitico;
                                                 SourceExpr=rPlantillaCeldas."Tipo mov. cont.";
                                                 OnFormat=BEGIN
                                                            DibujarControles;
                                                            CurrForm.TipoMovCont.EDITABLE := (rPlantillaCeldas."Tipo celda" <> rPlantillaCeldas."Tipo celda"::Formula);
                                                          END;

                                                 OnValidate=BEGIN
                                                              rPlantillaCeldas.Actualizar("Schedule Name", CurrForm.AccSchedMatrix.MatrixRec."Column Layout Name",
                                                                 "Line No.", CurrForm.AccSchedMatrix.MatrixRec."Line No.",
                                                                 TipoVisualizacion::"Tipo mov. cont.", FORMAT(rPlantillaCeldas."Tipo mov. cont."));
                                                            END;
                                                             }
    { 1103350009;Label  ;440  ;1540 ;3300 ;440  ;ParentControl=1103350008 }
    { 1103350007;TextBox;3850 ;990  ;2750 ;440  ;Name=TipoCelda;
                                                 ParentControl=8;
                                                 InPage=0;
                                                 CaptionML=[ENU=Cell Type;
                                                            ESP=Tipo celda;
                                                            FRA=Type cellule];
                                                 OptionCaptionML=[ENU=Formula,Net Change,Balance at Date,Beginning Balance,Year to Date,Rest of Fiscal Year,Entire Fiscal Year;
                                                                  ESP=F¢rmula,Saldo periodo,Saldo a la fecha,Saldo inicial,Hasta la fecha,Resto del a§o fiscal,A§o fiscal completo;
                                                                  FRA=Formule,Solde pÇriode,Solde Ö la date,Solde initial,Jusqu'Ö la date,Reste de l'annÇe fiscale,AnnÇe fiscale compläte];
                                                 OptionString=F¢rmula,Saldo periodo,Saldo a la fecha,Saldo inicial,Hasta la fecha,Resto del a§o fiscal,A§o fiscal completo;
                                                 SourceExpr=rPlantillaCeldas."Tipo celda";
                                                 OnActivate=BEGIN
                                                              DibujarControles;
                                                            END;

                                                 OnValidate=BEGIN
                                                              rPlantillaCeldas.Actualizar("Schedule Name", CurrForm.AccSchedMatrix.MatrixRec."Column Layout Name",
                                                                 "Line No.", CurrForm.AccSchedMatrix.MatrixRec."Line No.",
                                                                 TipoVisualizacion::"Tipo celda", FORMAT(rPlantillaCeldas."Tipo celda"));
                                                            END;
                                                             }
    { 1103350010;Label  ;440  ;990  ;3300 ;440  ;ParentControl=1103350007 }
    { 1103350014;TextBox;10560;990  ;5500 ;440  ;Name=Formula;
                                                 ParentControl=8;
                                                 InPage=0;
                                                 CaptionML=[ENU=Formula;
                                                            ESP=F¢rmula;
                                                            FRA=Formule;
                                                            ITA=Formula;
                                                            PTG=F¢rmula];
                                                 SourceExpr=rPlantillaCeldas.Formula;
                                                 OnValidate=BEGIN
                                                              rPlantillaCeldas.Actualizar("Schedule Name", CurrForm.AccSchedMatrix.MatrixRec."Column Layout Name",
                                                                 "Line No.", CurrForm.AccSchedMatrix.MatrixRec."Line No.",
                                                                 TipoVisualizacion::Sumatorio, rPlantillaCeldas.Formula);
                                                            END;

                                                 OnLookup=VAR
                                                            GLAccList@1103350002 : Form 18;
                                                            PanoramaCeldas@1103350001 : Form 7009823;
                                                            wOpcion@1103350000 : Integer;
                                                          BEGIN
                                                            IF NOT CurrForm.Formula.EDITABLE THEN
                                                              EXIT(FALSE);

                                                            IF NOT rPlantillaCeldas.GET("Schedule Name", CurrForm.AccSchedMatrix.MatrixRec."Column Layout Name",
                                                                   "Line No.", CurrForm.AccSchedMatrix.MatrixRec."Line No.") THEN
                                                              rPlantillaCeldas.INIT;

                                                                WITH rPlantillaCeldas DO BEGIN
                                                                  IF "Tipo celda" = "Tipo celda"::Formula THEN BEGIN
                                                                    PanoramaCeldas.LOOKUPMODE := TRUE;
                                                                    PanoramaCeldas.SETRECORD(rPlantillaCeldas);
                                                                    IF PanoramaCeldas.RUNMODAL <> ACTION::LookupOK THEN
                                                                      EXIT(FALSE);
                                                                    Text += PanoramaCeldas.CeldaSeleccionada;
                                                                    //PanoramaCeldas.GETRECORD(rPlantillaCeldas);
                                                                    //CellValue += rPlantillaCeldas."Nombre celda";
                                                                  END
                                                                  ELSE CASE "Tipo mov. cont." OF
                                                                    "Tipo mov. cont."::"G/L Entries","Tipo mov. cont."::"G/L Budget Entries",
                                                                    "Tipo mov. cont."::"7","Tipo mov. cont."::"8": BEGIN
                                                                      GLAccList.LOOKUPMODE(TRUE);
                                                                      IF GLAccList.RUNMODAL <> ACTION::LookupOK THEN
                                                                        EXIT(FALSE);
                                                                      Text += GLAccList.GetSelectionFilter;
                                                                    END;
                                                                    "Tipo mov. cont."::"5","Tipo mov. cont."::"Analytic Data": BEGIN
                                                                      //Rec.LookUpEstanciasFilter(1,CellValue);
                                                                    END;
                                                                  END;
                                                                END;

                                                                CellValue := Text;
                                                                rPlantillaCeldas.Actualizar("Schedule Name", CurrForm.AccSchedMatrix.MatrixRec."Column Layout Name",
                                                                  "Line No.", CurrForm.AccSchedMatrix.MatrixRec."Line No.",
                                                                  TipoVisualizacion::Sumatorio, CellValue);
                                                          END;
                                                           }
    { 1103350013;Label  ;7150 ;990  ;3300 ;440  ;ParentControl=1103350014 }
    { 1103355010;TextBox;3850 ;2090 ;2750 ;440  ;Name=CodDatoAnalitico;
                                                 ParentControl=8;
                                                 InPage=0;
                                                 CaptionML=[ENU=Analysis data Code;
                                                            ESP=C¢d. dato anal°tico;
                                                            FRA=Code donnÇe analytique];
                                                 SourceExpr=rPlantillaCeldas."Analytic data Code";
                                                 TableRelation="Dato analitico";
                                                 OnValidate=BEGIN
                                                              rPlantillaCeldas.Actualizar("Schedule Name", CurrForm.AccSchedMatrix.MatrixRec."Column Layout Name",
                                                                 "Line No.", CurrForm.AccSchedMatrix.MatrixRec."Line No.",
                                                                 TipoVisualizacion::"Dato analitico", rPlantillaCeldas."Analytic data Code");
                                                            END;
                                                             }
    { 1103355011;Label  ;440  ;2090 ;3300 ;440  ;ParentControl=1103355010 }
    { 1103350023;TextBox;3850 ;990  ;4290 ;440  ;Name=TotalHotel;
                                                 ParentControl=8;
                                                 InPage=1;
                                                 CaptionML=[ENU=Total hotel;
                                                            ESP=Total hotel];
                                                 SourceExpr=rPlantillaCeldas."Total Hotel";
                                                 OnActivate=BEGIN
                                                              DibujarControles;
                                                            END;

                                                 OnValidate=BEGIN
                                                              rPlantillaCeldas.Actualizar("Schedule Name", CurrForm.AccSchedMatrix.MatrixRec."Column Layout Name",
                                                                 "Line No.", CurrForm.AccSchedMatrix.MatrixRec."Line No.",
                                                                 TipoVisualizacion::Hotel, rPlantillaCeldas."Total Hotel");
                                                            END;

                                                 OnLookup=BEGIN
                                                            IF LookUpEstanciasFilter(1,Text) THEN BEGIN
                                                              rPlantillaCeldas."Total Hotel" := Text;
                                                              EXIT(TRUE);
                                                            END
                                                            ELSE
                                                              EXIT(FALSE);
                                                          END;
                                                           }
    { 1103350024;Label  ;440  ;990  ;3300 ;440  ;ParentControl=1103350023 }
    { 1103350021;TextBox;3850 ;1540 ;4290 ;440  ;Name=TotalTipopersona;
                                                 ParentControl=8;
                                                 InPage=1;
                                                 PermanentAssist=Yes;
                                                 CaptionML=[ENU=Total type of person;
                                                            ESP=Total tipo persona];
                                                 SourceExpr=rPlantillaCeldas."Total Tipo persona";
                                                 OnValidate=BEGIN
                                                              rPlantillaCeldas.Actualizar("Schedule Name", CurrForm.AccSchedMatrix.MatrixRec."Column Layout Name",
                                                                 "Line No.", CurrForm.AccSchedMatrix.MatrixRec."Line No.",
                                                                 TipoVisualizacion::"Tipo persona", rPlantillaCeldas."Total Tipo persona");
                                                            END;

                                                 OnAssistEdit=VAR
                                                                vTexto@1103350000 : Text[80];
                                                              BEGIN
                                                                CLEAR(vTexto);
                                                                vTexto := rPlantillaCeldas."Total Tipo persona";
                                                                IF LookUpEstanciasFilter(2,vTexto) THEN
                                                                  rPlantillaCeldas."Total Tipo persona" := vTexto;
                                                              END;
                                                               }
    { 1103350022;Label  ;440  ;1540 ;3300 ;440  ;ParentControl=1103350021 }
    { 1103350019;TextBox;11770;990  ;4290 ;440  ;Name=TotalTipoHabitacion;
                                                 ParentControl=8;
                                                 InPage=1;
                                                 CaptionML=[ENU=Total room type;
                                                            ESP=Total tipo habitacion];
                                                 SourceExpr=rPlantillaCeldas."Total Tipo habitacion";
                                                 OnValidate=BEGIN
                                                              rPlantillaCeldas.Actualizar("Schedule Name", CurrForm.AccSchedMatrix.MatrixRec."Column Layout Name",
                                                                 "Line No.", CurrForm.AccSchedMatrix.MatrixRec."Line No.",
                                                                 TipoVisualizacion::"Tipo habitacion", rPlantillaCeldas."Total Tipo habitacion");
                                                            END;

                                                 OnLookup=BEGIN
                                                            EXIT(LookUpEstanciasFilter(3,Text));
                                                          END;
                                                           }
    { 1103350020;Label  ;8360 ;990  ;3300 ;440  ;ParentControl=1103350019 }
    { 1103350017;TextBox;11770;1540 ;4290 ;440  ;Name=TotalTipoRegimen;
                                                 ParentControl=8;
                                                 InPage=1;
                                                 CaptionML=[ENU=Total board type;
                                                            ESP=Total tipo rÇgimen];
                                                 SourceExpr=rPlantillaCeldas."Total Tipo regimen";
                                                 OnValidate=BEGIN
                                                              rPlantillaCeldas.Actualizar("Schedule Name", CurrForm.AccSchedMatrix.MatrixRec."Column Layout Name",
                                                                 "Line No.", CurrForm.AccSchedMatrix.MatrixRec."Line No.",
                                                                 TipoVisualizacion::"Tipo regimen", rPlantillaCeldas."Total Tipo regimen");
                                                            END;

                                                 OnLookup=BEGIN
                                                            EXIT(LookUpEstanciasFilter(4,Text));
                                                          END;
                                                           }
    { 1103350018;Label  ;8360 ;1540 ;3300 ;440  ;ParentControl=1103350017 }
    { 1103355002;TextBox;3850 ;990  ;4290 ;440  ;Name=Dim1AnalyticData;
                                                 ParentControl=8;
                                                 InPage=2;
                                                 CaptionML=[ENU=Dim. 1 analytic data Tot.;
                                                            ESP=Total Dim. 1 dato anal°tico;
                                                            FRA=Total Dim. 1 donnÇe analytique];
                                                 SourceExpr=rPlantillaCeldas."Dim. 1 analytic data Tot.";
                                                 OnActivate=BEGIN
                                                              DibujarControles;
                                                            END;

                                                 OnValidate=BEGIN
                                                              rPlantillaCeldas.Actualizar("Schedule Name", CurrForm.AccSchedMatrix.MatrixRec."Column Layout Name",
                                                                 "Line No.", CurrForm.AccSchedMatrix.MatrixRec."Line No.",
                                                                 TipoVisualizacion::Dim1, rPlantillaCeldas."Dim. 1 analytic data Tot.");
                                                            END;

                                                 OnLookup=BEGIN
                                                            IF LookUpDimAnaDataFilter(1, Text) THEN BEGIN
                                                              rPlantillaCeldas."Dim. 1 analytic data Tot." := Text;
                                                              EXIT(TRUE);
                                                            END
                                                            ELSE
                                                              EXIT(FALSE);
                                                          END;
                                                           }
    { 1103355003;Label  ;440  ;990  ;3300 ;440  ;ParentControl=1103355002 }
    { 1103355004;TextBox;3850 ;1540 ;4290 ;440  ;Name=Dim2AnalyticData;
                                                 ParentControl=8;
                                                 InPage=2;
                                                 CaptionML=[ENU=Dim. 2 analytic data Tot.;
                                                            ESP=Total Dim. 2 dato anal°tico;
                                                            FRA=Total Dim. 2 donnÇe analytique];
                                                 SourceExpr=rPlantillaCeldas."Dim. 2 analytic data Tot.";
                                                 OnValidate=BEGIN
                                                              rPlantillaCeldas.Actualizar("Schedule Name", CurrForm.AccSchedMatrix.MatrixRec."Column Layout Name",
                                                                 "Line No.", CurrForm.AccSchedMatrix.MatrixRec."Line No.",
                                                                 TipoVisualizacion::Dim2, rPlantillaCeldas."Dim. 2 analytic data Tot.");
                                                            END;

                                                 OnLookup=BEGIN
                                                            IF LookUpDimAnaDataFilter(2, Text) THEN BEGIN
                                                              rPlantillaCeldas."Dim. 2 analytic data Tot." := Text;
                                                              EXIT(TRUE);
                                                            END
                                                            ELSE
                                                              EXIT(FALSE);
                                                          END;
                                                           }
    { 1103355005;Label  ;440  ;1540 ;3300 ;440  ;ParentControl=1103355004 }
    { 1103355006;TextBox;11770;990  ;4290 ;440  ;Name=Dim3AnalyticData;
                                                 ParentControl=8;
                                                 InPage=2;
                                                 CaptionML=[ENU=Dim. 4 analytic data Tot.;
                                                            ESP=Total Dim. 3 dato anal°tico;
                                                            FRA=Total Dim. 3 donnÇe analytique];
                                                 SourceExpr=rPlantillaCeldas."Dim. 3 analytic data Tot.";
                                                 OnValidate=BEGIN
                                                              rPlantillaCeldas.Actualizar("Schedule Name", CurrForm.AccSchedMatrix.MatrixRec."Column Layout Name",
                                                                 "Line No.", CurrForm.AccSchedMatrix.MatrixRec."Line No.",
                                                                 TipoVisualizacion::Dim3, rPlantillaCeldas."Dim. 3 analytic data Tot.");
                                                            END;

                                                 OnLookup=BEGIN
                                                            IF LookUpDimAnaDataFilter(3, Text) THEN BEGIN
                                                              rPlantillaCeldas."Dim. 3 analytic data Tot." := Text;
                                                              EXIT(TRUE);
                                                            END
                                                            ELSE
                                                              EXIT(FALSE);
                                                          END;
                                                           }
    { 1103355007;Label  ;8360 ;990  ;3300 ;440  ;ParentControl=1103355006 }
    { 1103355008;TextBox;11770;1540 ;4290 ;440  ;Name=Dim4AnalyticData;
                                                 ParentControl=8;
                                                 InPage=2;
                                                 CaptionML=[ENU=Dim. 4 analytic data Tot.;
                                                            ESP=Total Dim. 4 dato anal°tico;
                                                            FRA=Total Dim. 4 donnÇe analytique];
                                                 SourceExpr=rPlantillaCeldas."Dim. 4 analytic data Tot.";
                                                 OnValidate=BEGIN
                                                              rPlantillaCeldas.Actualizar("Schedule Name", CurrForm.AccSchedMatrix.MatrixRec."Column Layout Name",
                                                                 "Line No.", CurrForm.AccSchedMatrix.MatrixRec."Line No.",
                                                                 TipoVisualizacion::Dim4, rPlantillaCeldas."Dim. 4 analytic data Tot.");
                                                            END;

                                                 OnLookup=BEGIN
                                                            IF LookUpDimAnaDataFilter(4, Text) THEN BEGIN
                                                              rPlantillaCeldas."Dim. 4 analytic data Tot." := Text;
                                                              EXIT(TRUE);
                                                            END
                                                            ELSE
                                                              EXIT(FALSE);
                                                          END;
                                                           }
    { 1103355009;Label  ;8360 ;1540 ;3300 ;440  ;ParentControl=1103355008 }
    { 10  ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=8;
                                                 InPage=3;
                                                 Lookup=Yes;
                                                 CaptionML=[ENU=Account Schedule Name;
                                                            ESP=Nombre esquema cuenta;
                                                            FRA=Nom schÇma compte;
                                                            ITA=Nome situaz. contabile];
                                                 SourceExpr=CurrentSchedName;
                                                 LookupFormID=Account Schedule Names;
                                                 OnActivate=BEGIN
                                                              DibujarControles;
                                                            END;

                                                 OnValidate=BEGIN
                                                              AccSchedManagement.CheckName(CurrentSchedName);
                                                            END;

                                                 OnLookup=BEGIN
                                                            EXIT(AccSchedManagement.LookupName(CurrentSchedName,Text));
                                                          END;

                                                 OnAfterValidate=BEGIN
                                                                   AccSchedManagement.OpenSchedule(CurrentSchedName,Rec);
                                                                 END;
                                                                  }
    { 9   ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=10 }
    { 12  ;TextBox      ;3850 ;1540 ;2750 ;440  ;ParentControl=8;
                                                 InPage=3;
                                                 Lookup=Yes;
                                                 CaptionML=[ENU=Column Layout Name;
                                                            ESP=Nombre plantilla columna;
                                                            FRA=Nom modäle colonne;
                                                            ITA=Nome layout colonna];
                                                 SourceExpr=CurrentColumnName;
                                                 TableRelation="Column Layout Name".Name;
                                                 OnValidate=BEGIN
                                                              AccSchedManagement.CheckColumnName(CurrentColumnName);
                                                            END;

                                                 OnLookup=BEGIN
                                                            EXIT(AccSchedManagement.LookupColumnName(CurrentColumnName,Text));
                                                          END;

                                                 OnAfterValidate=BEGIN
                                                                   AccSchedManagement.OpenColumns(CurrentColumnName,CurrForm.AccSchedMatrix.MatrixRec);
                                                                 END;
                                                                  }
    { 11  ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=12 }
    { 13  ;CommandButton;14080;8690 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 19  ;OptionButton ;1870 ;8690 ;550  ;550  ;Name=OpcioV;
                                                 VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 HorzAlign=Center;
                                                 Border=Yes;
                                                 FontBold=Yes;
                                                 BitmapPos=None;
                                                 CaptionML=[ENU=V;
                                                            ESP=V;
                                                            FRA=V;
                                                            ITA=V;
                                                            PTG=Sx];
                                                 ToolTipML=[ENU=Displaying (May£s+Ctrl+V);
                                                            ESP=Visualizaci¢n (May£s+Ctrl+V);
                                                            FRA=Visualisation (Majus+Ctrl+V)];
                                                 SourceExpr=TipoVisualizacion;
                                                 OptionValue=Visualizacion }
    { 20  ;OptionButton ;1320 ;8690 ;550  ;550  ;Name=OpcioS;
                                                 VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 HorzAlign=Center;
                                                 Border=Yes;
                                                 FontBold=Yes;
                                                 BitmapPos=None;
                                                 CaptionML=[ENU=S;
                                                            ESP=S;
                                                            FRA=S;
                                                            ITA=S;
                                                            PTG=S];
                                                 ToolTipML=[ENU=Totalling;
                                                            ESP=Sumatorio (May£s+Ctrl+S);
                                                            FRA=Additionneur (Majus+Ctrl+S)];
                                                 SourceExpr=TipoVisualizacion;
                                                 OptionValue=Sumatorio }
    { 21  ;OptionButton ;770  ;8690 ;550  ;550  ;Name=OpcioM;
                                                 VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 HorzAlign=Center;
                                                 Border=Yes;
                                                 FontBold=Yes;
                                                 BitmapPos=None;
                                                 CaptionML=[ENU=M;
                                                            ESP=M;
                                                            FRA=M;
                                                            ITA=M;
                                                            PTG=M];
                                                 ToolTipML=[ENU=G/L entry type;
                                                            ESP=Tipo mov. contabilidad (May£s+Ctrl+M);
                                                            FRA=Type mvt. comptabilitÇ (Majus+Ctrl+M)];
                                                 SourceExpr=TipoVisualizacion;
                                                 OptionValue=Tipo mov. cont. }
    { 22  ;OptionButton ;220  ;8690 ;550  ;550  ;Name=OpcioT;
                                                 VertGlue=Bottom;
                                                 FocusOnClick=No;
                                                 HorzAlign=Center;
                                                 Border=Yes;
                                                 FontBold=Yes;
                                                 BitmapPos=None;
                                                 CaptionML=[ENU=T;
                                                            ESP=T;
                                                            FRA=T;
                                                            ITA=T];
                                                 ToolTipML=[ENU=Cell type;
                                                            ESP=Tipo celda (May£s+Ctrl+T);
                                                            FRA=Type cellule (Majus+Ctrl+T)];
                                                 SourceExpr=TipoVisualizacion;
                                                 OptionValue=Tipo celda }
    { 1103350000;CommandButton;9240;8690;2200;550;
                                                 Name=Aceptar;
                                                 HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Default=Yes;
                                                 PushAction=LookupOK;
                                                 InvalidActionAppearance=Hide;
                                                 CaptionML=[ENU=Accept;
                                                            ESP=Aceptar;
                                                            FRA=Accepter;
                                                            ITA=ok;
                                                            PTG=Aceitar] }
    { 1103350001;CommandButton;11660;8690;2200;550;
                                                 Name=Cancelar;
                                                 HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Cancel=Yes;
                                                 PushAction=LookupCancel;
                                                 InvalidActionAppearance=Hide;
                                                 CaptionML=[ENU=Cancel;
                                                            ESP=Cancelar;
                                                            FRA=Annulez;
                                                            ITA=Cancellare;
                                                            PTG=CANCELAMENTO] }
    { 28  ;MenuButton   ;11660;8690 ;2200 ;550  ;Name=Acciones;
                                                 HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=Functions;
                                                            ESP=Acci&ones;
                                                            FRA=Acci&ones;
                                                            ITA=F&unzioni];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=1103350002;
                                                     CaptionML=[ENU=view;
                                                                ESP=Ver;
                                                                FRA=Ver;
                                                                ITA=Visualizzare] }
                                                   { ID=1103350003;
                                                     ShortCutKey=May£s+Ctrl+T;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Cell Type;
                                                                ESP=Tipo celda;
                                                                FRA=Type cellule];
                                                     OnPush=BEGIN
                                                              TipoVisualizacion := TipoVisualizacion::"Tipo celda";
                                                            END;
                                                             }
                                                   { ID=1103350004;
                                                     ShortCutKey=May£s+Ctrl+M;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Acc. Mov. Type;
                                                                ESP=Tipo mov. cont.;
                                                                FRA=Type mvt. suit.;
                                                                ITA=Tipo mov. contabile];
                                                     OnPush=BEGIN
                                                              TipoVisualizacion := TipoVisualizacion::"Tipo mov. cont.";
                                                            END;
                                                             }
                                                   { ID=1103350005;
                                                     ShortCutKey=May£s+Ctrl+S;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=Totaling;
                                                                ESP=Sumatorio;
                                                                FRA=Additionneur;
                                                                ITA=Totale];
                                                     OnPush=BEGIN
                                                              TipoVisualizacion := TipoVisualizacion::Sumatorio;
                                                            END;
                                                             }
                                                   { ID=1103350006;
                                                     ShortCutKey=May£s+Ctrl+V;
                                                     MenuLevel=1;
                                                     CaptionML=[ENU=All;
                                                                ESP=Todos;
                                                                FRA=Tous;
                                                                ITA=Tutte le;
                                                                PTG=Todos];
                                                     OnPush=BEGIN
                                                              TipoVisualizacion := TipoVisualizacion::Visualizacion;
                                                            END;
                                                             }
                                                   { ID=1103350011;
                                                     Ellipsis=Yes;
                                                     CaptionML=[ENU=Copy cell;
                                                                ESP=Copiar celda;
                                                                FRA=Copier cellule];
                                                     OnPush=VAR
                                                              iCopiarCelda@1103350000 : Report 7009724;
                                                            BEGIN
                                                              CLEAR(iCopiarCelda);
                                                              iCopiarCelda.PasarCelda(rPlantillaCeldas);
                                                              iCopiarCelda.RUN;
                                                            END;
                                                             }
                                                 }
                                                  }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=DEFAULT;ESP=GENERICO;FRA=GêNêRIQUE;ITA=DEFAULT';
      Text001@1001 : TextConst 'ENU=* ERROR *;ESP=* ERROR *;FRA=* ERREUR *;ITA=* ERRORE *';
      Text002@1002 : TextConst 'ENU=Column formula: %1;ESP=F¢rmula columna: %1;FRA=Formule colonne: %1;ITA=Formula colonna: %1';
      Text003@1003 : TextConst 'ENU=Row formula: %1;ESP=F¢rmula fila: %1;FRA=Formule rangÇe: %1;ITA=Formula riga: %1';
      Text004@1015 : TextConst 'ENU=Not Available;ESP=No disponible;FRA=Pas disponible;ITA=Non disponibile';
      Text005@1021 : TextConst 'ENU=1,6,,Dimension %1 Filter;ESP=1,6,,Dimensi¢n %1 Filtro;FRA=1,6,,Dimension %1 Filtre';
      Text009@1103350000 : TextConst 'ENU=Stays Movs. With filters:\Hotel: %1\Pax Type: %2\Room Type: %3\Board Type: %4;ESP=Movs. Estancias con filtros:\Hotel: %1\Tipo Pax: %2\Tipo Habitaci¢n: %3\Tipo Regimen: %4';
      rPlantillaCeldas@1103350003 : Record 7009728;
      rPlantillaCeldas2@1103355002 : Record 7009728;
      AccSchedManagement@1103350007 : Codeunit 8;
      CurrentSchedName@1103350006 : Code[10];
      CurrentColumnName@1103350005 : Code[10];
      NewCurrentSchedName@1103355001 : Code[10];
      NewCurrentColumnName@1103355000 : Code[10];
      CellValue@1103350001 : Text[80];
      TipoVisualizacion@1103350002 : 'Tipo celda,Tipo mov. cont.,Sumatorio,Visualizacion,Signo,Hotel,Tipo persona,Tipo habitacion,Tipo regimen,Dato analitico,Dim1,Dim2,Dim3,Dim4';
      Text010@1103350004 : TextConst 'ENU=Formula,Net Change,Balance at Date,Beginning Balance,Year to Date,Rest of Fiscal Year,Entire Fiscal Year;ESP=F¢rmula,Saldo periodo,Saldo a la fecha,Saldo inicial,Hasta la fecha,Resto del a§o fiscal,A§o fiscal completo;FRA=Formule,Solde pÇriode,Solde Ö la date,Solde initial,Jusqu''Ö la date,Reste de l''annÇe fiscale,AnnÇe fiscale compläte';
      Text011@1103350008 : TextConst 'ENU=G/L Entries,G/L Budget Entries,,,,Stays movs.,Budget stays movs.,Gathered G/L Entries,Gathered G/L Budget Entries,Units No.,Budget Units No.,Ocupation %,Budget Ocupation %,Average price,Budget average price,Analytic data;ESP=Movs. contabilidad,Movs. ppto. contabilidad,,,,Movs. estancias,Movs. ppto estancias,Movs. contabilidad agrup.,Movs. ppto. contabilidad agrup.,Nß unidades,Ppto. nß unidades,% Ocupaci¢n,Ppto. % Ocupaci¢n,Precio medio,Ppto. precio medio,Dato Anal°tico';
      Text012@1103350009 : TextConst 'ENU=If %1 is %2 cannot assign %3;ESP=Si %1 es %2 no se puede asignar %3.';

    PROCEDURE ActualizarValor@1103350001();
    BEGIN
      IF CurrForm.LOOKUPMODE THEN
        CellValue := CeldaSeleccionada
      ELSE IF rPlantillaCeldas.GET("Schedule Name", CurrForm.AccSchedMatrix.MatrixRec."Column Layout Name",
        "Line No.", CurrForm.AccSchedMatrix.MatrixRec."Line No.") THEN
        CASE TipoVisualizacion OF
          TipoVisualizacion::"Tipo celda":
            CellValue := FORMAT(rPlantillaCeldas."Tipo celda");
          TipoVisualizacion::"Tipo mov. cont.":
            CellValue := FORMAT(rPlantillaCeldas."Tipo mov. cont.");
          TipoVisualizacion::Sumatorio:
            CellValue := rPlantillaCeldas.Formula;
          TipoVisualizacion::Visualizacion:
            IF rPlantillaCeldas."Tipo celda" = rPlantillaCeldas."Tipo celda"::Formula THEN
              CellValue := STRSUBSTNO('%1\%2\%3',
                FORMAT(rPlantillaCeldas."Tipo celda"),
                FORMAT(rPlantillaCeldas."Tipo mov. cont."),
                rPlantillaCeldas.Formula)
            ELSE
              CellValue := STRSUBSTNO('%1\%2',
                FORMAT(rPlantillaCeldas."Tipo celda"),
                FORMAT(rPlantillaCeldas."Tipo mov. cont."));
        END
      ELSE BEGIN
        CLEAR(rPlantillaCeldas);
        CellValue := '';
      END;
    END;

    PROCEDURE CeldaSeleccionada@1103350002() : Text[30];
    BEGIN
      IF (rPlantillaCeldas."Nombre esq. cuentas" <> "Schedule Name") OR
         (rPlantillaCeldas."Nß Fila" <> "Line No.") OR
         (rPlantillaCeldas."Nombre plantilla columnas" <> CurrForm.AccSchedMatrix.MatrixRec."Column Layout Name") OR
         (rPlantillaCeldas."Nß Columna" <> CurrForm.AccSchedMatrix.MatrixRec."Line No.") THEN
        IF NOT rPlantillaCeldas.GET("Schedule Name", CurrForm.AccSchedMatrix.MatrixRec."Column Layout Name",
          "Line No.", CurrForm.AccSchedMatrix.MatrixRec."Line No.") THEN
          CLEAR(rPlantillaCeldas);
      EXIT("Row No." + ':' + CurrForm.AccSchedMatrix.MatrixRec."Column No.");
    END;

    PROCEDURE DibujarControles@1103350004();
    VAR
      IsFormula@1103355000 : Boolean;
      IsAnalyticData@1103355002 : Boolean;
    BEGIN
      IF (rPlantillaCeldas."Nombre esq. cuentas" <> "Schedule Name") OR
         (rPlantillaCeldas."Nß Fila" <> "Line No.") OR
         (rPlantillaCeldas."Nombre plantilla columnas" <> CurrForm.AccSchedMatrix.MatrixRec."Column Layout Name") OR
         (rPlantillaCeldas."Nß Columna" <> CurrForm.AccSchedMatrix.MatrixRec."Line No.") THEN
        IF NOT rPlantillaCeldas.GET("Schedule Name", CurrForm.AccSchedMatrix.MatrixRec."Column Layout Name",
          "Line No.", CurrForm.AccSchedMatrix.MatrixRec."Line No.") THEN
          CLEAR(rPlantillaCeldas);


      WITH rPlantillaCeldas DO BEGIN
        IsFormula := "Tipo celda" = "Tipo celda"::Formula;
        IsAnalyticData := NOT IsFormula AND
          ("Tipo mov. cont." = "Tipo mov. cont."::"Analytic Data");
      END;

      CurrForm.Formula.EDITABLE := IsFormula;
      IF CurrForm.Dim1AnalyticData.EDITABLE <> IsAnalyticData THEN BEGIN
        CurrForm.CodDatoAnalitico.EDITABLE := IsAnalyticData;
        CurrForm.Dim1AnalyticData.EDITABLE := IsAnalyticData;
        CurrForm.Dim2AnalyticData.EDITABLE := IsAnalyticData;
        CurrForm.Dim3AnalyticData.EDITABLE := IsAnalyticData;
        CurrForm.Dim4AnalyticData.EDITABLE := IsAnalyticData;
      END;
    END;

    PROCEDURE SetAccSchedName@6(NewAccSchedName@1000 : Code[10]);
    VAR
      AccSchedName@1001 : Record 84;
    BEGIN
      NewCurrentSchedName := NewAccSchedName;
      IF AccSchedName.GET(NewCurrentSchedName) THEN
        IF AccSchedName."Default Column Layout" <> '' THEN
          NewCurrentColumnName := AccSchedName."Default Column Layout";
    END;

    PROCEDURE SetColumnName@1103355001(NewColumnName@1000 : Code[10]);
    VAR
      ColumnName@1001 : Record 333;
    BEGIN
      NewCurrentColumnName := NewColumnName;
    END;

    BEGIN
    {
      // PLB 30/09/2005
      Nuevo desarrollo: HYG-105, GUI-117

      // PLB 25/01/2007
      Actualizado con datos analiticos: SGI-118

      001 14/04/11 PLB: INC-54083. Error en SQL al realizar lookup en el †rea de datos
    }
    END.
  }
}
