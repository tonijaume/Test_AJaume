OBJECT Form 5097 Create To-do
{
  OBJECT-PROPERTIES
  {
    Date=14/08/09;
    Time=12:00:00;
    Version List=NAVW16.00.01;
  }
  PROPERTIES
  {
    Width=25520;
    Height=25960;
    CaptionML=[ENU=Create To-do;
               ESP=Crear tarea];
    Sizeable=No;
    SavePosAndSize=No;
    InsertAllowed=No;
    DeleteAllowed=No;
    LinksAllowed=No;
    SourceTable=Table5080;
    DataCaptionExpr=Caption;
    OnOpenForm=BEGIN
                 CurrForm.Step1.XPOS := 4400;
                 CurrForm.Step1.YPOS := 0;
                 CurrForm.Step2.XPOS := 4400;
                 CurrForm.Step2.YPOS := 0;
                 CurrForm.Step2NoAttendees.XPOS := 4400;
                 CurrForm.Step2NoAttendees.YPOS := 0;
                 CurrForm.Step3.XPOS := 4400;
                 CurrForm.Step3.YPOS := 0;
                 CurrForm.Step4.XPOS := 4400;
                 CurrForm.Step4.YPOS := 0;
                 FormWidth := CurrForm.Cancel.XPOS + CurrForm.Cancel.WIDTH + 220;
                 CurrForm.XPOS := ROUND((CurrForm.WIDTH - FormWidth) / 2,1) + CurrForm.XPOS;
                 CurrForm.YPOS := 3000;
                 CurrForm.HEIGHT := CurrForm.Cancel.YPOS + CurrForm.Cancel.HEIGHT + 220;
                 CurrForm.WIDTH := FormWidth;

                 CurrForm."Wizard Contact Name".EDITABLE(FALSE);
                 CurrForm."Wizard Campaign Description".EDITABLE(FALSE);
                 CurrForm."Wizard Opportunity Description".EDITABLE(FALSE);

                 IF SalesPurchPerson.GET(GETFILTER("Salesperson Code")) THEN BEGIN
                   CurrForm."Salesperson Code".EDITABLE(FALSE);
                   CurrForm.TeamTodo.EDITABLE := FALSE;
                 END;

                 IF "Team To-do" THEN BEGIN
                   CurrForm."Team Code".EDITABLE(FALSE);
                   CurrForm.TeamTodo.EDITABLE := FALSE;
                 END;

                 IF "Segment Description" <> '' THEN
                   CurrForm.SegmentDesc.EDITABLE(FALSE);

                 CurrForm.ContactSearch.ENABLED := (GETFILTER("Contact No.") = '') AND (GETFILTER("Contact Company No.") = '');

                 ShowStep(TRUE);
               END;

    OnAfterGetRecord=BEGIN
                       EnableFields;
                     END;

  }
  CONTROLS
  {
    { 3   ;Frame        ;4400 ;17710;10560;8250 ;Name=Step3;
                                                 Visible=No;
                                                 ShowCaption=No;
                                                 Border=No }
    { 15  ;Label        ;4840 ;17940;8140 ;770  ;ParentControl=3;
                                                 InFrame=Yes;
                                                 VertAlign=Top;
                                                 MultiLine=Yes;
                                                 LeaderDots=No;
                                                 CaptionML=[ENU=You can now specify optional detailed information regarding the To-do:;
                                                            ESP=Ahora puede especificar informaci¢n detallada opcional relacionada con la Tarea:] }
    { 32  ;TextBox      ;4840 ;19580;5500 ;440  ;ParentControl=3;
                                                 InFrame=Yes;
                                                 Lookup=No;
                                                 CaptionML=[ENU=To which campaign is the to-do linked?;
                                                            ESP=¨Con qu‚ campa¤a est  relacionada la tarea?];
                                                 SourceExpr="Wizard Campaign Description";
                                                 TableRelation=Campaign;
                                                 OnAssistEdit=VAR
                                                                Campaign@1102601001 : Record 5071;
                                                              BEGIN
                                                                IF GETFILTER("Campaign No.") = '' THEN BEGIN
                                                                  IF Campaign.GET("Campaign No.") THEN ;
                                                                  IF FORM.RUNMODAL(0,Campaign) = ACTION::LookupOK THEN BEGIN
                                                                    VALIDATE("Campaign No.",Campaign."No.");
                                                                    "Wizard Campaign Description" := Campaign.Description;
                                                                  END;
                                                                END;
                                                              END;
                                                               }
    { 36  ;Label        ;4840 ;19140;8140 ;440  ;ParentControl=32;
                                                 InFrame=Yes;
                                                 LeaderDots=No }
    { 35  ;TextBox      ;4840 ;20680;5500 ;440  ;ParentControl=3;
                                                 InFrame=Yes;
                                                 Lookup=No;
                                                 CaptionML=[ENU=What is the opportunity?;
                                                            ESP=¨Cu l es la oportunidad?];
                                                 SourceExpr="Wizard Opportunity Description";
                                                 TableRelation=Opportunity;
                                                 OnAssistEdit=VAR
                                                                Opp@1102601001 : Record 5092;
                                                              BEGIN
                                                                IF GETFILTER("Opportunity No.") = '' THEN BEGIN
                                                                  IF Opp.GET("Opportunity No.") THEN ;
                                                                  IF FORM.RUNMODAL(0,Opp) = ACTION::LookupOK THEN BEGIN
                                                                    VALIDATE("Opportunity No.",Opp."No.");
                                                                    "Wizard Opportunity Description" := Opp.Description;
                                                                  END;
                                                                END;
                                                              END;
                                                               }
    { 38  ;Label        ;4840 ;20240;8140 ;440  ;ParentControl=35;
                                                 InFrame=Yes;
                                                 LeaderDots=No }
    { 37  ;TextBox      ;4840 ;21780;5500 ;440  ;Name=SegmentDesc;
                                                 Editable=No;
                                                 ParentControl=3;
                                                 InFrame=Yes;
                                                 Lookup=No;
                                                 PermanentAssist=Yes;
                                                 CaptionML=[ENU=To-dos will be created for contacts linked to segment:;
                                                            ESP=Se crear n tareas para los contactos relacionados con el segmento:];
                                                 NextControl=9;
                                                 SourceExpr="Segment Description";
                                                 TableRelation="Segment Header";
                                                 OnAssistEdit=VAR
                                                                Segment@1102601000 : Record 5076;
                                                              BEGIN
                                                                IF GETFILTER("Segment No.") = '' THEN BEGIN
                                                                  IF Segment.GET("Segment No.") THEN ;
                                                                  IF FORM.RUNMODAL(0,Segment) = ACTION::LookupOK THEN BEGIN
                                                                    VALIDATE("Segment No.",Segment."No.");
                                                                    "Segment Description" := Segment.Description;
                                                                  END;
                                                                END;
                                                              END;
                                                               }
    { 40  ;Label        ;4840 ;21340;8140 ;440  ;ParentControl=37;
                                                 InFrame=Yes;
                                                 LeaderDots=No }
    { 53  ;TextBox      ;4840 ;24200;5500 ;440  ;Name=Location;
                                                 ParentControl=3;
                                                 InFrame=Yes;
                                                 CaptionML=[ENU=What is the location of the to-do?;
                                                            ESP=¨Cu l es el lugar de la tarea?];
                                                 NextControl=9;
                                                 SourceExpr=Location }
    { 54  ;Label        ;4840 ;23760;8140 ;440  ;ParentControl=53;
                                                 LeaderDots=No }
    { 20  ;TextBox      ;4840 ;22880;2750 ;440  ;ParentControl=3;
                                                 InFrame=Yes;
                                                 CaptionML=[ENU=What is the priority of the to-do?;
                                                            ESP=¨Cu l es la prioridad de la tarea?];
                                                 SourceExpr=Priority }
    { 21  ;Label        ;4840 ;22440;8140 ;440  ;ParentControl=20;
                                                 LeaderDots=No }
    { 1   ;Frame        ;14960;0    ;10560;8250 ;Name=Step1;
                                                 Visible=No;
                                                 ShowCaption=No;
                                                 Border=No }
    { 13  ;Label        ;15400;220  ;8140 ;770  ;ParentControl=1;
                                                 InFrame=Yes;
                                                 VertAlign=Top;
                                                 MultiLine=Yes;
                                                 LeaderDots=No;
                                                 CaptionML=[ENU=This wizard helps you to create to-dos.;
                                                            ESP=Este asistente le ayuda a crear tareas.] }
    { 18  ;TextBox      ;15400;1870 ;2750 ;440  ;ParentControl=1;
                                                 InFrame=Yes;
                                                 CaptionML=[ENU=What is the type of the to-do?;
                                                            ESP=¨Cu l es el tipo de la tarea?];
                                                 SourceExpr=Type;
                                                 OnValidate=BEGIN
                                                              IF Type <> xRec.Type THEN
                                                                IF Type = Type::Meeting THEN BEGIN
                                                                  AssignDefaultAttendeeInfo;
                                                                  LoadTempAttachment;
                                                                END ELSE
                                                                  ClearDefaultAttendeeInfo;
                                                            END;

                                                 OnAfterValidate=BEGIN
                                                                   EnableFields;
                                                                 END;
                                                                  }
    { 19  ;Label        ;15400;1430 ;8140 ;440  ;ParentControl=18;
                                                 LeaderDots=No }
    { 23  ;TextBox      ;15400;2970 ;5500 ;440  ;ParentControl=1;
                                                 InFrame=Yes;
                                                 CaptionML=[ENU=Describe your to-do.;
                                                            ESP=Describa la tarea.];
                                                 SourceExpr=Description }
    { 24  ;Label        ;15400;2530 ;8140 ;440  ;ParentControl=23;
                                                 LeaderDots=No }
    { 49  ;TextBox      ;17270;4730 ;1650 ;440  ;Name=Start Time;
                                                 ParentControl=1;
                                                 InFrame=Yes;
                                                 CaptionML=[ENU=What is the start time of the to-do?;
                                                            ESP=¨Cu l es la hora de inicio de la tarea?];
                                                 NextControl=51;
                                                 SourceExpr="Start Time" }
    { 44  ;CheckBox     ;15400;3630 ;3750 ;440  ;Name=AllDayEvent;
                                                 ParentControl=1;
                                                 InFrame=Yes;
                                                 CaptionML=[ENU=All Day Event;
                                                            ESP=Todo el d¡a];
                                                 SourceExpr="All Day Event";
                                                 OnAfterValidate=BEGIN
                                                                   EnableFields;
                                                                 END;
                                                                  }
    { 47  ;PictureBox   ;21120;2970 ;440  ;440  ;Focusable=No;
                                                 ParentControl=1;
                                                 InFrame=Yes;
                                                 ShowCaption=No;
                                                 Border=No;
                                                 BitmapPos=Center;
                                                 BitmapList=7,6;
                                                 SourceExpr=HasComment;
                                                 OnPush=BEGIN
                                                          ShowComment;
                                                        END;
                                                         }
    { 46  ;CommandButton;21120;2970 ;440  ;440  ;ParentControl=1;
                                                 InFrame=Yes;
                                                 ShowCaption=No;
                                                 BackTransparent=Yes;
                                                 ToolTipML=[ENU=Comment;
                                                            ESP=Comentario];
                                                 NextControl=9;
                                                 OnPush=BEGIN
                                                          ShowComment
                                                        END;
                                                         }
    { 12  ;TextBox      ;15400;4730 ;1650 ;440  ;ParentControl=1;
                                                 InFrame=Yes;
                                                 CaptionML=[ENU=What is the start date of the to-do?;
                                                            ESP="¨Cu l es la fecha de inicio de la tarea? "];
                                                 NextControl=49;
                                                 SourceExpr=Date }
    { 22  ;Label        ;15400;4290 ;8140 ;440  ;ParentControl=12;
                                                 LeaderDots=No }
    { 55  ;TextBox      ;17270;6930 ;1650 ;440  ;Name=Ending Time;
                                                 ParentControl=1;
                                                 InFrame=Yes;
                                                 CaptionML=[ENU=What is the end time of the to-do?;
                                                            ESP=¨Cu l es la hora de finalizaci¢n de la tarea?];
                                                 NextControl=9;
                                                 SourceExpr="Ending Time" }
    { 45  ;TextBox      ;15400;6930 ;1650 ;440  ;Name=Ending Date;
                                                 ParentControl=1;
                                                 InFrame=Yes;
                                                 CaptionML=[ENU=What is the end date of the to-do?;
                                                            ESP=¨Cu l es la fecha de finalizaci¢n de la tarea?];
                                                 NextControl=55;
                                                 SourceExpr="Ending Date" }
    { 42  ;Label        ;15400;6490 ;8140 ;440  ;ParentControl=45;
                                                 InFrame=Yes;
                                                 LeaderDots=No }
    { 51  ;TextBox      ;15400;5830 ;2750 ;440  ;ParentControl=1;
                                                 InFrame=Yes;
                                                 CaptionML=[ENU=What is the duration of the to-do?;
                                                            ESP=¨Cu l es la duraci¢n de la tarea?];
                                                 NextControl=45;
                                                 SourceExpr=Duration }
    { 52  ;Label        ;15400;5390 ;8250 ;440  ;ParentControl=51;
                                                 InFrame=Yes;
                                                 LeaderDots=No }
    { 29  ;CheckBox     ;15400;7590 ;3740 ;440  ;Name=TeamTodo;
                                                 ParentControl=1;
                                                 InFrame=Yes;
                                                 CaptionML=[ENU=Team to-do;
                                                            ESP=Tarea de equipo];
                                                 SourceExpr="Team To-do";
                                                 OnValidate=BEGIN
                                                              IF NOT "Team To-do" THEN BEGIN
                                                                "Team Code" := '';
                                                                IF Type = Type::Meeting THEN BEGIN
                                                                  ClearDefaultAttendeeInfo;
                                                                  AssignDefaultAttendeeInfo
                                                                END
                                                              END
                                                            END;
                                                             }
    { 6   ;Frame        ;0    ;8250 ;14960;110  ;ShowCaption=No;
                                                 TopLineOnly=Yes }
    { 7   ;Image        ;0    ;0    ;4400 ;8250 ;BackColor=8388608;
                                                 BackTransparent=No;
                                                 Bitmap=25 }
    { 8   ;CommandButton;5500 ;8580 ;2200 ;550  ;Name=Back;
                                                 Enabled=No;
                                                 CaptionML=[ENU=< &Back;
                                                            ESP=< At&r s];
                                                 OnPush=BEGIN
                                                          ShowStep(FALSE);
                                                          PerformPrevWizardStatus;
                                                          ShowStep(TRUE);
                                                          CurrForm.UPDATE(TRUE);
                                                          // UpdateCntrls;
                                                        END;
                                                         }
    { 9   ;CommandButton;7700 ;8580 ;2200 ;550  ;Name=Next;
                                                 CaptionML=[ENU=&Next >;
                                                            ESP=&Siguiente >];
                                                 NextControl=11;
                                                 OnPush=BEGIN
                                                          IF "Wizard Step" = "Wizard Step"::"3" THEN BEGIN
                                                            CurrForm.AttendeeSubform.FORM.GetAttendee(AttendeeTemp);
                                                            SetAttendee(AttendeeTemp);
                                                          END;

                                                          CheckStatus;
                                                          ShowStep(FALSE);
                                                          PerformNextWizardStatus;
                                                          ShowStep(TRUE);
                                                          CurrForm.UPDATE(TRUE);
                                                          // UpdateCntrls;
                                                        END;
                                                         }
    { 10  ;CommandButton;10120;8580 ;2200 ;550  ;Name=Finish;
                                                 Enabled=No;
                                                 CaptionML=[ENU=&Finish;
                                                            ESP=&Terminar];
                                                 OnPush=BEGIN
                                                          CurrForm.AttendeeSubform.FORM.GetAttendee(AttendeeTemp);
                                                          SetAttendee(AttendeeTemp);

                                                          CheckStatus;
                                                          FinishWizard;
                                                          CurrForm.CLOSE;
                                                        END;
                                                         }
    { 11  ;CommandButton;12540;8580 ;2200 ;550  ;Name=Cancel;
                                                 PushAction=Cancel;
                                                 CaptionML=[ENU=Cancel;
                                                            ESP=Cancelar] }
    { 4   ;Frame        ;14960;17710;10560;8250 ;Name=Step4;
                                                 Visible=No;
                                                 ShowCaption=No;
                                                 Border=No }
    { 16  ;Label        ;15400;17930;8140 ;770  ;ParentControl=4;
                                                 InFrame=Yes;
                                                 VertAlign=Top;
                                                 MultiLine=Yes;
                                                 LeaderDots=No;
                                                 CaptionML=[ENU=If the to-do is recurring, you can now specify optional information.;
                                                            ESP=Si la tarea es peri¢dica, ahora puede especificar informaci¢n opcional.] }
    { 17  ;CheckBox     ;15400;19140;8140 ;440  ;ParentControl=4;
                                                 InFrame=Yes;
                                                 CaptionML=[ENU=Recurring to-do.;
                                                            ESP=Tarea peri¢dica.];
                                                 SourceExpr=Recurring;
                                                 OnAfterValidate=BEGIN
                                                                   EnableFields;
                                                                 END;
                                                                  }
    { 26  ;TextBox      ;15400;20240;2750 ;440  ;ParentControl=4;
                                                 InFrame=Yes;
                                                 CaptionML=[ENU=What is the recurring date interval?;
                                                            ESP=¨Cu l es el intervalo de fecha peri¢dica?];
                                                 SourceExpr="Recurring Date Interval" }
    { 27  ;Label        ;15400;19800;8140 ;440  ;ParentControl=26;
                                                 LeaderDots=No }
    { 34  ;TextBox      ;15400;21340;2750 ;440  ;ParentControl=4;
                                                 InFrame=Yes;
                                                 CaptionML=[ENU=From which date do you want to calculate the due date?;
                                                            ESP=¨Desde qu‚ fecha desea calcular la fecha de vencimiento?];
                                                 NextControl=10;
                                                 SourceExpr="Calc. Due Date From" }
    { 41  ;Label        ;15400;20900;8140 ;440  ;ParentControl=34;
                                                 LeaderDots=No }
    { 5   ;Label        ;0    ;5940 ;4400 ;660  ;HorzAlign=Right;
                                                 VertAlign=Bottom;
                                                 ForeColor=12632256;
                                                 FontSize=16;
                                                 LeaderDots=No;
                                                 CaptionML=[ENU=to-do;
                                                            ESP=tarea] }
    { 43  ;Frame        ;4400 ;9460 ;10560;8250 ;Name=Step2;
                                                 Visible=No;
                                                 ShowCaption=No;
                                                 Border=No }
    { 60  ;Label        ;4620 ;9680 ;8140 ;770  ;ParentControl=43;
                                                 InFrame=Yes;
                                                 VertAlign=Top;
                                                 MultiLine=Yes;
                                                 LeaderDots=No;
                                                 CaptionML=[ENU=If you want to invite attendees, you may now select them from contacts and salespeople.;
                                                            ESP=Si desea invitar asistentes, debe seleccionarlos ahora desde contactos y vendedores.] }
    { 48  ;SubForm      ;4620 ;12320;10110;3300 ;Name=AttendeeSubform;
                                                 ParentControl=43;
                                                 InFrame=Yes;
                                                 Border=No;
                                                 SubFormID=Form5198;
                                                 SubFormLink=To-do No.=FIELD(No.) }
    { 50  ;TextBox      ;11110;10560;1700 ;440  ;ParentControl=43;
                                                 InFrame=Yes;
                                                 CaptionML=[ENU=Which template will you use for this e-mail invitation?;
                                                            ESP=¨Qu‚ plantilla utilizar  para este correo electr¢nico de invitaci¢n?];
                                                 SourceExpr="Interaction Template Code";
                                                 TableRelation="Interaction Template";
                                                 OnValidate=BEGIN
                                                              ValidateInteractionTemplCode
                                                            END;

                                                 OnAfterValidate=BEGIN
                                                                   EnableFields
                                                                 END;
                                                                  }
    { 56  ;Label        ;4620 ;10560;6270 ;440  ;ParentControl=50;
                                                 CaptionML=[ENU=Which template will you use for this e-mail invitation?;
                                                            ESP=¨Qu‚ plantilla utilizar  para este correo electr¢nico de invitaci¢n?] }
    { 57  ;TextBox      ;11110;11660;1700 ;440  ;Name=Attachment;
                                                 Editable=No;
                                                 ParentControl=43;
                                                 InFrame=Yes;
                                                 AssistEdit=Yes;
                                                 DropDown=No;
                                                 PermanentAssist=Yes;
                                                 CaptionML=[ENU=Attachment;
                                                            ESP=Archivo adjunto];
                                                 SourceExpr="Attachment No." > 0;
                                                 OnAssistEdit=BEGIN
                                                                AssistEditAttachment;
                                                              END;
                                                               }
    { 58  ;Label        ;4620 ;11660;6270 ;440  ;ParentControl=57;
                                                 CaptionML=[ENU=Attachment;
                                                            ESP=Anexo] }
    { 59  ;CheckBox     ;4620 ;15840;440  ;440  ;ParentControl=43;
                                                 InFrame=Yes;
                                                 ShowCaption=No;
                                                 CaptionML=[ENU=Send invitation(s) when I click Finish;
                                                            ESP=Enviar invitaciones al hacer clic en Finalizar];
                                                 SourceExpr="Send on finish" }
    { 61  ;Label        ;5170 ;15840;4950 ;440  ;ParentControl=59;
                                                 LeaderDots=No;
                                                 CaptionML=[ENU=Send invitation(s) when I click Finish.;
                                                            ESP=Enviar invitaci¢n/es cuando pulse Terminar.] }
    { 2   ;TextBox      ;11110;11110;1700 ;440  ;ParentControl=43;
                                                 InFrame=Yes;
                                                 SourceExpr="Language Code";
                                                 OnValidate=BEGIN
                                                              ValidateLanguageCode;
                                                            END;

                                                 OnLookup=BEGIN
                                                            LookupLanguageCode;
                                                          END;
                                                           }
    { 14  ;Label        ;4620 ;11110;6270 ;440  ;ParentControl=2 }
    { 63  ;Frame        ;14960;9460 ;10560;8250 ;Name=Step2NoAttendees;
                                                 Visible=No;
                                                 ShowCaption=No;
                                                 Border=No }
    { 33  ;Label        ;15400;9680 ;8140 ;770  ;ParentControl=63;
                                                 InFrame=Yes;
                                                 VertAlign=Top;
                                                 MultiLine=Yes;
                                                 LeaderDots=No;
                                                 CaptionML=[ENU=You must now record the contact, and the salesperson or the team linked to this to-do.;
                                                            ESP=Ahora debe registrar el contacto y el vendedor o equipo relacionado con la tarea.] }
    { 39  ;CommandButton;21120;11320;440  ;440  ;Name=ContactSearch;
                                                 ParentControl=63;
                                                 InFrame=Yes;
                                                 ShowCaption=No;
                                                 Bitmap=44;
                                                 ToolTipML=[ENU=Contact Search;
                                                            ESP=B£squeda contacto];
                                                 OnPush=VAR
                                                          SearchResult@1001 : Record 5113;
                                                          Contact@1003 : Record 5050;
                                                          ContactSearchForm@1000 : Form 5177;
                                                        BEGIN
                                                          ContactSearchForm.LOOKUPMODE(TRUE);
                                                          IF ContactSearchForm.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                            ContactSearchForm.GETRECORD(SearchResult);
                                                            IF Contact.GET(SearchResult."Contact No.") THEN BEGIN
                                                              "Wizard Contact Name" := SearchResult."Contact Name";
                                                              "Contact No." := SearchResult."Contact No.";
                                                              VALIDATE("Contact No.",SearchResult."Contact No.");
                                                              MODIFY;
                                                            END;
                                                          END;
                                                        END;
                                                         }
    { 62  ;TextBox      ;15400;11320;5500 ;440  ;ParentControl=63;
                                                 InFrame=Yes;
                                                 Lookup=No;
                                                 CaptionML=[ENU=Who is the contact?;
                                                            ESP=¨Qui‚n es el contacto?];
                                                 SourceExpr="Wizard Contact Name";
                                                 TableRelation=Contact;
                                                 OnFormat=BEGIN
                                                            IF SegHeader.GET(GETFILTER("Segment No.")) THEN
                                                              Text := Text000;
                                                          END;

                                                 OnAssistEdit=VAR
                                                                Cont@1102601001 : Record 5050;
                                                              BEGIN
                                                                IF (GETFILTER("Contact No.") = '') AND (GETFILTER("Contact Company No.") = '') AND ("Segment Description" = '') THEN BEGIN
                                                                  IF Cont.GET("Contact No.") THEN ;
                                                                  IF FORM.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                                                                    VALIDATE("Contact No.",Cont."No.");
                                                                    "Wizard Contact Name" := Cont.Name;
                                                                  END;
                                                                END;
                                                              END;
                                                               }
    { 31  ;Label        ;15400;10880;8140 ;440  ;ParentControl=62;
                                                 LeaderDots=No }
    { 25  ;TextBox      ;15400;12430;2750 ;440  ;ParentControl=63;
                                                 InFrame=Yes;
                                                 CaptionML=[ENU=Who is the salesperson responsible?;
                                                            ESP=¨Qui‚n es el vendedor responsable?];
                                                 SourceExpr="Salesperson Code" }
    { 28  ;Label        ;15400;11990;8140 ;440  ;ParentControl=25;
                                                 LeaderDots=No }
    { 30  ;TextBox      ;15400;13530;2750 ;440  ;ParentControl=63;
                                                 InFrame=Yes;
                                                 CaptionML=[ENU=What is the team code?;
                                                            ESP=¨Cu l es el c¢d. equipo?];
                                                 SourceExpr="Team Code";
                                                 OnValidate=BEGIN
                                                              IF (xRec."Team Code" <> "Team Code") AND
                                                                 ("Team Code" <> '') AND
                                                                 (Type = Type::Meeting)
                                                              THEN BEGIN
                                                                ClearDefaultAttendeeInfo;
                                                                AssignDefaultAttendeeInfo
                                                              END
                                                            END;
                                                             }
    { 64  ;Label        ;15400;13090;8140 ;440  ;ParentControl=30;
                                                 LeaderDots=No }
  }
  CODE
  {
    VAR
      Text000@1025 : TextConst 'ENU=(Multiple);ESP=(Multiple)';
      Text001@1001 : TextConst 'ENU=untitled;ESP=SinTitulo';
      Cont@1004 : Record 5050;
      SalesPurchPerson@1005 : Record 13;
      Campaign@1006 : Record 5071;
      Team@1007 : Record 5083;
      Opp@1008 : Record 5092;
      SegHeader@1009 : Record 5076;
      AttendeeTemp@1012 : TEMPORARY Record 5199;
      FormWidth@1011 : Integer;
      SalespersonFilter@1026 : Code[10];
      ContactFilter@1030 : Code[20];

    LOCAL PROCEDURE ShowStep@2(Visible@1001 : Boolean);
    BEGIN
      CASE "Wizard Step" OF
        "Wizard Step"::"1":
          BEGIN
            CurrForm.Step1.VISIBLE := Visible;
            IF Visible THEN BEGIN
              CurrForm.Finish.ENABLED(FALSE);
              CurrForm.Back.ENABLED(FALSE);
              CurrForm.Next.ENABLED(TRUE);
              CurrForm.Type.ACTIVATE;
            END;
          END;
        "Wizard Step"::"2":
          BEGIN
            CurrForm.Step2NoAttendees.VISIBLE := Visible;

            IF Visible THEN BEGIN
              IF "Team To-do" = FALSE THEN BEGIN
                CurrForm."Salesperson Code".ENABLED := Visible;
                CurrForm."Team Code".ENABLED := NOT Visible;
              END ELSE BEGIN
                CurrForm."Salesperson Code".ENABLED := NOT Visible;
                CurrForm."Team Code".ENABLED := Visible;
              END;
              CurrForm.Back.ENABLED(TRUE);
              IF Type = Type::Meeting THEN
                CurrForm."Wizard Contact Name".ENABLED(FALSE)
              ELSE
                CurrForm.Finish.ENABLED(Visible);
            END;
          END;
        "Wizard Step"::"3":
          BEGIN

            CurrForm.Step2.VISIBLE := Visible;
            IF NOT ISSERVICETIER THEN
              CurrForm.AttendeeSubform.VISIBLE := Visible;
            IF NOT Visible THEN
              CurrForm.AttendeeSubform.FORM.GetAttendee(AttendeeTemp);
            IF Visible THEN BEGIN
              GetAttendee(AttendeeTemp);
              CurrForm.AttendeeSubform.FORM.SetAttendee(AttendeeTemp);
              CurrForm.AttendeeSubform.FORM.SetTodoFilter(SalespersonFilter,ContactFilter);
              CurrForm.AttendeeSubform.FORM.UpdateForm;
            END;

            IF Visible THEN BEGIN
              CurrForm.Finish.ENABLED(TRUE);
              CurrForm.Back.ENABLED(TRUE);
              CurrForm.Next.ENABLED(TRUE);
            END;
          END;
        4:
          BEGIN
            CurrForm.Step3.VISIBLE := Visible;
            IF Visible THEN BEGIN
              CurrForm.Finish.ENABLED(TRUE);
              CurrForm.Back.ENABLED(TRUE);
              CurrForm.Next.ENABLED(TRUE);
              CurrForm."Wizard Campaign Description".ACTIVATE;
            END;
          END;
        5:
          BEGIN
            CurrForm.Step4.VISIBLE := Visible;
            IF Visible THEN BEGIN
              CurrForm.Finish.ENABLED(TRUE);
              CurrForm.Back.ENABLED(TRUE);
              CurrForm.Next.ENABLED(FALSE);
              CurrForm.Recurring.ACTIVATE;
            END;
          END;
      END;
    END;

    PROCEDURE Caption@1() : Text[260];
    VAR
      CaptionStr@1000 : Text[260];
    BEGIN
      IF Cont.GET(GETFILTER("Contact Company No.")) THEN
        CaptionStr := COPYSTR(Cont."No." + ' ' + Cont.Name,1,MAXSTRLEN(CaptionStr));
      IF Cont.GET(GETFILTER("Contact No.")) THEN
        CaptionStr := COPYSTR(CaptionStr + ' ' + Cont."No." + ' ' + Cont.Name,1,MAXSTRLEN(CaptionStr));
      IF SalesPurchPerson.GET(GETFILTER("Salesperson Code")) THEN
        CaptionStr := COPYSTR(CaptionStr + ' ' + SalesPurchPerson.Code + ' ' + SalesPurchPerson.Name,1,MAXSTRLEN(CaptionStr));
      IF Team.GET(GETFILTER("Team Code")) THEN
        CaptionStr := COPYSTR(CaptionStr + ' ' + Team.Code + ' ' + Team.Name,1,MAXSTRLEN(CaptionStr));
      IF Campaign.GET(GETFILTER("Campaign No.")) THEN
        CaptionStr := COPYSTR(CaptionStr + ' ' + Campaign."No." + ' ' + Campaign.Description,1,MAXSTRLEN(CaptionStr));
      IF Opp.GET(GETFILTER("Opportunity No.")) THEN
        CaptionStr := COPYSTR(CaptionStr + ' ' + Opp."No." + ' ' + Opp.Description,1,MAXSTRLEN(CaptionStr));
      IF SegHeader.GET(GETFILTER("Segment No.")) THEN
        CaptionStr := COPYSTR(CaptionStr + ' ' + SegHeader."No." + ' ' + SegHeader.Description,1,MAXSTRLEN(CaptionStr));
      IF CaptionStr = '' THEN
        CaptionStr := Text001;

      EXIT(CaptionStr);
    END;

    LOCAL PROCEDURE EnableFields@21();
    BEGIN
      CurrForm."Recurring Date Interval".ENABLED(Recurring);
      CurrForm."Calc. Due Date From".ENABLED(Recurring);

      IF NOT Recurring THEN BEGIN
        EVALUATE("Recurring Date Interval",'');
        CLEAR("Calc. Due Date From");
      END;

      IF Type = Type::Meeting THEN BEGIN
        CurrForm."Start Time".ENABLED := NOT "All Day Event";
        CurrForm."Ending Time".ENABLED := NOT "All Day Event";
        CurrForm.Duration.ENABLED := NOT "All Day Event";
        CurrForm.Location.ENABLED := TRUE;
        CurrForm.AllDayEvent.ENABLED := TRUE;
        CurrForm."Language Code".ENABLED("Interaction Template Code" <> '');
        CurrForm.Attachment.ENABLED("Interaction Template Code" <> '');
      END ELSE BEGIN
        CurrForm."Start Time".ENABLED := FALSE;
        CurrForm."Ending Time".ENABLED := FALSE;
        CurrForm.Location.ENABLED := FALSE;
        CurrForm.Duration.ENABLED := FALSE;
        CurrForm.AllDayEvent.ENABLED := FALSE;
      END;
    END;

    BEGIN
    END.
  }
}
